# AN ADAPTIVE DIGITAL FILTER

## Claims
Adaptives Digitalfilter mit einer Z Transfer Funktion, die stufenweise oder zumindest in jeder vorgegebenen Periode veränderlich ist, mit

## Description
The present invention relates to an improved iterative controlled adaptive digital filter which is stable in operation and has improved phase response characteristics. The present filter is used for instance as a predictive filter in an adaptive PCM ADPCM modulator and or demodulator. According to the present invention, only the relative location of a pair of solutions of a transfer function on a unit circle on a Z ¹ plane is monitored, while a prior art monitors the values themselves of the solutions zero, and pole of denominator and numerator of transfer function of a non recursive digital filter which has a feedback loop. Fig.1 shows a block diagram of an ADPCM system which is one of the applicatoins of the present invention. In Fig.1, the numeral 0 is an A D converter to convert an analog signal for instance, voice signal or picture signal at the input terminal 11 to a digital form, 1,4 and 7 are adders, 2 is a quantizer for converting an input digital signal to a PCM code, 3 and 6 are inverse quantizers which demodulates a PCM signal, 5 and 8 are filters, 9 is a D A converter for converting a digital signal to an analog form, and 11 through 18 are terminals. An analog signal at the input terminal 11 is converted to a digital form by the A D converter 0. A digital signal s Similarly, the signal at the output terminal 13 is transmitted to a reception side or a demodulation side. A noise might be added to the signal during the signal is transmitted to the reception side. In a reception side, the reception signal at the input terminal 16 is reproduced to the reproduce signal by the inverse quantizer 6, the adder 7 and the filter 8. Further, the output signal at the terminal 17 is converted to an analog form by the D A converter 9. Fig.2 is a block diagram of a prior non recursive digital filter for the filters 5 and 8 in Fig.1. In Fig.2, the symbol Z ¹ is a delay circuit which provides the delay time T which is equal to the sampling period of the digital signal. The symbols α₁ through α It has been known that an all pole type filter is preferable for a speech signal On the other hand, a filter which has not only a pole but also a zero point is preferable for multi level digital signal which has quick change in both amplitude and phase. However, a filter with both a pole and a zero point has not been used because that kind of filter is apt to oscillate and be affected by noise. Fig.3 shows a block diagram of an ADPCM system which includes both a pole and a zero point. In the figure, the numerals 19, 20, 21 and 22 are filters, 23 through 26 are terminals. Other symbols in Fig.3 are the same as those of Fig.1. The filters 19 through 22 are non recursive filters with the structure of Fig.2. The transfer function H Z ¹ of the transmission side of Fig.3 has the following form. Conventionally, it has been known that a prior filter of Fig.2 is not stable in operation. Further, in a prior art, the response of the system is not stable for an input signal which has unexpected statistical nature, and or noise, and further, the filter is apt to oscillate and or the reproduced code has much code error. In order to solve the above problem, one solution is to use a fixed filters 20 and 22 only filters 19 and 21 are adaptive filters , and the other prior solution is to delete the filters 20 and 22, and that the filters 19 and 21 have the series connection of a plurality of dual quadratic element filters each of which has a pair of tap coefficients in a stable area. However, the former solution has the disadvantage that the adaptive capability and or the redundancy compression capability is reduced. The latter solution has the advantage that the stable condition of the filter is satisfied, but, no mathematical algorithm for determining mutual relations between tap coefficients and solutions pole and zero point of each element filter. If the filters are adjusted so that an error signal becomes minimum, the convergence of solutions becomes slow and effect of a zero point becomes vague. A sound synthesizer comprising a certain puls processing is disclosed in GB A 2 059 726, thereby particulary comprising a sound synthesis filter section which is composed of a second order filter means with a zero on a unit circle in a complex plane. The output from the filter section is fed back to the input side through certain cascade operating means. The publication of P.A. Lynn in Med. Biol. Eng. Comput. Furthermore in the publication of J. M. Raulin in IEEE International Symposium of Circuits and Systems It is an object of the present invention to overcome the disadvantages and limitations of a prior adaptive filter according to the preamble of claim 1 by providing a new and improved adaptive filter, which has both a pole and a zero point, is stable in operation, and has excellent phase response. Preferably, solutions of a numerator, and solutions of a denominator of the transfer function locate alternately on a unit circle on a Z ¹ plane to assure stable operation and or minimum phase shift response of the filter. The foregoing and other objects, features, and attendant advantages of the present invention will be appreciated as the same become better understood by means of the following description and accompanying drawings wherein Fig.4 shows a block diagram of the adaptive filter according to the present invention. Fig.4 is the detailed block diagram of the filter 19, 20, 21 or 22 in Fig.3, and is used by inserting the same in the block 19, 20, 21 or 22 in Fig.3. The present filter has three substantially parallel branches A, B and C. The former two branches A and B have a series circuit which has a plurality of non recursive filters each of which has the degree equal to or less than 2 relating to the operator Z ¹. The third branch C is just a direct line. The adder 28 is provided to add the outputs of the branches A and B, and another adder 29 is provided to add the output of the adder 28 and the third branch C. The attenuator 30 for multiplying ½ to the input signal is provided between the input terminal and the branches A and B. The numeral 27 is another attenuator for providing the multiplication by the value which is 1 or less than 1 but close to 1, to the input signal. The structure of the filters 19 through 22 are completely identical, except that a degree of each element filter, and the solution pole or zero point of the filter depending upon the tap coefficients are differenct from those of other filters. When the filter is a zero filter, each tap coefficient is given below, where n is a degree of an element filter. The transfer function h Z ¹ of the present filter is given by the following equations. When n is an even number Fig.4 shows the case when n is an odd number, and the case when n is an even number equation 3 is shown in Fig.5. It is assumed for the sake of the simplicity of the explanation that n is an even number, a filter is a zero filter in the following description. Fig.6 shows the location of the solutions on a Z ¹ plane when n 8. All the solutions are imaginary number, which is positioned on a unit circle Z ¹ 1 . The symbols w The tap coefficients c The relations between coefficients of a transversal filter in Fig.2, and coefficients of the present adaptive filter Fig.4 are shown below, where the transfer function of the transversal filter in Fig.2 is The successive iterative update of the coefficients are accomplished by for instance correlation calculation, an inverse filtering, et al. The transfer function H Z of the present seccessive adaptive filter may be all pole type, all zero type, or pole zero type. Fig.7 shows the second embodiment of the present adaptive filter, when the degree of the filter is an even number. In the figure, the numeral 7 1 is an adaptive filter, 7 2 is an inverse filter for generating gradient vector component of a filter coefficient d According to the algorithm of a gradient method, a filter coefficient of an adaptive filter at time k 1 is updated by the following equations. The gradient vector component of the equations 26 and 27 are shown in the following equations, where E z is a z conversion of the difference signal e The following equations are useful for simplifying a hardware structure, instead of the above two equations. As described above, according to the second embodiment, the gradient vector component of successive updated coefficients according to the gradient method algorithm is obtained by an inverse filter. Therefore, the calculation is simple, and the stability of the updated solutions can be checked merely by the separation check alternate location check of the solutions. The embodiment is applicable to a pole zero type transfer function, pole type filter, zero type filter. As a modification of the second embodiment, the gradient vector component of a filter coefficient is obtained by correlation calculation, instead of using an inverse filter. Fig.8 is the third embodiment, in which the degree of the filter is M 4. In the figure, the numerals 8 1 and 8 2 are input and output terminals, respectively, 8 3 is an adaptive filter described in the previous first or second embodiment, 8 4 is an output buffer of an output of the adaptive filter 8 3, and 8 5 is a calculation circuit for the calculation of the gradient vector component of a filter coefficient. The gradient vector component in the equations 26 and 27 is obtained by the equations 5 , and 8 through 11 as follows. Accordingly Fig.9 shows the fourth embodiment of the present invention. In the figure, 1 and 2 are prediction filter, 3 is a line, 4 is a memory, 5 and 6 are calculation elements The circuit of Fig.9 provides the prediction signal s and from the input signal s. Then, the difference e between the signal s and the prediction signal s and is transmitted to the line. Then, the reception side reproduces the reproduction signal of the original signal s. The signal in the reception side is indicated by , which means that the signal is suffered from noise in the transmission line. The symbols in the figure are as follows. output signal pulse of the system, that is to say, the reproduction signal of the signal s. tap coefficients Fig.9 of the prediction filter 2. While the second and the third embodiments control directly the tap coefficients of an adaptive predictive filter, the fourth embodiment controlls the angular frequency w A pair of solutions of the prediction filter 1 in Fig.9 i 1 m 2 are controlled according to the next equation, where k is a discrete time. The tap coefficients are shown below. where The coefficients when m 6 in the equation 38 are shown below. Similarly, a pair of solutions i 1 n 2 are defined by the following equations. The tap coefficients are given below. where The constant α in the equations 40 and 49 are in the range 2 ⁷ and 2 ¹⁰. The four kinds of solutions i 1 m 2 prediction filter 1 , i 1 n 2 prediction filter 2 are obtained iteratively by the calculation of the equations 38 through 49 . Those values correspond to the angular frequency radian of the zero point and the pole of the transfer function H₀. The fourth embodiment is based upon the fact that the result of the iterative change of the four normalized angular frequency is in a predetermined range, and has the particular pattern defined by a kind of a signal. Fig. 10 shows the features of a speech, and a modem signal 9.6 kbps . In case of a speech signal, the range of the solution overlaps with that of adjacent solution. On the other hand, in case of a modum signal, the range of the solutions does not overlap. The memory 4 stores the upper limit value and the lower limit value of the range of the solution as a window set. The updated values of the solutions are calculated by the calculation element 5 equations 38 and 47 . Next, sequence check of the solutions is accomplished. If those conditions are satisfied, the transfer function H₀ reception , and the inverse transfer function 1 H₀ transmission side are stable and provide a minimum phase shift response. Next, the check if the solutions are within the window set window check is accomplished. When the solutions locates in the window set of a modem signal, the input signal is recognized as a modem signal, and the identification signal ID is output. The sequence check and the window check are accomplished by the calculation element 6, which is enough merely to perform subtraction and recognition of a sign positive or negative . If the calculation element 6 provides an output signal after a plurality of signal recognitions, a time constant is obtained in a recognition. When no identification output ID is provided, it is recognized that a reception signal is not normal, and perhaps a noise disturbed the signal. In that case, the value of the solution is reset to the previous value or the initial value so that the system does not oscillate. Thus, the unexpected operation by noise is prevented. As described above, the fourth embodiment transmits a difference of a digital signal, and monitors iteratively the solution of a prediction filter, then, the stable transmission of a signal is obtained, the minimum phase shift response is satisfied, the recognition of a signal is accomplished both in a transmission side and a reception side, and further, the affection by a noise is prevented. Fig.11 shows the location of the solutions for a modem signal of 9.6 kbps, and a modem signal of 4.8 kbps. In this case, the range of the solutions is similar to each other. The embodiments of Fig.10 and Fig.11 function to discriminate an input signal from a speech signal and a modem signal. Fig.12 shows a fifth embodiment of the present invention. In the figure, the symbol AQ is a quantizer, AQ ¹ is an inverse quantizer. The quantizer AQ provides the pulse code train I According to the embodiment of Fig.12, the PCM signal which is the differential signal is received, and according to said process, the signal is discriminated correctly in a short time. Fig.13 is a block diagram of sixth embodiment of the present invention. The embodiment of Fig.13 separates the error signal to the error signal e p k by a pole filter, and another error signal e z k by a zero point filter, while the previous embodiments use an error signal which is the difference between an input signal and the sum of a first prediction signal by a pole filter and a second prediction signal by a zero point filter, as an objective function for minimizing the error in an iterative control of an adaptive prediction filter. According to the embodiment of Fig.13, the updated tap coefficient of a pole filter is obtained by the correlation value of e p k and reproduced output signal S The structure of a pole filter and a zero point filter in Fig.13 is the same as that of the embodiments of Figs.1 through 5, and the calculation process in Fig.13 is shown below. The control is accomplished according to the following equation at a discrete time k.