# Microwave impedance measurement apparatus.

## Abstract
Apparatus for measuring the impedance or another parameter of a device by reference to the standing wave pattern set up in a transmission line along which microwave energy is applied to the device. A section of the transmission line has three spaced probes from the output voltages of which corresponding digital values are produced and digital computing means calculates the impedance from the values. Calibrating measurements using a matched load and a short circuit instead of the device are performed earlier and the result representing probe sensitivities and energy wavelength used to simplify and speed up the calculations, so that a reasonably smooth display plot of the impedance with varying energy frequency can be produced in real time. The computing means has an 8 bit microprocessor for the handling and a 16 bit microprocessor to perform the calcula tions.

## Claims
CLAIMS 1. Apparatus for measuring the impedance of a microwave device or a parameter related thereto by reference to the standing wave pattern set up in a transmission line along which microwave energy is applied to the device, the apparatus including an input for oscillations from a microwave oscillator, a section of transmission line for applying the oscillations to a device the impedance or other parameter of which is to be measured, a plurality of probes for sampling the microwave energy at respective spaced positions along the section of line and producing output voltages, a probe interface circuit connected to receive the output voltages from the probes and produce corresponding digital values therefrom, a digital signal processor circuit connected to receive the digital values as inputs from the probe interface circuit, the circuit being programmed to obtain calibration data representing the sensitivities of the probes and the wavelength of the microwave energy in the transmission line section and to calculate in response to the inputs, the spacing of the probes and the calibration data the effective impedance of the device connected to the transmission line section, or data related to that impedance, as indicated by the phase and amplitude of a standing wave pattern set up in the section, the energy of which is sampled by the probes, and to generate output signals, and output means responsive to the output signals to produce a display representing the impedance or related parameter. 2. Apparatus according to claim 1 in which the digital signal processor circuit is programmed to store data derived from digital values received from the probe interface circuit when a first load matched to the impedance of the transmission line section and a second load short circuiting the transmission line section are individually attached to the section, the derived data forming the calibration data and representing the normalised sensitivity of the probes and the wavelength of the microwave energy in the transmission line section. 3. Apparatus according to claim 1 or 2 including temperature responsive means coupled to the transmission line section whereby digital values representing the temperatures of the probes can be passed to the digital signal processor circuit to enable the effects of temperature changes on the probes to be compensated. 4. Apparatus according to claim 2 with or without the feature of claim 3, wherein the digital signal processor includes a first microprocessor and a second microprocessor, the first microprocessor receiving the digital values from the probe interface circuit, instructing the second microprocessor to perform calculations on the digital values and receiving output values from the second microprocessor to produce therefrom the output signals, and the second microprocessor performing the calculations while the first microprocessor is performing other functions. 5. Apparatus according to claim 4, wherein the second microprocessor is provided with high speed random access memory which it uses when performing the calculations, and the first microprocessor has access to the high speed random access memory to enter therein and extract therefrom digital values. 6. Apparatus according to claim 5, wherein the first microprocessor also transfers calculations program data for the second microprocessor from a read only memory to the high speed random access memory. 7. Apparatus according to claim 6 wherein the calculation program data includes data relating to the parameters of the probes. 8. Apparatus according to any preceding claim wherein the spacing of the probes along the transmission line section is chosen so that relative to the wavelength of the energy in the section no two probes are separated by an integral number of half wavelengths, at least one probe is separated from the device by a distance not close to an integral number of quarter wavelengths, and the ratios of the spacing distances of the probes from the device are equal to the ratios of prime numbers each greater than the number of wavelengths in the spacing distances. 9. Apparatus according to any preceding claim Wherein the device has an outlet for microwave energy, the apparatus including a further transmission line section connected to the outlet of the device, the further section having a fourth probe and a matched load so that the foruth probe measures the amount of microwave energy transmitted by the device, and means for producing a digital value from the output of the fourth probe,which digital value is applied to the digtal signal processor circuit which is programmed to produce output signals representing the transmission performance of the device. 10. Apparatus according to any preceding claim wherein the probe interface circuit has an input for a variable d.c. signal from a microwave oscillator representing the frequency of the oscillations produced, means for comparing the level of the d.c. signal with a preset value generated in response to an output of the digital signal processor circuit, and means for holding the digital values representing probe outputs in response to an output from the comparing means so that the values held represent probe outputs at a frequency corresponding to the preset value.

## Description
This invention relates to apparatus for the measurement of the impedance of microwave networks or devices. In the design, construction and adjustment of microwave networks or devices, it is necessary to assess the performance of the devices and one way of doing this is to measure the impedances of the networks or devices.Impedance measurement of a microwave device makes use of the standing wave pattern set up in a transmission line or waveguide along which microwave energy is applied to the device, and the theory and practice of this technique have been described for instance in chapter 8 of Volume II of the M.I.T. Radiation Laboratory Series, 1st Edition, published by McGraw EIill. Originally a single sliding probe was employed to explore the startling wave pattern, but later three fixed probes spaced apart by one eighth of the wavelength of the microwave signal in the transmission line were used as described, for example, in an article entitled Check Impedance with an Electronic Slotted Line by Norman Spector, pages AS to 51 of Microwaves, September 1976.A difficulty with the methods described is that when the probe voltages have been measured it is then necessary to perform lengthy calculations before the actual value of the impedance can be kncwn, with the result that the process of adjusting a microwave device for optimum performance can take a very long time. This time becomes even longer if the impedance is required at different frequencies. It is an object of the present invention to reduce this difficulty enabling a display of the impedance value to be produced from the probe voltages within a relatively short time. According to the present invention there is provided apparatus for measuring the impedance of a microwave device or a parameter related thereto by reference to the standing wave pattern set up in a transmission line along which microwave energy is applied to the device, the apparatus including an input for oscillations from a microwave oscillator, a section of transmission line for applying the oscillations to a device the impedance or other parameter of which is to be measured, a plurality of probes for sampling the microwave energy at respective spaced positions along the section of line and producing output voltages, a probe interface circuit connected to receive the output voltages from the probes and produce corresponding digital values therefrom, a digital signal processor circuit connected to receive the digital values as inputs from the probe interface circuit, the circuit being programmed to obtain calibration data representing the sensitivities of the probes and the wavelength of the microwave energy in the transmission line section and to calculate in response to the inputs the spacing of the probes and the calibration data the effective impedance of the device connected to the transmission line section, or data related to that impedance, as indicated by the phase and amplitude of a standing wave pattern set up in the section, the energy of which is sampled by the probes, and to generate output signals, and output means responsive to the output signals to produce a display representing the impedance or related parameters. The signal processor circuit may include a microprocessor or computing means of greater size and complexity. The apparatus may be calibrated by measuring the probe voltages when devices of known impedance are attached to the transmission line section. Conveniently, a device matched to the impedance of the transmission line section and a device short circuiting the transmission line section may be used. Since the efficiencies of the probes and the sensitivities of their associated R.F. detectors may vary slightly the use of a matched load on the transmission line section will enable the outputs of the probes to be normalised because the microwave energy level is the same at all places along the section. A short circuit on the transmission line section will produce total reflection of the R.F. energy so that a measure of the wavelength of the energy in the transmission line can be derived. In addition, it has been found that the R.F. detectors are affected by changes in temperature, and therefore a temperature sensor may be provided on the transmission line section so that an input representing its temperature and consequently that of the detectors can be fed to the signal processor circuit to correct the outputs from the detectors.The correction required may be measured beforehand and stored in the signal processor circuit, for example in digital form in a read only memory a set of read only memories respective to the detectors may be provided so that if a detector is changed the read only memory can also be changed to maintain the calibration of the apparatus. The oscillator connected to the apparatus may be of variable frequency and ramp generating means may be included or provided separately to cause the frequency of the oscillator to increase steadily or in steps over a range of values. The ramp generating means may be connected to the processor circuit so that the calculations performed can take into account the variation in oscillator frequency and the display can indicate tireffect of change in frequency on the impedance of the device under test. The processor may be arranged to control the ramp generation or may follow it. The spacing of the probes should be chosen relative to the wavelength of the RF energy in the transmission line section so that relatively large errors do not arise in the calculations. The probes themselves may be connected to the electric or magnetic field within the transmission line where appropriate or if the transmission line is a waveguide they may take the form of holes coupling the fields within the guide to, for example, strip lines outside the guide. The probes have detectors which produce d.c. output signals. The probe interface circuit is arranged to perform the analogue to digital conversions so that digital inputs are fed to the signal processing circuit. Where the device under test also has a microwave output the apparatus may include a further probe probe coupled to this output and interfaced to provide a further input to the processor circuit. In general, the apparatus will include three probes along the section of transmission line, as this number of probes will enable three equations to be set up which can be solved readily for the unknowns as will be explained later.Certain calibration measurements are made to simplify the calculations required, but addition calibrationsmeasurements could enable the apparatus to function adequately with only two probes on the transmission line section. The output means may include a cathode ray tube display device, a numerical display and or a printer with a suitable interface for receiving, and storing if necessary, data from the processor circuit. The programming of the processor circuit may include the processing of the impedance data and or other data related thereto to produce a display of a specific form from such as a Smith Chart. The data related to the impedance may be, for example, the reflexion coefficient and its phase. Alternatively, the transmission loss could be displayed as a function of frequency. The microprocessor circuit could be arranged to calculate and store each point of the display as the osciallator frequency performs a single sweep throgh the range and build up the display as spots on a raster scanned cathode ray tube progressively in synchronism with the frequency sweep. The display would need to be refreshed frequently from the stored display data. The stored data could represent picture elements of the display to be produced, and the data could also be fed to a dot matrix printer. Alternatively, if the display is in the form of a linear graph similar to that of an oscilloscope, X,Y or r, e deflection, the stored data could represent the coordinates of successive points along the line to be produced as the display, from which data deflection voltages for the cathode ray tube would be derived.Stored data of this latter form could be applied to a plotter if a printed output is required.It may be preferable for the oscillator frequency to be stepped rather than continuously varied through the range so that the different probe voltages relate to exactly the same frequency this is on the assumption that the probe voltages are sampled or converted sequentially. Alternatively, the probe voltages may be sampled simultaneously and the conversion carried out on the sampled values. The processor circuit may provide signals for controlling the sweeping or stepping of the oscillator frequency or these signals may be generated by a separate clock which also produces a synchronising input for the processor circuit. Alternatively, as would be appropriate if the ramp generator were incorporated in the oscillator, a signal from the ramp generator could be applied to the processor to indicate to it the frequency of the oscillation being produced at the time.The control of the oscillator frequency could also be manual, in which case a corresponding voltage would be applied to the processor and the output could take the form of a single value display. The processor circuit itself may include a first, 8 bit, microprocessor to perform the receiving of the data and the operations required to convert the output data in the desired format, and a second, 16 bit, processor to carry out the calculations on the data The programs and calibration data required for the calculations to be performed by the second processor may be stored in a read only memory. Because of the shorter access time of semiconductor random access memories than that of read only memories it may be desirable to transfer the data from the read only memory to a random access memory to increase the speed of the caculations performed by the second processor. In order that the invention may be fully understood and readily carried into effect an embodiment will now be described with reference to the accompanying drawings, of which FIGURE 1 is a diagram of the probes and probe interface of one example of apparatus according to the invention FIGURE 2 is a diagram of the signal processor circuit of the example of the invention FIGUREs 3 4 show in more detail the circuit of the probe interface FIGURE 5 shows the circuit of a random access memory of the signal processor circuit of Figure 2 FIGURE 6 shows the circuit of a read only memory of the signal processor circuit of Figure 2 and FIGUREs 7 8 show further parts of the circuit of Figure 2. Before describing in detail the embodiment of the invention shown in the drawings, the form of the calculation of the impedance from the output voltages of the probes will be indicated, leading to the derivation of formulae suitable for determining the actual value of the impedance from the probe voltages by the processor circuit. The distribution of voltage along a terminated transmission line resulting from an applied oscillation may be expressed in the form Vx k 1 P2 22.cos 8 2.x 2 . . . . 1 where x is the distance along the line from a termination, p is the ratio of the magnitudes of the waves reflected by and incident on the termination, e is the phase angle difference between the incident and reflected waves at the reference plane, i.e. the load, and is 2 g, where g is the wavelength of the oscillation along the transmission line and in some cases is assumed to be known. In order to find the impedance of the termination it is necessary to calculate the values of p and , because from these the impedance can be determined, as follows ZL Zo 1 P.ei 1 P.ei where Zo is the characteristic impedance of the transmission line, and ZL is the impedance of the termination. For three probes producing voltages V1, V2 and V3 and located at distances x1, x2 and x3 from the termination, equation 1 becomes V12 k 1 p 2 2 P.cos 2ss.x1 v2ê k 1 Pê 2P.cos 2ss.x2 v3ê k 1 Pê 2P.cos 2ss.x3 To carry out an analysis of an unknown termination, it will be necessary to find p, e. k, kg. k may be found by considering the system terminated with a matched load. when p o k v2LDue to the spread of manufacturing tolerances of the detecting device, it will be necessary to normalise the voltage outputs obtained. For the three probes under matched load conditions vl2L kl v22L k2 v23L k3Let k kl k2 k3 3The three normalisation factors are Al k A2 k A3 k kl k2 k3 with a short circuit termination, p 1 and so for probe 1, v21 kl 2 2 Cos 2ssx 2V1L 1 CosTh Cos2ssx1 Sin Sin2ssx1 2v21L 1 Cos 2ssx1 EMI11.1 Similar calculations are made for the 2 other probes.EMI12.1 Cos 2ssx1 U1 28x Cos U1 There are an infinite number of angles whose cosines are U1, producing an infinite number of values of g 2ssx 2n Cos 1U1 where n is an integer.Thus g 2 x1 0.5 Cos 1U1Several values of g can be ignored a Negative values i.e. for n o b Those out of the range of interestThe correct value of g can be found by comparison with those calculated at the other probes. The required value will appear at all three probe positions.Measurements on an unknown terminationTo find the impedance of the termination, p and G must be found.The outputs from the three probes may be expressed as v1ê k1 1 pê 2p Cos 2ssx1 v2ê k2 1 pê 2pCos 2ssx2 v3ê k3 1 pê 2pCos 2ssx3 Normalisation and re arrangement gives v4 Alv21 k 1 p2 2p Cose Cos2ssx1 Sine Sin2ssx1 ....4 v5 A2v22 k 1 p2 2p Cose Cos2ssx2 Sine Sin2ssx2 ....5 v6 A3v23 k 1 p2 2p Cose Cos2ssx3 Sine Sin2ssx3 ....6V6 3 kFl p 2p Cose Cos2x3 SinO Sin2x3 i ...6Let A pSine B prose So that p Also let C1 Cos2ssx1 C2 Cos2ssx2 C3 Cos2ssx3 S1 Sin2ssx1 S2 Sin2ssx2 S3 Sin2ssx3Substituting in 4, 5, 6V4 k 1 A2 B2 2 BC1 As1 1 ............ 7 v5 k 1 A2 B2 2 BC2 AS2 .............8V6 k 1 A2 B2 2 BC3 As3 1 ............. 9 subtracting v4 v5 2kB cl c2 2kA S2 S1 A 5 V4 v5 2kB Cl C2 2k S2 S1 substituting for A in 7. produces a quadratic equation inB2 which can be evaluated using the general expressions ax2 bx c o and x P b b2 4ac 2a yielding 2 values of B.Each value of B may then be substituted in equation 8.to produce 2 values of ASimilarlyV5 V6 2kB C2 C3 2kA 53 S2 A V5 V6 2kB C2 C3 2k s3 S2 substitution in 8. produces another quadratic in B2 which gives 2 more values of B.These values of B may be substituted in equation 9. to give 2 further values of A.Comparisons of the two sets of values for A and B will yield the correct values, which can be used to extract psine and pCosB. A graph of the voltage reflection co efficient can thus be obtained by plotting pCos as the X co ordinate, and psine as the Y co ordinate.An impedance plot is obtained by superimposing this graph onto a Smith chart.Also note that o tan 1 A B and p X A B Sine Cos One example of apparatus according to the present invention will now be described with reference to Figures 1 and 2, of which FIGURE 1 is a diagram of the probe interface circuit together with the transmission line section and the probes, and FIGURE 2 is a diagram of the digital signal processor circuit which receives as inputs the signals from the probe interface circuit and produces output signals representing the impedance or related parameter of the device under the test. In Figure 1, the transmission line section is indicated at 1 and has connected to it a device 2 under test. Some examples of the device 2 may have a microwave output to which a further section 3 of transmission line is attached and which preferably incorporates a matched load. This further section and its associated components are shown in dotted form because they would not be provided in all embodiments of the apparatus. Amplifiers 4 are provided for the outputs from detectors 4A to which probes 4B provide signals representing the magnitude of the microwave energy in the part of the transmission line section where they are located.The probes 4B may be of the type Omni Spectra 204 8232A and the detectors 4A may be of the type Wiltron 75850. The amplifiers 4 are of the type AD 517 manufactured by AnalogDevices. It has been found that the detectors 4A are sensitive to changes in temperature and therefore a further amplifier 5, like the amplifiers 4, are provided and which receives the output of a temperature transducer which may be of the type AD 590 manufactured by Analog Devices. The outputs of the amplifiers 4 are applied as inputs to respective sample and hold circuit 6 of type AD 582 manufactured byAnalog Devices, and the outputs of the sample and hold circuit 6 and the amplifier 5 are applied to an analogue signal multiplexer 7 of type Analog Devices AD 7501.The output of the multiplexer 7 is applied to a 12 bit analogue to digital converter 8 of type Analog Devices AD 574 which feeds a parallel digital output via a bus 8A to a peripheral interface adaptor of types 6522. The adaptor 9 provides a 3 bit address input to the multiplexer 7 via conductors 9A and also a control signal for the converter 8 via a conductor 9B. The converter generates a ready signal which it transmits to the adaptor 9 via a conductor 8B when it has completed an analogue to digital conversion. The adaptor 9 is connected to the conductors of a bus 15 adapted to suit a microprocessor of the type 6502, which bus is also connected to provide input digital data to a digital to analogue converter 10 of type Analog DevicesAD 7542. The monostable trigger 11 of type 74LS123 is set by the output of a comparator 12 of type National SemiconductorLM 319 when the voltage of a ramp output from a radio frequency generator 13, which ramp voltage represents the output frequency of the generator, reaches the value of the output voltage from the converter 10. The output from the monostable trigger 11 is applied to operate the hold circuits of the sample and hold circuits 6 and also provides via an interrupt connection a signal to the 6502 microprocessor to cause it to accept signals from the peripheral interface adaptor 9.The generator 13 is connected by a flange or other coupling 14 to the section 1 of transmission line. It is expected that the user of the apparatus would provide an RF generator and therefore no particular type of generator is suggested. The bus for the type 6502 microprocessor is also shown in Figure 2 where it is connected to the microprocessor 16 itself by means of a bus buffer transceiver 17 consisting of 74LS241 and 74LS245 integrated circuits.For test purposes an input from a block 17A can isolate the microprocessor 16 from the bus 15 so that the components attached to the bus can be tested by inputs fed in at 15A. Connected to the bus 15 are a random access memory of capacity 3k x 8 bits formed of integrated circuits of type HM 6116 manufactured by Hitachi, and three EPROM circuits 19 of type 2732, each of capacity 32k x 8 bits.TheEPROM circuits 19 are selected by a bank select switch 20 formed of integrated circuits of type 74LS138. Output circuitry connected to the bus 15 include a video display controller 21 of type Thompson EF 9365 with a video refresh random access memory of capacity 16k x 16 bits formed of type 4116 integrated circuits and driving a video display monitor 23 of type Motorola MD 2000.In addition, two 12 bit digital to analogue converters 24 and 25 of typeAD 7542 receive digital data from the bus 15 and feed deflection voltages Vy and Vx respectively to aa X Y plotter 26A which has a pen control signal fed to it by means of a latch 26 connected to the bus 15. Interfaces 27 and 38 are provided for connections 27A and 38A respectively forIEEE 488 and RS 232 external buses. The IL 488 interface 27 may be of type Motorola MC 68488 and the RS 232 inteface 38 may be an asynchronous communication adaptor of typeR 6551. A keyboard 29 is connected to the bus 15 by means of an interface 28. For convenience of use the keyboard is coupled to the interface 28 by an infra red link and uses a transmitter of type Plessey So 490, the interface 28 including a Plessey SL 480 receiver and an ML 924 decoder. A second microprocessor,of type Texas InstrumentsTMS 9995, is provided having its own bus 32 connectible to the bus 15 by a transceiver 30 formed of integrated circuits type 74LS241 and 74LS245. The transceiver 30 and microprocessor 33 are controlled by a controller 31 of type 6821 connected to the bus 15. The 9995 bus 32 is connected to high speed random access memory 34 of capacity 4k x 8 bits formed of integrated circuits of type 2148 and a bipolar read only memory 35 of capacity lk x 8 bits formed by an integrated circuit type Texas Instruments TEP 28586. A second peripheral interface adaptor 36 is connected to the bus 15 to drive a printer buffer 37 connected to a parallel printer interface 37A. No particular construction is suggested for the interface 37A since this will vary in dependence upon the type of printer used. Detailed circuits of parts of the probe interface circuit shown in Figure 1 and the digital signal processor circuit shown in Figure 2 are set out in Figures 3 to 8 in which the same reference numerals as are used in Figures 1 and 2 are employed, so that the part shown can readily be recognised. Figure 3 shows the sample and hold circuit 6 together with the multiplexer 7 and analogue to digital converter 8 of Figure 1. Figure 4 shows the peripheral interface adaptor 9 of Figure 1 together with its input connections from the converter 8 and its output connections to the bus 15 shown in Figure 4 but not shown in Figure 1 are buffers constructed from individual integrated circuits of type 74LS241 and gating circuits for selecting the registers in the adaptor 9 formed of an integrated circuit of type 74LS125A. Figure 5 shows the random access memory 18 ofFigure 2 together with chip select circuitry not shown in Figure 2 and formed by an integrated circuit of type 74LS183. Figure 6 shows one of the EPROM circuits 19 ofFigure 2 together with chip select circuitry included in, the switch 20. Figure 7 shows the keyboard interface 28 which includes the receiver and decoder for infra red signals from the transmitter connected directly to the keyboard 29.This interface includes a versatile interface adaptor of type 6522 for connecting the keyboard to the bus 15. Figure 8 shows the RS 232 interface circuit 38 including an integrated circuit of type R 6551 asynchronous communication interface adaptor together with a 1.8432 MHz oscillator. In the operation of the apparatus described above, before the device 2 the impedance of which is to be found is connected to the output of the transmission line section 1, the calibration measurements are carried out using a matched load and a short circuit load in place of the device 2.As described above in the mathematical explanation of the operation of the apparatus these calibration measurements provide an indication of the sensitivities of the detectors so that their outputs can be normalised, and a measure of a the wavelength of microwave energy in the transmission line section 1. The measurements are performed at a number of frequencies throughout the range and the values stored.Although the response of the detectors is almost independent of frequency, the response of a probe and a detector together can vary considerably with frequency. The value of h9 g is also taken for different frequencies so that the inaccuracies in the frequency of the output of the R.F. generator can be corrected in fact the frequency can be calculated from using the known characteristics of the transmission line from which the section 1 is made, and the exact relationship between the ramp voltage output and the frequency determined. If desired the corrected frequency may be displayed as an output. The results of the calibration measurements may be stored in the EPROM s 19, and if desired each EPROM may be arranged to store, amongst other data, the response of a respective detector and probe, but in the following description of the operation the results of the calibration measurements are stored in the RAM 18. The following is a list of operations which are performed by the apparatus described in the sequence given 1. Power on, perform self check.2. Display equipment connection details to the operator.3. Instruct operator to attach matched load to the probe unit.4. Instruct operator to increase RF output level on RF generator gradually.5. Monitor RF level in the probe unit using the outputs from the probes.6. When the RF level is optimum i.e. between ¹ and h of the maximum which the probes can handle display Level Correct . 7. Display Enter Probe Unit Codes . These are reference numbers allocated to the different probes so that correction can be made for their parameters.8. Retrieve probe unit parameters from store X 1,2 3, calibration constants .9, Display Set start frequency on generator to xxxxGHz .10. Display Set stop frequency on generator to xxxxGHz .11. Display Set sweep time to xxx secs. press enter button on keyboard .12. Dump program for matched load test from 6502 EPROM to 9995 RAM.13. For each of 4096 discrete frequencies between F START CAL F STOP CAL a Input probe voltages and temperature from probe assembly. b Retrieve compensation factors and calibration constants for selected probe unit from 6502 EPROM. c Dump data a b to 9995 RAM and initiate 9995 matched load mathematics program to calculate K and probe sensitivity normalisation constants Al, A2 A3 . d Transfer results of c to 6502 RAM.14. Display Attach short circuit and press RETURN key.15. Dump program for short circuit test from 6502 EPROM to 9995 RAM.16. For each of 4096 discrete frequencies between F START CAL AND F STOP CAL a Input probe voltages and temperature from probe assembly. b Retrieve K, Al, A2 and A3 compensation factors and calibration constants from 6502 ROM RAM. c Dump data a b to 9995 RAM and initiate 9995 9995 Short Circuit load maths program to calculate Xg. d Transfer results of c to 6502 RAM.17. Display Attach unknown load press RETURN key .18. Display Enter Start Frequency GHz and press ENTER Key Input F START MEAS . Display Enter Stop Frequency GHz and press ENTER Key Input F STOP MEAS . Display measurement cycle menu. e.g. Display Format 1. Smith Chart 2. Amplitude vs. Frequency 3. Phase vs. Frequency. Cursor control instructions. 19. Dump program for measurement test from 6502 EPROM to 9995 RAM.20. For each discrete frequency between F START MEAS BR F STOP MEAS a Input probe voltages temperature from probe unit. b Retreive calibration constants compensation factors K Al, A2 A3 Ag from 6502 EPROM RAM. c Dump date a b to 9995 RAM. d Initiate 9995 measurement maths program to derive Amplitute and phase values. e Transfer results of d to 6502 RAM.21. While 9995 is calculating results for each frequency, format previous result according to display type selected and send this information to video display processor.22. Display graph in selected format with indication of current cursor position, 23. Display F START MEAS F STOP MEAS .24. Display Frequency, Amplitude and phase at current cursor position. 25. Display Interrupt options menu 26. Repeat 22 to 27 until Interrupt occurs. Some further details of certain of the operations are given below 1. On switch on, the power on reset circuitry 39 resets the two microprocessors 16 33 and sets all other peri phorals to a known condition, The controller 31 asserts hold on the 9995 33 which sets all its bus lines 32 to a high impedance state, The 6502 16 then executes a self check subroutine which exercises the RAM 18 and checks internal supply voltages via the analogue multiplexer 7, the 12 bit Analogue to Digital Convertor 8 and the peripheral interface adaptor 9.2. A series of vector coordinates stored in EPROM 19 is transferred over the bus 15 to the video display controller 21. This then calculates line plots and stores them in the video refresh RAM 21. This results in a high resolution drawing of connection details to be displayed on the video display monitor, 5. The probes, which are embedded in the probe unit 1, convert RF energy into a d.c. level. These voltages are conditioned and amplified by the amplifiers 4 and continuous samples taken by the sample and hold amplifiers 6. A binary representation of any probe voltage can be input to the 6502 16 via the multiplexer 7, the analogue to digital converter 8 PIA 9 and 6502 Bus 15.These levels are compared to optimum levels held in store EPROM 19 Account is taken of the fact that a probe voltage with a short circuit load can be four times as great as its output with a matched load.11. The action of pressing the ENTER button on the key board causes an interrupt to the 6502 which indicates that the operator has completed adjustments requested in steps 7, 9, 10 and 11. 12. The sequence for transferring program and parameter data from the 6502 memory to the 9995 High Speed RAM 34 is as follows. a The hold line on the 9995 is made active, which isolates the 9995 MPU 33 from its bus 32. b The controller 31 switches the bus buffer transceiver 30 on which connects the 6502 bus 15 to the 9995 bus 32. c This means the high speed RAM34 now becomes part of the 6502 memory map, thus enabling a transfer of data under 6502 control from either EPROM 19 or RAM 18 to the high speed RAM 34. d After the transfer, the bus buffers 30 isolate the two busses.13a. To acquire a set of probe voltages at a particular frequency, a voltage is applied to one input of com parator 12 from the 6502, via the digital to analogue converter lo. The other comparator input is the ramp voltage output from the RF generator which is proportional to frequency. When the ramp voltage in one comparator input exceeds the set voltage on the other input, the com parator output changes state. The monostable multivibrator 11 outputs a short pulse on a positive transition from the comparator. This pulse enables the sample and hold amplifiers 6 to acquire the probe voltages and also interrupts the 6502 to indicate that the m uisition is complete. The 6502 now selects each probe voltage via PIA 9 and MPX 7 , and commands the A D converter 8 to initiate a conversion.13c. 16c. 20d. The high speed RAM 34 contains the 9995 program and the arguments for the mathematics to be performed. The Bipolar PROM 35 contains mathematical subroutines which can be called. from the main program. The 9995 hold line is released which causes the program to be executed. Results of calculations are returned to the high speed RAM 34. The last instruction in the program is IDLE which causes an output to toggle. This interrupts the 6502 to indicate that the calculations are complete. Other interrupts are KEYBOARD INTERRUPT functions are as foBbws 1. Dump numeric data. to printer Parallel RS 232 .2, Change display format Display menu .3. Set Frequency for digital readout of results.4. Change Start Stop frequencies.5. Expand display.6. Transferlcomplete control to I.E.E.E. controller.7. Output graphics to X Y plotter Vx Vy, Pen up down .8. Cursor up in frequency or Cursor down in frequency.9. Return to calibrate mode. ERROR INTERRUPT Display cause of error and instruct on procedure to rectify if possible. The microprocessor 33 performs the calculations set out earlier to calculate the impedance or other parameter of the device under test, and the details of the way in which the calculations are preformed and what results are stored are set out in Table 1. It will be noted that the programs for the microprocessor 33 are stored in the EPROM s 19 and are transferred to the RAM 34 for execution this is because the access time of the RAM 34 is much shorter than that of the EPROM 19 and it is important that the calculations be performed quickly.It is intended that the operation of the apparatus is sufficiently rapid for a useful display of the impedance to be produced in real time on the monitor 23 or at a similar speed on the X Y plotter 26A. The use of the calibration measurements also speeds up the operation of the apparatus because the calculations are simpler and shorter than they would otherwise be. The apparatus may also be arranged to produce a more detailed output, for example up to 4096 frequency points, on the monitor 23 or the plotter 26A, but obviously the period of time needed to produce such an output would be longer than for a simpler output of, say, 32 frequency points. A typical embodiment of the invention might have the following features which could be obtained by suitable programming of the microprocessor 16 and the use of the video display controller 21. It can accept an input voltage from a fourth probe and use this in conjunction with the three other inputs to calculate and display insertion loss.During the calibration procedure it would be possible to set up the start and stop frequencies and display them on the screen.During calibration it would be possible to check for variations in incident power and the correlation between ramp voltage and frequency.During calibration a check could be made for deterioration in crystal sensitivity and noise output and a failure report produced if necessary.The R.F. generator can be swept manually to any frequency within band. This frequency may be indicated by brightening up trace or providing marker.It can either sweep plots of p and e against frequency Smith Chart p against frequency, or Insertion loss against frequency. OR display p, commat , and I.L. in alphanumeric form at spot frequencies.It may have a fault finding system to determine faults to board level.It may have operator instructions on calibration and measurement procedures in ROM which can be displayed to prompt the operator. Instructions may be provided to enable a selected part of the displayed image to be displayed on a larger scale and possibly with higher accuracy. Additional display storage may be provided to enable a previous image to be displayed with the current one so that, for example, the effects of tuning can be seen. From a consideration of the calculations performed by the apparatus it will be apparent that the positions of the probes influence the accuracy obtainable in the result, and indeed if the spacing of the probes is.a multiple of half a wavelength of the microwave energy in the transmission line section then it will not be possible to solve the equations. The constraints on the probe positions may be summarised as follows 1. No pair of probes may be spaced by a distance of a multiple of half a wavelength of the energy in the transmission line section for any frequency in the range of interest. 2. For any frequency in the range of interest at least one of the probes must be spaced from the load by a distance not close to an integral multiple of a quarter wavelength of the energy in the transmission line section. 3. The ratios of the probe distances from the load, x1 x2 and xl x3, must be of the form p q where p and q are prime numbers greater than the number of wavelengths in the transmission line section of the microwave energy in the distances. All of these constraints arise because of the periodic nature of the sine function. It can be shown that it is desirable to keep the probe distances as small as is practicable. Although the invention has been described with reference to a specific embodiment it is not limited to this embodiment and many alterations may be made, possibly arising from improvements in microcomputer components, without departing from the invention. TABLE ICALIBRATION PROCEDUREEMI32.1 tb SEP First SEP attach SEP matched SEP load. SEP p SEP SEP 0, SEP e SEP any SEP value tb SEP We SEP then SEP get SEP at SEP first SEP probe tb SEP VlL2 SEP SEP kl SEP SEP k1 o SEP SEP 2k 0 SEP kl tb SEP ViL SEP tb SEP Similarly tb SEP V2L2 SEP SEP k2 SEP SEP k2 tb SEP V SEP 2 SEP kg SEP k3 tb SEP 2 SEP 2 tb SEP Let SEP k SEP SEP 1 SEP 2 SEP SEP k3 SEP V1L SEP SEP V2L SEP SEP V3L2 tb SEP 3 SEP 3 tb SEP 2. SEP Allow SEP for SEP different SEP crystal SEP sensitivities tb SEP Normalise SEP as SEP follows tb SEP MultIply SEP V2 SEP by SEP k SEP V12 SEP 2 SEP k SEP A tb SEP k1 SEP V1L2 SEP by SEP k1 tb SEP Multiply SEP V2L2 SEP by SEP k2 SEP SEP V2N2 SEP k2 SEP A2 tb SEP k2 tb SEP 2 SEP Ir SEP 2 SEP SEP k SEP A tb SEP Multiply SEP V3L SEP by SEP k3 SEP 3N SEP k3 SEP SEP 3 tb SEP .. SEP V1N SEP SEP V2N SEP SEP sV3N2 SEP SEP k tb SEP N tb SEP Then SEP attach SEP short SEP circuit SEP p SEP SEP 1, SEP e s SEP 2x1 SEP SEP x1 tb SEP We SEP then SEP get SEP at SEP first SEP probe SEP 2x2 SEP x2 tb SEP Vls2 SEP k1 SEP SEP kl l 2 SEP SEP 2kl.l.cos n 2gxl SEP 2 SEP x3 SEP 3 SEP x3 tb SEP Vls2 SEP SEP 2kl SEP 1 SEP SEP cos n lpxl l tb SEP V152 SEP SEP 2k111 SEP cosn,cos2exl SEP SEP sinit.sin2 3x1J tb SEP V1S2 SEP SEP 2k1 SEP 1 SEP SEP cos2ssxl tb EMI33.1 tb SEP 33 SEP 2 tb Normalise SEP by SEP multiplying SEP by SEP k SEP SEP A1 SEP V15 SEP J tb SEP k1 SEP Ji tb SEP J1. SEP A1 SEP SEP 2k SEP l cos2x1 SEP V252 SEP SEP J2 tb SEP V3s2 SEP 2 SEP J3 tb SEP 39 tb SEP Y1 SEP 2k SEP l cos2x1 SEP 2 SEP kk SEP SEP J1A1 SEP 1 tb SEP 1 SEP 2k SEP SEP 2k SEP SEP 2kcos2ssxl SEP V25 SEP 2.kk2 SEP SEP J2A2 SEP tb SEP 2k.cos2ssxl SEP SEP 2k SEP SEP Y1 SEP V352 SEP k SEP SEP J3A3 SEP Y3 tb SEP y SEP k3 SEP 3 tb SEP CoS2ssXl SEP SEP 1 SEP SEP 2k SEP SEP UI SEP 1 SEP SEP Y1 tb SEP 2k SEP SEP 1 SEP SEP 2k SEP SEP 1 SEP y tb SEP 2box1 SEP SEP cos SEP lug SEP SEP Q SEP 1 SEP SEP 2k2 SEP SEP U1 tb SEP 2k SEP tb SEP y tb SEP SEP Y3 SEP SEP U tb SEP 2k SEP 3 tb The SEP angles SEP whose SEP cosines SEP are SEP U1 SEP are SEP given SEP by SEP cos SEP U1 tb SEP U1 tb SEP 2ns SEP SEP 91 SEP cos SEP U2 SEP tb SEP SEP 2 tb SEP and SEP 2ns SEP SEP 91 SEP cos SEP 1 SEP U3 SEP SEP Z3 tb SEP 2box1 SEP SEP 2ns SEP SEP cos SEP 1 tb SEP U1 tb or SEP 2box1 SEP SEP 2ns SEP SEP cos SEP U1 tb SEP ssxl SEP SEP cos SEP SEP 2 SEP 1U tb SEP 2 tb 3 SEP tb hs SEP I tb SEP 2Rx1 SEP 7011 tb SEP g SEP no SEP cos SEP co SEP SEP ns SEP SEP co SEP XU tb SEP 2 SEP 2 tb SEP 2exl SEP 1 tb SEP na SEP SEP Z SEP nn SEP SEP Z1 tb SEP 2 SEP 2 tb This SEP can SEP be SEP evaluated SEP for SEP different SEP values SEP of SEP n tb starting SEP at SEP n SEP SEP 0 tb similarly SEP 2sx2 SEP fX2 tb SEP g SEP ns SEP SEP SEP Z2 SEP ns SEP t SEP Z2 tb SEP 2sox3 SEP KX32 tb SEP t SEP t SEP Z3 SEP SEP Z3 SEP m tb SEP 3 SEP 2 tb EMI34.1 tb There SEP are SEP obviously SEP an SEP infinite SEP number SEP of SEP values SEP of SEP hg SEP obtainable tb at SEP each SEP probe SEP position SEP depending SEP on SEP the SEP value SEP of SEP n. tb Negative SEP values SEP of SEP Xg SEP can SEP be SEP neglected. tb Negative SEP values SEP of SEP kg SEP only SEP occurs SEP when SEP n SEP SEP 0, SEP since SEP Z3 SEP SEP 2 tb SEP g tb If SEP we SEP define SEP limits SEP of SEP Xg SEP for SEP each SEP probe tb SEP g tb SEP i.e. SEP Longest SEP wavelength SEP SEP kgL SEP SEP W1 SEP W1 tb SEP Shortest SEP wavelength SEP SEP kgs SEP SEP W2 SEP W2 tb Then SEP values SEP of SEP Xg SEP outside SEP these SEP limits SEP can SEP be SEP neglected. tb As SEP n SEP increases SEP kg SEP decreases, SEP so SEP that SEP the SEP computation SEP of tb can SEP stop SEP when SEP the SEP lower SEP of SEP the SEP two SEP values SEP given SEP by SEP Z tb is SEP less SEP than tb SEP The SEP remaining SEP values SEP of SEP Ag SEP at SEP each SEP probe SEP position SEP must tb SEP g tb then SEP be SEP compared. SEP The SEP correct SEP value SEP is SEP that SEP which SEP appears tb at SEP each SEP position. tb SEP Let SEP the SEP correct SEP value SEP of SEP kg SEP tb SEP Then tb SEP Then SEP SEP 2s tb SEP A tb SEP g tb SEP 2x1 SEP SEP ssXl SEP SEP W SEP SEP B1 tb SEP 27IX2 SEP . tb SEP 2Bx2 SEP SEP ssX2 SEP W SEP pyx2 SEP SEP B2 SEP B2 tb SEP 2sX3 SEP SEP B tb SEP 2pyx3 SEP SEP j3x3 SEP W SEP 2 3 SEP 3 SEP B3 SEP B3 tb SEP 2Bx, SEP SEP BX3 SEP SEP W tb SEP Let SEP gin SEP B1 SEP SEP 51 SEP S1 tb SEP sin SEP B2 SEP SEP S2 tb SEP sin SEP B3 SEP SEP S3 SEP s3 tb SEP Let SEP cos SEP B1 SEP SEP C1 SEP C tb SEP cos SEP B2 SEP SEP C2 SEP C2 tb SEP cos SEP B3 SEP SEP C3 SEP C3 tb SEP Let tb SEP S1 SEP SEP 52 SEP SEP D1 SEP . SEP D1 tb SEP Cl SEP SEP 2 SEP D2 SEP D2 tb SEP 53 SEP SEP 53 SEP SEP D3 SEP 1 SEP D3 tb SEP C2 SEP C3 SEP SEP D4 SEP D4 tb EMI35.1 tb Let tb SEP 2kD1 SEP SEP E1 SEP E1 tb SEP 2kD2 SEP SEP E2 SEP E2 tb SEP 2kD3 SEP 3 SEP E3 tb SEP 2kD4. SEP E4 SEP E4 tb Let tb SEP EEl SEP SEP G2 SEP G2 tb SEP 2 tb SEP E4 SEP 4 SEP G4 SEP G4 tb SEP 4 tb Let tb SEP 2kG2 SEP SEP P1 SEP P1 tb SEP 2kS1 SEP SEP PlCl SEP SEP P2 SEP P2 tb SEP 2kG4 SEP SEP P3 SEP P3 tb SEP 2kS2 SEP SEP P3G2 SEP SEP P4 SEP r4 tb Let tb SEP 2kC1 SEP SEP Ol SEP Ol tb SEP 2kC2 SEP Q2 SEP Q2 tb Let SEP k SEP SEP G2 SEP k SEP SEP H1 SEP H tb SEP k SEP k SEP SEP H2 SEP H2 tb SEP 4 tb Let tb SEP SEP R tb SEP 2H1 tb SEP I SEP P SEP P2 tb SEP 2H2 SEP 2 tb Let tb SEP E5 SEP 1 tb SEP E2 tb EMI36.1 SEP MEASUREMENT SEP PROCEDURE SEP CALCULATION tb SEP performed SEP and tb SEP stored tb SEP The SEP following SEP formulas SEP apply tb SEP V1ê SEP SEP k1 SEP SEP k1 ê SEP SEP 2k1 cos 2ssx1 SEP . SEP . SEP . SEP . SEP . SEP 1 tb SEP V2ê SEP SEP k2 SEP SEP k2 ê SEP SEP 2k2 cos 2ssx2 SEP . SEP . SEP . SEP . SEP . SEP 2 tb SEP V3ê SEP SEP k3 SEP SEP k3 ê SEP SEP 2k3 cos 2ssx3 SEP . SEP . SEP . SEP . SEP . SEP 3 tb SEP USING SEP 1 SEP 2 SEP USING SEP 2 SEP 3 tb SEP L1 SEP SEP k1 SEP SEP k1 ê SEP SEP 2k1 cos SEP SEP B1 SEP V2ê SEP SEP L2 SEP SEP k2 SEP SEP k2 ê SEP SEP 2k2 cos SEP SEP B2 SEP V1ê SEP SEP L1 tb SEP L2 SEP SEP k2 SEP SEP k2 ê SEP SEP 2K2 cos SEP SEP B2 SEP V3ê SEP SEP L3 SEP SEP k3 SEP SEP k3 ê SEP SEP 2k3 cos SEP SEP B3 SEP V2ê SEP SEP L2 tb NORMALISE SEP V3ê SEP SEP L3 tb V1êA1 SEP SEP A1L1 SEP SEP k SEP SEP k ê SEP SEP 2k cos SEP SEP B1 SEP V2êA2 SEP SEP A2L2 SEP SEP k SEP SEP k ê SEP SEP 2k cos SEP SEP B2 SEP A1L1 SEP SEP V4 tb V2êA2 SEP SEP A2L2 SEP SEP k SEP SEP k ê SEP SEP Zk cos SEP SEP B2 SEP V3êA3 SEP SEP A3L3 SEP SEP k SEP SEP k ê SEP SEP 3k cos SEP SEP B3 SEP A2L2 SEP SEP V5 tb V4 SEP SEP k SEP SEP k ê SEP SEP 2k cos SEP cosB1 SEP SEP sin sinB1 SEP V5 SEP SEP k SEP SEP k ê SEP SEP 2k cos cosB2 SEP SEP sin sinB2 SEP A3L3 SEP SEP V6 tb V5 SEP SEP k SEP SEP k ê SEP SEP 2k cos SEP cosB2 SEP SEP sin sinB2 SEP V6 SEP SEP k SEP SEP k ê SEP SEP 2k cos cosB3 SEP SEP sin sinB3 tb Let SEP sin SEP SEP N tb SEP cos SEP SEP M tb Then SEP Nê Mê tb V4 SEP SEP k SEP SEP k Nê SEP Mê SEP SEP 2k NC1 SEP SEP MB1 SEP V5 SEP SEP k SEP SEP k Mê SEP SEP Nê SEP SEP 2k MC2 SEP SEP MS2 SEP tb V5 SEP SEP k SEP SEP k Nê SEP Mê SEP SEP 2k NC2 SEP SEP MB2 SEP V6 SEP SEP k SEP SEP k Mê SEP SEP Nê SEP SEP 2k MC3 SEP SEP MS3 SEP tb Let SEP V4 SEP SEP V5 SEP SEP F1 SEP V4 SEP SEP V5 SEP SEP F1 tb SEP V5 SEP SEP V6 SEP SEP F2 SEP V5 SEP SEP V6 SEP SEP F2 tb EMI37.1 F1 SEP SEP 2k NC1 SEP SEP MS1 SEP SEP NC2 SEP SEP MS2 SEP F2 SEP SEP 2k NC2 SEP SEP MS2 SEP SEP MC3 SEP SEP MS3 SEP CALCULATION tb F1 SEP SEP 2kN C1 SEP SEP C2 SEP SEP 2kM S1 SEP SEP S2 SEP F2 SEP SEP 2kN C2 SEP SEP C3 SEP SEP 2kN S2 SEP SEP S3 SEP performed SEP and tb F1 SEP SEP 2kND2 SEP SEP 2kND1 SEP F2 SEP SEP 2kND4 SEP SEP 2kMD3 SEP stored tb F1 SEP SEP K2N SEP SEP B1N SEP F2 SEP SEP E4N SEP SEP E3M tb Let tb SEP SEP G1 SEP SEP SEP SEP G3 SEP SEP SEP G1 SEP SEP SEP G3 tb M SEP SEP SEP SEP SEP .N SEP N SEP SEP SEP SEP .M tb M SEP SEP G1 SEP SEP G2.M SEP M SEP SEP G3 SEP SEP G4.M tb Going SEP back SEP to SEP tb V4 SEP SEP k SEP SEP k Nê SEP SEP Nê SEP SEP 2k NC1 SEP SEP MS1 SEP V5 SEP SEP k SEP SEP k Mê SEP SEP Nê SEP SEP 2k NC2 SEP SEP MS2 tb V4 SEP SEP k SEP SEP kNê SEP SEP kNê SEP SEP 2kNC1 SEP SEP 2kMS1 SEP V5 SEP SEP k SEP SEP kMê SEP SEP kNê SEP SEP 2kNC2 SEP SEP 2kMS2 tb V4 SEP SEP k SEP SEP kMê SEP SEP k G1 SEP SEP G2M ê SEP SEP 2kC1 G1 SEP SEP G2M SEP SEP 2kMS1 SEP V5 SEP SEP k SEP SEP kMê SEP SEP k G3 SEP SEP G4M ê SEP SEP 2kC2 G3 SEP SEP G4M SEP SEP 2kMS2 tb V4 SEP SEP k SEP SEP kMê SEP SEP kG1ê SEP SEP 2kG1G2M SEP SEP kG2êMê SEP SEP 2kC1G1 SEP V5 SEP SEP k SEP SEP kMê SEP SEP kG3ê SEP SEP 2kG3G4M SEP SEP kG4êMê SEP SEP 2kC2G3 tb SEP 2kC1G2M SEP SEP 2kMS1 SEP SEP 2kC2G4M SEP SEP 2kMS2 tb Mê k SEP SEP kG2ê SEP SEP M 2kS1 SEP SEP 2kG1G2 SEP SEP 2kC1G2 SEP SEP k SEP SEP kG1ê SEP Mê k SEP SEP kG4ê SEP SEP M 2kS2 SEP SEP 2kG3G4 SEP SEP 2kC2G4 SEP SEP k SEP SEP kG3ê tb SEP A1L1 SEP SEP 2kC1G1 SEP SEP 0 SEP SEP 2kC2G3 SEP SEP A2L2 SEP SEP 0 tb MêH1 SEP SEP M F2 SEP SEP F1G1 SEP SEP C1G1 SEP SEP k SEP SEP kG1ê SEP SEP A1L1 SEP SEP 0 SEP M2H2 SEP SEP M F4 SEP SEP F3G3 SEP SEP C2G3 SEP SEP k SEP SEP kG3ê SEP SEP A2L2 SEP SEP 0 tb Let tb F2 SEP SEP P1G1 SEP SEP H3 SEP F2 SEP SEP F1G1 SEP SEP H3 tb P4 SEP SEP P3G3 SEP SEP H4 SEP F4 SEP SEP F3G3 SEP SEP H4 tb C1G1 SEP SEP k SEP SEP kG1ê SEP SEP L1 SEP SEP H5 SEP C1G1 SEP SEP k SEP SEP kG1ê SEP SEP L1 SEP SEP H5 tb C2G3 SEP SEP k SEP SEP kG3ê SEP SEP L2 SEP SEP H6 SEP C2G3 SEP SEP k SEP SEP kG3ê SEP SEP L SEP SEP H6 tb EMI38.1 tb SEP CALCUXAXU4 tb SEP performtA SEP a L tb SEP stored tb SEP 2 SEP 2 tb H1M SEP SEP H3M SEP 5 SEP hum SEP O SEP H2M SEP SEP H4M SEP SEP H6 SEP SEP 0 tb M SEP SEP JH3 SEP WI1Hg SEP M SEP SEP H4 SEP JHB tb 2Hi SEP 2H2 tb Let tb SEP 4H1H5 SEP H7 SEP v SEP 5 SEP HX tb SEP SEP 4H1Hg SEP SEP H7 SEP ZHg SEP Hg tb SEP Wm4H2H6 SEP H8 SEP N H4 SEP 4H2H6 SEP H8 tb SEP M1 SEP SEP H3 SEP SEP H7 SEP R1 SEP M3 SEP SEP H4 SEP SEP H8 SEP R2 SEP H3 H7 R1 SEP M1 tb SEP M2 SEP SEP H3 SEP SEP H7 SEP R1 SEP M4 SEP SEP H4 SEP SEP H8 SEP R2 SEP M1 2H7R1 SEP SEP M2 tb SEP SEP H3R1 SEP SEP H7R1 SEP SEP H4R2 SEP 2 SEP H8R2 SEP H H8 SEP SEP R2 M3 tb SEP SEP M1 SEP SEP H7R1 SEP SEP H7R1 SEP SEP M3 SEP SEP H8R2 SEP SEP H8R2 SEP M3 2H8R2 SEP 4 tb SEP M2 SEP SEP M1 SEP SEP 2H7R1 SEP M4 SEP M3 SEP SEP 2H8R2 tb At SEP this SEP stage SEP we SEP have4values SEP of tb M SEP and SEP 4 SEP corresponding SEP values tb of SEP N tb i.e. tb SEP N1 SEP SEP G1 SEP SEP G2M1 SEP N3 SEP SEP G3 SEP SEP C3 tb SEP N2 SEP SEP G1 SEP SEP G2M2 SEP 4 SEP 53 SEP 3 SEP GqM4 tb Compare tb SEP M1 SEP with SEP M3 tb SEP M1 SEP with SEP M4 tb SEP M2 SEP with SEP M3 tb SEP M2 SEP with SEP M4 tb EITHER SEP Calc. SEP N1 SEP or SEP N2 tb SEP M1 SEP will SEP equal SEP M3 SEP or SEP M4 SEP SEP from tb OR SEP N1 SEP SEP G1 52M1 tb SEP M2 SEP will SEP equal SEP M3 SEP or SEP M4 SEP N2 SEP SEP G1 G2M2 tb IF SEP M1 SEP SEP M3 SEP or SEP M4 SEP THEN SEP M1 SEP N1 SEP are SEP used tb IF SEP M2 SEP SEP M3 SEP or SEP M4 SEP THEN SEP M2, SEP N2 SEP are SEP used tb EMI39.1 Calculate SEP p tb p ABS SEP Kê SEP SEP Mê SEP SEP R SEP R SEP SEP ABS SEP Mê SEP SEP Nê tb IF SEP PRINT SEP OUT SEP OF SEP SEP IS SEP NOT SEP REQUIRED SEP IT SEP IS SEP NECESSARY SEP AT SEP THIS SEP STAGE tb TO SEP CALCULATE SEP tb SINCE tb p SEP sin SEP SEP SEP M SEP SEP Y SEP co ordinate SEP SEP Y SEP co ordinate tb p SEP cos SEP SEP SEP N SEP SEP X SEP co ordinate SEP SEP X SEP co ordinate SEP FLOT SEP X, SEP Y tb IF SEP THE SEP VALUE SEP OF SEP SEP IS SEP REQUIRED SEP THEN SEP PROCRED SEP AS SEP FOLLOWS tb Let tb 1 SEP SEP tan 1 SEP SEP T1 SEP tan 1 SEP SEP T1 tb 2 SEP SEP tan 1 SEP SEP SEP SEP T2 SEP tan 1 SEP SEP SEP T2 tb Let tb N6 SEP SEP R SEP cos 1 SEP R SEP cos 1 SEP SEP N6 tb N7 SEP SEP R SEP cos 2 SEP R SEP cos 2 SEP SEP N7 tb Compare SEP N6 SEP with SEP M5 tb N7 SEP with SEP M5 tb IF SEP N6 SEP SEP N5 SEP THEN SEP T1 SEP is SEP correct SEP value tb IF SEP N7 SEP SEP N5 SEP THEN SEP T2 SEP is SEP correct SEP value tb N5 SEP SEP G1G2M5 SEP OR tb N5 SEP SEP G3G4M5 tb M5 SEP SEP result SEP of SEP comparison tb of SEP M1 M4 tb EMI40.1 tb SEP pC tb SEP NI SEP a tb SEP o SEP t9 SEP 0 tb SEP d SEP N SEP N tb SEP SEP SEP CcH SEP 3N SEP S tb SEP a SEP 5 SEP 1 tb SEP S tb SEP a SEP N tb SEP U SEP 0 tb SEP I SEP a SEP N tb SEP ol SEP b SEP SEP SEP SEP N SEP 4J tb SEP N SEP 0 SEP S tb SEP C3rl SEP 3C SEP CY,I SEP cum SEP U SEP iu tb SEP SEP SEP SEP I tb SEP a SEP e SEP NI SEP a, tb SEP p SEP In SEP 0 SEP I SEP I SEP SEP SEP x SEP SEP c tb SEP X SEP SEP I SEP In SEP I SEP SEP 0 SEP C SEP tb SEP ffi SEP X SEP Ï SEP S tb SEP a, tb SEP SEP 11 SEP 11 SEP U SEP H SEP n SEP vII SEP a, tb SEP l SEP e SEP q SEP SEP In SEP vD SEP I SEP N SEP NI SEP Sl SEP In SEP In tb SEP O SEP o SEP x SEP SEP 1 SEP SEP E SEP S SEP SEP SEP zx SEP tb O SEP . SEP . SEP . SEP . SEP . SEP . SEP . SEP . SEP . SEP O SEP N SEP NI tb l tb SEP z tb SEP o tb SEP a tb a9 tb JI tb SEP a tb SEP w tb SEP o tb SEP NI tb SEP O SEP tb SEP N SEP N tb SEP S SEP S tb SEP NI tb SEP SEP SEP SEP m SEP es SEP mr SEP z SEP N SEP N SEP m SEP F SEP V SEP XNX SEP 4 SEP C NNNINI SEP N SEP tb SEP aw SEP HH SEP N SEP m SEP m SEP m SEP U N SEP NI SEP Ue SEP m SEP SEP rq SEP 4 SEP WN SEP N SEP N SEP Ilr gN SEP NH SEP 4 SEP N SEP I SEP N SEP t SEP I SEP N SEP 4 SEP CY tb SEP E4 SEP X SEP X SEP X SEP X SEP C SEP C SEP a SEP e SEP n SEP n SEP I SEP I SEP o SEP o SEP O SEP w w SEP Sct S SEP W SEP t3 SEP ivy SEP U SEP o SEP NN a aUO tb SEP iu SEP 4 SEP SEP O SEP O SEP O SEP H SEP H SEP N SEP N SEP X SEP X SEP X SEP X SEP H SEP n SEP SEP SEP X SEP X SEP X SEP X SEP X tb SEP 51 SEP R SEP N SEP N SEP SS SEP X SEP D SEP Ilì SEP U SEP U SEP U SEP W SEP U SEP Vl SEP UN SEP N SEP N SEP N SEP X SEP W4 SEP X SEP X SEP N SEP N SEP N SEP N SEP N SEP N SEP c1 SEP H SEP H SEP w SEP N SEP N tb SEP o SEP n SEP a SEP n SEP n SEP u SEP n SEP n. SEP n SEP Ii SEP Ii SEP Ii SEP n SEP u SEP u SEP n SEP n SEP II SEP u SEP n SEP u SEP II SEP u SEP n SEP n SEP n SEP U SEP n SEP u SEP u SEP n SEP n SEP n SEP n tb SEP H SEP N SEP NI SEP H SEP N SEP NI SEP H SEP N SEP N SEP H SEP N SEP NI SEP N SEP n SEP 4 SEP NI SEP N SEP 1 SEP 4 SEP N SEP 4 SEP H SEP N SEP I SEP N SEP NI SEP SEP H SEP N SEP H SEP N SEP P r SEP In SEP 0 SEP H SEP c SEP N tb SEP o SEP WWWUUU00O a a a a S S fl SEP tL 5 IaCI SEP a SEP C C a aWW tb