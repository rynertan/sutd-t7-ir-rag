# DEVICE FOR CONTROLLING SHIFT IN AUTOMATIC TRANSMISSION

## Claims
Vorrichtung zum Steuern der Schaltung eines automatischen Getriebes 1 306 eines Kraftfahrzeuges,

## Description
The invention relates to a device indicated in the precharacterizing part of claim 1. Such a device for activating a shift in an automatic transmission in a closed loop control manner as disclosed in DE A 32 05 767 and as indicated in the precharacterizing part of claim 1 comprises a motor, a transmission including an input shaft and an output shaft, sensor means for detecting a revolution speed of the input shaft and the output shaft respectively and pressure means for activating friction means of said transmission. A ratio of an input shaft revolution speed and an output shaft revolution speed is computed and compared in a control unit with a curve table of predetermined ration values. On dependence from result of said comparison, pressure actuator will be activated in a timed relationship. From FR A 2 417 689, it is know to determine the instantaneous ratio by dividing the measured period of the input shaft by that of the output shaft. It is the object of the invention to provide a reliable operating device which alleviates or prevents shocks during shifting in an automatic transmission. In accordance with the invention, this object is solved by the features as claimed in the characterizing part of claim 1. The inventive device comprises sensor means for generating pulse train signals indicative of a frequency variable in proportion to a revolution speed of an input shaft or output shaft respectively. A means converts said pulse train signals into square shaped pulses and zero cross detectors detect a zero cross point of said square shaped pulses. Periods T₁ and T₂ indicative of the frequency of the corresponding pulse train signals have been determined and the ratio is calculated by dividing said second period T₂ by said first period T₁. Such a speed ratio of an input shaft speed to an output shaft speed is detected and calculated in a very quick, reliable and simple manner. Referring to Figs. 1 to 5, one embodiment according to the present invention is described. Referring to Fig. 1, there is schematically shown an automatic transmission 1 installed in a motor vehicle having an engine, not shown. The automatic transmission has an input shaft 11 drivingly connected via a torque converter to the engine in a known manner, an output shaft drivingly connected with driving wheels, not shown, of the motor vehicle in a known manner, and a change speed mechanism which is shiftable to three forward gear positions and one reverse gear position. The change speed mechanism comprises two groups of planetary gear sets 17, 18, and a plurality of friction elements that include a front clutch 12, a rear clutch 13, a band brake 14, a low and reverse brake 15, and a one way clutch 16. Among all, the friction elements 12 15 are selectively put into action engaged released , thus changing a speed ratio of the revolution speed of the input shaft 11 to that of the output shaft 11. The friction elements 12 15 are engaged or released in each of drive ranges as shown in Table. The friction elements 12 15 are actuated by hydraulic pressure pistons 42 45, respectively, such that each of the friction elements is engaged in response to hydraulic fluid pressure supplied to the corresponding hydraulic pressure piston. The hydraulic pressures supplied to the above mentioned hydraulic pressure pistons 42 45 are regulated by pressure regulator valves 46a 46d, respectively. These pressure regulator valves are of the same construction like the one as shown in FIg. 2, for example. Referring to Fig. 2, an inlet passage 53 is supplied with a hydraulic fluid pressure P The drainage rate via the drain 54 is variable in response to a bias force applied to a needle valve 62, which bias force is adjustable by varying ON OFF duty ratio of an energization current passing through a solenoid valve 61. That is, when the solenoid valve 61 stays in OFF state duty ratio D If duty ratio D The solenoid valves for the regulator valves 46a, 46b, 46c and 46d are supplied with excitation currents, respectively, having duty ratios Sa, Sb, Sc, and Sd which are determined by a control unit 30. The control unit 30 is a microcomputer system that comprises a CPU 31, a memory 32, an I O interface 33 and a system clock 34. In order to detect or measure a speed ratio r of the revolution speed of the input shaft 10 to that of the output shaft 11, a detector is provided which includes the control unit 30. It also includes an input shaft revolution speed sensor 21, an output shaft revolution speed sensor 22, wave shapers 23, 24, zero cross detectors 25, 26, and period counters 28, 29. The sensor 21 includes a magnetic pinion 21b attached to the input shaft 10 and a magnetic pick up 21a arranged adjacent to the magnetic pinion 21. According to this arrangement, the magnetic pick up 21a generates a pulse train signal P₁ having a frequency variable in proportion to the revolution speed of the magnetic pinion 21, i.e., the revolution speed of the input shaft 10. Similarly, the sensor 22 includes a magnetic pinion 22b attached to the output shaft 11, and a magnetic pick up 22a. The magnetic pick up 22a generates a pulse train signal P₂ having a frequency variable in proportion to the revolution speed of the output shaft 11. One pulse of each of the above mentioned pulse train signal P₁ and P₂ is generated whenever each of the teeth of the corresponding one of the magnetic wheels 21b and 22b passes the corresponding one of the magnetic pick ups 21a and 22b, as shown in Fig. 3 a . The pulse signals P₁ and P₂ are converted by the wave shapers 23 and 24, respectively, into square shaped pulses, as shown in Fig. 3 b . At the zero corss detectors 25 and 26, a zero cross point Z Fig. 4 is a flow chart showing the sequence of operations executed in the above mentioned control unit 30. The series of operations shown in Fig. 5 relates to a control of the band brake 14 of the automatic transmission 1. Although not shown, similar flow charts for the front clutch, rear clutch, and low reverse brake are stored. These four flow charts are executed consequtively and the execution of each of them is initiated after a predetermined length of time. The series of operations for the band brake is controlling as shown in Fig. 5 is executed after a length of time of T. First of all, a step 201 is executed where a decision is made of which running range should be selected. This decision making at step 201 involves selecting one running range out of N, P , R , D₁ , D₂ , D₃ based on parameters detected such as, a vehicle speed, a position of a shift lever, and an opening degree of a throttle valve. The operation at step 201 also involves comparing a new running range determined in the present run with an old running range determined in the preceding run, and deciding whether D₁ range determined in the preceding run has changed to D₂ range determined in the present run, i.e., whether a shift from the first to the second gear position hereinafter abbeviated as a 1 2 shift is demanded. When the decision made at the step 201 ends in 1 2 shift, the band brake 14 has to be engaged or applied because the application of the band brake 14 takes place only during a shift from D₁ range to D₂ range, as illustrated in the Table mentioned before. When the decision made at the step 201 turns out to be an instruction that 1 2 shift is to be initiated speed ratio r is given at steps 202 and 203, and the hydraulic fluid pressure for engaging the band brake 14 is determined at steps 204 to 211. At the step 202, the period T₁ of the pulse train signal P₁ stored in the output register within the period counter 28 and the period T₂ of the pulse train signal P₂ stored in the output register within the period counter 29 are read. Then, at the step 203, the ratio T₂ T₁ of the above mentioned period T₂ to the period T₁ is calculated. Since this ratio is equal to the speed ratio of the revolution speed of the input shaft 10 to that of the output shaft 11, r T₂ T₁ is set. At the subsequent step 204, the time t At step 205, a target value in speed ratio r₀ t At step 206, the actual value r is compared with the target value r₀. When r is greater than r₀, a step 208 is executed where a predetermined increase d is placed as a duty ratio variation D. This duty ratio variation D represents a variation in duty ratio D When r is equal to r₀, a step 207 is executed where 0 zero is placed as D, while when r is less than r₀, a step 209 is executed when a decrease d is placed as D. At a step 210, the duty ratio variation D is added to an old duty ratio D At a step 211, the time t When, on the other hand, the decision making at the step 201 ends in N, P , D₁ , D₃ or R , D When the running range to be selected is found to be D₂ , D Fig. 5 is a graph showing a variation in the speed ratio r versus time during a 1 2 shift and also a variation in the duty ratio D Referring to Fig. 5, since D₁ range is established prior to the instant t₁, the duty ratio D At the instant t₁ when a 1 2 shift is demanded after the vehicle speed has increased sufficiently high enough for this shift, the series of operations from the step 202 to step 211 see Fig. 5 is executed where the comparison of r with r₀ is repeated after every predetermined length of time t so as to increase or decrease the duty ratio D After the predetermined period T As explained in the preceding description, according to this embodiment, since the setting is made such that the target value r₀ gradually decreases during the predetermined period T Since the periods T₁ and T₂ of the pulse train signals P₁ and P₂ produced by the input shaft revolution speed sensor 21 and the output shaft revolution speed sensor 22 are used, the actual speed ratio r can be detected at the instant whenever every two pulses of each of the pulse train signals P₁ and P₂ have been generated. As a result, it can be detected within a short length of time. This, therefore, has realized a feedback control with excellent precision as shown by the flow chart shown in Fig. 4 where the actual speed ratio value r is brought into agreement with the target value r₀. Although, in the above mentioned embodiment, the input shaft revolution speed sensor 21 and the output shaft revolution speed sensor 22 are mounted directly to the input shaft 10 and the output shaft 11, respectively, sensors of the type which indirectly detect the revolution speed may be used as long as they generate a pulse train signal with a frequency variable with the rotational speed of the input shaft and the output shaft. For example, the sensors may be mounted to the planetary gear sets 18 and 19 or a rotational angle sensor and a vehicle speed sensor for a speed meter may be used as such sensors. As different from the manner of varying the duty ratio D The variation characteristic of the target value r₀ is not limited to that illustrated in Fig. 5 and may be set as desired as long as it is effective in decreasing shift shocks. Referring to Figs. 6 to 9, a second embodiment is described hereinafter. Referring to Fig. 6, there are illustrated an engine 301, and an automatic transmission 306 drivingly connected via a torque converter 306a to the engine 301. The engine 301 has spark plugs 309 provided for its cylinders, respectively, and is provided with a distributor 310. The distributor 310 applies a secondary high voltage that has been generated by continuous supply of a primary electric current to the spark plugs 9, selectively, at a timing determined by a spark timing controller 311 under the control of a spark timing control signal S Owing to a 1 2 shift valve 318, a 2 3 shift valve 314 and a 3 4 shift valve 315 within a hydraulic pressure control system 307, the automatic transmission 306 automatically selects a gear position out of four gear positions which is suitable for a running condition of the vehicle. A control unit 316, as shown in Fig. 7, is a microcomputer based system which is provided with a CPU 324, a RAM 325, a ROM 326, an input interface circuit 327, an outut interface circuit 328, a wave shaper 329, an A D converter 330, and a drive circuit 331. Input signals fed to the control unit 316 comprises an input shaft revolution speed signal S The above mentioned revolution speed sensor 333 and the output shaft revolution speed sensor 334 are similarly constructed and arranged to the sensors 21 and 22 shown in Fig. 1 pulse train signals generated by the sensors 333 and 334 are fed, as output signals S The accelerator sensor 317 is constructed of a potentiometer which generates an analog signal variable in proportion to the depression degree acceleration degree of the accelerator pedal 312. The accelerator signal S The 1 2 shift switch 318 and 2 3 shift switch 319 are like their counterparts described, for example, in U.S. patent No. 4,431,095. They are closed and generate low level signals when spools of the 1 2 shift valve 313 and 2 3 shift valve 314 assume downshift positions, respectively, while they are opened and generate high level signals when the spools assume upshift positions, respectively. A 3 4 shift switch 320 is constructed similarly and closed to generate a low level signal when a spool of the 3 4 shift valve 315 assumes a downshift position but opened to generate a high level signal when the spool assumes an upshift position. Thus, the shift signals S₁₂, S₂₃ and S₃₄ are expressed by various combinations of high and low level signals as shown in the following Table. In the Table, the reference character H represents a high level signal and the reference character L a low level signal. Fig. 8 is a flow chart showing a sequence of operations executed by the above mentioned control unit 316. The series of operations illustrated in Fig. 8 is started by turning ON an ignition switch and the execution thereof is repeated after a length of time T. First of all, at a step 341, a shift position signal S₁₂ or S₂₃ or S₃₄ coming out of the 1 2 shift switch 318, 2 3 shift switch 319 and 3 4 shift switch 320 is read, and at a step 342, a decision is made whether any change in gear position signal occurred. If, now, no change in gear position signal took place, a flag F is reset as 00 at a step 343, and then a retard ϑ At a step 345, an ordinary spark timing ϑ At a step 346, a spark timing control signal S Since, when the decision that no change in gear position signal is made, the retard ϑ If the decision made at the step 342 turns out to be YES, i.e., a case where a change in gear position signal occurred, a determination is made based on gear position signals before and after the decision making at the step 342 what kind of change in gear position has occurred, i.e., which shift command has occurred step 347. That is, what is done at the step 347 is to determine which one of 1 2 shift command, 2 3 shift command and 3 4 shift command has occurred. At a step 348, a first reference value β₁ and a second reference value β₂ which are preset for content of the shift command determined are obtained after reading the data in the memory. These reference values β₁ and β₂ are used to determine the instant when a shift is initiated and the instant when it is completed, and a different pair of values is set for every different shift command. At a step 349, the flag F 01 is set. The fact that the flag F 01 is set is memorized by the computer as the occurrence of a change in gear position signal. Referring to Fig. 9, assuming now that the gear position signal has changed from the second to the third gear position 2 3 shift at the instant t₁, a decision is made that there has occurred a change in gear position command in the first run immediately after the instant t₁ and the steps 347, 348 and 349 are executed. At a step 350, an input shaft revolution speed Ni is obtained from the output signal S More particularly, the actual speed ratio r is given by finding a period of a pulse train signal in a similar manner to the first embodiment. At a step 351, a decision is made whether the content of the flag F is 01 or 11. Since, now, the content of the flag is 01, a step 352 is executed where the speed ratio r is compared with the first reference value β₁. In the case as illustrated in Fig. 9, for example, the speed ratio changes from R Referring to Fig. 9, during the response delay T₁, the speed ratio r continues to stay at R Hereinafter, the series of operations through the steps 341 to 343, 350 to 352, 345, 346 is executed repeatedly until r becomes equal to or less than β₁. When r becomes equal to or less than β₁, the decision made at the step 352 results in YES, allowing the execution of a step 353 wherein the retard ϑ At the next step 354, the flag F 11 is set. This causes the computer to memorize that the speed ratio r has becomne lower than the first reference value β₁ and the actual shift operation has begun. Since the retard ϑ This causes the engine output Te to drop, causing the input torque Ti to drop by Ti. This drop works to offset the variation Tm in the torque Tm owing to the inertia which variation is caused by the shift operation. As a result, shocks are alleviated. The above mentioned retard action of the spark timing continues until the speed ratio r becomes lower or equal to the second reference value β₂. This series of operations is maintained because the decision made at the step 351 always results in 11 and the decision made at the step 355 alway results in NO until r becomes lower or equal to β₂. When the shift in the automatic transmission 306 is completed at the instant t₃ , the speed ratio r becomes equal to the second reference value β₂. This cause the decision made at the step 355 to turn out to be YES, allowing the execution of steps 356 and 357 where the retard ϑ As described above, according to this embodiment, the initiation of a shift in the automatic transmission 306 and the completion thereof can be recognized accurately by monitoring the speed ratio, and the engine output is dropped by retarding the spark timing of the engine 301 during the transient period from the initiation of the shift to the completion thereof, preventing the occurrence of shocks during the shift. Since the engine output control mentioned above is rendered to occur always in timed with the initiation of the shift owing to a feedback control by monitoring the speed ratio r, the occurrence of shocks is alleviated to a sufficiently low level without any secondary shocks. Referring to Figs. 10 to 13, a third embodiment is described. This embodiment is similar to the second embodiment except that, instead of the spark timing ϑ, the opening degree of a throttle valve is controlled during a shift to achieve a drop in the engine output. Fig. 10 is a flow chart showing a series of operations executed by a control unit 316 shown in Fig. 11. Fig. 11 is similar to Fig. 6 except the provision of a throttle valve 335 and a throttle valve actuator 336. The control unit 316 which is specifically shown in Fig. 12 is similar to Fig. 7 except the provision of a drive circuit 357 for the throttle valve actuator 336. Referring specifically to the flow chart shown in Fig. 10, the content of the control is different from that of the second embodiment only in that the operations of the correction ϑ The operation of this third embodiment will be readily understood from Fig. 13. Referring next to Fig. 14, there is a flow chart illustrating the content of operations carried out in a fourth embodiment according to the invention. The construction of this embodiment is substantially the same as the second embodiment see Figs. 6 and 7 . The flow chart of this embodiment is different from that of the second embodiment see Fig. 8 only in the provision of new steps 371, 372 and 37. At the step 371, a timer T₁ is started so as to measure time T₁ beginning with the instant t₁ see Fig. 15 . At the step 372, a decision is made whether the time T₁ measured is equal to or greater than a reference time value Ts. If T₁ is equal to or greater than Ts, the step 373 is executed where the flag F is reset, the timer T₁ is cleared, and the retard ϑ This embodiment operates in the same manner as the second embodiment under the normal condition where decisions that the speed ratio r drops below the first reference value β₁ and then it drops below the second reference value β₂ are made normally. If abnormal condition occurs where owing to a malfunction due to an error in signal system or noise, the decision that r is lower than or equal to β₂ fails to be made, i.e., the completion of the shift fails to be recognized, the operation of the engine with the spark timing ϑ retarded continue even after the instant t₃, thus allowing the engine to continue to produce the engine output Te of the decreased level. In order to provide a safeguard against the occurrence of this event, the reatard control of the spark timing is mandatory terminated when the time T₁ measured exceeds the above mentioned reference time value Ts thereby to prevent the occurrence of undesirable event. Referring to Fig. 16, there is a flow chart illustrating the content of operations carried out by a fifth embodiment according to the invention. The other construction is the same as the above mentioned fourth embodiment. The content of the control is substantially the same as that shown by the flow chart in Fig. 14 except the provision of steps 380 to 385. At the step 380, a decision is made whether the content of the flag F is 01 or 10 or 11. If the flag F is equal to 11, the step 81 is executed where a decision is made whether the sign of a second derivative .. r of the speed ratio r is positve or negative. What is done at this step is to decide whether a first derivative r of the speed ratio r is on the incline or decline. If the second derivative .. r is less than or equal to zero, the flag F 11 is maintained, thus leaving the spark timing ϑ subject to retard ϑ If r is greater than β₂, the step 383 is executed where the retard ϑ Thus, the operation of decreasing the retard ϑ The operation just described is illustrated in Fig. 17. At the instant t₁, a 2 3 upshift command occurs, and then at the instant t₂ when r becomes less than or equal to β₂, the retardation of the spark timing ϑ starts. At the instant t₂ when the rate at which the first derivative r of the speed ratio r decreases the second derivative r becomes greater than zero , the spark timing starts to increase gradually, and returns to the ordinary spark timing ϑ The advantage given by this control whereby the output torque of the engine varies smoothly near the instant when the actual shift operation is completed is that the occurrence of secondary shift shocks is alleviated, which secondary shift shocks would be occurred in the event where the variation To in the output torque To of the automatic transmission during the shift decreases gradually at the instant t₃ rather than it decreases abruptly, or where the amount of the drop Ti in the engine output is less than that of the torque variation Tm due to the inertia. As will be readily understood from the flow chart shown in Fig. 16, similarly to the flow chart shown in Fig. 14, the retarding of the spark timing is forcibly terminated after a predetermined length of time Ts beginning with the instant t₁. The above mentioned value α alpha that was constant may be given a value variable with the value of the speed ratio r, and in this case, the step 355 may be skipped if the value of α alpha is varied so that the retard ϑ It goes without saying that in order to drop the engine output, the technique of decreasing the throttle opening degree which has been employed in the third embodiment shown in Figs. 10 to 13 may be applied to the fourth and fifth embodiments see Figs. 14 and 16 . The technique of controlling the engine output in response to the variation in the second derivative r of the speed ratio r which has been employed by the fifth embodiment see Fig. 16 may be applied to the third embodiment see Fig. 10 . In each of the second to fifth embodiments described above, the engine output control for the purpose of decreasing the shift shocks occurring during an upshift has been described, similar control technique used in each of these embodiments may equally used in engine control for reducing shift shocks occurring during a downshift. When applying to conrolling shift shocks during a downshift, the second to fifth embodiments have to be modified such that the decisions to be made are whether the speed ratio r has exceeded the respective reference values, and the engine output has to be increased during a shift. In the preceding description, what are employed for controlling the engine output involve a techinque of retarding the spark timing ϑ and a technique of decreasing the throttle opening . However, decreasing the fuel amount supplied to the engine, increasing the exhaust gas recirculation amount, throttling the intake air flow passage and decreasing the charging pressure of the turbo charger are another expedients which may be employed. Referring to Figs. 19 to 24, a sixth embodiment according to the present invention is described. Referring to Fig. 19, a lock up type automatic transmission 306 has an input shaft, not shown, drivingly connected to an engine, also not shown via a lock up type torque converter 405. It automatically selects one gear position out of first to fourth gear postions in accordance with running state of a vehicle by the action of a 1 2 shift valve 313, a 2 3 shift valve 314 and a 3 4 shift valve 315 provided in a hydraulic control system 307. As shown in Fig. 20, a control unit 316 is a microcomputer based system that includes a CPU 324, a RAM 325, a ROM 326, an input output interfeace circuit 427, a wave shaper 329, and an A D converter 330. Input signals include an input shaft revolution speed signal S Referring to Fig. 21, there is a flow chart illustrating a series of operation carried out by the above mentioned control unit 316. The series of operations illustrated in this Figure is initiated after the ignition switch is turned ON, and thereafter the execution of them is repeated after lapse of a predetermined length of time T. First of all, at a step 441, an arithmetic operation is carried out to determine a lock up control data T n . The lock up control data is obtained using a lock up schedule which is stored as a data Table that is predetermined versus the gear position indicated by the shift signals S₁₂, S₂₃ and S₃₄ and the position of the accelerator as indicated by the accelerator signal S At a step 442, a decision is made whether the content of a flag F is equal to 00. What is meant by the fact that the flag F is 00 is that neither shift nor lock up is being carried out. If, under this condition, a change is gear position command is not detected as a result of operations at steps 443 and 444, a step 450 is executed where the lock up control data T n given at the above mentioned step 441 is issued as a control signal S What is done at the step 444 is to determine based on the shift signal S₁₂ or S₂₃ or S₃₄ whether there occurred any change in gear position command. If the result of the decision at this step 444 is YES, the lock up control which will be described hereinafter will be carried out. Hereinafter, in order to make the explnation in detail, a graph shown in Fig. 22 is also referred to. As an example, an upshift from the second gear position to the third gear position is descriubed. The same control procudure is applicable to the other shift operations. Prior to the instant t₁, the second gear position is maintained and T n that has been given at the step 441 is equal to 1. Thus, under this condition, the control signal S When there occurs a change in gear position command from the second gear position to the third gear position at the instant t₁, steps 445 and 446 of the flow chart shown in Fig. 21 are executed and then the flag F 01 is set at a step 447. At the step 445, the content of the above mentioned change, i.e., the content of the shift demand, is recognized. In this example, the content of the shift recognized is an upshift from the second to the third. At the step 446, among different pairs of first and second references which are predetermined for various contents of shift, an appropriate one for the content of the shift recognized at the step 445 is set. In this example, as references 2 3 shift, a value that is near but smaller than the speed ratio of 1.5 that is peculiar to the second gear position is set as the first reference C₁, and a value that is substantially equal to the speed ratio of 1.0 that is peculiar to the third gear position is set as the second reference C₂. At a step 448, a decision is made whether the content of a memory register M that stores the lock up control data T n 1 obtained in the preceding run is equal to 1. Sinbce, in this example, T n was equal to 1 before the instant t₁, M is equal to 1, allowing the execution of a step 452 where an actual speed ratio r is obtained by a similar computation to that described in connection with the step 350 in Fig. 8. At a step 453, a decision is made whether the speed ratio r is lower than or equal to the first reference C₁. Explaining here how the speed ratio varies after the instant t₁, the speed ratio r is kept at the speed ratio of 1.5 that is peculiar to the second gear position during the response delay T₁ and thus the relationship that r is greater than C₁ is maintained, so that the decision at the step 453 results in NO. Since the flag F 01 is maintained until r becomes equal to or lower than C₁, a series of operations at steps 441, 442, 451, 452, 453 and 463 is repeated, and thus the lock up is maintained. Thereafter, at the instant t₃ after the response delay T₁, the actual shift operation in the automatic transmission 6 is initiated, causing the speed ratio r to decrease. Thus, immediately after the instant t₃, the speed ratio r becomes below the first reference C₁, causing the decision at the step 453 to result in YES. As a result, a step 454 is executed where the control signal S At the next step 455, a desicion is made whether the lock up control data T n is equal to 1. If it is equal to 1, a step 456 is executed where the flag F 10 is set, whereas if it is equal to 0, a step 457 is executed where the flag F is reset as being equal to 00. It is assumed, in this example, that the lock up is needed even during operation at the third gear position and thus T n 1 is obtained at the computation at the step 441. Thus, under this condition, after the execution of the step 455, the flag F 10 is set at the step 456. Thereafter, the steps 441, 442, 451, and 458 are executed, and then a step 459 is executed where a decision is made whether the speed ratio r has become equal to or lower than the second reference C₂. As long as the speed ratio r stays greater than C₂, the execution of the steps 441, 442, 451, 458, 459, and 463 is repeated, thus leaving the lock up released. When the speed ratio r become equal to or lower than C₂, at the instant t₄ when the shift in the transmission 306 is completed, the decision at the step 459 turns out to be YES, thus allowing the execution of steps 460 and 461 where the state of the lock up solenoid 422 is set in accordance with the lock up control data T n . Since, now, the data T n is equal to 1, the control signal S At a step 462, the flag F is reset as 00 which indicates the completion of the lock up release during the shift. As a result of the operations described above, the initiation timing of the lock up release is isalways brought into agreement with the instant t₃ when the actual shift is initiated, thus preventing the occurrence of engine racing which was experienced in the conventional example as illustrated in Fig. 25. Besides, since the instant t₄ when the shift is completed is detected and the lock up release is terminated at this instant, the resumption to the lock up action after the completion of the shift operation can be effected rapidly without any delay. Although, in the above description, a case where there occurs a shift from the second gear position with the lock up to the third gear position with the lock up has been explained, there is described as to a shift from the second gear position with the lock up to the third gear position with the converter state lock up release state referring to Fig. 23.. Referring to Fig. 23, at the instant t₁ when a change in gear position command occurs, T n 1 and M 1 hold, and thus the execution of steps 441, 442, 451 to 458, and 463 is repeated until the speed ratio 1 become below the first reference C₁, allowing the lock up to continue. When the speed ratio r becomes equal to or less than C₁ immediately after the instant t₃ , the decision at the step 453 turns out to be YES, and thus the steps 454 and 455 where the decision results in NO because T n 0 are executed. and the step 457 is executed where the flag F 00 is set Thus, the lock up is released. Subsequently, the steps 441 to 448 are executed. Since M 0 is recognized at the step 448, the step 449 is executed where the flag F 10 is set. The lock up release continues until the speed ratio r becomes equal to or lower than C₂. When r C₂ is established at the instant t₄ , the result of the decision at the step 459 turns out to be YES. Then, at the next step 60, a decision is made whether T n is equal to 1. Since, now, T n 0, the control signal S During a shift from the second gear position with the converter state to the third gear position with the lock up, the control as illustrated in Fig. 24 is carried out. Referring to Fig. 24, since T n 0 and M 0 hold at the instant t₁, the flag F 10 is set at the step 449. In the next run during the length of time T after the instant t₁ , since the flag is equal to 10, after the execution of the steps 441, 442 and 451, steps 458 and 459 are executed where the operations that the speed ratio r is compared with the first reference C₁ is skipped and the speed ratio r is compared with the second reference C₂. This is because since this shift is from the converter state lock up release state the second gear position, the lock up release operation is unnecessary. When the speed ratio r becomes lower that the second reference C₂, the flag F is reset as being equal to 00 and the control signal S The transision between the lock up and the release of the lock up is illustrated by one dot chain line curve in each of Figs. 22 to 24. However, this time required for this transision is very short and thus the shift operation is not affected. Although, in the preceding description in connection with Figs. 19 to 24, the invention has been described as being applied to an upshift, it is apparent that the invention may be equally applied to a downshift. What is necessary for applying the flow chart shown in Fig. 21 to the downshift is to modify the step 453 such that the speed ratio r is greater than or equal to C₁ and to modify the step 454 such that the speed ratio r is equal to or greater than C₂. Of course, it is possible to apply the invention to both upshift and downshift.