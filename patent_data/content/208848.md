# Device for separating the signal from the noise and background contribution, particularly for computerised electrochemical instruments.

## Abstract
A device for separating the signal from the noise and background contribution, particularly for computerised electrochemical instruments, characterised by comprising an experimental data manipulator circuit 1 an ordering processor 2 connected to said manipulator 1 and arranged to provide this with the rules for the correct formatting of the experimental data, on the basis of the prechosen function a command sequencer circuit 3 , which governs the operation of the device on the basis of the values of the characteristic parameters for each function an interpolator circuit 4 which execute the prechosen function and recalculates each formatted data item using algorithms based on interpolation polynominals calculated by the Newton divided differences formula and the Aitken scheme for accelerating the calculation.

## Claims
1. A device for separating the signal from the noise and background contribution, particularly for computerised electrochemical instruments, characterised by comprising an experimental data manipulator circuit 1 an ordering processor 2 connected to said manipulator 1 and arranged to provide this with the rules for the correct formatting of the experimental data, on the basis of the prechosen function a command sequencer circuit 3 , which governs the operation of the device on the basis of the values of the characteristic parameters for each function an interpolator circuit 4 which execute the prechosen function and recalculates each formatted data item using algorithms based on interpolation polynominals calculated by the Newton divided differences formula and the Aitken scheme for accelerating the calculation. 2. A device as claimed in claim 1, characterised in that an input is provided in the command sequencer circuit 3 for a command for the function to be performed separation of the signal from the noise separation of the signal from the background contribution . 3. A device as claimed in claim 1, characterised in that an input is provided in the command sequencer circuit 3 for a parameter a corresponding to the width of that portion of the experimental curve to be recalculated iteratively in separating the signal from the noise. 4. A device as claimed in claims 1 and 3, characterised in that an input is provided in the command sequencer circuit 3 for a parameter b corresponding to the number of successive recalculations to which the entire curve is subjected in separating the signal from the noise. 5. A device as claimed in claim 1, characterised in that an input is provided in the command sequencer circuit 3 for a parameter a corresponding to the width of that portion of the experimental curve to be recalculated iteratively in separating the signal from the background contribution. 6. A device as claimed in claim 1, characterised in that an input is provided in the command sequencer circuit 3 for a parameter c corresponding to the total width of the curve portions, to the right and or to the left of the portion to be recalculated, which are to be taken into consideration when effecting the said recalculation in separating the signal from the noise. 7. A device as claimed in claim 1, characterised in that an input is provided in the command sequencer circuit 3 for a parameter c corresponding to the total width of the two curve portions, to the right and or to the left of the portion to be recalculated, which are to be taken into consideration when effecting the said recalculation in separating the signal from the background contribution. 8. A device as claimed in claim 1, characterised in that an input is provided in the command sequencer circuit 3 for a parameter 3 corresponding to the maximum precision level of the mathematical calculation in separating the signal from the noise. 9. A device as claimed in claim 1 characterised in that an input is provided in the command sequencer circuit 3 for a parameter e corresponding to the maximum precision level of the mathematical calculation in separating the signal from the background contribution. 10. A device as claimed in claims 3 to 8, characterised in that in the command sequencer circuit 3 there is provided a circuit for memorising standard values of one or more of the parameters a, b, c, c , e, e , but which can in any event be modified by the operator.

## Description
Device for separating the signal from the noise and background contribution, particularly for computerised electrochemical instruments This invention relates to a device for separating the signal from the noise and background contribution, particularly for computerised electrochemical instruments. The use of the computer for controlling electrochemical instruments has been known for some time see for example Anal. Chem., 50 5 Reviews, 14R 1978 Anal. Chem., 52 5 Reviews, 136R 1980 Anal. Chem., 54 5 Reviews, 16R 1982 Anal. Chem., 56 5 Reviews, 15R 1984 . The main advantages of these computerised instruments are automatic extraction of the required information from the experimental data the possibility of implementing various electrochemical techniques with a single instrument automatic control of the experimental parameters presentation of the final results in the most appropriate manner, according to the electrochemical technique used. Known computerised electrochemical instruments suffer from limits on their performance, these limits being due essentially to the incomplete utilisation of the computer potential. In practice, this performance corresponds substantially to the performance of conventional analog instruments of much lower cost, particularly at low concentration levels, where the capacity to separate the noise from the signal and to calculate the background contribution becomes very important. With regard to noise separation from the signal, this is currently done with filtering devices using algorithms based on the moving average, on the ensemble average, or on parabolic least squares smoothing. Filtering devices of the first type see Bunscki Kagaku, 31 8 , T55 1982 are based on the principle of reconstructing the experimental data sequence, which constitutes the unrefined signal, by taking subsequences formed from a predetermined odd number of successive data items and substituting the mean value of these data items for central data item of the subsequence. One of the drawbacks of these devices is that at low signal noise rations, the calculation has to be repeated many times to give good noise suppression, and this can introduce serious distortion into the signal of interest. Filtering devices of the second type see Anal. Chem., 52 8 , 1174 1980 Anal. Chem. 43 3 , 342 1971 are based on the principle of repeating the measurement m times to obtain m sequences of experimental data which, when added and averaged, give rise to an average sequence. Devices of this second type, which use a conceptually more correct principle, have however the serious drawback of requiring a number of measurements to be made which is greater the lower the signal noise ratio the noise reduction is proportional to the square root of the number of averaged curves , and this can require very long data acquisition times. Filtering devices of the third type see Anal. Chem., 43 3 , 342 1971 Anal. Chem. 36 8 , 1627 1964 are based on parabolic smoothing of the experimental data. This consists of calculating that parabola of assigned degree d which on a least squares basis best fits the experimental data over a range of length l. The value assumed by the thus calculated parabola at the centre of this range is taken as the filtered value of the relative experimental data item. The drawbacks of devices of this type are particularly related to the absence of criteria in choosing the parabola degree d and the length l of the range of data to be considered. With regard to correcting the background contribution, the known devices are based on approaches generally related to the electrochemical technique used. For example in sampled d.c. polarography and in normal pulse polarography, linear extrapolation of the background contribution is used see Anal. Chem. Acta, 101, 309 1978 . After being subtracted, the curve is forced to assume a sinusoidal pattern described by theoretical equations in differential pulse techniques see Anal. Chem., 51 3 , 337 1979 , the interpolation is based on a linear or quadratic least squares fit of the experimental points adjacent to the signal of interest in linear scanning and staircase voltametry see Anal.Chem., 43 11 , 1485 1971 , if two consecutive faradaic processes are present, then to calculate the background contribution for the more cathodic signal, a current diminution with t 1 2 function is used. The limits of all these approaches are mainly determined by their poor reproducibility, which confines their application to relatively high concentration levels. In other known devices, the background contribution correction is made by using a signal measured in the absence of the analyte, under the same experimental conditions see Anal. Chem., 43 11 , 1485 1971 Anal. Chem., 54 13 , 1313A 1982 . In this case, besides poor reproducibility, it is impossible to use it in the case of real samples, for which a reference sample can generally not be provided. The aforesaid drawbacks mean that it is currently impossible to use the various electrochemical techniques for measuring concentration values less than the limits given in the following Table A. EMI5.1 The object of the invention is to overcome the limits of the prior art by providing a device for separating the signal from the noise and background contribution which allows automatic extraction of the analytical signal of interest under prohibitive signal noise and signal background conditions, and in any event for anlytical concentration values less than those measurable by known devices enables analytical results to be obtained with high precision and accuracy is applicable to computerised electrochemical instruments and to any type of analytical instrument which generates signals having characteristics similar to those generated by electrochemical instruments. These objects are attained, according to the invention, by a device for separating the signal from the noise and background contribution, particularly for computerised electrochemical instruments, characterised by comprising an experimental data manipulator circuit an ordering processor connected to said manipulator and arranged to provide this with the rules for the correct formatting of the experimental data, on the basis of the prechosen function a command sequencer circuit, which governs the operation of the device on the basis of the values of the chracteristic parameters for each function an interpolator circuit which executes the prechosen function and recalculates each formatted data item using algorithms based on interpolation polynomials calculated by the Newton divided differences formula and the Aitken scheme for accelerating the calculation. A preferred embodiment of the presente invention is described in detail hereinafter with reference to the accompanying drawings, in which Figure 1 is a simplified block diagram of the device according to the invention Figures 2a, 2b,2c, 2d, 2e, 2f illustrate six successive stages in the treatment of an unrefined experimental curve entering the device according to the invention for separating the analytical signal of interest and Figure 3 is a block diagram of an electrochemical instrument using a device according to the invention. As can be seen from Figure 1, the device according to the invention comprises a vectorial structures manipulator circuit 1, which receives the unrefined signal ie comprising the analytical signal of interest, the noise and background contribution as it arrives from the analytical instrument. This unrefined signal is constituted in practice by a sequence of digital numerical values generated by an analog digital converter, which receives the electrical signal voltage or current originating from the analytical instrumentation associated with the device according to the invention.This signal is a function of the parameter being measured eg. analytical concentration, temperature, heat quantity etc. an ordering processor 2 connected to the manipulator 1, to govern the continuous organisation of the data formatted by the manipulator 1 on the basis of parameters which are iteratively requested from the operator a command sequencer circuit 3, which receives these parameters, to determine the operational manner in which the prechosen function is to be performed. This circuit is connected not only to the ordering processor 2, but also to the vectoral structures manipulator 1 and to an interpolator circuit 4, so as to govern their operation an interpolator circuit 4, which is that responsible for reconstructing the final signal.This interpolator circuit is connected to the manipulator 1, from which it receives the formatted data to be processed, and to which it restores the process data, to be reformatted and then transmitted to the outside for display. Further characteristics of the said modules 1, 2, 3 and 4 are described in greater detail during the course of the following description of operation. Initially, on activating the device, the operator is requested to introduce into the command sequencer 3 the parameters coresponding to the following the type of function to be performed, ie separation of the signal from the noise or separation of the signal from the background contribution the width of that portion of the experimental curve signal to be recalculated iteratively in separating the signal from the noise parameter a the number of successive iterations of the function over the entire curve in separating the signal from the noise parameter b the width of that portion of the curve to be recalculated iteratively in separating the signal from the background contribution paramater a the total width of the two curve portions to the right and to the left of the portion to be recalculated, which are to be taken into consideration in effecting the recalculation in separating the signal from the noise parameter c or in separating the signal from the background contribution paramater c generally the width 1 of the curve portion to the left of the portion to be recalculated is equal to the width r of the curve portion to the right of the portion to be recalculated and is equal to c 2.Consequently if the width of the available curve portion to the left or to the right is less than l or r respectively,the other portion, where possible, will be correspondingly greater so that in each case l r c in separating the signal from the noise, and l r c in separating the signal from the background contribution the maximum precision level of the mathematical calculation in separating the signal from the noise parameter e or in separating the signal from the background contribution parameter e . The precision level actually reached during the course of the calculation is also related to automatic convergency criteria based on the difference between successive numerical estimations of the numerical data, as will be clarified hereinafter. The command sequencer circuit 3 memorises, as standard values, the values of six of the seven parameters, namely a, b, c, c , e, e , which can in any event be modified at any time by the operator. The paramater a has to be introduced at the required time, according to the requirements of the various analytical techniques. As stated, the manipulator circuit 1 receives the original experimental curve in the form of a sequence of numbers generated during the course of the experimental measurement, as is described hereinafter. If separation of the signal from the superimposed noise filtration is required, the interpolator 4 considers a curve portion corresponding to a sequence of data items. Using the interpolation polynomials PDD calculated by the Newton differences formula and the Aitken solution for accelerating the calculation see F.B.Hildebrand Introduction to Numerical Analysis , McGraw Hill 1974, chapter 2, section 2.7 the interpolator 4 recalculates with a given order each data item of this portion as a function of the two adjacent portions external to the portion itself, or of only one of them if the other is missing this being done by an iterative process which uses an interpolation polynomial of continually increasing degree , until the absolute value of the difference between the current estimation and that found in the preceding iteration is equal to or less than the predetermined precision value parameter e or until this difference is equal to or greater than the absolute value of the difference between the preceding and the third from last estimate. In particular, if Yi d k is the interpolation estimation of polynomial degree d k of the i th point, the process stops if one of the following two inequalities is verified EMI12.1 The interpolator 4 then excludes the first point of the considered portion and includes the point successive to the last, to then repeat the iterative process, until all the data items have been recalculated. This operation is repeated b times. Theory states that the points thus recalculated, and thus the profile of the reconstructed curve, correspond to the experimental curve with the noise removed. If it is required to separate the background contribution, which is an operation generally done after separating the signal from the noise, and is therefore carried out on a signal from which the noise has been removed, the parameters a , c , e are taken into consideration as stated, the latter two having the same meaning as the parameters required for the preceding filtration function, whereas the parameter a corresponds to the curve portion over which the background contribution is to be calculated. In order to reconstruct the eliminated curve portion, the interpolator 4 calculates, again using the PPDs, the central point of this portion as a function of the two segments containing a total of c experimental points, to the left and to the right interpolation or only to the left extrapolation . It then proceeds in the same manner, recalculating the central points of the two portions into which the portion to be reconstructed has been divided by the first calculated central point, and so on. Again in this case the points are calculated by an iterative process which at each cyle uses an interpolation polynomial of an ever higher degree, until one of the two inequalities 1 or 1a is verified. Theory states that the curve reconstructed in this manner corresponds substantially to the curve relative only to the background contribution, and if this is subtracted from the initial curve, the result is the curve of only the analytical signal of interest. On termination of this iterative process, the interpolator 4, on request, restores to the manipulator 1 either the data sequence relative to the base line thus calculated, or the difference between the initial curve and the reconstructed base line. The manipulator 1, in both cases, reformats the data and makes them available to the outside for display or recording in the mass memory. At this point the device has performed its function, and the command sequencer 3 prepares to receive new instructions and parameters for performing the same or a new function. The following example will further clarify the invention. It will be assumed for the purposes of this description that the manipulator 1 receives a sequence of n pairs Xi, Yi of numbers representing the experimental data obtained during the measurement by the instrument. In particular, they represent the values of the two dependent and independent physical variables. In the case of electrochemical measurements, they can represent the electric current passing between the electrodes inserted into the measurement cell, and the value of the applied potential. The device then requests from the operator the function to be performed and the value of the parameters which characterise it should the operator wish to change these from the standard values memorised . Having chosen the function for example signal filtration followed by separation of the background contribution and having introduced the parameters a, b, c, e for the filtration stage the parameters a , c , e for separating the background contribution will be requested later , the ordering processor 2 defines, on the basis of the introduced parameters, the rules to be used by the manipulator 1 to format the data, ie to transform the sequence of n input data items into a sequence of n formatted data items A1,j, A2,j, A3,j, ......Ai,j , An,j 2 which are then fed to the interpolator 4 for executing the required function. In 2 , Ai,j indicates the i th data item of the sequence, recalculated by the j th interpolation. Obviously j 0 corresponds to the unrefined data see curve 2a . For separating the analytical signal from the noise, the interpolator 4 considers the first a unrefined data items, ie the subsequence A1,0 ....Aa,0 3 and constructs the interpolation polynomial P d x of degree d with d c calculated by the following Newton divided differences formula EMI16.1 where P d 1 x , Q d 1 x are independent polynomials of degree d 1. For d 1 EMI16.2 where P 0 x Aa 1,0 and Q 0 x Aa 2,0 Using these polynomials, it recalculates the value of A1,0 as a function of the values Aa 1,0 , .....Aa c,0 , ie of the c data items of the sequence 2 present to the right of the a data items to be recalculated N.B. As will be clear hereinafter, the parameter c is the maximum number of total data items in the calculation and present to the right and to the left of the subsequence to be recalculated. Because of the fact that in this stage the subsequence 3 does not have data to the left, c data items to the right are obviously taken into consideration . This first recalculation is follewed by a subsequent recalculation. If the data item A1,2 thus recalculated differs from the data item A1,1 by more than e, the interpolator 4 carries out a new recalculation after increasing the degree of the interpolation polynomial by one, thus using the following polynomial EMI17.1 The operation is reiterated until one of the two conditions 1 or 1a is verified. At the end of this stage, the experimental data item A has been transformed into the recalculated data item EMI17.2. The interpolator 4 then executes the same operations on the experimental data item A2,0 which becomes transformed into the data item EMI17.3 and so on, until the initial sequence 2 is transformed into the sequence EMI17.4 in which the first a data items have been recalculated, the next n a data items are the initial ones, and ki indicates the number of successive recalculations to which each data item has been subjected. The interpolator 4 then considers the subsequence EMI18.1 ie the subsequence of a data items of the sequence 6 , hifted through one position with respect to the subsequence 3 , and for each data item of this subsequence 7 effects the recalculation applying the same procedure and using again a total of c data items of the subsequence 6 in this case only the data item EMI18.2 to the left, and the data items from Aa 2,0 to Aa 1 c,0 to the right . On termination of this recalculation operation, a new sequence EMI18.3 is obtained in which the subscripts ki indicate the number of iterations to which each data item has been subjected in recalculating the first subsequence 3 , and the subscripts k i indicate the number of iterations to which each data item has been subjected in recalculating the subsequence 3 and the subsequence 7 . The interpolator 4 then proceeds with the next subsequence EMI19.1 and so on. On termination of this first cycle of recalculations, which has led to a new sequence being obtained in which all the data items have been recalculated at least once by the indicated method, further cycles to a total of b are repeated the curves 2b and 2c are representative of two intermediate sequences of recalculated data items. Theory states that on termination of this iterative recalculation procedure, a sequence of recalculated data items is obtained which represents the curve of the input signal separated from the noise see curve 2d . From this sequence A 1, A 2 .....A n 10 the interpolator 4 separates the background contribution after requesting the value of the single parameter a , as the other parameters c , e have standard values. Using the procedure described for the filtration, the interpolator 4 considers the data sequence 10 obtained from the preceding filtration operation, and defines the a data items corresponding to that curve portion to be recalculated, ie considers, on the instructions of the operator, the subsequence A i , ......A i a 1 11 which must be recalculated with the PDDs on the basis of the two subsequences A i 1, ..... A i l 12 A i a , .....A i a r 1 13 where l r c These subsequences are respectively to the left and to the right of the subsequence 11 in the case of interpolation. In the case of extrapolation r 0 , only the subsequence 12 is used. Again applying the interpolation polynomial EMI20.1 of degree d c , the central point of the subsequence 11 is recalculated iteratively as a function of the data of the two subsequences 12 and 13 or only 12 the iteration stops at the degree k if one of the following two inequalities is verified EMI21.1 Using the same criteria, the central points of the two portions into which the curve has been divided by the first central point are recalculated, and so on. At the end of this procedure, when all the points of the original sequence 11 have been recalculated, a data sequence is obtained corresponding to the background contribution alone see curve 2e , and if this is subtracted form the former it provides a data sequence corresponding to only the analytical signal of interest see curve 2f . These data are then transferred to the manipulator 4 for reformatting and feeding to the outside for display or for recording in the mass memory. The described device finds advantageous application in the analytical instrumentation field whenever the instrument under consideration generates signals which are characterised by an associated noise electrical and or mechanical having an amplitude which can be even greater than that of the signal itself, provided it is of a frequency sufficiently high compared with the signal, and by a background contribution which follows a pattern enabling it to be reconstructed by interpolation or extrapolation. In particular, one advantageous application of the device according to the invention is its use in electrochemical instruments, for example of the type illustrated diagrammatically in Figure 3. It comprises a traditional electrochemical cell 6 connected to a potentiostat 5 which is controlled by the operational unit see Anal. Chem., 51 3 , 337 1979 Anal.Chem., 43 11 , 1485 1971 through a digital analog conversion device 9 and an interface circuit 10. The cell signal is fed by way of an electronic conditioning circuit 7 comprising a current voltage converter and a variable gain amplifier, to an analog digital conversion device 8 for conversion into a sequence of digital numbers which, by way of the interface circuit 10, enters the device 11 according to the invention for filtration and subtraction of the background contribution. This device, containing a SBC single board computer and a memory board, also governs the control of the electrochemical instrumentation by means of a control circuit 12, and the connection to the various terminals peripherals by means of an interface 13. The process signal leaving the device 12 is fed through an interface 13 to the peripherals, which can comprise a print out unit 14, a video graphic unit 15 for its display, and a floppy disk 16 for its recording. As in the case of all known computerised electrochemical instruments, the present one also offers high performance in terms of numerous possible electrochemical techniques, automatic control of instrument parameters, and presentation of experimental data in the most appropriate manner. However in contrast to known computerised electrochemical instruments, the instrument using the device 11 according to the invention allows analytical extraction of the required information under prohibitive signal noise and signal background ratio conditions, which in terms of minimum measurable concentration can be up to 20 times less than that of known devices, according to the technique applied. The following Table B indicates the minimum concentration which can be measured by the instrument according to the invention a for certain electrochemical techniques, and the corresponding concentration values measurable by known electrochemical instruments b . EMI24.1 Finally,the following Table C shows the reproducibility of the parameters characteristic of the analytical signal Ep and ip for two electrochemical techniques considered by way of example. EMI25.1