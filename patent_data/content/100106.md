# Communications systems and transmitters and receivers including scrambling devices.

## Abstract
Pseudo random number PN sequence generators used in scrambling and descrambling circuits at separate locations are periodically preset to the same start value in order to main tain synchronism, with the preset value being also periodically changed. The preset value can be transmitted to the scram bling and descrambling circuits over a privacy channel once per frame and stored in storage registers 20 associated with each of the scrambling and descrambling circuits 22, 24 . The stored starting state values can be loaded into the PN se quence generators 22 as often as desired to maintain proper synchronization, with the stored values themselves being changed at a rate dependent on the desired degree of secur ity.

## Claims
Claims 1. A communications system comprising at least one transmitting and at least one receiving station, said transmitting station having a scrambling means of the type including first generator means 12 for generating a scrambling sequence commencing with a starting state and mixing means 14 for scrambling data in accordance with said scrambling sequence, said receiving station having descrambling means of the type including second generator means 22 for generating a descrambling se quence commencing with said starting state and mixing means 24 for descrambling received data in accordance with said descrambling sequence, said first and second generating means being arranged to generate identical sequences commencing from identical starting states characterized by means for periodically setting both said first and second generating means to identical starting states, and by means 10,20 for periodically changing the starting state to which said first and second generating means are set. 2. A system as claimed in claim 1 characterized in that said means for periodically changing comprises a first storage register 10 at said transmitting station for storing said starting state a second storage register 20 at said receiving station for storing said starting state, the contents of said first and second storage registers being set into said first and second generating means, respectively, in response to a start signal and means for periodically changing the contents of said first and second storage registers. 3. A system as claimed in claim 2 characterized in that said means for periodically changing the contents of said first and second storage registers comprises means for periodically generating a new starting state value, said new starting state value being transmitted in an unscrambled state to at least said receiving station for storage by said second storage register. 4. A system as claimed in claim 3, characterized by aTDMA system having a reference station in addition to said transmitting and receiving stations, said means for periodically generating a new starting state value being located at said reference station and said new starting state value being transmitted in an unscrambled state to both of said transmitting and receiving stations. 5. A system as claimed in claim 3 or 4 characterized by means other than said scrambling means for encrypting said new starting state value prior to transmission. 6. A communications system in which original data to be transmitted is provided at a transmitting station to a scrambler 12,14 , the output of said scrambler comprising scrambled data and being transmitted to a receiving station, the received scrambled data being provided at said receiving station to a descrambler 22,24 for recovery of said original data, characterized in that each of said scrambler and descrambler comprises storage register means 10,20 for receiving and storing a periodically changing starting state value a PN sequence generator 12,22 for generating a PN sequence commencing from a sequence start value, the PN sequence generators in each of said scrambler and descrambler generating the same PN sequence for any given sequence start value and means for synchronously loading the starting state values from each storage register into their respectivePN sequence generators as said sequence start values. 7. A transmitting or receiving station for use in the system of any one of the preceding claims, characterized by storage register means 10t20 generator means 12 22 arranged to generate a scrambling sequence from a variable starting state means for loading the content of said register means into said generator means as said start value and means for changing the content of said register means.

## Description
Conununications Systems and Transmitters and Peceivers Including ScraSDling Devices The present invention relates to communications systems and to transmitters and receivers having a scrambler, such as a scralabling circuit capable of providing satisfactory security in a high bit rate TIJMA communications system. In conventional TDMA systems where data security is desired, data encryption equipment has been placed at the data source with decryption equipment used at the receiver. For data rates of 64 kilobits or less, encryption is possible using commercial encryption equipment operating in a well known manner in accordance with the National Bureau of Standards NBS DataEncryption Standard DES . However, even at such a relatively low bit rate, some situations involve a large number of 64 kilobit data streams each of which must be encrypted, thus requiring a large number of encryption devices and increasing system costs and complexity. Until recently, data security in TDDE systems has not been a widespread concern and the few applications in which it has been necessary may have justified its expense and attendant performance limitations.However, with increasingly widespread use of TDMA comanunications, for example in the commercial marketplace where sensitive data such as bank transfer information and petroleum exploratory data is being transmitted via TDIfE links, the need to provide data security is becoming increasingly important. Users ofTDMA systems now desire to have the TDMA transmission bulk encrypted in accordance with the National Bureau of Standards DES, but for domestic TDMA systems this may necessitate a set of hardware to encrypt data at either 30 or 60 megabits. Such equipment is not readily available. Rather than utilize encryption equipment, a measure of security can be provided by scramlUling the TDIiA transmission. A common scrambling technique is to generate a psuedo random PN number sequence and to mix this sequence with the data bit stream, e.g.via an Exclusive OR gate. The scrambled data is then modulated and transmitted with energy that is substan tially equally distributed across the bandwidth of the transmission channel. A descrambler utilizing an identical PN sequence generator is located at the receiver and utilizes an identical PN sequence to extract the information data. In order to accurately extract the information, however, the PN sequence generators at the data source and receiver must be operated in synchronism, and this is assured by periodically resetting both of the PN sequence generators to a known state.In typical TDIKA systems7 the PN sequence generators are loaded with an all ones pattern at the beginning of a sequence, with the sequence being started either at the beginning of a TDI42 frame and running continuously for the duration of the frame or at the beginning of each burst and running for the duration of each burst. While such scrambling techniques do provide a measure of security, the protection provided is not sufficient for sensitive information. An unauthorized user with the same receiver hardware can reset his ownPN sequence generator to enable decryption of the data. Even if he does not know from the start the value to which the sequence generator should be reset each time, if the reset value is always the same he need only collect enough data to break the code once, after which he will have no trouble in thereafter receiving and descrambling all transmitted information. A slight improvement in security is provided by a system such as disclosed in U.S. Patent 3,659,046 to Angeleri et al. In that system, the PN sequence generators in the transmitter and receiver are concurrently reset in order to maintain synchronization, but the resetting is performed in response to a randomly generated pulse at the transmitter. Thus, an unauthorized user, even knowing the starting state to which the scrambler is to be reset, would have the additional problem of determining exactly at what times the resetting is to occur. Although this does provide an additional measure of security, the system would not be protected from an unauthorized user having the same receiver hardware.Such an unauthorized user would have his own PN sequence generator reset at the proper times by merely detecting the reset pulse.It is an object of this invention to provide a communications system utilising a scrambling descrambling technique which is relatively secure even from an unauthoriz ed user having the same receiver hardware.According to one aspect of the invention, there is provided a communications system comprising at least one transmitting and at least one receiving station, said transmitting station having a scrambling means of the type including first generator means for generating a scrambling sequence commencing with a starting state and mixing means for scrambling data in accordance with said scrambling sequence, said receiving station having descrambling means of the type including second generator means for generating a descrambling sequence commencing with said starting state and mixing means for descrambling received data in accordance with said descrambling sequence, said first and second generating means being arranged to generate identical sequences commencing from identical starting states characterized by means for periodically setting both said first and second generating means to identical starting states, and by means for periodically changing the starting state to which said first and second generating means are set.According to a further aspect of the invention, there is provided a communications system in which original data to be transmitted is provided at a transmitting station to a scrambler, the output of said scrambler comprising scrambled data and being transmitted to a receiving station, the received scrambled data being provided at said receiving station to a descrambier for recovery of said original data, characterized in that each of said scram bler and descrambler comprises storage register means for receiving and storing a periodically changing starting state value a PN sequence generator for generating a PN sequence commencing from a sequence start value, the PN sequence generators in each of said scrambler and descrambler generating the same PN sequence for any given sequence start value and means for synchronously loading the starting state values from each storage register into their respective PN sequence generators as said sequence start values. According to a further aspect of the invention, there is provided a transmitting or receiving station for use in said communications system and characterized by storage register means generator means arranged to generate a scrambling sequence from a variable starting state means for loading the content of said register means into said generator means as said start value and means for changing the content of said register means.The invention will be more clearly understood from the following description of a preferred embodiment in conjunction with the accompanying drawings, in which Figure 1 is a block diagram of components of a scrambler circuit arrangement according to the present invention Figure 2 is a block diagram of components of a descram bler circuit arrangement according to the pres ent invention andFigure 3 is a diagram of TDMA frame architecture showing the location of the privacy channel in which a starting state is to be transmitted.The invention will be described in the context of a TDMA system of the type having a centrally controlled network with a Network Control Processor NCP at the reference terminal providing all command information required to define the TDMA frame structure. However, it should be appreciated that in its most basic form the invention is applicable to scrambled transmissions between any two stations.As described above, it is common in a TDMA system to scramble the data using a PN sequence generator, with the PN sequence gnerators at the transmitter and receiver being periodically reset. The resetting may occur once every frame or once every burst, or it may even occur at random intervals as in the above cited U.S. Patent 3,659,046 to Angeleri et al. The present invention is applicable to any and all of the these systems regardless of the frequency with which the sequence generator is to be restarted. In its most basic form, the invention is directed to a technique for adjusting the value at which the scrambler and descrambler PN sequence generators will be restarted. Figure 1 is a brief block diagram of the essential components of a scrambler circuit according to the present invention, and Figure 2 is a similar block diagram of a descrambler circuit. In the scrambler circuit of Figure 1, a storage register 10, which may for example comprise a 22 bit storage register, stores the starting state data which is then loaded into a 22 bit PN sequence generator 12 in response to a start pulse. Having been loaded with this star ting state, the sequence generator then proceeds to generate itsPN sequence in response to a clock signal, with thePN sequence being combined with clear text data in anExclusive OR EOR gate 14.In the descrambler circuit of Figure 2, a similar 22 bit storage register 20 stores a starting state which is loaded into an identical 22 bit PN sequence generator 22 in response to a start pulse, and the PN sequence output from the sequence generator 22 is combined with the scrambled data in EOR gate 24 to recover the clear text data. The generation of the start and clock pulses and the scrambling and unscrambling of the data via EOR gates are conventional and well known and need not be described in further detail. Further, the operation of PN sequence generators is also well understood in the art and the sequence generator itself may operate according to any of a number of well known algorithms.The distinctive feature of the present invention is that, whereas in a conventional system the PN sequence generators 12 and 22 would be reset to fixed starting states in response to the start pulses, the present invention provides registers 10 and 20 for storing a variable starting state value and the sequence generators according to the present invention are instead set not to fixed values but to the values stored in respective storage registers 10 and 20, which storage values may be periodically changed. For the purposes of this description, as stated above, the invention is assumed to be utilized in a centrally controlled TDMA network having Ã  plurality of stations including at least one reference terminal.In such a case, the 22 bit number to be stored in the registers 10 and 20 at each terminal is preferably transmitted from. the NCP to each local terminal in the network. The 22 bit number is then loaded into thePN sequence generators in each circuit when that circuit is initialized at the beginning of a TDER frame, at the beginning of a TDMA burst, or randomly as may be desired. For an unauthorized user to correctly receive the information, he must fad his own PS sequence generator with the same 22 bit number at the same time. .There are 222, or more than 4 million, different numbers which could be used to start the scrambling and descrambling processes, and the unauthorized user must not only determine the particular number which will correctly start his descrambler but must also make this determination as often as the contents of the registers 10 and 20 are changed. This will present at least a substantial obstacle to unauthorized interception of the transmission. The 22 bit number to be stored in the registers 10 and 20 may preferably be transmitted from theNCP in the privacy channel. Figure 3 is a diagram of the TDMA frame architecture showing the privacy channel transmitted in reference burst 1 immediately following the preamble. In order for each of the local terminals to receive the privacy channel, the privacy channel is transmitted with the scrambling circuits disabled. This does present a problem in that unauthorized users will also be listening to the privacy channel, and some means is therefore 4weeded to secure the privacy channel from unauthorized reception. This may be done by encrypting the privacy channel using the National Bureau of Standards data encryption standard.The TDIMA system in which the present invention is used may utilize the electronic code book mode as described in Federal Standard 1026, and this mode may be implemented using either a master key only or a master key plus secoIluar key to decrjpt the privacy channel. This type of encryption decrvm tion is well understood in the art and need not be described in detail here. Further, it should be noted that, although the electronic code book mode may be used in the TDNA system employing this invention, the invention is not constrained to the use of such an encryption mode, and other techniques such as the cipher feedback mode or the cipher block chaining mode as described in Federal Standard 1026 may be used.Indeed, virtually any encryption descryption technique could be used without departing from the essential nature of the invention The network control processor via the privacy channel has the means to send new starting states for the scrambling and descrambling circuits to each of the local stations in the TDMA network. Depending on the degree of system wide security desired, new starting states may be transmitted at intervals from, e.g., every five minutes to once per day. Where a high degree of security is required, short intervals between transmission of new starting states may be employed so that, by the time the unauthorized user could break the code, a new code would be implemented. This process can be totally automatic within the NCP, with the user, i.e., the overall system operator, only having to specify the interval between the sending of starting state updates to the subscribers. The 64 bits in the privacy channel can be used to transmit the new starting state a 22 bit number plus the necessary coordination information so that the change of starting states at all local terminals in the TDMA network will occur in the same frame as seen by the satellite. This coordination is required so that no frames are lost and so that the change of starting states of the scrambling and descrambling circuits is not observable by the system user. With the configuration as described above, the unauthorized user, having been denied access to the contents of the privacy channel, must attempt to decode the starting state of the scrambler on the basis of the scrambled frame data. This process is made difficult, since 1 all channels that are scrambled either contain data of a random nature or do not occupy fixed positions in the frame, and channels which both occupy fixed positions in the frame and contain data that is not random, are not scrambled and 2 in the TDMA system, the frame configuration is constantly changing to meet the dynamic traffic requirements. The unauthorized user having no knowledge of the present frame configuration would, therefore, find it difficult to accumulate a sufficiently large data base to allow estimation of the starting state in the period between changes of this state. With the relatively simple configuration described above, a degree of security is provided which, although not as secure as encrypted data, is adequate for many applications and is certainly much easier and less costly to implement. Briefly, the present invention comprises a method and apparatus by which the PN sequence generators in the transmitter and receiver are periodically set to identical but variable starting states. A starting state value to be used at the transmitter is transmitted over a privacy channel to the receiver so that the receiver knows the same starting state used at the transmitter. In a preferred embodiment of the invention, the transmitter and receiver each include multi bit storage registers for storing a particular starting state. The contents of this starting state register can be periodically changed, and setting of the PN sequence generators at the scrambler and descrambler is performed by loading the stored starting state value into the PN sequence generator in response to a start, or load, pulse which can be generated and transmitted in a conventional manner. The starting state value, which is generated at the transmitter, can be transmitted to the receiver over a privacy channel and can be preferably encrypted in accordance with the well known DES.