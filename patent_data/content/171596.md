# METHOD AND APPARATUS FOR CONCENTRATING SIGNALING AND NON SIGNALING MESSAGES OVER A COMMON CHANNEL

## Claims
Verfahren zum Konzentrieren einer Mehrzahl von Benutzerkanälen auf einen gemeinsamen Kommunikationskanal in einem TASI Kommunikationssystem, dadurch gekennzeichnet, daß dieses die folgenden Schritte umfaßt

## Description
The invention relates to trunk concentrators in general and more particularly to trunk concentrators utilizing the well known TASI Time Assignment Speech Interpolation technique. The use of a common communication channel for transmitting data generated from a plurality of data terminal equipment DTE is well known in the prior art. The data terminal equipment may include devices such as telephones, computers, facsimile like machines, etc. Except for telephone devices, communication between other types of devices may be done asynchronously. Asynchronous communication suggests that the information being exchanged can be reasonably delayed without adversely affecting the information. Telephone devices usually require synchronous communication. Synchronous communication suggests immediate transmission. Failure to transmit speech within a reasonable time will degredate the contents of the speech. Notwithstanding the differences, telephone and non telephone devices may be concentrated onto a common communication channel if the concentrator is designed to accommodate the idiosyncrasies associated with speech. The cyclic pattern or characteristic of speech is the idiosyncrasy that is most utilized in providing a concentrator to handle speech and non speech intelligence. Generally, the cyclic pattern has a period burst of activity followed by a period of silence. By applying an interpolation technique to this cyclic pattern, both speech and non speech information generated from a plurality of users is made to statistically share a communication channel. Usually, the silent period in the speech is used to transmit an increased number of speech channels and or non speech data. The input signal lines speech and or data are monitored for valid signals. When a valid signal is detected, the line is connected with the first free transmission facility. On the receiving end the transmitted information is routed to the appropriate output port for the duration of the speech burst. The technique tends to maximize the efficiency of the communication channel and decrease per user channel cost. The most widely known and practical implementation of the principle is in the Time Assignment Speech Interpolation TASI system which was first introduced by Bell Systems in the early 1960 s. Although the system works well for its intended purpose, one common criticism is that the system utilizes large and costly equipment, thus, limiting its application to very special environments such as transoceanic use where transmission facilities are scarce. The PLC 1 private line voice concentrator is another prior art device which uses the principle of speech interpolation to multiplex a large number of users onto fewer communication facilities. In the system blocked speech segments are delayed in a queue, or buffer pending the availability of transmission channel resources. Overload relief is provided by operating the buffer in a FIFO first in, first out manner, discarding messages which have been in the queue for more than a predetermined period of time. Furthermore, supervisory signaling information is transmitted on a dedicated channel. This channel is not available to the system s users. A more detailed description of the PLC 1 system is given by Nakhla, Michael S., and David Black, Analysis of a TASI System Employing Speech Storage, IEEE Trans. on Comm., Vol. COM 30, No. 4, April 1982, pp. 780 785 and Black, David, PLC 1 A TASI System for Small Trunk Groups, also in COM 30, Vol. 4, pp. 786 791. Document FR A 2 296 983 also illustrates a TASI system where the signaling data are transmitted over a dedicated channel. It is therefore a general object of the present invention to provide a signal concentrator which is more efficient than has heretofore been possible. The technique of the present invention integrates the supervisory signaling function with normal message traffic, thereby freeing any residual signaling capacity for use by the normal message traffic. The technique increases the effective capacity of the communication channel. The invention provides a method for concentrating a plurality of users channels onto a common communication channel in a time assignment speech interpolation communication system, characterized in that it comprises the steps of The invention also provides a TASI communication system for concentrating a plurality of users channels onto a common communication channel, said users channels generating a plurality of signaling and non signaling voice, data, control etc... messages, characterized in that it comprises The foregoing features and other advantages of this invention will be more fully described in the accompanying drawings. Fig. 1 shows a schematic representation of the Private Line Multiplexer PLM according to the teaching of the present invention. Fig. 2 is a block diagram showing the functional components of the PLM. Fig. 3 is a flow chart of the algorithm used to control the sequencing of messages from the message buffer onto the common communication channel. Fig. 4 is a graphical representation of the queue map. Fig. 5 is a graphical representation of the output time map. Fig. 1 shows a block diagram of a communication system embodying the teaching of the present invention. The invention is embodied in the boxes identified by numeral 10 and labeled private line multiplexor PLM . A plurality of the PLM boxes are used to interconnect a plurality of conventional digital PBX s to a private trunk network communication system. The private trunk network provides a digital communication facility which enables a local area network such as the one identified by numeral 12 to be connected to the other local area network identified by numerals 14, 16 and 18. Although the diagram shows four local area networks interconnected with the private trunk communication network, in an actual system as little as two local area networks can be interconnected. Each of the local area networks is located in different and distant localities. For example, local area network 12 may be located in any part of the United States, say Raleigh, North Carolina, while the other local area network is located in a company headquarters, say in Kingston, New York. The interconnection of both local area networks is achieved by the private trunk communication network. Each of the local area networks includes a private line multiplexer 10 which is connected by a bidirectional bus identified by numeral 20 to a digital PBX. The PBX in turn is used to interconnect a plurality of conventional telephones identified by numeral 22. In addition, other devices identified as data terminal equipment DTE which may be other telephones, computers, facsimile machines, etc. are also tied into the PBX. The digital PBX is a conventional device which is used for tying such DTEs and as such details of the PBX will not be given. In addition, other local telephone networks LTN s are also tied into the PBX s. By way of example, the local telephone network enables personnel in a particular local area network facility to communicate with personnel which are off site, albeit in close proximity with the local area network facility. Fig. 2 shows a block diagram for the private line multiplexer. The private line multiplexer comprises of a transmitting section 22 and a receiving section 24. The transmitting section 22 is shown above the broken line while the receiving section is shown below the broken line. In the figure the symbol M and arrows are used to show the direction of data flow in the system. The design and implementation of the PLM revolves around an integrated buffer concept. To this end, a buffer identified by numeral 26 is provided for storing messages generated from different DTE s and signaling information. The signaling information carries control data and is usually generated by the system control processor 28. The signaling information is merged into the normal traffic information which is stored in the buffer and is transmitted onto the trunk on a priority basis to be described later . The input to buffer 26 is controlled by a queue manager means 29. The output of the buffer is connected and is controlled by server means 30. As will be explained subsequently, the server means 30 sequences entries from buffer 26 in a predetermined priority order to be described subsequently over the telco telephone company interface into the digital trunks. The status information relative to the trunks are fed over conductor 32 into server means 30. The function of the telco interface is to prime the signals outputted from server 30 so that the signals can be transmitted over trunk lines. The function of the telco interface is well known in the prior art and as such further details will not be given. As stated previously, the signals into queue manager means 29 are supplied from the DTEs which are attached to the network and the signaling information. The signaling information or control information is generated from the system control processor 28. The other input signals on terminal 32 are outputted from signal detection and compression means 34. The input to the signal detection and compression means 34 is supplied from PBX interface 36, the input to the PBX interface is taken from the internal bus structure of the PBX not shown . The function of the PBX interface 36 is well known in the art and details will not be given. Suffice it to say that the PBX interface conditions signals outputted from the PBX and feeds those signals into the signal detection and compression means 34. The signal detection and compression means 34 includes a plurality of individual devices which perform signal detection and compression functions. These boxes include standard algorithms which take the digital voice signal from the PBX interface as 12 bit PCM signal and converts down to 16 kilobits per second digitized speech going from 96 kilobits second PCM to 16 kilobits second. Devices for performing this function are well known in the prior art and as such details will not be given. A different compression technique, 64 kilobit second mu or A 1A PCM, is used in coding voice band data signals. Digitized data packets are transmitted directly and are not coded or compressed. Still referring to Fig. 2, the queue manager means 29 includes a controller and a queue map. Turning to Fig. 4 for the moment, a copy of the queue map is shown. Although the controller can be fabricated from combinatorial logic, in the preferred embodiment of this invention the controller is a microcomputer and the queue map is generated in the RAM associated with the microprocessor. The RAM may be internal or external to the microprocessor. The queue map Fig. 4 has a maximum depth d and a plurality of vertical columns. The queue map is used to store information about each entry into the message buffer. In other words, the text associated with a particular message is placed in the buffer while information about each text in the buffer is maintained in the queue map. To this end, the queue map has a priority section, an identification ID section, an entry time section, a release time section, and a location section. The priority section is used to store data regarding the priority associated with a particular message. The identification section records an identification number defining the source from which the message is derived. The entry time section is used to record the time when a particular message is stored in the buffer. The release time section is used to record the time when a particular group of messages to be described later may be released from the queue. The location section records the address in the message buffer where a particular text is stored. It should be noted that with this map messages can be stored at random addresses in the buffer. As will be explained subsequently, as message packets pour into the queue manager, this information that is, Priority, I.D., Entry Time, etc. is extracted and is recorded in the queue map and the text is passed onto the buffer. Still referring to Fig. 2, the function of server means 30 is to sequence the stored messages in a predetermined priority order from buffer 26 into the trunk or communication channel. Before describing the function and components of server 30, the predetermined priority scheme will be given. All messages entering the queue are assigned to one of five priority classes Returning to Fig. 2, the server means 30 includes a controller which in the preferred embodiment of this invention is a microprocessor having adequate ROM and RAM storage and an output time map which is formed in the RAM storage and is shown in Fig. 5. The output time map is divided into an ID section and a timing section. The ID section is used to record the identification of the speech source and the time when a particular message from that speech source was last transferred from the queue. As will be explained subsequently, the information in the timing section of the output time map is used to determine the time when a particular message should be transferred from the queue map. As will be explained subsequently, by assigning a departure time to priority 3 messages, the delay which is associated with normal speech is maintained when a plurality of information from a common source is stacked into the buffer. This option is not exercised in transmitting data. In addition, an algorithm is used for running the processor in server means 30 so that the information is outputted from the buffer in accordance with the priority basis. Fig. 3 shows a flow chart of the algorithm which is used to control the processor in server means 30. The first block identified by numeral 36 is a delay block called advance clock. Block 38 is a decisional block in which the program tests to see if the channel or trunk space is free. This information is supplied over conductor 32 labeled trunk status Fig. 2 . If the trunk is not free, the program enters a loop and after the delay 36 Advance Clock expires the test is again performed. When a free channel is available at the trunk, the program descends into block 40. In block 40 the program scans the queue map and buffer 26 to see if any priority 1 P1 traffic is in the buffer. If there is any, the program enters block 42 where it sends the P1 message mess g and enters decisional block 38 via a path B. Still referring to Fig. 3, if there was no P1 traffic in the buffer, the program descends into block 44. In block 44 the buffer checks to see if there is any priority 2 traffic in the buffer. If there is priority 2 traffic, the program enters block 46 where it sends the P2 message and exits the block via path B. If there was no P2 traffic in the buffer, the program descends into block 48 where it checks to see if any ready for release P3 traffic is in the buffer. If there is any ready for release P3 traffic in the buffer, the program enters block 50. In block 50 the program consults the output time map. The program then descends into decisional block 52. In decisional block 52 the program checks to see if sufficient delay has expired since the last readout of a message from the source which is currently requesting service. If the delay is sufficient, the program enters block 54 where it sends the message to the channel and exits the block along path B. If sufficient time has not lapsed since the last transmission from said source ID, then the program descends into operational block 56. In block 56 the program calculates a release time and changes the priority classification from P4 to P3. As stated before, the P3 classification is reserved for reclassified messages. The program then drops into block 58 where it checks to see if the total delay from the inception of the message to the anticipated time of transmission is acceptable. If it is acceptable, the program exits the block along path B. If not, the program drops into block 60 where the message is dropped and the program exits block 50 along path B. Still referring to Fig. 3, if in block 48 the answer is in the negative, the program then enters decisional block 62 where it checks the buffer to see if it contains any priority 4 P4 traffic. If the answer is yes, the program enters block 50 and performs the steps previously described. If there is no P4 traffic in the buffer, the program drops into block 64 where it checks the buffer for the presence of priority 5 P5 traffic. If P5 traffic is found, a packet is transmitted block 65 , and the program returns along path A. If there is no P5 traffic, the program exits block 64 along path A and repeats the above described process. A tag identifying the source ID is appended to each departing message on transmission. Referring again to Fig. 2, the receiver portion of the PLM includes the means for routing each incoming message from a remote PLM to its intended destination. Incoming signals from the trunks are primed by the telco interface for entry into the receiver. Message tags are read by the address decoder means 80. For P2, P3, P4, and P5 messages, connection table 82, established via signaling to be described , authorizes address decoder 80 to operate one of the enable means 84. The incoming message now appears on one of lines 86 for input to the selected signal reconstructor means 88. In cases of P3 or P4 traffic appearing on 86, these reconstructors decode 16 kilobit second speech originally encoded by the speech compressors means 34. Signals are outputted from the reconstruction as 96 kilobit second PCM and sent to the attached PBX by the PBX interface means 90. In case of P2 traffic, the reconstructor decodes the associated voice band data as 64 kilobit second mu or A law PCM. These signals flow through interface 90 as described. In the case of P5 traffic, the reconstructors do not alter the incoming traffic as no reconstruction is needed. These P5 messages flow through interface 90 to the PBX bus. In the case of P1 signaling messages, the connection table authorizes the address decoder 80 to operate the signaling enable means 92, establishing a path to the system control processor 28. The connection table 82 contains the routing information associating a particular incoming tag ID with the appropriate PBX input port connected via PBX interface 90 . This path routing is established by a series of signaling P1 exchanges between the two PBX PLM pairs at the establishment of each virtual circuit, i.e., during the dialing phase of each phone call or data session. The routing exists only for the duration of a session, and is erased from connection table 82 by a series of signaling exchanges at the termination of a call or session. Voice packets are generated by the TASI like operation of signal activity detectors operating in the input ports. A period of silence is not transmitted as would be expected with any compression system of this type. The buffer operation is controlled by microprocessor controller and software tables which are maintained up to date as messages flow through the system a queue map, an output time map, and the actual message buffer form the crux of the system. Messages are taken from the buffer as communication channels become available. The readout follows a first in first out discipline, within priority groups, with priority class taking precedence over absolute queue position. In such a system, the priority 1 messages are read first in first out , followed by priority 2 messages FIFO within their class , etc. Each message carries a short header indicating its origination ID. The receiver assigns each message to the appropriate destination by reference to a connection table Fig. 2 established during new traffic signaling. The controller itself is assigned an originator s ID, the appearance of which indicates a signaling message. The originator s ID is the only differentiation between signaling and normal message trafficking other than the actual message contents . Signaling traffic is assigned priority 1 by the buffer management software. Regarding voice traffic, the proposed technique creates two priority classes for the management of voice traffic. New voice packets are assigned priority 4 P4 classification and sent to the buffer. Under conditions of light or normal system loading, these packets will be sequentially read from the buffer without further delay. This mode of operation provides normal voice communications. A departure time of each message from a channel is logged overwriting the previous entry for a given origination ID in the output time map Fig. 5 . Prior to the message s departure and logging, a check is made by reference to the output time map to see if sufficient time has lapsed since the message from the same originating ID last departed the queue. The purpose of this check is to ensure that, under conditions of heavy systems loading, some of the naturally occurring inter message delay remains, as stacked messages from a given ID are read from the queue. If needed, a short delay is inserted before the message is allowed to exit the buffer. Such messages are assigned a release time and their priority is changed from class 4 to class 3. These messages then remain in the buffer pending the arrival of the release time. A delay will not be included when the messages under consideration are initially generated without significant interspersed gaps. Voice traffic is dropped from the buffer if it lingers past a predetermined allowable maximum total delay. The present invention provides several advantages which are not present in the prior art, for example, the invention increases channel efficiency for small user groups. The present invention preserves a component of the naturally occurring interspersed silences between active speech segments. The present invention maintains voice band data integrity by inclusion of a separate priority class in the buffer. The present invention allows the integration of digital data packets with voice band data and speech. While the invention has been particularly shown and described with reference to the preferred embodiments thereof, it will be understood by those skilled in the art that various changes in form and details may be made therein without departing from the scope of the invention.