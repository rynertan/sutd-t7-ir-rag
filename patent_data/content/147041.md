# ERROR PROTECTION APPARATUS

## Claims
Fehlerschutzeinrichtung zur Verwendung als Decoder für Reed Solomon Codes über ein Galois Feld GF 2

## Description
The invention relates to an error protection appartus for use as a decoder for Reed Solomon codes over a Galois field GF 2 K.Y. Liy, Architectur for VLSI design of Reed Solomon Encoders, IEEE Trans. on Computers, Vol. C31, No. 2, Feb. 82, p. 170 175 describes a Reed Solomon encoder that also comprises 2t shift registers with 2t attached Galois Field multiplexers and 2t attached OR gates. Reed Solomon error correcting apparatus have generally utilised a general purpose digital computer to control peripheral arithmetic units implementing Galois Field manipulation. For large error correction capability codes, such as a ten error correcting code, it is believed that an all hardware implementation of the necessary error correction algorithms would be too expensive. However, an all software implementation of the error correction algorithms would be too slow. According to the present invention the apparatus according to the preamble is characterized in that it comprises a set of 2t bottom multiplexers, each adapted to select between two ordered sets of m bit inputs and place the selected set on m ordered outputs, a first set of inputs being an A set, a second set of inputs being a B set, the outputs of the respectively ordered multiplexer connected to a second ordered set of inputs of the correspondingly ordered exclusive OR gate a first set of 2t Galois Field GF 2 a feedback multiplexer adapted to select between two ordered sets of m bit inputs and place the selected set on m ordered outputs, a first set of inputs being an A set, a second set of inputs being a B set, the outputs connected to the inputs of each of said second set of Galois Field GF 2 The invention also relates to such apparatus wherein said controller means includes means for adapting said apparatus to encode data comprising means for selecting the B input set of said top multiplexers, means for selecting the A input set of said bottom multiplexers, and means for selecting the B input set of said feedback multiplexers. By itself, S. Deohar et al., High Speed interleaved Reed Solomon error detection and correction system, Proceedings of SPIE The International Society for optical engineering, Arlington VA, USA, 8th 9th June 1989, Vol. 421, pp. 65 78, Bellingham, Washington, USA describes a combined all hardware syndrome processor and encoder. The feature of providing different modes within a Galois Field processor in therefore principally known. Further aspects of the invention are recited in dependent Claims. The invention is illustrated, merely by way of example, in the accompanying drawings, in which Figure 1 is a schematic diagram of a ten error correcting Reed Solomon error correcting apparatus according to the present invention, The mathematics employed in encoding and decoding has been described elsewhere, see especially Chapter 10 of Berlekamp, Error correction is essentially a three step process 1 encoding information, 2 decoding it, and 3 correcting any errors. Encoding information comprises forming a codeword C X of n symbols for transmission of data to, for example, an optical disk recorder for recording. The codeword C X comprises k information symbols I X and n k parity check symbols P X . Each symbol comprises m bits. The parity check symbols are derived by dividing the information symbols X The generator polynomial for a Reed Solomon ten error correcting code having n 2 The code word C X thus transmitted is a multiple of both the generator polynomial and each of its factors or roots. Thus, the division of the received word R X by the generator polynomial or each of its roots, if the received word contains no errors, results in some quotient and a remainder of zero. To check if a received word contains errors, one may divide the received word either by the generator polynomial or by all of its roots and then test whether the remainder or remainders are all zero. For error correction purposes, it is necessary to generate a number of syndromes equal to twice the number of errors being corrected. In the preferred embodiment, as ten errors are being corrected, twenty syndromes must be generated. The syndrome can be defined as the remainder after dividing the received word R X by a root X α X The error locations can be derived from the syndromes in the following manner first, the coefficients of an error location polynomial are calculated according to Berlekamp s Algorithm given on page 154 of his If the polynomial σ X is evaluated at α This search shortened by ignoring errors in the parity check symbols and not evaluating the polynomial at powers of α corresponding to the locations of the parity check symbols. Once the error locations X Having described the mathematical background for Reed Solomon error correction, the various elements of the error correction apparatus according to the present invention and shown in Figure 1 will now be described. The operation of the apparatus will be described later. The error correction apparatus indicated by reference numeral 10 is comprised of two major elements a controller 12 and an ECC array 14. The controller 12 is connected to a microprocessor not shown through a bus 16 for the bi directional transfer of data. It is also connected through a read write line 18 for controlling the direction of data on the bus 16 and a clear line 20. The controller 12 is connected to the ECC array 14 through an ECC input data path 22, an ECC output data path 24, a Chien search output data path 26, and a miscellaneous control signals 28. The bus 16, the ECC input data path 22, the ECC output data path 24 and the Chien search output data path 26 are all eight line connections for transmitting eight bits in parallel. The ECC array 14 is comprised of twenty registers 30 whose inputs are respectively connected to twenty exclusive OR gates 32. The two sets of inputs to the exclusive OR gates are respectively connected one set to the outputs of twenty top multiplexers 34 and another set to the outputs of twenty bottom multiplexers 36. The outputs of each of the registers 30 are inversely respectively connected to twenty Galois Field multipliers S₀ to S₁₉. The outputs of the respective multipliers S₀ to S₁₉ are provided as the A inputs to the inversely corresponding top multiplexers 34. Additionally, a highest order register 38 of the registers 30 has its outputs connected to a lead exclusive OR gate 40, whose outputs are connected as a feedback connection through a feedback multiplexer 42 B inputs to a Galois Field parallel multiplier array 44 of the multipliers G₀ to G₁₉. Additionally, the outputs of the registers 38 are provided directly as the A inputs of the feedback multiplexer 42. The outputs of the respective multipliers G₀ to G₁₉ of the parallel multiplier array 44 are provided as the A inputs to the correspondingly ordered bottom multiplexers 36, the outputs of which are, in turn, connected as one set of inputs to the correspondingly ordered exclusive OR gates 32. The ECC input data path 22 is connected first to the exclusive OR gate 40 second, in parallel to each of the B inputs of the bottom multiplexers 36 third, to the ECC output data path 24 via the A inputs of an output multiplexer 50 and fourth, as one set of inputs to an AND gate 46, the outputs of which are connected to the B inputs of a lowest order top multiplexer 48. The outputs of the registers 30, save for the register 38, are additionally respectively connected to the B inputs of the top multiplexers 34, save for the multiplexer 48. The outputs of the registers 30 connected to multipliers S₁ to S₁₀ are additionally respectively connected as one set of inputs to nine exclusive OR gates 52 in the following manner the outputs from the multiplier s₁₀ and the outputs from the multiplier S₉ are connected as inputs to a first exclusive OR gate 70 see Fig. 2 . The outputs of this exclusive OR gate are connected as a first input set to a next exclusive OR gate 72 the other inputs to this next exclusive OR gate 72 are from the multiplier S₈ the outputs of this next exclusive OR gate 72 are provided as a first input set to a subsequent exclusive OR gate 74 the other input set to this subsequent exclusive OR gate 74 being the outputs from the register S₇, and so on until an exclusive OR gate 64. The outputs of this last exclusive OR gate 64 are provided on the Chien search output data path 26 to the controller 12. All of the inputs and outputs of each register 30, multiplexer 34, 36, 42, 50, exclusive OR gate 32 and 52, multiplier S₀ to S₁₉, to G₀ to G₁₉ are eight bits wide each line corresponding to a power α In Table 2, the number to the left of the equal sign represents the number of the output, while the numbers to the right of the equal sign represents the numbers of the inputs. The plus sign represents addition modulo 2, which is equivalent to an exclusive OR gate. The mathematical meaning of Table 2 can best be illustrated by example. Multiplication of two elements of GF 2 Each of the α¹ is an 8 tuple, as is the product Y α α¹⁹⁰, which can be represented by Z α , From inspection, it can be seen then these last equations for Z It can be seen from Table 2 that the multipliers S₀ to S₁₉ multiply the inputs by the fixed constants α⁰ to α¹⁹, respectively, while the multipliers G₀ to G₁₉ multiply the input by the corresponding coefficients of the generator polynominal G X i.e. α¹⁹⁰, α¹⁸⁸ ... α¹⁷. Each of the inputs to the multipliers S₀ to S₁₉ are provided by the associated registers 30. In contrast, each of the inputs to multipliers G₀ to G₁₉ are provided from a single source, the multiplexer 42. This results in the same symbol being multiplied by twenty constants, G₀ to G₁₉, in parallel. The actual implementation of the above multiplier logic attempts to simplify the circuitry and reduce redundancy by sharing repeated logic patterns. For example, in the multiplier S₂, the pattern 6 7 is repeated in equations 3 and 4 . Only one 6 7 circuit need be implemented and its output provided as inputs to both the 3 and the 4 circuits. As can be appreciated, the logic associated with multipliers G₀ to G₁₉ may be greatly simplified by making terms appearing in many different multipliers common to all. The actual choice of circuitry implementing the logic equations is deemed to be within the skill of the art. In addition to the above, the following control lines are connected between the controller 12 and the ECC array 14 an initialise line 56 is connected between the controller 12 and the clear input of each of the registers 30. Activation of the initialised line clears each of the registers 30. A master clock line 58 is similarly connected between the controller 12 and each of the registers 30. Ten σ enable clock signals 60 are connected respectively to ten of the registers 30, beginning with a register 62 connected to the multiplier S1 as shown in Figure 1. A multiplexer select line 1 is connected to a select input of the top multiplexer 34. A multiplexer select line 2 is connected to a select input of the bottom multiplexer 36. An enable detection line is connected to the AND gate 46 and the select input of the feedback multiplexer 42. A read parity syndrome select line is connected to the enable input of the feedback multiplexer 42 and the select input of the output multiplexer 50. When off the B input of the output multiplexer 50 is selected and the feedback multiplexer 42 is disabled. When disabled, the feedback multiplexer 42 outputs all zeros. Having briefly described the error correction apparatus, its operation for encoding will now be described. The transmitted code word can be broken down into two parts the first part, the k information symbols and the second part, the 2t parity check symbols, each symbol being eight bits in length. The maximum number of symbols in a code word is 255 2 r X being the remainder resulting from the division of X The error correcting apparatus divides X The error correcting apparatus 10 encodes the information symbols as follows the output multiplexer 50 is initially set to output, on the ECC output data path 24, the ECC input data. The top multiplexers 34 are set to pass through the B inputs. The bottom multiplexers 36 are set to pass through the A inputs. The feedback multiplexer 42 is set to pass through the B inputs. The AND gate 46 is disabled. When so conditioned, the ECC array 14 operates as the equivalent circuit shown in Figure 3. The information symbols are transmitted, one by one, highest order first, along the ECC input data path 22. Each information symbol proceeds through the ECC input data path 22 to the lead exclusive OR gate 40, and then through the feedback multiplexer 42 into the multiplier array 44, where the symbol is multiplied by the twenty multipliers G₀ to G₁₉, which are the coefficients of the generator polynomial G X . The multiplied outputs are immediately available on the line 54 and pass through the bottom multiplexers 36 to one set of inputs to the exlusive OR gates 32. For each information symbol, the master clock is clocked once thereby causing the registers 30 to copy the information present at the exclusive OR gates 32. The copied information is then available on the outputs of the registers 30. The outputs, as aforementioned, are multiplexed through the top multiplexers 34 B inputs to a second set of inputs to the exclusive OR gates 32. When a second information symbol is available on the ECC input data path 22, the results of the first symbol multiplied by the multipliers G₀ to G₁₉ are exclusive ORed with the results of the second symbol multiplied at the exclusive OR gates 32. When the second master clock appears, the register 30 copy the results of this exclusive OR gate. This process continues until all information symbols have been clocked through the multiplier array 44. As is known to the art, the above sequence of operations divides the information symbols, multiplied by X When so connected, the ECC array 44 functions as the equivalent circuit shown in Figure 4. When the B inputs of the output multiplexer 50 are first selected, the first parity symbol from the register 38 is available. When the master clock clocks the registers, the symbols from preceding registers are copied into the next registers, and the second parity symbol is now available on the output of the register 38. The master clock is pulsed 19 more times or a total of 20 times to clock out each parity symbol to the ECC output data path. After all parity symbols have been clocked out, the code word C X is complete. It should he noted that the information symbols I X are provided highest order first. Assuming there are k information symbols, I₀ I₁X I The remainder r X is also provided to the ECC output data path 26 highest order first. Thus It will be appreciated that feeding I X from the right end, after the highest order the register 38, is equivalent to dividing X From the process of encoding it is known that the code word C X is a multiple of the generator polynomial G X or The division of the code word C X by the generator polynomial G X results in a remainder r X having a value of zero if the code word is received without error. Thus, for error detection, the error correcting apparatus is conditioned to divide the code word C X by the generator polynomial G X and test the remainder r X for a zero result by shifting the contents of the registers 30 out to the microprocessor which can perform the text for zero. In operation, the error correcting apparatus is conditioned in a slightly altered fashion to perform the division and testing. The controller 12 enables the AND gate 46 by activation of the enable detection line from the controller 12. The controller selects the A inputs of the bottom multiplexers 36, the B inputs of the top multiplexers 34, and the A input of the feedback multiplexer 42. When so configured, the ECC array 44 appears as in Figure 5. The code word is provided, symbol by symbol, highest order first at the ECC data input path 22. The symbols are clocked through the registers 30, lowest order register to highest order register, and then fed back through the feedback multiplexer 42 into the multiplier array 44, where the highest order symbol is multiplied by the multipliers G₀ to G₁₉, the coefficients of the generator polynomial. The process continues until each code word symbol has been clocked into a lowest order register 39, at which time the remainder from the division will be present in the registers 30. Thereafter, the B inputs of the multiplexer 50 are selected to connect the register 38 to the ECC output data path 26. The feedback multiplexer is disabled and 0 s are provided for symbols to the exclusive OR gates 32. The circuit is now equivalent to the circuit of Figure 3. The registers 30 are clocked 20 times providing the remainder to the microprocessor for testing for a zero value. If any of the remainder symbols are non zero, then an error has occurred in the wode word C X . Assume that the code word C X was transmitted and that word R X C X E X is the word received where E X is an error word. That is From the above we know that the code word C α The 2t syndromes for the preferred embodiment are S The syndrome components S The division can be performed as shown in Figure 6 where the received word R X is provided, symbol by symbol, as one set of inputs to one Of the exclusive OR gate 32, which exclusive OR is bit by bit the correspondingly ordered bits of its two input sets. The output of the exclusive OR gate is stored, bit by bit, into one of the registers 30. The output of the register 30 is provided, bit by bit, to a multiply by α After each of the symbols of the received code word R X have been clocked through the multiplier circuit 62. A residue or remainder comprising the syndrome S Referring to Figure 1, the control circuit conditions the ECC array to calculate the syndromes S After the syndromes have been computed, the syndromes are present in the registers 30. The controller 12 then selects the B input of the top multiplexers the 34 A inputs of the lower multiplexers 36 and disables the feedback multiplexer 42 to supply zero symbol data to the exclusive OR gates 32 and clocks the ECC array 14 twenty times thereby reading out of the array along ECC output data path 24 all twenty syndromes. After the microprocessor has received the syndromes S A circuit as shown in Figure 2 performs the Chien search function. The circuit is comprised of ten registers 30, ten multipliers S₁, S₂, S₃ ... S₁₀, which multiply the contents of the registers 30 by the corresponding power of α and provide feedback into the registers 30, and nine modulo 2 addition gates 52 serially connected to one another and also connected to the outputs of the registers 30. An additional input to register 30 comprises the coefficients of the error locator polynomial σ₁, σ₂ ... σ₁₀. These are initally loaded into the registers 30. Thereafter the registers are clocked once to form in the registers 30 the values σ₁₀α¹⁰, σ₉α⁹, σ₈α⁸ ... σ₁α¹. The modulo 2 addition of these registers by the exclusive OR gates 52 forms at a Chien search output at the exclusive OR gate 64 the evaluation of the error locator polynomial at α i.e., σ α 1. The outputs are evaluated by the controller 12. If the results of this evaluation are identical to 1, i.e., the eight bit symbol at the Chien search output has only its least significant bit with non zero value, then an error location has been found. The location of the error is α ¹. The location of α ¹ corresponds to the X²⁵⁴ location in the received word R X because α ¹ α²⁵⁵ ¹ α²⁵⁴, the code being multiplicative cyclic. When the controller identifies a Chien search output symbol having a value of 1, it signals this fact to the microprocessor. The actual location of the error is established by a counter in the microprocessor. To evaluate the error locator polynomial at α² the registers 30 are clocked one more time thereby again multiplying the contents registers 30 by the powers of α Referring to Figure 1 the controller 12 conditions the ECC array 14 to perform the Chien search function by initially loading the coefficients of the error locator polynomials σ X into the registers 30 corresponding to multipliers S₁ to S₁₀ as follows the registers 30 are first initialised to zero and the B inputs of the bottom multiplexers are selected thereby connecting the ECC input data path 22 to the exclusive OR gates 32. As the contents of the registers 30 are zero, the exclusive OR gates 32 will pass the information on the ECC input data path 22 unchanged into the registers 30 if the information is loaded into the registers from right to left in the figure. Thus the coefficients of the error polynomial σ X are presented with the lowest order coefficient σ₁ first and the highest order coefficient σ₁₀ last. When σ₁ is transmitted to the ECC array 14 by the microprocessor, the controller 12 enables and clocks the register 62 via the σ₁ enable clock signals 60. A similar procedure is performed for σ₂ to σ₁₀ individually clocking into the registers 30 the respective coefficients of the error locator polynomial. Once the coefficients have been loaded, the controller 12 presents symbols of zero value on the ECC input data path 22 thereby effectively changing the exclusive OR gates 32 into OR gates which pass the information presented by the upper multiplexers unchanged into the registers 30. The controller selects the A inputs of the upper multiplexers 34 to connect the multipliers S₁ to S₁₀ into exclusive OR gates 32. The registers 30 are then clocked once to evaluate the error locator polynomial at α¹. The outputs of the multipliers S₁ to S₁₀ are fed into the exclusive OR gates 52 connected as shown in Figure 2 so that the modulo 2 sum of the registers appears at the Chien search output. This output is provided as a feedback to the controller 12 which, in turn, provides it as feedback to the microprocessor. Whenever the Chien search output is identical to one, as discussed above, an error location has been found. The controller clocks the registers 2 After the error locations have been found the values of the error at the locations can be found by solving the error value formula for the Y The error correcting apparatus of the present invention can also perform burst error trapping. Reed Solomon codes are cyclic and therefore may be used for trapping single burst errors to a maximum length of t, where t is the error correction capability of the code, provided the errors are confined to contiguous symbols within a code word. To trap a burst error the controller 12 selects the B inputs of the upper multiplexers 34, the A input of the bottom multiplexers 36 and the B input of the multiplexer 42. The arrangement is set to divide the received word X