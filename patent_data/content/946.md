# Apparatus for controlling the movement of the data head in a moving head data recording system.

## Abstract
Two servoing functions, both operating from the data reading and recording transducer, are performed in a high performance movinghead disc drive. One servo rapidly moves the head from its current track to any other track utilizing absolute track identifying addresses recorded in the inter sector gap between data sectors. Once located on a track, the other servo maintains head location precisely over the center of that track while data is being read or recorded employing track following information also recorded in the inter sector gap. The resolution of transducer location is enhanced by secondary use of the track following information.

## Claims
C L A I M S 1. Apparatus for controlling the movement of the data head in a moving head data recording system, characterized by signal conditioner 41 for receiving electronic signals repre senting data from the data head 46 a b , said data including informational data recorded along tracks on a recording medium, and track following data and track addresses recorded at regular intervals in the informational data along the tracks track following means 42 coupled to the signal conditioner 41 for guiding the data head 46 a b along a track of recorded data in response to electronic signals representing track following data received from the signal conditioner 41 and track locating means 43, 44, 45 coupled to the signal conditioner 41 and track following means 42 for moving the data head from one data track to another in response to the electronic signals representing track addresses and track following data received from the signal conditioner 41 . 2. Apparatus as in claim 1, characterized in that the track following means 42 includes means for producing additional track locating data from the electronic signals representing track following data received from the signal conditioner 41 . 3. Apparatus as in claims 1 or 2, characterized in that the infor mational data is recorded in sectors on magnetic recording medium, and the track following data and track addresses are recorded in the inter sector gap between informational data sectors. 4. Apparatus as in any of claimsl through 3, characterized in that the track addresses are recorded in a unit distance code format. 5. Apparatus as in any of claims 1 through 4, characterized in that the track following data for each track comprises two magnetic transitions serially disposed along the data track each extending from approximately the midpoint of the track to approximately the midpoint of the distance between tracks. 6. Apparatus as in claim 4 or 5, characterized in that the unit distance code format is a Gray code.

## Description
In a typical prior art moving head disc drive, the data reading and recording transducer, hereinafter referred to as the data head or head, is moved from one track to another under servo control to ensure that the data head will stop directly over the target track e.g. US patent 35 34 344 . Given practical acceleration limitations, the data head carrier or actuator is typically accelerated at the maximum level possible until half the total distance has been traveled, then decelerated until it is stopped over the target track. An open loop head position system is impractical because electrical and mechanical perturbations will result in over shoot and under shoot of the target track.The acceleration, velocity and position profiles of such a conventional system are shown in Figure 1. Combining the velocity and position curves, it is clear that the velocity at any instant in time is proportional to the square root of the distance yet to be traveled. Such proportionality is the principle of many conventional track locating servos such as the one shown in Figure 2.Such servos typically include one register for containing the target track information and another for containing current track location, the latter being updated as the head moves. Update information is obtained by counting track crossings from a glass encoder or dedicated, continuous servo surface. The informational difference between these two registers represents the distance yet to be traveled and is converted to an analog voltage which is proportional to the distance to the target track. The desired velocity of the carrier is obtained by taking the square root of the analog voltage which is then compared to the actual velocity to derive a current proportional to the difference between the two velocities for driving the motor.For the conventional track locating system diagrammed in Figure 2, the position transducer is a pulse generator which produces a pulse to increment or decrement the up down counter or current track register whenever a track center is crossed. Track centers are obtained by detecting lines on a glass encoder attached to the structure for moving the head, or by detecting specially written tracks on a dedicated surface of the disc pack which is read by a separate servo head. However, such systems require a dedicated servo surface or position transducers other than the data head itself. Moreover, such systems define the relative position of the servo head to servo track, not of the data head to data track. Other prior art systems use encoders on the head carriage.In addition to expense, however, encoder systems define the relative position of the casting to head carriage, not of the data head to data track.The system shown in U.S. Patent 3 924 268 is typical of more recent prior art moving head disc track locating systems. It describes a system, having track following information recorded in the intersector gap between data sectors and read by the data head, which is dependent on sensing the velocity of the transducer carriages while moving to another track. In this case there is a primary and a low mass secondary carriage for supporting and translating the data head. The position of transducer carriages is determined with respect to a reference plane by servo circuitry which includes a register for storing a commanded track position, a counter which is incremented or decremented relative to the reference plane as the transducer moves across data tracks and a comparator for comparing the contents of the counter and register.The low mass secondary carriage to which the head is actually coupled, is used for fast response movement to follow, for example, the radial runout of the track, such movement typically being limited to a single track width.Conventional track following systems, such as the one shown inFigure 3, employ rate and position feedback in a continuous null seeking analog servo system. The rate information is obtained from a velocity transducer, and the position information from one of several possible transducers. Position transducers may consist of an optical or magnetic encoder attached to the same moving structure as the head, or a separate head which reads magnetic transitions on the surface of the disc pack dedicated to servo information servo surface . A continuous, linear voltage versus distance signal with zero volts at track center is derived from the encoder or separate head output.In most prior art track following systems, the object is to center a data head over a data track based on reference information derived from servo data written on another servo surface. Thus, these systems depend on the stability, fidelity and integrity of the mechanical linkages between the reference and data tracks for assuring that the data head are over data track centers. Such mechanical linkages are inadequate at best owing to misalignments, uncompensated temperature coefficients and spindle runout.A track locating servo constructed according to the present invention servos on the position profile of Figure 1 rather than on the velocity profile. Hence, the need for an expensive velocity transducer is eliminated. Data relating to the current track, the target, and maximum actuator acceleration and deceleration levels, is provided to a microprocessor which mathematically generates a characteristic curve of position versus time.The desired position is compared to the actual position. The error signal representing the difference between the actual and desired position is processed by digital signal processing circuitry which determines the linear actuator motor current, since no direct velocity feedback is used.No encoder or dedicated servo head and surface is required in the present invention since position information for track locating is provided by the data head reading track identifying addresses recorded on the data surface. Track identification data, in the form ot coded track addresses, are pre recorded on the surfaces of the disc in the gap between the sectors of data on each track inter sector gap hereafter . The track addresses are sampled and stored and are updated as each inter sector gap is read by the data head.For track following, again no remote reference exists since magnetic transitions detected by the data head, to produce a tracking signal, also have been written on the data surface. These transitions are written in the inter sector gaps but separate from track addresses.The tracking signal is updated by reading the magnetic transitions at each inter sector gap. Again, the velocity transducer has been eliminated and, for this mode, replaced by analog lead networks to compensate the servo loop. In addition, the resolution of data head position is enhanced by wadding data, derived from the tracking signal produced by the track following servo, for determining which side of and the distance from a track s center the data head is located to the coded track address data produced by the track locating servo.The microprocessor used in the present invention is located in the disc controller, and otherwise would be idle while the drive is in track locating mode. Since the present invention has no dedicated servo surface, data storage capacity is maximized. The present system also has no velocity transducers or decoders, thus reducing manufacturing cost. Figure 1 shows the acceleration, velocity and position profiles for conventional disc drive head positioning systems.Figure 2 is a block diagram of a typical track locating servo used in a conventional disc drive head positioning system.Figure 3 is a block diagram of a typical track following servo used in a conventional disc drive head positioning system. Finlssre 4 is an overall block diagram of a moving head disc drive head positioning system constructed according to the preferred embodiment of the present invention. Figure 5 is a block diagram of the signal conditioner used in the head positioning system of Figure 4.Figure 6 is a block diagram of the track following data decoder used in the head positioning system of Figure 4.Figure 7 is a diagram of the track following and track address data as recorded in the inter sector gap of a disc used in the head positioning system of Figure 4.Figure 8 is a block diagram of the track address decoder used in the head positioning system of Figure 4.Figure 9 is a block diagram of the actuator drive amplifier used in the head positioning system of Figure 4Figure 10 is a diagram of the tracking signal showing the points thereon corresponding to track centers, and showing points thereon at which the recorded track addresses change code.Figure 11 is a diagram of the tracking signal of Figure 10 showing points thereon at which the extended precision information changes.Figures 12A 12C are flow charts of the algorithms used by the micro processor of the positioning system of Figure 4 to compute the position profile according to the present invention.Figure 13A is a characteristic curve of position versus time showing settling time over target track in the positioning system of Figure 4 uncorrected for steady state track locating error.Figure 13B is a characteristic curve of position versus time showing settling time over target track in the positioning system of Figure 4 corrected for steady state track locating error.Referring to Figures 4 and 5, the disc drive servos of the present invention comprise microprocessor 40, signal conditioner 41, track following data decoder 42, track address decoder 43, actuator drive amplifier 44,and data heads 46a and 46b carried by linear actuator 45.Magnetic transitions, recorded in the inter sector gap as shown, for example at 71, in Figure 7, are detected by data head 46a and 46b as the inter sector gap passes beneath them. The differential signals produced by the data heads are amplified by preamps 411a and 411b and one of the signals, as selected by head selector switch 412 in response to a head select command from microprocessor 50, is transmitted to track following data decoder 42 via buffer 413 and filter 414.In Figure 6, track following data decoder 42 comprises voltagecontrolled gain amplifier 421 for receiving the differential head signal from signal conditioner 41, signal converter 422 for converting input signal from a differential signal to a single ended signal, that single ended signal hereinafter referred to as the head signal, and pulse detector 423 for initiating time base 424 in cooperation with GAP command from microprocessor 40. The GAP command is timed to activate time base 424 circuitry to process the head signal at and during the time the inter sector gap passes beneath the data head. Synchronization sync pulse detector 423 detects a first sync pulse derived from magnetic transition 74 on the head signal.Peak detectors 425 and 426, the input to which being controlled by time base 424 via switches S1 and S2, respectively, transmits the head signal to summing and difference networks 427 and 429 in response to control signals from time base 424.Summing network 427 in turn controls the gain of amplifier 421 viaAGC automatic gain control 428 and difference network 429 transmits a signal, hereinafter referred to as the tracking signal, to track address decoder 43 and actuator drive amplifier 44.Referring now to Figures 7 and 8, coded track identifying data are recorded in the form of magnetic transitions or lack thereof at regularly spaced intervals, designated W1 Wn and referred to hereafter as address intervals 73 in the inter sector gap. Window time base 433 generates bit windows synchronously timed with disc rotation speed to correspond to detection of address intervals 73 by one of the data heads, 46a or 46b, in response to a second sync pulse derived from magnetic transition 72. Transition 72, also recorded in the inter sector gap, is located just ahead in sequence, of the coded track identifying data. Window time base 433 automatically terminates bit window generation at the end of bit window W. n The presence of a magnetic transition recorded in an address interval W1 Wn causes a pulse to be transmitted on the head signal. That pulse is interpreted by multiplexer 434 at a one in the corresponding bit window generated by window time base 433.The absence of a magnetic transition in an address interval is conversely interpreted as a zero . The cumulative result of bit window data is a coded track address.If the data head is moving to another track and crosses more than one track as the inter sector gap passes beneath it, the data head will sense all ones common to all track addresses sensed. The decoded track address, however, can be resolved to 1 2 track maximum simply by using the address coding scheme described later in this specification and by suitably limiting the length of the track address code. Thus, track addresses should be limited in length so that the head travels over parts of no more than two such addresses at maximum translation velocity of the head and rotation speed of the disc.According to Figure 8, track address decoder 43 comprises pulse detector 431, flip flop 432, multiplexer 434, window time base 433 and analog to digital A D converter 435. Pulse detector 431 actuates window time base 433 upon detection of the second sync pulse representing magnetic transition 72. Flip flop 432 is set by pulses representing magnetic transitions in intervals W1 Wn. Flip flop 432 is reset by window time base 433 at the end of each data window. If no pulse appears in a data window, flip flop 432 remains reset. Thus, the output of flip flop 432 is coded address data, hereinafter referred to as the track address, uniquely identifying earh fi erk, nd derived from the head signal for the time period during which the intersector gap passes beneath the data head.Flip flop 434 ignores the third sync pulse and pulse detector 431 is insensitive to interval pulses.Multiplexer 434 combines the track address data from flip flop 432 with two additional bits of data from A D converter 435 in accordance with the timing of bit windows received from window time base 433 to produce an extended precision track address as explained later in this specification with respect to Table I. A D converter 435 produces the additional data from the tracking signal as also described in connection with Table I later in this specification.Among the features of the present invention is the method used to determine data head location while it is moving to another track.Track addresses are written in the inter sector gap as shown inFigure 7 at 70 for tracks 0 7, together with track following magnetic transitions shown at 71 which are used by the track following servo described elsewhere in this specification. As the inter sector gap passes beneath the data head, it detects at least one track address for processing into position information by microprocessor 40. Since a track address is available only at inter sector gaps, track following data decoder 42 produces tracking signal 100 as shown in Figure 10, which is similar to a position signal produced by sampling the output signal of a servo head detecting transitions on a dedicated servo disc surface. In Figure 10 V in the tracking signal resulting from the data head being at position X at the time an inter sector gap passes under the head. N is the approximate distance over which unit distance code address N in read by the data head. VMAX is the maximum tracking signal amplitude produced when the data head is exactly between two data tracks.Referring also to Figure 7, each magnetic transition at 71 is centered between tracks such that slightly less than one half of two serially disposed transitions for each track is on a track. The other half of the two transitions are disposed approximately equally to each side of each track. Thus, if the data head is exactly at center track, the tracking signal amplitude is zero if the data head is off track center, the tracking signal amplitude increases toward VMAX as the center of a magnetic transition is approached. At VMAX the data head is exactly between tracks.At high head velocities and track densities, as many as 10 tracks may be crossed between samples taken at each gap in the present invention. A track address according to the present invention, therefore, is written in absolute form and formatted to minimize decoding errors if the data head is instantaneously positioned between tracks when the inter sector gap passes beneath it.Decoding errors are limited to 1 2 track in the present invention by writing the track addresses in a unit distance code. Track locating resolution is improved to at least 1 8 track by addition of two bits of track locating data generated from processing of track following data as explained later in this specification. Track addresses in the preferred embodiment of the present invention are written in a unit distance code known as the Gray code. The Gray code is described in detail in U.S. Patent 2 632 058 which is incorporated by reference as if set forth fully herein. In a unit distance code, consecutive binary numbers differ by only one bit of digital data.Therefore, the addresses of neighboring tracks differ by only one data bit. Hence, if the head is between two adjacent tracks and reads a part of the address of both, the ambiguity is limited to 1 2 track.In the unit distance code addressing scheme of the present invention, the address of the track over which the data head is located is read as the inter sector gap passes under the head. Again, this address could be as much as 1 2 track in error, simply because the same address is produced even if the head is up to 1 2 track to either side of the track center. However, in this invention, the resolution of data head position is improved by using the tracking signal produced by track following data decoder 42 to determine which side of and the distance from track center the data head is located. The tracking signal is processed by A D converter 435 to provide bits A and B which are added to the track address produced by the track locating servo. A single, unit distance code having greater precision is thus produced.Referring to Figure 11, the A D converter 435 outputs two bits according to the following criteria Bit A is high if the track following position signal is negative.Bit A is low if the track following position signal is positive.Bit B is high if the magnitude of the track following position signal V is less than 1 2 VMAx. Bit B is low if the magnitude of the track following position signal V is greater than 1 2 VMAx. Table I summarizes the resulting sequence of increased precision bits of track locating data code as the radial position of the data head is increased. It should be noted that the points at VMAx on the waveform represent the midpoint between tracks, but also the points at which the track address code changes. Final Bits of Track Address Unit DistanceIncreasing X A B CodeTrack Center 1 1 00 1 0 00 1 0 01 1 1 owl Track 1 Center 0 1 Ol 0 0 01 0 0 11 0 1 11Track 2 Center 1 1 11 1 0 11 1 0 10 1 1 10Track 3 Center 0 1 10 0 0 10 Table I XThe sequence is itself a unit distance code. Thus, the precision of the track locating servo system has been increased to at least 1 8 track.Referring now to Figure 9, actuator drive amplifier 44 comprises odd even track inverter 441, servo compensation network 442, digital to analog D A converter 443, mode selector 444 and output amplifier 445. Linear actuator 45 is driven by output amplifier 445 which is powered by the tracking signal or a track locating power signal as determined by mode selector 444 in response to appropriate command from microprocessor 40. Compensated error signals, representing the difference between actual head position and the computed position profile for a given target track, are derived by microprocessor 40 in the form of digital control words in accordance with the algorithm shown in Figures 12A 12C, utilizing track addresses detected by the data head as it moves in the track locating mode.Digital to analog D A converter 443 then converts the control words into track locating power signals for driving actuator 45. The computed position profile then converges on the target track.Referring also to Figure 11, track g center is identified at A on the signal waveform. Similarly, track 1 center is identified atB, track 2 center is at C, and so on. While each track center is at zero, the slope of the signal is of opposite polarity for adjacent tracks, such as tracks and 1, and the slope is the same for every other track, such as tracks 0 and 2. Thus, if the head were slightly off center to the left on track , the polarity of the signal required to move it back to center track might be, for example, positive, hut negative for the same error on track 1. Therefore, odd even track inverter 441 arbitrarily inverts the tracking signal for every other track so that the head moves in the same direction relative to track center for every track in response to the tracking signal.Servo compensation network 442 comprises lead and lag networks well known to those skilled in system technology to provide loop stability, noise reduction and resistance to steady state forces on the actuator. These, as well as other specific circuits which perform the functions described in Figures 4 6, 8 and 9 are well known to those skilled in the art. Since such circuits form no part of the present invention, hey are net detailed in this specification.The track following and track locating servos of the present invention rely on a sampled servo signal rather than a continuous servo signal. For that reason the band width and the servo loop gain are less than the bandwidth and the servo loop gain of a convent,onal track locating system. Thus, the track locating servo o the present invention inherently includes a steady state error cit several tracks, where conventional systems have steady state errors of only a fraction of a track. To compensate for this large error and reduce settling time of the actuator at the target track, microprocessor 40 actually computes a positive profile for several tracks short of the target track.The profile generated then jumps when the true target is finally approached as shown in Figure 13B. The steady state error is controlled, primarily by compensation network 442.This method of reducing settling time requires that short track locating seeks be considered as special cases i.e., seeks shorter than the steady state error. Thus,for short seeks in the present invention, the position profile is essentially set equal to the target tracks for the entire duration of the seek.Single track seeks must be as fast as possible to facilitate repaid transfer of large segments of data. Therefore, a one track seek is performed entirely open loop whereby the arm is accelerated, then decelerated, for the required amounts of time to step over one track. The track following servo is then initiated immediately.A complete listing of the routines and subroutines of instructions, including all constants, employed by the head positioning system of the present invention is given below. Tabel of ContentsPage 15 Logical Seek Routine Introduction 16 Logical Seek Routine Definition of Constants 17 Logical Seek Routine Current Track Determination 18 Logical Seek Routine Target Track Bounds Check 19 Logical Seek Routine Target Track Offsetting 20 Logical Seek Routine Head Sector Bounds Check 21 Logical Seek Routine Physical Seek Invocation 22 Logical Seek Routine Exit Code Delay Routine 23 Logical Seek Routine Drive Recovery Routine 24 Logical Seek Routine External Links LOBICAL SECK ROUTINE INTROOUCTION 2 LSFEKO4 3 9 77.1050 00002000 3 00003000 4 LOBICAL SEEK ROUTINE 00004000 5 THIS ROUTINE PERFORMS AN INTERFACE BETWEEM THE EEX COMMAND 00005000 6 PROCTSSOR AND THE PHYSICAL SEFK KOUTINE.IT ACCEPTS A LOEICAL 00006000 7 TAGGET TRACK AOORESS, PFHFORMS HOUNDS CHECKING, SETS UP THE NEM 00007000 8 ICW VALUE, CUMPUTES THE PHYSICAL TARGFL ANNRESS, AND INVOKES THE 00008000 9 PHYSICAL SEEK MOUTINE. IT TMFN SFIS UP INE TEHMINATION STATUS 00009000 10 AND KETURMS. 00010000 11 00011000 12 AT EMTKY TARG CONTAINS THE TARBET TRACK NOMBER LOBICAL 00012000 13 CTRK MAS THE CURRENT TRACK PHYSICAL 4 IF ON TRACK 00013000 14 THSEC CONTAINS THE TARBET MTAD SECTOR ADDRESS 00014000 15 AT EXIT FINE SERVO CONTROL IS RESTOMEO 00015000 16 REGISTEM 2 CONTAINS SFEK TERMINATION STATUS 00016000 17 0 FOR SURRESSFUL COMPLFLION 00017000 18 1 FOR RONMDS VIOL ATION LCYLINDER OR MEAD SECTOR 00018000 19 1 FOR DMSUCCESSFOR SEEK ATTEMPT ISEEK FAILURE 00019000 20 RE ISTEM 1 CONTAINS WESULT STATUS OF REOLSTER 2 00020000 21 ALL OTHER REGISTFRS ARE VOLATILE 00021000 22 CIC IS UNCMANGED FOR A SOUMDS VIOLATTON, OTHERWISE IT 00022000 23 MAS THE FINE SENVO TCW VALUE AT THE TARGET TRACK. 00023000 24 CTRK IS UNCMANGED FOR A DOUNOS VIOLATION, OTHERMISE IT 00024000 25 MAS THE VALUE OF THE PHYSICAL TARGET TRAQCK 4. 00025000 26 00026000 27 00027000 28 00028000 29 00029000 31 FBOG ONG IS FRun 00031000 LOGICAL SEEK RUUTINE DEFINTION OF CONSTANTS 33 00033000 34 00034000 35 THE FOLLOWING VALUES ARE VAMIABLES STORED IN THE RAM. 00035000 36 THE FIRST VARIABLE TARB IS THE VALUE OF THE LOGICAL TARBET 00036000 37 INOCK NUMBER. THIS VARTABLE TS SFT UP HY THE SEEK COMMAND 00037000 38 INTERPHETER BEFORT THIS ROUTINE IS CALLED SEE ABOVE .THE 00038000 39 SEEB ROUTINE DOES NOT CMANBE THIS VALOE. 00039000 40 THE SECVND VARIABLE FCNT IS A TIMEOUT INDEX TMAT IS 00040000 41 DECREMENTEO EVERY SAMPLE TIME AND GOES TO ZERO IF THE SEEK 00041000 42 DOES NUT COMPLETE ITRIN 200 MILLISFCONDS 320 SAMPLE TINES . 00042000 43 IF UECREMEMTEO TO ZERO, THE SEEK ABORTS AND RETYRNS AN ERROR 00043000 44 STATUS. 00044000 45 THE THIRD VARIADLE CTNK COMTATMS THE PHVSICAL ADDRESS OF THE 00045000 46 CURRENT TRACK TIMES A . THIS VALUE IS ASSUMEO TO MAVE BEEN SET 00046000 47 BY THE PREVIOUS SEEK ANN IS SET HY THTS ROUTINE FOR THE FOLLOWING 00047000 48 SEEK.IF THE OFF TRACK FLAB TS SET THEM ALL BETS ANE OFF AND THE 00048000 49 CWRRENT TRACK VALUE WILL BE OBTAIMEN BY TRACK SAMPLINB. 00049000 50 THE FOUKTH VARIABLE CICW IS THF CURRENT VALUE OF THE ICW AND 00050000 51 IS UPOATED BY THIS ROUTIME TO REFLFOT THE VALUE AT THE TARGET. 00051000 52 THE FIFIM VARIAULE THSEC IS THE MFAD AND SECTOR ADDRESS OF 00052000 53 THE SEEK TARGET.THE MIGH BYTE SPECTFIES THE HEAD SURFACE AND 00053000 54 THE LO BYIE SPECIFIES THE SECTOR. 00054000 55 00055000 56 00056000 58 0009 TARB IS 10069 TARCET TRACK 00058000 59 00 FCNT IS 10068 SEEK TIMFOUT COUNT 00059000 60 00 CTRR IS 10066 CURRENT TNACK SAVE LOCATION 00060000 61 00 4 CIC IS 10064 CURRENT TCW VALUE 00061000 62 00 TMSEC IS 10060 TARGET HEAP SECTOR VALUE 00062000 LOBICAL SEEK ROUTINE DEFINITION OF CONSTAMIS 64 00064000 65 00065000 66 THE FOLLOHIHG VALUES ARE CONSTANTS USED BY THF SEEK ROUTINE. 00066000 67 OFSET IS THE TRACK OFFSET BETWFFN PHYSICAL TRACK NUMBERS AND 00067000 68 LOGICAL TRACK NUMMERS. TMOUT IS TMF MAXIMUM NUMBER OF SAMPLE 00068000 69 TIMES ALLO EN FOR ANY SINGLE SEEK. MAATR IS THE MA IMUM LOSICAL 00069000 70 TARGE T TRACK VALUE. OUAN IS THE NUMBER OF TRACKS IM A OUAORANT. 00070000 71 MXSEC IS THE MAQXIMUM SFCTOR ADDHESS. 00071000 72 00072000 73 00073000 75 OOOF OFSET IS 15 PHYSICAQL TRACK OFFSFT IS IS THACKS 00075000 76 O140 TMOUT IS 320 SEEKS TIME OUT IN 320 SAMPLE TIMES 1200 MSECI 00076000 77 O2EC MAALR IS 748 THE MAXIMUM LOGICAL THACK NUMRER IS 748 00077000 78 OOBB OUAD IS 187 WUADMANTS AHF 187 TRACKS WINE 00078000 79 OO1F MASEC IS 31 THE MAXIMUM SECTOR ADORESS IS 31 00079000 LOGICAL SEEK ROUTINE CORRENT TRACK DETERMTNATION 81 POHG ONG 100 00081000 82 DOHG 00082000 84 00084000 85 00085000 86 THE FOLLNUINB COOE IMITIALIZES THE SFEK TIMEOUT INOEX FCNT 00086000 87 AND DEIERNINES THE CURRENT TRACK. THE FIRST INSTRUCTION TESTS 00087000 88 THE NOT READY FLAGH AND THE FOLLOMINB INSTRUCTION CALLS THE ORIVE 00088000 89 RECUVERY ROUTINE IF THE NOT REAUY FIAG IS SET. THIS ROUTINE WILL 00089000 90 BMING THE ANH TO THE OUTSTOE CRASH STOP AND CLEAR THE NOT READY 00090000 91 FLAG ILHE MOUTINE DOES NOT WAIT FOR THE DRIVE TO BECOME READY . 00091000 92 THE FOLLO INB TWO INSTRUCTIONS SET FCNT TO THE SEEK TIMEOUT VALUE 00092000 93 TROUT . TMIS VALUE DETERMINES HFN TOF SEEK WILL TIMEOUT ANO IS 00093000 94 RETAINEO IN R3 FOR SUBSEOUENT OSE. THE NEXT IMSTRUCTION LOAOS R6 00094000 95 WITH THE VOLUE OF CTRK.THE FOLLONING TWO INSTRUCTIONS TEST THE 00095000 96 OFF TRACK LAB ANU BRANCN TO LSOZ IF TIS CLEAR WHICH IMDICATES 00096000 97 TMAL CIRK IAND TMUS R61 SMOULD CONTAIN THE CORRECT CURRENT TRACK 00097000 98 VALUE IPHYSTCAL AL. 00098000 99 IF THE OFF TRACK FLAG IS SFT THN THE CURRENT TRACK VALUE IS 00099000 100 OHTAINEO BY READINB A TRACK SAMPLE WHICM IS PERFORMED BY THE NEXT 00100000 101 JNSTRUCTION. THE FOLLOWTNG TWO TNSTRUCTIONS SET R6 TO THIS VALUE 00101000 102 MOUMOED TO THE NEAREST TRACK 1 2.THF CODE THEN OROPS TO THE 00102000 103 FOLLOWINB BLOCK OF COOE MMICH PERFORMS A REOUNDANT CALL TO THE 00103000 104 TRACK SAMPLING ROUTINE TO CHECK FOR A POSSISLF SAMPLTNG ERROR. 00104000 105 00105000 106 00106000 108 F900 2ADC 8 LSEEK UTST R2 XR 13 TESI NOT MEAOY FLAB 00108000 109 F901 9543 9 CALL MECOV IF CAIL NECOVERY ROUTINE IF NOT READY 00109000 110 F902 803 6 LLIT R3 TMOUT R3 1 TIM OUT COUNT 00110000 F903 0140 111 F904 0003 12 STOK FCMT R3 INITIAT IZE TIMEOUT COUNT 00111000 F905 0068 112 F906 CO 12 LOAU HO CTHK R6 1 PHYSTCAL CURRENT TRACK VALUE 00112000 F907 0068 113 F908 2FEC 8 TSF HT AR 14 TEST OFF IRACK FLAG 00113000 114 F909 6217 8 GOTG 1502 IF BRANCH IF ON TRACK 00114000 115 F90A 9F5F 9 LSOI CALL 16AP.1 RE D THACK ADORESS 00115000 116 F90B IEE2 7 BSET 49 RE 14 ROUNO TO RACK . 1 2 00116000 117 F90C OEF 7 BCLK R6 15 00117000 LOGICAL SEEK ROUTINE CURKENT TRACK OETERMINATION 119 00119000 120 00120000 121 AT ENTRY INTO THE FOLLOWING CODF R6 CONTAINS A CURRENT TRACK 00121000 122 VALUE THAT HAS BEEN OBTAINED FROMA TRACK SAMPLING. THIS CODE 00122000 123 CHECKS THE TRACK VALUE FOR A POSSIBIE SAMPLING ERROR, THE FIRST 00123000 124 INSTRUCTION PERFORMS A REDUNDANT TRACK SAMPLING. THE FOLLOWING 00124000 125 INSTRUCTION SETS R2 WITH DIFFEHENCE BETWEEN THIS SAMPLE AND R6, 00125000 126 THE FOLLOWING TWO INSTRUCTIONS YIELD THF ABSOLUTE VALUE OF THIS 00126000 127 DIFFERENCE. tHE NEXT TWO INSTRUCTION STEST THIS VALUE AND BRANCH 00127000 128 TO L5O2 IF IT IS LESS THAN FOUR 1 TRACK .OTHERWISE THE NEXT 00128000 129 TWO INSTRUCTIONS TEST THF TIMEOUT INDEX AND BRANCH BACK TO LS01 00129000 130 IF ITS GREATER THAN TWO. IF THE TIMEOUT INDEX IS TWO OR LESS, A 00130000 131 TIMEOUT ERROR IS ASSUMED AND THE FOILOWING TWO INSTRUCTIONS SET 00131000 132 R2 TO ZERU INDICATING A SEEK FAILHRE AND BRANCH TO L504. 00132000 133 00133000 134 00134000 136 F900 9F5F 9 CALL IGAR.1 TEST WTTH REOUNOANT TRACK SAMPLINE 00136000 137 F90E 7 26 7 R2 R6 R2 00137000 138 F90F 8311 6 GOTU 2 IF 00138000 139 F910 8332 6 R2 R2 00139000 140 F911 AO4 6 R2 R2 4 00140000 141 F912 17 6 GOTU LS02 IF BRANCH IF 1 TRACK DIFFERENCE 00141000 142 F913 6802 6 R3 R3 2 TEST TIMEOUT 00142000 143 F914 810A 6 GOTU LSOL IF LOOP IF TIME OK 00143000 144 F915 E20B 6 R2 0 R2 INDICALES SEEK FAIL ORE 00144000 145 F916 8730 6 GOTU LS04 BRANCH TO FRROR CODE 00145000 LOGICAL SEEK ROUTINF TARGET TRACK ROUNDS CMECK 147 00147000 148 00148000 149 THE FOLLO INB CODE TESTS FOF A TRACK BOUNOS VIOLATIONS ON THE 00149000 150 IAR ET TRALK TRACK ANO CNMPUTES THE OUAORANT EITS FOR THE ICW. 00150000 151 THE FINST INSTRUCTION SFTS R2 10 TWO WNICM INDICATES A BOUNDS 00151000 152 VIOLATION. THE FOLLOWINE SIX IMSTRUCTIONS SFT RT TO THE LOGICAL 00152000 153 IARGET THACK VALUE AND HRANCH TO LSOS IF IT IS LESS TMAN ZERO OR 00153000 154 GREATEM THAN MAXTR MAXIMUM TRACK VALUT . THESE SIX INSTRUCTIONS 00154000 155 OHOP TMROUGH WITH R4 CONTAINING THE NEGATIVE VALUE TARSET MAXTR. 00155000 156 THE NEAT INSTRUCTION LOANS R3 WITH THE ICW VALUE FOR MOP, RUN, 00156000 157 AND FINE SEHVO. THE NEXY FOUR INSTRUCLIONS SIT IN A LOOP THAT 00157000 158 INCNEMENTS R4 BY THE OUANRANT WTDTM SES DESCRIPTION OF OUAD 00158000 159 OUTIL IT REACNES ZERO. FACH TIHF IHCREMENTINE THE QUADRANT FIELD 00159000 160 ELLS IZ OF THE IC MASK R3 .THE COOE EXITS TO LSOB WITH 00160000 161 R3 CONTAININE THE PROPER QUAORAMT BTTS FOR THE TARBET TRACK. 00161000 162 00162000 163 00163000 165 F917 E202 6 R7 2 R2 TMDICALES BOUNDS VIOLATION 00176000 166 F918 C007 12 LOAU R7 TARB R7 LOBICAL TARGET TRACK VALUE 00176000 F919 0069 167 F91A 6700 6 R7 H7 D TEST LNEICAL TRACK VALVE 00176000 168 F91B 843E 6 GOTO LSOS IF lt EAIT IF N BATIVE 00176000 169 F91C 04 6 LLIT R4 MAXTH R4 MAXLMUM TRACK VALUE 00176000 F91D 02EC 170 F91E 7C27 7 R4 R7 R4 R4 TAR ET MAXIMUM 00176000 171 F91F 813E 6 GOTO LSOS IF EXTT IF TARGET MAXIMUM 00176000 172 F920 H03 6 LOIL R3 AF9E R3 TCM ASK FINE SERVO 00176000 F921 AF9E 173 F922 8488 6 R4 R4 QUAD TEST TAHBET QUANRANT 00176000 174 F923 8320 6 GUTO LS03 IF BRANCM IF OUADRANT EITS RIOHT 00176000 175 F924 8804 6 R3 R3 4 DECMEMFNT OUADRANT FIELD 00176000 176 F925 8722 6 GUTO 3 LOOP UNTTL QUADRANT BITS OK 00176000 LOGICAL SEEK ROUTINE TARGET TRACK OFFSETTTNG 178 00178000 179 00179000 180 AT 1 00180000 181 R0 LSEEK RETURN ADDRESS 00181000 182 R2 2 IBOUNDS VIOLATION INDICATORT 00182000 183 R3 ICW MASK 00183000 184 R4 SCRATCH 00184000 185 R5 SCRATCH 00185000 186 R6 CURRENT TRACK VALUE PMYSICAL 4 00186000 187 R7 IARGET TRACK VALUE LOGIGAL 00187000 188 00188000 189 00189000 191 00191000 192 00192000 193 THE FOLLOWING CODE COMPUTES THE PHYSTCAL TARGET TRACK VALUE 00193000 194 AWN SETS UP THE EVEN OOD BIT OF THE ICH MASK R3 . THE RIRST 00194000 195 INSTRUCTION ADUS THE LOGICAL TRACK OFFSET TO R7 LEAVINB IT WITH 00195000 196 THE PHYSICAL TRAGET TRACK NHMHEN. THE NEXT INSTRUCTION SHLFTS 00196000 197 TMIS VALUE LEFT ONE PLACE MULTIPLIES BY 2 . THE POLLOWING TWO 00197000 198 INSTRUCTIONS EXTRACT THE LSG OF THE INTEGER PART OF 87 885 14 00198000 199 AND USE IT TO SET THE EVEN OUD BIT OF THE ICW HASK R3 14 . 00199000 200 1 FOR EVEN, O FOR 000 .THE NEXT TNSIRUCTION AGAIN SHIFTS R7 TO 00200000 201 THE LEFT ONE PLACE LEAVING IT WITH FOUR TIMES THE PHYSICAL TARGET 00201000 202 THACK MUMHER. 00202000 203 00203000 204 00204000 206 F926 670 6 LS03 R7 R7 OFSET R7 PHYSTCAL TRACK E OF TARGET 00206000 207 F927 737 6 LSL R7 F R7 2 TARRET TRACK 00207000 208 F928 2CE7 7 BTSI R4 R7 14 R4 14 TARGET LSG 00208000 209 F929 3324 7 R3 RE AOR R4 SET EVFN ODD GIT IN ICM MASK 00209000 210 F92A 8707 6 LSL F7 R7 TARGFT 4 00210000 LOGICAL SEEK ROUTINE HEAD SECTOR ROUNDS CHECK 212 00212000 213 00213000 214 THE FOLLOWING COUE PERFORMS A BOUNDS CHECK OF THE READ SECTOR 00214000 215 ADDKESS AND SETS UP THE SUNFACE BIT OF THE ICN MASK R3 . THE 00215000 216 FINST INSTRUCTION LOADS R4 WITH THE TARGET HEAO SECLOR ADDRESS. 00216000 217 THF FOLLOWING THREE INSTRUCTIONS TEST. THE HEAD ADDRESS BIT AND 00217000 218 SET THE SUKPACE BIT IN THE ICW MASK R3 10 IF SURFACE 1 IS THE 00218000 219 AOORESSEU SURFACE. OTMERWISE LEAVING THF BIT CLEAR. 00219000 220 THE FOLLOWINB INSTRUCTION CLEARS THE SURFACE EIR FROM R4 WHICH 00220000 221 SMOULD RESULT IN R4 CONTAINING OUST THE SECTOR ADDRESS.THE NEXT 00221000 222 THREE INSIRUCTIONS WILL BRANCH TO LSOS IF THESE REMAINING EITS 00222000 223 ARE WEGATIVE OR GREATER TMAN MASEC WHICH WOUCO INDICATE A BOUNDS 00223000 224 VIOLATION. 00224000 225 00225000 226 00226000 228 F92B C004 12 LOAQU R4 TMSEC R4 TARGET HEAD SECTOR VALUE 00228000 F92C 0060 229 F92D 2074 7 GTST R5 R4 7 TEST SURFACE GIT 00229000 230 F92E 230 6 TOTO 2 IF SKIP IF SURFACE 0 00230000 231 F92F 1843 7 BSET R3 10 SET ICN M SK TO SURFACE 1 00231000 232 F930 OC74 7 SCLM R 7 CEEAR SURFACE BIT 00232000 233 F931 B43E 6 GOTU LSOS IF EXIT IF MEAD SEOTOR BOUNDS ERROR 00233000 234 F932 C1F 6 R4 R4 MASEC TEST MEAD SECTOR VALUE 00234000 235 F933 813E 6 GOTO LSOS IF EXIL IF HEAD SECTOR BOUNDS ERROR 00235000 LOGICAL SEEK ROUTINE PHYSICAL SFFK INVOCATION 237 00237000 238 00238000 239 AT 00239000 240 R0 LSEER RETURN AODRESS 00240000 241 R2 SCHAICH 00241000 242 R3 FINE SERVO ICM VAIUE FOR TAROFT 00242000 243 R4 SCRAICH 00243000 244 R5 SCRALCH 00244000 245 R6 CURRENT IRACK VALUF PMYSICAL 4 00245000 246 R7 TARGET TRACK VALUE PMYSICAL 4 00246000 247 00247000 248 00248000 250 00250000 251 00251000 252 THE FOLLOWTHG CODE SETS UP AND INVORFS PSEEK IPMYSICAL SEEK 00252000 253 ROUTINE . THE FIRST INSTRUCTION SETS R2 TO THE SEEK ICW VALUE. 00253000 254 THE FOLLOWING INSTRUCTION STORES THE TARGETIS ICW VALUE INTO CICW 00254000 255 CURRENT IGW LOCATION . THF NEXT INSTMUCTION STORES THE PHYSICAL 00255000 256 TARGET TRACB VALUE R7 INIU CTRN CURRFNT TRACK LOCATION .THE 00256000 257 FOLLOWING INSTRUCTION INVOKES THE PHYSLCAL SEEK ROUTINE PSEEK . 00257000 258 FOLLOWING THE RETURN FROM THE PMYSICAL SEEK ROUTINE, THE NEXT 00258000 259 INSTRUCTION TESTS THE COMPLETION STATUS. THE NEXT INSTRUCTION 00259000 260 ILL BHANCD IO LSOS FOR A SUCCESSFUL SEFK COMPLETION OTHERWISE, 00260000 261 THE FOLLOWING INSTROCTION WILL TEST THE NOT READY FLAG, AND THE 00261000 262 MEXT INSTRUCTION WILL CALL THE ORIVE RECOVERV ROUTINE IF THE FLAG 00262000 263 INOICAIES IHAT THE ORIVE IS READY. THIS WILL LEAVE THE ARM AT 00263000 264 THE OUTSIOE CRASM STOP.MOTE TMAT IF THE ORIVE IS MOT READY, THE 00264000 265 BECOVERY ROUTTNE IS NOT CALLEN AND THE ARM IS LEFT LATCHED UP. 00265000 266 00266000 267 00267000 269 F934 3A93 7 BCPL R2 R3191 R2 SEEK ICW VALUE 00269000 270 F935 0003 12 STOR CICW R3 CICW FLME SERVO ICW FOR TARGET 00270000 F936 0064 271 F937 0007 12 STOR CTRK R7 CTRK PMYSICAL TARGEI TRACK VALUE 4 00271000 F938 0060 272 F939 9F52 9 CALL ISEEK.1 CALL SFFK ROUTINE 00272000 273 F93A 6200 6 R2 R2 0 TEST COMPLETION STATUS 00273000 274 F93B 813E 6 GUTO LSO5 IF BRANCH IF SEEK SUCCESSFUL 00274000 275 F93C 200C 8 LS04 BTST R5 XR4 13 TEST MOT READV FLAG 00275000 276 F930 9243 9 CALL RECOV IF CALL ORIVE RECOVERY IF ORIVE REAOY 00276000 LOBICAL SEEK ROUTINE EXIT CODE L DELAY ROUTINE 278 00278000 279 00279000 280 AT LSOS, R2 CONTAINS A 2 IF A BOUNDS VIOLATION WAS DETECTED IN 002800O0 281 THE ABOVE CODE. R2 CONTATNS A 1 FOR AQ SUCCESSFUL SEEK COMPLETION, 00281000 282 AND R2 CONTAIMS A O IF A SEEK FAILURE OCCURED.THE INSTRUCTION 00282000 283 IMEN DECRE ENTS R2 THUS SETTING R2 AND R1 TO THE APPROPRIATE EXIT 00283000 284 VALUES. IME NEXT INSTRUCTION METURMS TO THE CHLLING PROGRAM. 00284000 285 00285000 286 00286000 288 F93E 6AO1 6 LSOS R2 R2 1 SET TERMINATION STATUS 00288000 289 F93F 8100 10 RIRM RETUHN 00289000 291 00291000 292 00292000 293 THE FOLLOWINB ROUTINE PERFURMS A DFLAY BY OECREMENTINB THE 00293000 294 DELAY INDEA R2 UNTIL IT REACHES ZERO. THE OELAY CETAINEO IS 00294000 295 .5125 2.85 R2 MICROSFCONDS FOR R2 0. THE DELAY IS ABOUT 00295000 296 .187 SECONDS FON R2 0. 00296000 297 00297000 298 00298000 300 F940 0A01 6 SOLAY R2 R2 1 DECMEMENT OELAY INDEX 00300000 301 F941 8540 6 GOTO 1 1F LOOP UNTIL TMOEX O 00301000 302 F942 BLOC 10 HTKN RETURN 00302000 LOGICAL SEEK ROUTINE DRIVE RECOVERY ROUTINE 304 00304000 305 00305000 306 THE FOLLOWINE ROUTINF IS CALLED IN ORDER IO BRINB THE ARM OUT 00306000 307 OF THE LANUING ZONE AND CLEAQR THF NOT HEADY FIAB. THE FIRST TWO 00307000 308 INSIRUOTIONS SET R3 TO AN ICW VALUF WITH THE RUN BIT DRSSASSERTED 00308000 309 AND R2 TO THF SANE ICW VALUE WITH THF RON EIT ASSERIED.USING 00309000 310 INESE TWO VALUES, IME NFXT INSTRUCTION OISSASSERTS THE RUN STGNAL 00310000 311 AND THE FULLOWIMG INSTRUCTION TMMEDIATELY REASSERTS RUN. THIS 00311000 312 MAS THE EFTECT OF RELEASING THE ARM FROM THE LATCH. THE NEZT 00312000 313 IMSTRUTION SETS THE SC 10 APPLY A SLIEHT OUTWARD FORCE TO THE 00313000 314 ARM IN OROER TO NOVE IT 10 THE OUTSIDE CRASHSTOP. THE FOLLOWING 00314000 315 INSTRUOTION CLEARS THE NOT AEAD FLAB AND THE NEXT INSTRUCTION 00315000 316 SETS THE CURRENT ICW MEMMORY VALUE TO T E VALUE IN R2.THE NEXT 00316000 317 FIVE INSTRUCITONS LOOP FOR ABOUT LS SECONDS TO ALLOW THE ARM TO 00317000 318 REACH TME OUTSIDE CRASHSTOP FOLIOWING WHICH THE ROUTINE RETURMS. 00318000 319 IME HOUTINE EXITS ITH R2 R3 0 WHIOH IS USED BY SOME CALLS. 00319000 320 00320000 321 00321000 323 F951 843 6 RECOV LLIT R3 INFD2 R3 TCM VALUE IRUN DISSASSERTEO 00323000 F951 6F02 324 F951 5823 8 AND R3 OISSASSERT THE RUN SIONAL 00324000 325 F951 3A33 7 BCPL R2 R3 3 R2 ICW VALUE RUN ASSERTEO 00325000 326 F951 5822 8 ARD R2 REASSERT RUN RELEASE LATCH 00326000 327 F951 E921 7 AN1 121 SET SCW TO APPLY OUTWARD FORCE 00327000 328 F951 EA05 7 AN2 5 CLEAR NOT READY FLAG 00328000 329 F951 D002 12 STOM CLCW R2 SET CURRENT ICW LOCATION 00329000 F951 0064 330 F951 E200 6 R2 0 CLEAR R2 INELAY INOEX 00330000 331 F951 E30H 6 R3 8 SET R3 t A LOOP INOE 00331000 332 F951 9740 9 CALL SOLAY DELAY APPAOK. 0.187 SECONDS 00332000 333 F951 6801 6 R3 R3 1 DECREMFNT LOOP INOEX 00333000 334 F951 8143 6 GOTO 2 IF LOOP ON OELAY END WITH R2 R3 0 00334000 335 F951 100 10 KTRN RETURM 00335000 LOGICAL SEEK ROUTINE EXTFRNAL LINKS 337 00337000 338 00338000 339 THE FOLLOWING CUDE PROVIOES TMF LINKS TO THE EXTERNAL ROUTINES 00339000 340 HEFERENCED IN THIS PROGHAM. ISFEK IS A LOINK TO THE PHYSICAL 00340000 341 SEEK KOUTIME. IGAP IS A LINK TO SGAP TRACK SAMPLING ROUTINE . 00341000 342 THE 16MP LINK IS UNLY REFERENCED RY THIS COOE SINCE EVEN THOUGH 00342000 343 IT RESINES OM THIS MEMORY PAGE.IT IS ACTUALLY DEFINED IM THE 00343000 344 PAYSICAL SEEK PROGRAM. 00344000 345 00345000 346 00346000 348 F952 F800 ISEEK OATA PSEEK LINK TO PHYSICAL SEEK ROUTINE 00348000 349 F95F IGAP IS ONB I15F LINK TO SGAP 00349000 350 F800 PSEEK IS URG ADDRESS OF PHYSICAL SEEK ROUTINE 00350000 352 00352000 353 00353000 354 END OF LOGICAL SFFK ROUTINE 00354000 355 00355000 356 00356000 358 EMU 00358000 CROSS REFEMENCE TABLECICW 100 LIT 61 329 270CTRK 102 LIT 60 271 112FCNT 104 LIT 59 111IGAP 1097 LIT 349 136 115ISFEK F952 ROM 348 272LSO1 F90A ROM 119 143LSO2 F917 ROM 165 141 114LSO3 F926 ROM 200 174LSO4 F930 ROM 275 145LSO5 F93E ROM 208 274 235 233 171 168LSEEK F900 ROM 108 MAXTR 14 B LIT 77 169MXSEC 31 LIT 79 234OFSET 15 LIT 76 200ORG 2040 LIT 31 350 349 81PSEEK 2048 LIT 3501 346RUAD 187 LIT 78 178RECOV F943 ROM 323 276 109SOLAY F940 ROM 300 332TARG 105 LIT 62 166TMSEC 96 LIT 76 228TMOUT 320 LIT 34 110 MOMBER OF PASS 2 ERRURS 0 MOMBER OF PASS 2 WARMINGS 0 Tabel of ContentsPage s 30 Seek Routine Introduction 31, 32, 33, 34 Seek Routine Definition of Constants 35, 36, 37, 38 Seek Routine Initial Setup 39, 40, 41, 42 Seek Routine Switchpoint Initiali43, 44, 45, 46 zation Code 47 48, 49 Seek Routine Accelerate Up Phase 50, 51, 52, 53 Seek Routine Servo Loop 54, 55, 56, 57, 58, 59 Seek Routine One Track Seek Special Case 60 Seek Routine Model Termination Phase 61, 62 63, 64 Seek Routine Seek Termination 65, 66, 67 Tests 68, 69 Seek Routine Special Multiplication Routine Z 70 Seek Routine Delay Routine 71, 72 Seek Routine Sector Gap Routine 73, 74 Seek Routine Seek Failure Code 75 Seek Routine Seek Exit Code 76 Seek Analysis Patches 77 Seek Routine Link to SGAP Routine 78, 79 Seek Routine Model Computation Routine 80 Seek Routine End of Routine SEER ROUTINE IMTHOUCITOR 2 SEFK16 3 9 77.1000 00002000 3 00003000 4 SEFK ROUTIME 00004000 5 THIS HOUTINE EXEOUTES THE FIRMMARE OPERATIONS NECESSARY 00005000 6 IN PERFORM A SEEX UPERATION FROM THE CUPRENT TRACK TO THE 00006000 7 TARGET TRACK. 00007000 8 AT ENIRY CTRK CONTAINS TARGET IRARK VALUE PMYSICAL 4 00008000 9 CTCW CONTAIMS TARGET ICW VALME FOR FINE SERVO 00009000 10 FCMT CONTAINS TIMEOUT INDEX EMAININB SAMPLE TIMES 00010000 11 R2 CONFAINS SEEK ICW VALUE 00011000 12 R3 CONTAINS FIME SERVO TOW VALUE TSAME AS CICW 00012000 13 R6 CONTAINS CURRENT TRACK VALUE PMYSICAL 4 00013000 14 R7 CONTAINS TARGFT TRACK VALUE PMYSTCAL 4 00014000 15 AT EXIT R2 1 FOR SUCCESSFUL SFFK COMPLETION 00015000 16 R2 0 FOR SFFK FAILURE TIMEOUT 00016000 17 ALL ORMER REBISTERS ARF VOLATILE 00017000 18 00018000 19 MOTE 00019000 20 IF IME SEEK NOUTINE IS UNABLE TO COMPLETE THE SEEK IF IT 00020000 21 EXCEEDS A OROSS TIMEOUT .IT WITL ATTEMPT TO LATCH UP THE HEAD 00021000 22 IN THE LANUING ZONE AND RFTURN AN FRROH STATUS RERISTER 2 0 . 00022000 23 00023000 24 00024000 25 00025000 26 00026000 28 F800 ORG IS IFBOO 00028000 SEEX ROUTINE OEFINITION OF CONSTANTS 30 00030000 31 00031000 32 THE FOLLOMING VALUES AHE VARIABLFS STORED IN THE RAM. 00032000 33 THE FLHST VALUE INT IS THE MODEL POSITION WHICH IS COMPUTED 00033000 34 AN THE SERVO LOOP TO OETERMINE SERVO ERROR. ELGHTHS OF A TRACK 00034000 35 THE MEXT TWO VALOES ETAZ AND ETASR ARE FUNCTIONS OF THE 00035000 36 ESTIMAIED IME TO ARRIVAL AT THE TARBE TRACK ETA .THESE TWO 00036000 37 VALUES ARE INITIALIZEN IN THE SINIT ROUTINE AND USEO TO COMPUTE 00037000 38 THE MODEL POSITION M . ETAZ IS FOUAL TO ETA TIMES 2 AND ETASQ 00038000 39 IS EOUAL TO FTA SOUARED. TIME IS IN S MPLE TIMES HICH EOUAL 00039000 40 THE TINE BETEFEN SUCCESSIVE SAMPLES, 625 MICROSECONDS 00040000 41 THE FOURTH VARLABLE IFCNT IS A TIMEOUT INDEX TMAT IS 00041000 42 OECREMENTED EVERY SAMPLE TIME AND GOES TO ZERO IF THE SEEK 00042000 43 OUES NOT COMPLETE WITMIN 200 MILLISFCONDS 320 SAMPLE TIMES . 00043000 44 IF DECHEMENTED TO ZENO, THE SEEK ABORTS AND RETURNS AN ERROR 00044000 45 STATUS SEE NOTE ABOVE . 00045000 46 THE FIFTH VARIABLE PTARG IS THE AUJUSTEO TARGET VALUE. THIS 00046000 47 IS A COMPUTED VALUE THE MODEL MUST CONVERGE TO IS OROFR TO HAVE 00047000 48 THE ACTUAL HFAD POSITIOM COME INTO THE ACTGAL TARGET TRACK. ISEE 00048000 49 THE EXPLAMATION GIVEN IN SINIT . 00049000 50 THE SIXIH VARIABLE CTRK IS THE PHYSICAL TARGET TRACK VALUE 00050000 51 AND IS SET PRIOR TO EMTRY INTO THIS ROUTINE. THE SEEK ROUTINE 00051000 52 DOES NOT CMAMGE THIS VALUE. 00052000 53 THE SEVENTH VARLABLE CICW IS THE CURRENT ICW VALUE. IT IS 00053000 54 SET UP BY THE CALLING PROGRAM, AND OURING THE SEEK IT CONTAINS 00054000 55 THE VALUE OF THE ICW FOR FIME SEHVOING AT THE TABGEI TRACK. 00055000 56 00056000 57 THE FINAL VARIADLE SSLTM IS THE SEEK SERVO LIMITS CODE 00057000 58 WORO. IF ANY OF THE LOWFR 15 BITS OF THE WORO IS A ONE TMEN, 00058000 59 WORING THE SERVO PORTION OF THE SEEK.THE CURRENT COMMAND IS 00059000 60 ALLOWEO TO VARY OVER THE ENTIRE RANGE 1 1 AMP TO 1 AMPLI TMIS 00060000 61 IS ALLOWED ONLY WHEN THE SEEK MODEI MAS REACHED THE TARGET 00061000 62 TRACK. PRIOR TO TMIS, THE CURRFNT IS ALLOWED TO VAHY OVER 00062000 63 ONLY HALF OF THE ENTIRE RANGE. IF RITIN 0 AND RITS 1 15 0 00063000 64 SSLIM 0 THEN THE CURRENT IS ALLOWFO TO VARY WITHIN THE RANGE 00064000 65 1 AMP TO O AMPS. IF BITIO 1 AND RITS 1 15 0 SSLIM 18000 00065000 66 THEN THE CURRENT IS ALLOWED TO VARY WILMIN THE RANGE O AMPS TO 00066000 67 1 AMP.TMIS VALUE IS KFPT IN NO RATHER TMAN A MEMORY LOCATION, 00067000 68 SUT ITS USE 15 COMPLICATEO ENOUGH TO RTOUIRE SOME EAPANATION AT 00068000 69 IMIS POINT. 00069000 70 00070000 72 006C M IS 10060 MODFL POSITION 00072000 73 0068 E1A2 IS 10068 FSTIMATEN TIME TO ARRIVAL TIMES 2 00073000 74 000A ETASR IS 10064 ESTIMATEN TIME TO ARRIVAL SOUARED 00074000 75 0008 FCNT IS 10068 SEEK TIMFOUT COUNT 00075000 76 0067 PTAKB IS 10067 ADJUSTED TARGET VALUE 00076000 77 0068 CTRK IS 10066 TARGET TRACK PHYSICAL 4 00077000 78 0064 CICM IS 10064 TABGET FINE SERVO ICW VALUE 00078000 79 0002 SSLIM IS RU MINIMUM MAXTMUM SCW SERVO VAL UES 00079000 SEEK ROUTINE UEFINITION OF CONSTANTS 81 00081000 82 00082000 83 THE FOLLOWING VALUES ARE COMSTANTS USED BY THE SEEK ROUTINE. 00083000 84 THE FIHST FOUR CONSTANIS ARE VALUES USEO TO SET UP THE SCW. 00084000 85 MAXV IS EOUAL TO THE MAXIMUM VELOCITY THAT THE ARM CAN REACH 00085000 86 OURING A STEK. THE VALUE IS GIVEN IN OUARTER TRACKS. SCWMK IS 00086000 87 THE MAXIMUM VALUE THAT THE SCW CAN BE SET TO MAGNTTUDE ONLY . 00087000 88 FVAL IS THE ICM VALUE THAT IS SET FOR SEEK FAILURE. 00088000 89 TCMTI AND TERRA ARE TWO TERMINATION PARAMETERS THAT DETERMINE 00089000 90 WHEN THE SEEK TURNS CONT OL OVER TO FINE SFRVO. THIS OCCURS 00090000 91 WHEN THE HVDEL MAS ARRIVED ON TABGET AND THE SEEK SERVO MAS MELO 00091000 92 THE MEAO ON TRACK WITH A MAXIMU ERROR OF TERRL FOR TCNTI SAMPLE 00092000 93 TIMES. LINEWISE.ICMTZ OND TERR2 ARE TWO TERMINATION PARAMETERS 00093000 94 TMAT OETERMINE WMEN THE SEEK ROUTINE EAITS, THIS OCCURS WHEN THE 00094000 95 FINE SERVO HAS HELO THE MEAU ON TRACK WITH A MAXIMUM ERROR OF 00095000 96 IERR2 OURING WHICH TIME TCNTZ SFOUFNTIAL SAMPLES ARE READ WITMOUT 00096000 97 AN OFF TRACK CONDITION OCCURING. 00097000 98 DLYI AND DAY2 AND TWO DELAY INDEXES THAT COME INTO PLAY OURING 00098000 99 A ONE IHACK SEEK.FOR A ONE TRACK SFEK, THE MEAD IS ACCELERATED 00099000 100 TOWAROS THE TARGET TRACK FOR A TIME OELERMINED BY DLYL AND IS 00100000 101 TMEN DEACCELERATEO FOR A TIME OF TERMINEN BY OL Y2 AFTER WHICH THE 00101000 102 COOE DROPS INTO THE SERVO LOOP. 00102000 103 00103000 104 00104000 104 001F SCW31 IS 31 ACCELENATE UP VALUE FOR INWARD SEFKS 00106000 107 003F SCW63 IS 63 ACCELERATE UP VALUF FOR OUTWARD SEEKS 00107000 108 0000 SCWO IS 0 NO ACCELERATION VAIUE 00108000 109 0010 SCW16 IS 16 MALF ACCELERATIOM VALUE TOWAROS LANDING ZONE 00109000 111 003C MAXV IS 60 MAXIMUM VELOCITY FOUALS 15 TRACKS SAMPLE TIME 00111000 112 AFFE FVAL IS IAFFE SEEX FATLURE ICW VALHE 00112000 113 001F SCWMX IS 31 SCW MAXTMOM MAGHITUDE 1 31 5 BITS 00113000 114 0003 TCNT1 IS 3 SERVO TERMINATION COUNT 1 3 00114000 115 0002 TERR1 IS 2 SERVO TEMMINATION ERROR 1 2 EIGMTHS OF A TRACK 00115000 116 0008 TCNI2 IS H FINE SERVO TERMINATION COUNT 1 8 00116000 117 0004 TERR2 IS FINE SERVO TERM. EOROR 1 4 EIGHTHS OF A TRACK 00117000 118 0198 DLY1 IS 1019A TRACK IN TRACK DFLAY INDEX 1 1 40a 1.16 MSEC 00118000 119 022C DLY2 IS 1022C TRACK IN TRACK DELAY INDEX 2 1 55b 1.58 MSEC 00119000 SEEN ROUTINE INITIAL SFIUP 121 PORS OHG 00121000 122 UGRU 00122000 124 00124000 125 00125000 126 THE SEEN ROUTINE BERINS BY GUSMIMG THE RETURN ADDRESS ONTO 00126000 127 THE STACK. THIOS FHEES WN FOR COMPUTATIONAL USE. THE FOLLOWINE 00127000 128 TWO INSTRUCTIONS PLACE THE TERMINATION COUNT IN THE STACK.THE 00128000 129 TERMINATIUN COUNT IS AN INOEX VALUE THAT DECREMENTS TO ZERO WHILE 00129000 130 THE SEMVE MOLOS THE MFAN ON TARGGT. UPON REACHING ZERO. FINE 00130000 131 SERVO IS INVOKEO AND THE TERMINATION COUNT IS SET TO A NEGATIVE 00131000 132 VALUE FROM WHERE IT IS INCREMENTEO TO ZERO UPON WHICH THE SEEK 00132000 133 TXITS. 00133000 134 THE NEXT TWO INSTRUCTIONS INITIAL IZE THE SSLIM VALUE IROL AND 00134000 135 THE SCM ACCEIERATE UP VALUE R4 FOR AN OUTWARD SEEK. 00135000 136 TRACKS ARE NUMBERED HEGINNING WITH O AT THE OUTSLO EOGE AND 00136000 137 INCKEASING TO JUST AROUT BOO AT THE INSTDF EOBEI THEREFORE, FOR 00137000 138 INWARO SEERS, THE CURRENT TRACK IS LESS THAT THE TARGET TRAQCK, 00138000 139 AND FOR OUTWARD SEEKS THF CURRENT TRACK IS EREATER THAW THE 00139000 140 IARGET TRACK.THE FOLLOWING CODE SAVES THE TABSET TRACK NUMBER 00140000 141 IN R3. R7 THEN GETS THE OUTWARD SEEK DISTANCE CURRENT TRACK 00141000 142 TARGET TRACK . THIS VALDE IS ZERO FOR A SEEK SELF ITO CURRENT 00142000 143 TRACKI. IT IS NEGATIVE IF THE SEEK IS TNWARD AND POSITIVE IF THE 00143000 144 SFEX IS OUTWARD.FOR AN OUTWARN SEEK, A BRANCH TO SKOZ OCCURS. 00144000 145 A BRANCN TO SKOI OCCURS FOH AN IMWARD SFFK, AND FOR A SEEK SELF 00145000 146 CONTROL OROPS THHOUGH TO THE FOLIOWING INSTRUCTIONS WHICH SET THE 00146000 147 ICW TO THE APPROPRIATE VALUE, WAIT TWO SAMPLE TIMES TO ALLOW THE 00147000 148 ELECTHOMICS TO SETILE OUR, AND HRANCH IN SK07. 00148000 149 00149000 150 00150000 152 F800 B000 8 SEEK PUSH R0 SAVE RFTURN ADORESS 00152000 153 F801 E303 6 R3 TCNTI TERMINATION COUNT 3 00153000 154 F802 8003 8 PUSM R3 SAVE TERMINATION COUNT 00154000 155 F803 8800 6 LLIT R0 18000 RO SSLTH 1 18000 00155000 F804 800B 156 F805 E43F 6 R4 SCW63 SCW ACCELERATE UP VALUE OUTWARD 00156000 157 F806 5327 7 R3 R7 R3 TARGET TRACK 00157000 158 F807 7F26 7 R7 R6 R7 R7 CURREMT TRK TARGET TRK 00158000 159 F808 8112 6 GOTO SKO2 IF BRANCH IF SEEK OUTWARD 00159000 160 F809 840F 6 GOTO SK01 IF BRANCH IF SEEK INWARD 00160000 161 F80A 3892 7 HCPL R3 R2 9 R3 FINE SERVO IOW WALUE FOR TARGET 00161000 162 F80B 5823 8 HO R3 SET ICW FINE SERVO 00162000 163 F80C 97UD 9 CALL SGAP WAIT FOR SECTOR GAP 00163000 164 F80D 97OD 9 CALL SGAP WAIT FOR SECTOR GAP 00164000 165 F80E 87AI 9 GOTO SKU7 BRANCH SCEK SELF 00165000 SEEK ROUTINE INITIAL SETUP 167 00167000 168 00168000 169 AFTER UETERMINING THE SEEK DIRECTION. SOME SET UF IS REOUIRED 00169000 170 BEFORE THE SEEK HEGINS. FIRST OF AIL SSL IM MUST HE SET ISEE 00170000 171 DESCRIPTION OF SSLIM .THE SEEK STARTS BY SUPPLYING FULL CURRENT 00171000 172 ACCELERATING THE ARM TOWARDS THE TARGET TRACK UNTIL REACHING A 00172000 173 SWITCHPOINT WHERE THE CURRENT IS REVERSED AND SUPPLYS A VARLABLE 00173000 174 AMOUNT OF BRAKING FORCE TO THE ANM FOLLOWING A MATHEMATICALLY 00174000 175 COEPUTED APPROACH TO THE TARGET IRACK. POSITIVE CURRENT SUPPLYS 00175000 176 INWARD ACCELERATIONI THEREFORE. OURINS THE BRAKING POPTION OF AM 00176000 177 OWTWARD SEEK SSL IM SHOULD DE 18000 TO ALLOW THE CURRENT TO VARY 00177000 178 FROM 0 TO 1 AMP. LIKEWISE, IN THE BRAKING PORTION OF AN INWARD 00178000 179 SEEK, SSLIH SHOULD D BE O LIMITING THF CURRENT FROM O TO 1 ANP. 00179000 180 THE SC REOISTEN COMTROLS THE CURRENT. IT IS A SIQN MAGNITUDE 00180000 181 VALUE HITH A 5 BIT MAGNITUDE ALLOWING THE CURRENT TO BE SET TO A 00181000 182 1 32 AMP RESOLUTION.THE CURREMI IS NEBATIVE FOR A SIGN BIT IO 00182000 183 OF 1 AND IS POSITIVE FOR A SION OF O. THE MAX MUM SERVO VALUE IS 00183000 184 THE VALUE OF THE SCM TMAT SUPPLYS FULL BRAKING CURRENT TO THE ARM 00184000 185 OURING THE SERVO PORTIOM OF THE SFFK. THIS VALUE IS PLACED IN 00185000 186 THE SCW AT THE SWITCHPOINT IMMEDIATLY FOLLOWING THE ACCELERATE UP 00186000 187 PHASE UF THE SEEK. SINCH THE ACCFLERATE UP SOW VALUE PROVIOES 00187000 188 FULL CURRENT ACCELERATING, THE MAXIMUM SERVO VALUE IS TMIS VALUE 00188000 189 WITH THE SIGN BIT BIT TO COMPLEMFNTEO. 00189000 190 TO STARL THE SEEK AT FULL CURRFNT REOUIRES THE SCW BE SET TO 00190000 191 63 31 SIGN FOR AN OUTWARD SEEK AND 31 FOR AN INWARD SEEK. 00191000 192 THE FOLLOWING COOE IS EMTERED AT SKOI FOR AN INWARO SEEK. THE 00192000 193 COOE SETS UP THE SEEK DISTANCE 87 .THE SSLJM VALUE RO , AND 00193000 194 THE ACCELERATE UP SCW VALUE R . AT SKOZ, TMESE REGISTERS HAVE 00194000 195 THE APPROPRIATE VALUES REBAROLESS OF SEEK DIRECTION. THE MAXIMUM 00195000 196 SERVO VALUE RS IS THEN COMPUTEO FROM R4 ACCELERALE UP VALUE . 00196000 197 00197000 198 00198000 200 F80F E337 6 SK01 R7 R7 R7 1 SEEK OISTANCE 00200000 201 F810 E000 0 R0 0 RO SSLIM 0 00201000 202 F811 EALF 6 R4 SCW31 ACCELERATE UP VALUE 31 00202000 203 F812 3DAQ 7 SK02 BCPL R5 R4 10 R5 1 MAXIMIM SERVO VALVE 00203000 SEEK WOUTINE INILIAL SFTUP 205 00205000 206 00206000 207 AT FOLLOWING COOE STACK 00207000 208 R0 1 SSLIM VALUE 00208000 209 R2 1 SEEK ICW VALUE TERMINATION COUNT 00209000 210 R3 1 TARGET TRACK SEEK RETURN ADDRESS 00210000 211 R4 1 ACCELERATE UP SCM VALUE 00211000 212 R5 1 MAXIMUM SERVO VALUE 00212000 213 R6 1 CURRENT TRACK 00213000 214 R7 1 POSITIVE SEEK DISTANCE 00214000 215 00215000 216 00216000 218 00218000 219 00219000 220 THE FOLLOWING INSTRUCTIONS SAVE THE MAXIMUM SERVO VALUE R5 ON 00220000 221 THE STACK FOR SUBSEOUENT USE, PLACES THE ACCELERATE UP VALUE R4 00221000 222 IM IME SCW AQR1 , ANO THEN SETS THE ICM AROI WITH SEEK ICW VALUE 00222000 223 1821.THIS TAKES THE DISC OUT OF THE FINE SERVO MOOE AND STARTS 00223000 224 THE ARM ACCELERATING TOWAROS THE TARGET TRACK. 00224000 225 THE CODE THEN TESTS THE POSITIVE SEEK DISTANCE R7 AND IF THE 00225000 226 DISTANCE IS ONE TRACK 4 OUARTERS OF A TRACK , BRANCHES TO SK06. 00226000 227 00227000 228 00228000 230 F813 8005 8 PUSH R5 SAVE MACIMUM SERVO VALUE 00230000 231 F814 5924 8 XH1 R4 SCW 1 R4 00231000 232 F815 9FFA 9 CALL SCWST,I ANALYSTS PATCH 00232000 233 F816 5822 8 ARO R2 SET SEFK ICW START MNTION 00233000 234 F817 9FFB 9 CALL SKSET,I ANAL YSTS FATCH 00234000 235 F818 A704 6 CMP N1,4 TEST OTSTANCE 00235000 236 F819 8298 6 GOTO SK06 1F BRANCH IF ONE TRACK SEEK 00236000 SEEK ROUTINE SWITCHPUINT INITIALIZATION COUE 238 00238000 239 00239000 240 AT SINIT STACKI 00240000 241 R0 SSLIM VALUE 00241000 242 R2 SCRATCH MAXINUM SERVO VALUE 00242000 243 R3 TARGET TRACK ADDRFSS TERMINATION COUNT 00243000 244 R4 SCHALCM SFEK RETURN AODRESS 00244000 245 R5 SCRATCH 00245000 246 R6 CURRENT TRACK ANNRFSS 00246000 247 R7 POSITIVE SEEK DISTANCE 00247000 248 00248000 249 00249000 251 00251000 252 00252000 253 THE PURPOSE OF THE STNIT IS TO INITIKALIZE THE MODEL PARAQMETERS 00253000 254 AND THE SNITCMPUIMT VALUE.AT THE FNO OF THIS CODE, THE MODEL 00254000 255 POSITION IS CONTAINEO IN MEMORY LOCATION M, THE ETA SOUAREO VALUE 00255000 256 IS CONTAINED IN ETASQ, ETA TIHES Z IS IM ETAZ, THE SWITCHPOINT 00256000 257 VALUE IS IN RS, AND THE ADOUSTEN MODEL TARGET IS IN PTARG. ALL 00257000 258 HEOISTERS ARE VOLATILE IEXCEPT FOR RO AND R51. 00258000 259 THE SEER SERVO ALGORITHM DEVELOPES A STEAOY STATE SERVO ERROR 00259000 260 OF ABOUT 3.75 TRACKS. THIS MEANS THAT THE ACTUAL ARM WILL TEND 00260000 261 TO LEAD THE NOOEL BY AHOUT 3.75 TRACKS AND THUS WHEN THE MODEL 00261000 262 MEACHES THE TANGET TRACK. THE ACTUAL AHM WILL MAVE OVERSMOT BY 00262000 263 3.75 TRACKS. THE SEEK ROUTINE COMPFNSATES FOH THIS BY MAVISG 00263000 264 THE MOUEL CONVERGE 3.75 TRACKS SHORT OF THE ACTUAL TARGET TRACK, 00264000 265 AND TMEN JOMPING THE MODEL POSITION TO THE TARGET TWACK AFTER THE 00265000 266 MODEL ETA HAS REACHED 0. THIS SCHENE HAS THE OISADVANTABE THAT 00266000 267 FOR SMORT SEFKS THE MONEL NEVER REACHES ITS STEADY STATE SERVO 00267000 268 ERROH. TO REMEOY THIS PROBLEM, THE SEEK ROUTINE REOUCES THE SEEK 00268000 269 UISTQANCE BY ONLY ONE TRACN INSTEAD OF 3.75 IF THE ACTUAL SEEK 00269000 270 UISTANCE IS LESS THAN 6 TRACKS EXCFPT O OR TRACK SEEKS WHICH 00270000 271 ARE DEALT HITH SEPARATELY . 00271000 272 IN ORDER TU ACCUMPLISH TMIS DISTANCE OFFSETTING, THE ROUTINE 00272000 273 USES THE TMREE CONSTANTS DOFF1. DOFF2. L DOFF3 DEFINED BELOW . 00273000 274 THE ROUTINE SUGTRACTS 6 DOFF1 FRON THE SEEK DISTANCE AND IF 00274000 275 THIS IS NEGATIVE THEN IT ADDS 2.75 DOFF2 TO THE DISTANCEI NEXT, 00275000 276 2.25 DOFF3 IS ADDED TO THE SEEK DISTANCE REGARDLESS OF LENGTH. 00276000 277 THEREFORE, FOR 2,3,4, OR 5 TRACK SEFKS THE SEEK DISTANCE OFFSET 00277000 278 IS DOFF2. DOFF3 DOFF1 01 TRACK. FOR SEEKS OF 6 TRACKS OR LONGER 00278000 279 THE SEEK DISTANCE OFFSET IS DOFF3 DOFF1 03.75 TRACKS.NOTE 00279000 280 THAT ALL VALUES ARE COMPUTED IN OUARTER TRACKS. 00280000 281 00281000 282 00282000 284 0018 DOFF1 IS 24 DISTAMGE OFFSET 1 IS 6.00 TRACKS 00284000 285 0008 DOFF2 IS 11 DISTAMGE OFFSET 2 IS 2.75 TRACKS 00285000 286 0009 DOFF3 IS 9 DISTAMGE OFFSET 3 IS 2.25 TRACKS 00286000 SEEK ROUTINE SWITCHPOIMT INITIALIZATION CODE 288 00288000 289 00289000 290 THE FOLLOMING CODE PERFORNS THE SEEK OTSTANCE OFFSETTING SEE 00290000 291 THE ABOVE DESCRIPTION AND STORES THE ADJUSYED RESULT IN PTARG. 00291000 292 THE FIRST INSTRUCTION SUBTNACTS DOFF OFF TME SEEK OTSTANCE R7 . 00292000 293 IF THE SEED DISTANCE IS OREATER THAM OR EOUAL ROFFI THEN THE NEXT 00293000 294 INSTRUCTION RRANCHESI OTHERWISE, THF TMIRO INSTRUCTION ADDS OOFFZ 00294000 295 IO THE PARTIALLY ADJUSTED SEEK OISTANCE R7 . REGAHDLESS OF THE 00295000 296 SEED DISTANCF, THE MEXT INSTRUCTION ADUS DOFF3 LEAVING 47 WITH 00296000 297 THE FULLY ADJOSTED SEEK DISTANCE FOR USE IN THE ETA CALCULATIONS 00297000 298 BELO . PTARG IS THE ADJUSTED MOOEL TAKGET. FOR OUTWARO SEEKS, 00298000 299 PTARG EOUALS THE CURREMT TRACK LOCATTON MINUS THE DLSTANCE WHICH 00299000 300 EOUALS R6 R7. FOR INNARD SEEKS, PTARG FOUALS MINUS THE CURRENT 00300000 301 TRAC LOCALION MINUS THF DISTANCE WHICH EOUALS R6 R7. NOTE THAT 00301000 302 HTARG IS NEGATIVE FOR IMWARD SEEKS. THFSE TWO EOUATIONS OIFFER 00302000 303 ONLY IN THE SIGN OF R61 THEREFORE.THE NEXT THREE INSTRUCTIONS 00303000 304 TEST THE SEEK OLRECTION AND NEGATE R6 IF THE SEEK IS OUTWARD. 00304000 305 THUS THE EOUATION FOR PTARG REOUCES TO R6 R7 REGARDLESS OF THE 00305000 306 DIHECTION. THE MEAT THREE INSTRUCTIONS PERFORM THIS OPERATION 00306000 307 LEAVING THE RESULT IN R3. THIS VALUE IS IN QUARTER TRACK UNITS 00307000 308 THEREFORE. THE NEXT INSTRUCTION SHIFTS R3 LEFT 1 PLACE TO YIELO 00308000 309 PTARG IN ELGHTHS OF A TRAC .THF FOLLOWING INSTRUCTION STORES 00309000 310 THIS VALUE IN PTAHG. 00310000 311 00311000 312 00312000 314 F81A 6F18 6 SINIT R7 R7 DUFF1 R7 1 SEE DISTANCE DOFFI 00314000 315 F81B 8110 6 GOTO 2 IF BRANCH IF 0 00315000 316 F81C 6708 6 R7 R7 DOFF2 ADJUST SEEX OISTANCE AOD DOFF2 00316000 317 F81D 6709 6 R7 R7 DOFF3 R7 1 FULLY ADJUSTED SEEK DISTANCE 00317000 318 F81E 2623 7 CMP R3,R6 TEST DIRFCTTON OF SEEK 00318000 319 F81F 8121 6 GOTO 2 IF SKTP ON INWARO SFFK 00319000 320 F820 8336 6 R0 R6 R6 1 CURRENT TRACK OUTWARD SEEK 00320000 321 F821 5327 7 R3 R7 R3 1 ADJUSTED SEFK OTSTANCE 00321000 322 F822 7326 7 R3 R3 R6 R3 1 AUJUSTED TARGET 00322000 323 F823 8333 6 R3 R3 R3 1 ADJUSTED TARGET 4 00323000 324 F824 8703 6 LSL R3 R3 1 ADJUSTED TARGET R 00324000 325 F825 0003 12 STOR PLAWG R3 STORE ADJUSTED TARGET VALUE 00325000 F826 0067 SEEK ROUTINE SWITCHPOINT INITIALIZATION CODE 327 00327000 328 00328000 329 THE MOUEL COMPUTATIONS AHE BASED ON A TIME VALUE WHICH IS THE 00329000 330 ESTIMATEO TIME TO ARRIVAL AT THE TARGET TRACK. THIS VALUE IS 00330000 331 COMMUTEO FROM THE EOUATION T SORT 2 WHERS X IS THE OISTANCE 00331000 332 TRAVELED BY THE MODEL AND A IS THE MODEL ACCEI ERATION. THE ETA 00332000 333 IS TMEM ROUNOED TO THE MEANEST WHOI F NUMBER SO THAT THE MODEL 00333000 334 TLL CONVERGE EXACTLY TO THE ADJUSTED TARGET TRACK.FROM THIS 00334000 335 KOUNDED VALUE THE MODEL PARAMETERS ETA AND ETASQ AHE COMPUTED. 00335000 336 IN THE EOUATION T SQRT 2 X A . X IS EQUAL TO THE OISTANCE FROM 00336000 337 THE SWITCHPOINT TO THE ANJUSTED TABGET WHICM EQUALS D 20 37 WHERE 00337000 338 D IS THE ADJUSTED DISTANCE WHICH IS CONTAINED IN R7. THUS THE 00338000 339 EOUATION REOUCES TO T SORT R7 SORT 2 4 71 A . THE FOLLOWING 00339000 340 CODE COMPUIES SORT R7 . THE AD USTFD TARGET R3 IN INVOLATILE. 00340000 341 THE FIHST TWO INSTRUCTIONS CLEAR R2 AND R5. R2 WILL CONTAIN 00341000 342 THE OPERAND MINDS THE RODT SOUARED ERROR INDICATION AND R5 WILL 00342000 343 CONTAIN THE ROOT. THE NEXT TNSTHUCTION SETS R6 TO 9 WHICH IS THE 00343000 344 ITEMATION INDEX THE PROGRAM WILL LDOP 9 TIMES . THE NEXT FOUR 00344000 345 INSTRUCTIONS SHIFT R2.R7 LEFT TWO PLACES.THIS MULTIPLTES THE 00345000 346 UPERAND BY FOUR BRINGIMG IM TWO NEW BITS. THE NEXT INSTRUCTION 00346000 347 SRIFTS THE ROOT R5 LEET ONE PLACE. THE EFFECT OF THESE LAST 5 00347000 348 INSTRUCTIONS IS THAT THE OPERAND HAS BEFN MULTIPLIED BY 4 AND THE 00348000 349 ROOI BY 2. THE NEXT 3 INSTEUCTIONS SEL R4 70 2 ROOT 1 WHICH IS 00349000 350 THE OIFFERENCE BETWEEN ROOT 2 AND IROUT 1 2. THE FOLLOWING 00350000 351 INSTROCTION TESTS THIS VALUE. IF IT IS LESS THAN OR EOUAL TO THE 00351000 352 OPERAND MINUS THE ROOT 2 THEN THE MEXT INSTRUCTION BRANCHESI 00352000 353 OTHENWISE THE MEXT 3 INSTRUCTIONS INCREMENT THE ROOT R5 AND 00353000 354 OPDATE R2 BY SUBTRACTING R4. THE NFXT INSTRUCTION OECREMENTS THE 00354000 355 INDEX R6 AND THE NEXT INSTRUCTION LDOPS RACK TO SINTI IF NOT OI 00355000 356 OTREKWISE, THE ROUTINE OROPS TH OUGM WITH R5 MAVING THE SQUARE 00356000 357 ROOT OF THE SEEK OISTANCE IN 1 4 TRACK UNITS. 00357000 358 00358000 359 00359000 361 F827 E200 6 R2 0 R2 IS OPERAND SOUARE 00361000 362 F828 E500 6 R5 0 R5 IS ROOT 00362000 363 F829 E609 6 R6 9 R6 IS TNDEX 00363000 364 F82A 8707 6 SIMIT LSL R7 SHIFT IR2.R71 LEET TWO HITS 00364000 365 F82B 8722 6 RRL R2.C THIS GRINGS TWO NEW HITS 00365000 366 F82C 8707 6 LSL R7 INTO R2 00366000 367 F82D 8722 6 RRL R2.C 00367000 368 F82E 8705 6 LSL R5 SHIFT ROOT LEET ONE BIT 00368000 369 F82F 3401 6 R4 1 R4 ROOT ROOT 1 00369000 370 F830 7425 7 R4 R4 R5 00370000 371 F831 7425 7 R4 R4 R5 00371000 372 F832 2224 7 CNP R4.R2 IF 2 ROOT 1 OPERAND ROOT 2 00372000 373 F833 8137 6 GOTO SINTZ IF THEN GOTO SINT2 00373000 374 F834 6501 6 R5 R5 1 ELSE ROUT ROOT 1 00374000 375 F835 7A24 7 R2 R4 N2 AND R2 OPERAND ROOT 2 00375000 376 F836 8332 6 R2 R2 00376000 377 F837 6E01 6 SINTZ RO R6 1 DECNEMFNT TNDEX 00377000 378 F838 812A 6 GOTO SINTI IF LOOP TILL DONE 00378000 SEEK ROUTINE SWITCHPOINT INITIALIZATION CODE 380 00380000 381 00381000 382 AT ENTRY INTO THE FOLIOWING CODE. R3 HAS THE ADJUSTED TARBET 00382000 383 VALUE AND MS CONTAINS THF SORT D WHERE N IS THE ANJUSTED SEEK 00383000 384 DISTANCE.SINCE THE ET IS EQUAL TO SQRT D SORT 2 4 7 A . 00384000 385 R5 MOST RE MULTIPLIEO BY SORT 2 4 7 A WHICH IS A CONSTANT 00385000 386 EQUAL TO APPUOXINATELY 2.515625. THE FOLLOWING CONE THERERORE 00386000 387 MULTIPILTES THE SORT D BY 2.515625. 00387000 388 THE MULTIPLICATION IS DONE BY THF FIPST EIGHT INSTRUCTIONS. 00388000 389 THE SINT KOHTINE PERFOH A SHIFT AND ADD OPERATION. THE SHIFT 00389000 390 OHL Y IS DONE EXPLICITLY. SINCE THE SORT D CONTAINED IN R5 WAS 00390000 391 EXPRESSED IN QUARTER TRACK UNITS AND SINCE THE ROUTINE PERFORMS 00391000 392 SIX SMIFTS IN AOUITION TO THE MULTIPLY BY 2.X SHIFT. THE RESULT 00392000 393 LEFI IN R6 AFTER THE EIOHTM INSTRUCTION MAS THE INTEGER PART IN 00393000 394 THE MIGH BYTE.THE MEKT INSTRUCTION ROUNOS THE VALUE BY ADDING 00394000 395 1 2 AND THE FOLLOWING INSTRUCTION TRUNCATES THE RESULTING VALUE 00395000 396 BY MOVING DOWH THE MIBH AYTE. THIS COUE EXITS WITH THE INTEGER 00396000 397 VALUE OF THE ETA CONTAINED IN R6. 00397000 398 00398000 399 00399000 401 F839 5625 7 R6 R5 R6 R5 2.515625 CIA 00401000 402 F83A 8705 6 LSL R5 00402000 403 F83B 8705 6 LSL R6 00403000 404 F83C 8705 6 LSL R6 00404000 405 F83D 8705 6 LSL R5 00405000 406 F83E 9706 9 CALL SINT4 00406000 407 F83F 8705 6 LSL R5 00407000 408 F840 9706 9 CALL SIMT4 00408000 409 F841 6680 6 R6 R6 160 ROUND OFF 00409000 410 F842 5656 7 R6 R6 R0 MOVE COWN IMTEGER PART 00410000 SEEA KOUTINE SWITCHPOINT INITIALIZATION CODE 412 00412000 413 00413000 414 AT CNTRY TNTO THE FOLIOWING CODE, R6 CONTATNS THE ETA AND R3 00414000 415 CONIAINS THE AO USTED TARGET VALUE. USINB THESE VALUES THIS COOE 00415000 416 CONPOTES THE SWITCHPOINT AND THE INTTIAL VALUES FOR THE MODEL 00416000 417 PARAMTERS ETASW.ETAZ, AND M. 00417000 418 THE ETA SOUARED PARAHETER ETASO IS COMPUTED BY SOUARING THE 00418000 419 ETA R0 . THE FIRST 3 TMSTHOCTIONS SET UP THF LOOP INOEX R2 , 00419000 420 THE PHODUCI R4 ANO THF MULTIPLIER R5 . THF NEXT INSTRUCTION 00420000 421 DOUBLES THE PRODUCT R4 INITIALLY ZERO . THE FOLLOWING TWO 00421000 422 SHIFT UP A NEM MULTIPLIER BIT AND SKIP IF THE RIT IS ZERO. THE 00422000 423 NEXT INSTRUCTION WILL AND THE ETA VALUE R6 TO THE PRODUCT R4 00423000 424 IF THE MULTIPLIER BIT WAS A ONE. THE FOLLOWINB TWO INSTRUCTIONS 00424000 425 UECREMENT THE IMOEX VALUE R2 AND LOOP BACK TO SINTG UNTIL THE 00425000 426 IMOEX BOES TO ZERO.TMF FOILOWINB INSIRUCTION STORES THE SQUARED 00426000 427 VALVE IN ELASO. 00427000 428 THE NEAI TWO INSTRUCTIONS COMPUTE THE ETA TINES 2 VALUE ETAZ 00428000 429 HY SHIFTING FTA R6 LEFT ONE PLACE AND THEN STORINB THE VALUE IN 00429000 430 ETAZ. 00430000 431 AT THIS POINT R3 CONTATNS THE ADJUSTED TARGET VALUE AND R4 HAS 00431000 432 THE ETGSO VALUE. THE NEXT INSTRUCTION CALLS THE MCOMP HOUTINE 00432000 433 HICH COMPUTES THE MODEI LOCATION PARAMFTFR EROK THESE VALUES AND 00433000 434 STORES IT IN H IN EIGHTHS OF TRACKS . THE CONE EXITS WITH THIS 00434000 435 INITLAL MODEI VALUE IN R5. 00435000 436 THE SWITCHPOINT IS THE SAME AS THE INITIAL MODEL VALUE EXCEPT 00436000 437 IT IS EXPRESSED IN OUARTER TRACKS.THE NEXT TNSTRUCTION SHIFTS 00437000 438 INITIAL MODEL VALUE R5 RTGHT OME PLACE AND THE MODEL TNITIALIZE 00438000 439 HOUTINE THER RETURRS WITH THE SHITCHPOINT IN R5 OUARTER TRACKS . 00439000 440 00440000 441 00441000 443 F843 E207 6 R2 7 R2 LOOP INDEX 00443000 444 F844 E400 6 R4 0 CLEAR R4 00444000 445 F845 5516 7 R5 R6 H l R5 1 MULTIPLIER HIBH BYTE 00445000 446 F846 8704 6 SINT3 LSL R4 R4 R4 2 00446000 447 F847 8705 6 LSL R5 SHIFT UP FXT HULTIPLIER BIT 00447000 448 F848 834A 6 GUTU 2 IF SKIP IF BIT 0 00448000 449 F849 7426 7 R4 R4 R6 ADD MIN.TIPLICAND 86 00449000 450 F84A 6A01 6 R2 R2 1 DECREMENT INDEX 00450000 451 F84B 6146 6 GUTU SINT3 IF LOOP TILL DONE 00451000 452 F84C D004 12 STIH ETASQ H4 STORF FTA SQUARED VALIIE 00452000 F84D 006A 453 F84E H706 6 LSL R6 R6 ETA TIMES 2 00453000 454 F84F U006 12 STOH E1A2 R6 STORE ETA TIMES 2 VALIIE 00454000 F85O 006 455 F851 9FD9 9 CALL ICOMP,I COMPUTE MODEL LOCATTON 00455000 456 F852 8545 LSR RS R5 1 SMTICHPOINT QUAHTER TRACKS 00456000 SEEK ROUTINE ACCELERATE UP PHASE 458 00458000 459 00459000 460 THE FOLLOWING CODE LOOPS ON ITSEIF ONTIL THE ACTUATOR REACHES 00460000 461 THE SWITCHPOINT. AT ENTRY INTO THE CODE. RS CONTAINS THE VALUE 00461000 462 OF THE SWI CHPOINT QUARTER TRACKS , R4 CONTAINS THE ACCELERATION 00462000 463 SERVO VALUE, AND RO COMTAINS THE SSIIM VALUE THE SSLIN VALUE AT 00463000 464 IBIS PUINI IS EITHER O FOR INWAHD SFEKS OR 8000 FOH AN OUTWARD 00464000 465 SEEK .DUHIN THIS PHASE A SINBLE FRRONEOUS TRACK SAMPLE IS NOT 00465000 466 ALLOWED TO PREMATURELY INDICATE SWITCHPOINT ARRIVAL. THIS IS 00466000 467 ACHIEVED BY TESTING THE DISTANCF BFTHFEN THE TRACK SAMPLE WHICH 00467000 468 APPEARS TO HAVE REACHED THE SWITCHPOINT AND THE PREVIOUS SAMPLE. 00468000 469 IF THIS DISTANCE IS GREATER THAN THE MAXIMUM VELOCITY MAXV THEN 00469000 470 THE SAMPLE IS IGNORED AND THE CODE EXECUTES ANOTHER SAMPLE READ. 00470000 471 THE FIRST INSTRUCTION POPS THE STACK TO GET THE MAXIMUM SERVO 00471000 472 VALUE R4 . THE NEXT INSTROCTION PROVINES A SECTOR TIME DELAY IN 00472000 473 OROER TO SYNC THE ROUTIME TO THE GAP AND ALLOW THE ELECTRONICS 00473000 474 TIME TO SEITLE OUT. 00474000 475 THE NEXT INSTRUCTION READS A TRARK SAMPLE INTO R2. THIS SETS 00475000 476 UP THE LOOP. THE NEXT INSTRUCTION TRANSFERS THE PREVIOUS TRACK 00476000 477 SAMPLE TO R3 AND THE FOLLOWING INSTRUCTION READS A NEW TRACK 00477000 478 SAMPLE INTO R2. THE NEXT TWO INSTRUCTIONS SET R6 WITH THE VALUE 00478000 479 OF THE SWITCHPOINT THE CURRENT TRACK SAMPLE. THE SIGN OF THIS 00479000 480 VALUE INDICATES TO WHICH SIDE OF THE SWITCHPOINT THE TRACK SAMPLE 00480000 481 LIES. THE NEXT INSTRUCTION EXCLUSIVE DRS R6 WITH THE SSLIM VALUE 00481000 482 WHICH HAS THE EFFECT OF COMPLENFNTING THE SIGM BIT IF AND ONLY IF 00482000 483 THE SEEK IS OUTWARD. THUS THE SIGM OF R6 NOW INDICATES WHETHER 00483000 484 OR NOT SWITHCPOINT HAS BFEN PASSED.THE NEXT INSTRUCTION LOOPS 00484000 485 BACK TO SKO IF THE R6 IS POSITIVE INDICATING THE SWITCHPOINT HAS 00485000 486 NOT YET BEEN REACHED. 00486000 487 THE NEXT THREE INSTRUCTIONS SET R3 WITH THE DISTANCE BETWEEN 00487000 488 THE LAST TWO TRACK SAMPLES ABSOLUTE V LUE .THIS VALUE IS THEN 00488000 489 COMPARED TO THE MAXIMUM VELOCITY BY THE NEXT INSTRUCTION, AND THE 00489000 490 FOLLOWING INSTRUCTION LOOPS BACK TO SK IF THE DISTANCE IS TOO 00490000 491 LARGE INDICATING A TRACK SAHPLING FRROR . 00491000 492 WHEN THE SWITCHPOINT HAS BEEN REACHEN, THE SERVO ERROH R6 IS 00492000 493 SET TO ZERO AND THE CODE THEN BRANCHES INTO THE SERVO LOOP AT THE 00493000 494 POINT WHEND THE SCW VALUE IS SET FROM R4 . 00494000 495 00495000 496 00496000 498 F853 H904 9 POP R4 R4 MAXIMUM SERVO VALUE 00498000 499 F854 970D 9 CALL SGAP WAIT ONE SECTOR TIME DELAY 00499000 500 F855 970D 9 CALL SGAP R2 TRACK SAMPLE QUSRTER TRACKS 00500000 501 F856 5322 7 SK03 R R2 R3 . THACK SAMPLE 00501000 502 F857 970D 9 CALL SGAP R2 NEW THACK SAMPLE 00502000 503 F858 5622 7 R6 R2 R6 NEW THACK SAMPLE 00503000 504 F859 7E2S 7 R6 R5 R6 R6 DISTANCE FROM SWITCHPOINT 00504000 505 F85A 3620 7 R6 R6 XUR RO TESI DIRECTION FROM SWITCHPOINT 00505000 506 F85B 8156 6 GOTO SK03 IF LOOP IF NUT PAST SWITCHPOINT 00506000 507 F85C 7822 7 R3 R2 R3 R3 NEW SAMPLE OLD SAMPLE 00507000 508 F85D 835F 6 GOTO num 2 IF SKIP IF POSITIVE 00508000 509 F85E 833 6 R3 H3 R3 ABSINEW SAMPLE OLD SAMPLE 00509000 510 F85F 433C 6 CMP R3,MAXV TEST DISTANCE BETWEEN SAMPLES 00510000 511 F860 8156 6 GOTO SK03 IF LOOP IF TRACK SAMPLE READ ERROR 00511000 512 F861 7A25 7 R2 R5 R2 ANALYSIS PATCH 00512000 513 F862 8732 6 LSL R2,F ANALYSIS PATCH 00513000 514 F863 9FFC 9 CALL ERSET,I ANALYSIS PATCH 00514000 515 F864 E600 6 R6 0 SET INITIAL ERROR TO ZERO 00515000 516 F865 8784 6 GOTO SK05 BRANCH INTO SERVO LOOP 00516000 SEEK ROUTIME SERVO LOOP 518 00518000 519 00519000 520 AT SKO41 STACK1 00520000 521 R0 SSLIN VALUE 00521000 522 R2 SCRATCH TERMINATION COUNT 00522000 523 R3 SCRATCH SEEK RETURN ADDRESS 00523000 524 R4 SCRATCH 00524000 525 R5 SCRATCH 00525000 526 R6 SERVO ERROR COMPFNSATION BAIN HIGH WORD 00526000 527 R7 SCHATCH 00527000 528 00528000 529 00529000 531 00531000 532 00532000 533 THE FOLLOWING CODE IS THE STABT OF THE SERVO LOOP. THE SERVO 00533000 534 LOOP CUMPUTES NEW VALUES FOR THE SCW BASFD ON THE SERVO ERRORS 00534000 535 AND UPOATES THE SENVO NODEL.AT EACH ITERATION THROUGH THE LOOP, 00535000 536 THE SCW IS SET EQUAL TO K F1 2 K EO WHERE K IS THE GAIN OF 00536000 537 THE COMPENSATION. 2 IS THE COMPENSATIONIS ZERO LOCATION, EO IS 00537000 538 THE PREVIOUS SENVO ERROR, AND E1 IS THE CURRENT SERVO ERROR. 00538000 539 AT THE START OF THE SFRVO LOOP R6 CUNTAINS THE K E1 TERN FROM 00539000 540 THE PREVIOUS SERVO LOOP TIERATION. THIS VALUE IS EQUAL TO K EO 00540000 541 FOR THE PRESENT SERVO LOOP ITEHATION AND CAN BE CONVERTED TO THE 00541000 542 SECOND TERN OF THE SERVO EQUATION BY N BATING AND MULTIPLYING BY 00542000 543 2 GIVES 2 K EO . 00543000 544 THE FIRST INSTRUCTION NEGATE R6 EAVING IT WITH K ED. THE 00544000 545 NEXT INSTRUCTION SAVES THE SION BIT FOR USE IN THE MULTIPLY.THE 00545000 546 NEXT INSTROCTION CLEARS R4 WHICH IS TO RECEIVE THE KESULT OF THE 00546000 547 MULTIPLY BY 7. 00547000 548 SINCE 2 IS EQUAL TO 1 8, R4 MUST BE SET EQUAL TO 7 8 K ED. 00548000 549 THIS IS ACCOMPLISHED BY THREE CALLS TO ZHULT. ZMULT DIVIDES R6 00549000 550 BY TWO AND ADDS THE RESULT TO R4. PRIOR TO THE CALLS TO ZMULT, 00550000 551 R4 U AND R K ED.AFIER THE FIRST CALL TO ZMULT, R4 R6 K E0 2. 00551000 552 AFTER THE SECOND ZMULT CALL, R4 3 4 K ED AND R6 1 4 K ED. 00552000 553 AFTER THE THIRD CALL TO ZMULT, R4 7 8 K ED WHICH IS THE SECOND 00553000 554 ERM OF THE SERVO EQUATION. R6,R7 1 8 K ED. 00554000 555 00555000 556 00556000 558 F866 336 6 SK04 R6 R6 R6 K ED 00558000 559 F867 2806 7 BTSI R3 R6 0 R3 SIG BIT 00559000 560 F868 400 R4 0 R4 0 00560000 561 F869 9702 9 CALL ZMULT R4 R6 7 8 Z K ED 00561000 562 F86A 9702 9 CALL ZMULT 00562000 563 F86B 2AF6 7 BTSI 42 R6 15 R2 LSB OF R6 00563000 564 F86C 9702 9 CALL ZMULT 00564000 565 F86D 7422 7 R4 R4 R2 ROUND OFF R4 00565000 SEEK ROUTINE SERVO LOOP 567 00567000 568 00568000 569 MAVING COMPUTED THE SECOND TERM OF THE SERVO EQUATION IN THE 00569000 570 A OVE CODE, THERE REMAINS THE FIRST TERM K E1 TO BE COMPUTED. 00570000 571 THE FIRST STEP TO ACCOMPLISH THIS IS TO COMPUTE THE SERVO ERROR 00571000 572 WHICH IS THE MODEL POSTION MINUS THE ACTUAL POSITION.THE ACTUAL 00572000 573 POSITION IS READ FROM A THACK SAMPLING WHICH YIELDS TWO SINARY 00573000 574 PLACESI ROWEVER, THE FOUR STATES REPRESENTED BY THESE TWO BITS 00574000 575 00.01.10.11 CORRESPOM TO 1 8, 3 8, 5 8, AND 7 8 RESPECTIVELY. 00575000 576 THE ERROR IS THEREFORE COMPUTED TO THREE BINARY PLACES EIBMTHS . 00576000 577 TO COMPUTE THE ERROR, THE MODEL POSITION IS FIRST LOADED FROM 00577000 578 ITS MEMORY LOCATION M . M IS IN FIGHTHS OF TRACKS 00578000 579 THE NEXT INSTRUCTION CALLS THE SOAP ROUTINE WHICH WAITS FOR A 00579000 580 SECTOR GAP AND THEN READS THE TRACK ADORESS SAMPLE. THIS VALUE 00580000 581 IS RETURNED IN R2 WITH A 2 RIT FRACTION.THE NEXT INSTRUCTION 00581000 582 SHIFTS THE VALUE LEFT ONE PLACE, SHIFTING A 1 INTO THE L58, THUS 00582000 583 LEAVING R2 WITH THE ACTUAL POSITION AND A FRACTIONAL PART OF 1 8, 00583000 584 3 8, 5 8 OR 7 8. THE NEXT INSTRUCTION SETS R2 TO THE SERVO ERROR 00584000 585 MOUEL POSITION ACTUAL POSITION TO AN EIGHTH OF A TRACK. 00585000 586 THE NEXT THREE INSTRUCTIONS SET R6 TO K E1 WHERE K 32 AND E1 00586000 587 IS IN R2 IN EIGHTHS . SINCE R2 IS IN EIGHTHS R6 SHOULD BE SET 00587000 588 EQUAL TO R R2 8 R2 K 8 R2 4. THIS IS PERFORMED BY THE 00588000 589 TWO SHIFTS. 00589000 590 THE FOLLOWING INSTRUCTION ADDS R6 K E1 TO R4 Z K ED WHICH 00590000 591 LEAVES R4 WITH K E1 1 K ED WHICH IS THE SERVO EQUATION. THE 00591000 592 NEST THREE INSTRUCTIONS RESULT IN R5 BEING SET TO THE SIGN OF THE 00592000 593 RESULT AND R4 IS SET TO THE NAGNITUNE OF THE RESULT. 00593000 594 00594000 595 00595000 597 F86E C003 12 LOAD R3 M R3 MODEL POSITION 8 00597000 F86F 006C 598 F870 9700 9 CALL SGAP R2 ACTUAL POSITION 4 00598000 599 F871 8732 6 LSL R2,F R2 ACTUAL POSITION 8 00599000 600 F872 7A23 7 R2 RE R2 R2 FRR R 8 00600000 601 F873 9F C 9 CALL ERSET,1 ANALYSIS PATCH 00601000 602 F874 S622 7 R R2 R6 K E1 00602000 603 F875 B706 6 LSL R 00603000 604 F876 B706 6 LSL R6 00604000 605 F877 7426 7 R4 R4 R6 R4 K E1 Z K ED 00605000 606 F878 2004 7 BITI R5 R4 O R5 SIGN BIT OF R4 SCH 00606000 607 F879 8278 6 GUTO 2 IF num SKIP IF R4 POSITIVE 00607000 608 F87A 8334 6 R4 R4 R4 ABSOLUTE VALUE R4 00608000 SEEK ROUTINE SERVO LOOP 610 00610000 611 00611000 612 AT FOLLOWING CODE STACK 00612000 613 R0 SSLIM VALUE 00613000 614 R2 SERVO ERROR VALUE EIGHTHS TERMINATION COUNT 00614000 615 R3 SCRATCH SEEK RETURN ADDRESS 00615000 616 R4 NEW SCW VALUE MAGNITUDE 00616000 617 R5 SIGN OF NEW SCW VALUE MSR 00617000 618 R6 K SERVO ERRUR 00618000 619 R7 SCRATCH 00619000 620 00620000 621 00621000 623 00623000 624 00624000 625 THE FOLLO ING CODE ROUNDS CHECKS THE NEW SCW VALUE, ADJUSTS 00625000 626 THE VALUE IF NECESSARY. AND OUTPUTS IT TO THE SCW REOISTER XR1 . 00626000 627 DEPENDING ON THE CONTENTS OF SSLIM RO , THE SCW XH1 SOUNDS ARE 00627000 628 EITHER SC MX TO 0, 0 TO SCWHX, OR SC MX TO SCWHX. REGAROLESS, 00628000 629 THE SCW CANNOT EXCEED SCWMX. THE FIRS INSTRUCTION COMPARES THE 00629000 630 MAGNITUDE OF THE SCW R4 WITH SCWMX. THE NEXT TWO INSTRUCTIONS 00630000 631 WILL SET THE SCW MAGNITUNE TO SCWMX LARBEST VALUE IN BOUNDS IF 00631000 632 IT E CEEDS THIS ROUND.THE NEXT INSTRUCTION TESTS THE SIGN OF 00632000 633 THE SC VALUE R5 . THE FOLLOWING TWO INSTRUCTIONS SET THE SCW 00633000 634 SIGN BIT IN R4 BIT 10 IF THE SCW SHOULD BE NEGATIVE. 00634000 635 THE RESULT OF THE FOLLOWING XOR INSTRUCTION HAS ITS LOW ORDER 00635000 636 IS BITS EQUAL TO THE 15 LOW ORDER RITS OF SSLIM R0 . THESE BITS 00636000 637 ARE ALL ZEHO IF THE SCW RANGE IS SIGNED EITHER SCWMX TO ZERO OR 00637000 638 ZERO TO SCWMX . IF THE RANGE IS UNSIGNED SCWMX TO SCWMX THEN 00638000 639 AT LEAST UNE OF THESE BITS WILL BE A ONE. THE SIGN BIT OF THE 00639000 640 EXCLUSIVE UR RESULT IS THE EXCLUSIVE OR OF THE SIGN OF THE SCW 00640000 641 VALUE R5 AND THE SIGN OF SSLIM RO .IF THE RANGE IS SIGNED 00641000 642 THEN TMIS BIT IS A ZERO ONLY IF THE SCW VALUE HAS THE WRONG SIGN. 00642000 643 THEREFORE, THE 16 BIT RESULT WILL BE ZERO ONLY IF THE SCW VALUE 00643000 644 SET THE SCW VALUE TO ZERO IF IT HAS AN INAPPROPRIATE SIGN BIT. 00644000 645 AL HIS POINT THE SCW VALUE R4 HAS BEEN PROPERLY BOUNDED AND 00645000 646 THE NEXT INSTRUCTION OUTPUTS IT TO THE SCW.THIS INSTRUCTION IS 00646000 647 ALSO THE PUINT AT WHICH THE SERVO LOOP IS ENTERED FROM THE 00647000 648 ACCELEHATE UP PHASE AFIER THE SWITCHPOINT HAS BEEN HEACHED. 00648000 649 00649000 650 00650000 652 F87B A41F 6 CMP R4,SCWMX TEST MAGNITUDE OF R4 SCW 00652000 653 F87C B67E 6 GOTO 2 IF SKIP IF LESS THAN OR EQUAL SCWMX 00653000 654 F87D E41F 6 R4 SCWMX ELSE SET TO SCWMX 00654000 655 F87E 6500 6 R5 R5 0 TEST SIGN OF SCW R5 00655000 656 F87F B281 6 GOTO 2 IF SKIP IF POSITI E 00656000 657 F880 ICA4 7 BSET R4 10 ELSE SET SIGN OF H4 SCW 00657000 658 F881 3520 7 R5 R5 XUR R TEST SFRVD LIMITS 00658000 659 F882 8584 6 GOTO 2 IF SKIP IF IN ROUNDS 00659000 660 F883 E4000 6 R4 SET R4 SCW 00660000 661 F884 5924 8 SK05 XR1 R4 SCW R4 00661000 662 F885 9FFA 9 CALL SCWST,1 ANALYSIS PATCH 00662000 SEEK ROUTINE SERVO LOOP 664 00664000 665 00665000 666 THE FOLLOYING CODE OPNATES THE MODEL PARAMETERSI AT ENTRY INTO 00666000 667 THIS CODE, THE MODEL PARAMETERS ETA2, ETASQ, AND M CONTAIN THE 00667000 668 APPHOPHIATE VALUES FOR THE SERVO PASS JUST COMPLETED. AT EXIT 00668000 669 FROM THIS CODE THESE VALUES MUST BE SFI APPROPPIATELY FOR THE 00669000 670 MEXT PASS IHROUGH THE SERVO LOOP. ET ETA 1 00670000 671 THE FIRST INSTRUCTION LOADS THE ETA TIMES 2 PARAMETER ETA2 00671000 672 INTO R4.THE NEXT TWO INSTRUCTIONS WILL CAUSE A BRANCH TO SK09 00672000 673 IF ETA2 IS ZFRO WHICH INDICATES THAT THE MODEL HAS COMPLETED THE 00673000 674 APPROACH AND IS NOW AT TARGET. 00674000 675 SINCE X 1 2 X 2 THE NEXT INSTRUCTION UPDATES THE ETA2 00675000 676 PARAMETEN BY SUBTRACTING 2 FROM IT. IF THIS CAUSES THE VALUE TO 00676000 677 GO TO ZERO THEN THE MODE1 HAS APPIVFD AT TARGET AND THE FOLLOWING 00677000 678 INSIRUCTION DOES A SRANCH TO SK WHERE THE MODEL S PROPERLY 00678000 679 TENMINATED. OTHERWISE THE NEXT INSTRUCTION STORES THE NEW ETA2. 00679000 680 THE NEXT INSTHUCTION LOADS THE ETA SOUARED VALUE ETASQ INTO 00680000 681 RS. SINCE x 1 2 X 2 2 X 1 X 2 2 X 1 1, THE 00681000 682 ETASQ VALUE IS UPDATED BY THE NEXT TWO VALUES WHICH SU TRACT THE 00682000 683 UPRATED ETA2 VALUE 2 X 1 AND SUBTRACTING 1.THE FOLLOWING 00683000 684 INSIRUCTION STORES THE UPDATED ETASQ. 00684000 685 THE NEXT INSTRUCTION SETS UP A CALL TO HCOMP BY LOADING THE 00685000 686 PTAHG VALUE INTO R3. THE NEXT INSTRUCTION CALIS MCOMP WHERE THE 00686000 687 NEW NOUEL POSITION IS COMPUTED AND STORED IN M. SEE DESCRIPTION 00687000 688 OF HCOMP .THE LAST INSTRUCTION BRANCHES BACK TO THE START OF 00688000 689 THE SERVO LOOP. 00689000 690 00690000 691 00691000 693 F886 C004 12 LOAU R ETA2 R4 1 ETA TIMES 2 00693000 F887 006B 694 F888 640D 6 R4 R4 0 TEST ETA 00694000 695 F889 82 E 6 GUTO SK09 IF BRANCH IF ETA 0 00695000 696 F88A 6CD2 6 R4 R4 2 UPDATE ETA TIMES P 00696000 697 F88B 8645 6 GUTO SK08 1F BRANCH IF NEW ETA 0 00697000 698 F88C D004 12 STUR ETA2 R4 STORE UPDATED ETA TINES 2 00698000 F88D 0068 699 F88E C005 12 LOAD R5 ETASQ RS ETA SOUARED 00699000 F88F 006A 700 F890 7C25 7 R4 R5 R4 UPDATE ETA SOUARED 00700000 701 F891 6C01 6 R4 R4 1 R4 NEW ETA SOUARED 00701000 702 F892 D004 12 STOR E1ASO R4 STORE UPDATED ETA SOUARED 00702000 F893 006A 703 F894 C003 12 LOAD R3 PTARG R3 ADJUSTED TARGET VALUE 00703000 F895 0067 704 F896 9FD9 9 CALL ICOMP,1 COMPUTE MODFL POSITION VALUE 00704000 705 F897 8766 6 GUTO SK04 BRANCH TO START OF SERVO LOOP 00705000 SEEK ROUTINE ONE TRACK SEEK ISPECIAL CASEI 707 00707000 708 00708000 709 A1 SK06 STACK 00709000 710 R0 SSLIN VALUE 00710000 711 R2 SEEK IC VALUE MAXIMUN SERVO VALUE 00711000 712 R3 TARGET TRACK TERNINATION COUNT 00712000 713 R4 ACCELEHATE UP SCW VALUE SEEK RETURN ADDRESS 00713000 714 R5 MAXIBUM SERVU VALUE 00714000 715 R6 CURRENT TRACK 00715000 716 R7 POSITIVE SEEK DISTANCE 00716000 717 00717000 718 00718000 720 00720000 721 00721000 722 THE FOLLOWING CODE PERFORMS A ONF THACK SEEK. IT IS ENTERED 00722000 723 RIOHT AFTER THE IC HAS REEN SET AND SEEK MOTION STARTED.THE 00723000 724 FIRSI TWO INSTRUCTIONS SET UP THE OFLAY INDEX AND CALL THE DELAY 00724000 725 ROUTINE, THUS INVORING A DELAY WHILE THE ARM ACCELERATES TO ABOUT 00725000 726 THE HIUPOINT OF THE SEEK. THE FOLLOWING TWO INSTRUCTIONS SET THE 00726000 727 MAXIMUM SERV VALUE FRON THE STACK R2 AND OUTPUT IT TO THE SCW 00727000 728 REGISTER. THIS REVERSES THE CURRENT IN THE ACTUATOR AND BEGINS 00728000 729 DEACCELERATING THE ARH. THE NEXT TWO INSTRUCTIONS SET UP THE 00729000 730 DELAY INDEX R2 AND AGAIN CALL THE DELAY ROUTINE WHICH RESULTS 00730000 731 IN A DELAY WHILE THE AR DEACCELERATES TO ZERO APPRUXIMATELY ON 00731000 732 TARGET. THE FOLLOWING BLOCK OF CODE IS ENTERED EITHER FROM THE 00732000 733 THACK 10 INACK SEEK CODE ON FOR THE START OF A SEEK SELF.IN 00733000 734 EITHER OF THESE CASES THE CODE EXITS DIRECTLY INTO FINE SERVOINS. 00734000 735 THIS IS ACCOMPLISHED BY SETTING THE TERWINATION COUNT TO ONE AS 00735000 736 IS DONE BY THE FOLLOWING THREE INSTRUCTIONS. THE FOLLOWING 00736000 737 INSTRUCTION CLEARS R2 TH S INITIALIZING THE SERVO ERROR TO ZERO. 00737000 738 00738000 739 00739000 741 F898 8802 6 SK06 LLI R2 DLY1 R2 DEL Y INDEX 00741000 F899 0198 742 F89A 97DA 9 CALL SOLAY CALL DELAY ROUTINE 00742000 743 F89B 8902 9 POP R2 R2 MAXIMUM SERVO VALUE 00743000 744 F89C 5922 8 XH1 R2 SCW R2 00744000 745 F89D 8802 6 LLIT R2 DLY2 R2 DELAY INDEX 00745000 F89E 022C 746 F89F 97DA 9 CALL SDLAY CALL DELAY ROUTINE 00746000 747 F8A0 9FFA 9 CALL SCWST,1 ANALYSIS ATCH 00747000 748 F8A1 B902 9 SK07 POP R2 R2 TERMINATION COUNT 00748000 749 F8A2 E201 6 R2 1 SET TERMINATION COUNT 1 00749000 750 F8A3 002 8 PUS R2 SAVE TERMINATION COUNT 00750000 751 F8A4 E200 6 R2 0 CLEAR R2 ISERVO ERROR 00751000 SEEK ROUTINE MODEL TERBINATION PHASE 753 00753000 754 00754000 755 AT SKUS STACK 00755000 756 R0 SCRATCH 00756000 757 R2 CURRENT SERVO ERBOR TERMINATION COUNT 00757000 758 R3 SCRATCH SEEK RETURN ADDRESS 00758000 759 R4 SCRATCH 00759000 760 R5 SCRATCH 00760000 761 R6 SCRATCH 00761000 762 R7 SCRATCH 00762000 763 00763000 764 00764000 765 00765000 767 00767000 768 00768000 769 THE FOLLOWING CODE IS EXECUTED ONLY ONCE DURING A SEEK.IT IS 00769000 770 ANTERED EITHER AT THE START OF A SEEK SELF 10 TRACK SEEK , JUST 00770000 771 AFTER THE OPEN LOOP PORTION OF A ONF TRACK SEEK, OR WHEN THE 00771000 772 ESTIMAIED TIME TO ARRIVAL REACHES ZERO OURING ANY OTHER SEEK. 00772000 773 THE FIHST THREE INSTRUCTIONS SET THE ODEL POSITION PARAMETER 00773000 774 IN TO THE ACTUAL TARGET TRACK. THE NEXT INSTRUCTION SETS THE 00774000 775 SSLIM VALUE R0 SUCH THAT THE SERVO RANGE EXTENDS FROM SCWMX TO 00775000 776 SCWMX FULL RANDE . THE NEXT INSTRUCTION CLEARS THE SERVO ERROR 00776000 777 TERM R6 .THE FOLLOWING INSTRUCTION SETS THE ESTIMATED TIME TO 00777000 778 ARRIVAL TO ZERO ETA2 TO INDICATE ARRIVAL AT TARGET. 00778000 779 00779000 780 00780000 782 F8A5 C005 12 SK08 LOAD R5 CTRK R5 TARGET TRACK PHISICAL 00782000 F8A6 0066 783 F8A7 705 6 LSL R5 R5 TARGET TRACK 8 00783000 784 F8A8 0005 12 STON R R5 SET MONEL TO TARGET TRACKS EIGHTHS 00784000 F8A9 006C 785 F8AA 0001 6 R0 R0 1 SET SSLINI MIN 311 MAX 31 00785000 786 F8AB E600 6 R 0 CLEAR SERVO ERROR TERM 00786000 787 F8AC D00 12 STON ETA2 R6 CLEAR ETA2 00787000 F8AD 006 SEEK ROUTINE SEEK TERMINATION TESTS 789 00789000 790 00790000 791 AT SK09 STACK 00791000 792 R0 SSLIM VALUE FULL RANDE 00792000 793 R2 CURRENT SERVO ERROR TERMINATION COUNT 00793000 794 R3 SCRATCH SEEK RETURN ADDRESS 00794000 795 R4 SCRATCH 00795000 796 R5 SCRATCH 00796000 797 R6 K SERVO ERROH 00797000 798 R7 SCHATCH 00798000 799 00799000 800 00800000 802 00802000 803 00803000 804 THE FOLLOWING CODE IS ENTERED FRON THE MODEL UPOATE CODE IF 00804000 805 THE MODEL VELOCITT HAS REACHED ZERO. THIS CODE CHECKS THE SERVO 00805000 806 ERROR AND DETERMINES AT WHAT POINT TO SWITCH TO FINE SERVO AND AT 00806000 807 WHAT POINT TO FXIT THE SEEK ROUTINF.THE TERMINATION IS DONE IN 00807000 808 T O PHASES, THE FIRST PHASE IS UNDER CONTROL OF THE TCNTI AND 00808000 809 TERRI PARABETERS. DURING THIS PHASE THE TERMINATION COUNT WHICH 00809000 810 WAS INITIALIZED TO TCNT1 IS DECREMENTED EACH PASS IF THE SERVO 00810000 811 ERRON IS LESS THAN OR EQUAL TERRI, IF THE ERROR EXCEEDS TERR1 00811000 812 THEN THE TERMINATION COUNT IS REINITTALIZED TO TCNT1 AND THE 00812000 813 TERMINATION SEQUENCE STARTS OVER. WHEN THE TERMINATION COUNT IS 00813000 814 DECREMENTED TO ZERU, FINE SERVO IS INVUKED. THE TERMINATION COUNT 00814000 815 IS SET TO TCMT2, AND THE TERMINATION SEQUENCE PROSHESSES TO THE 00815000 816 SECOND PHASE. THIS PHASE IS UNDER CONTROL OF THE TCNT2 AND TERR2 00816000 817 NARABETERS. AT THE START OF THIS PHASE THE TERMINATION COUNT IS 00817000 818 EQUAL 10 ICNT2. THEREAFTER THE TERMINATION COUNT IS INCREMENTED 00818000 819 ACH PASS IF THE SERVO ERROR IS LESS THAN OR EQUAL TERR2. IF THE 00819000 820 ERROR EXCFEDS TERR THEN SEEK SERVN IS REINVOKEN. THE TERMINATION 00820000 821 COUNT IS REINITIALIZED TO TCNT1. AND THE TERMINATION SEOUENCE 00821000 822 SIARTS OVER FROM THE BEGINNINE. WHEN THE TERMINATION COUNT IS 00822000 823 INCREMENTED TO ZERO IN THE SECOND PHASE THE SEEK ROUTINE EXITS. 00823000 824 THE FOLLOWING CODE REGINS BY COPYING THE ERROR VALUE INTO R5. 00824000 825 IF THE ERRUR IS NEGATIVE, THE FOLLOWING TWO INSTRUCTIONS NEGATE 00825000 826 R5, LEAVING IT WITH THE POSITIVE ERROR VALUE. THE FOLLOWING TWO 00826000 827 TWO INSTRUCTIONS POP AND TEST THE TERMINATION VALUE.THE NEXT 00827000 828 INSTRUCTION BRANCHES TO SK10 IF THE TERMINATION COUNT IS NEGATIVE 00828000 829 SECOND PHASE OF TERMINATION SEQUENCE OTHERWISE, THE CODE DROPS 00829000 830 THROUGH TO THE NEXT BLOCK FIRST PHASE OF TERMINATION SEQUENCE . 00830000 831 00831000 832 00832000 834 F8AE 5522 7 SK09 R5 R2 R5 FRROR 8 00834000 835 F8AF 8381 6 GOTO 2 IF SKIP IF POSITIVE 00835000 836 F880 8335 6 R5 R5 R5 ARSIFRROR 8 00836000 837 F881 8902 9 POP R2 R2 TERMINATION COUNT 00837000 838 F882 8200 6 R2 R2 0 TEST TERMINATION COUNT 00838000 839 F883 84BE 6 GOTO SK10 IF BRANCH IF NEGATIVE 00839000 SEEK ROUTINE SEEK TERMINATION TESTS 841 00841000 842 00842000 843 AT ENTRY INTO THE FOLLOWING CODE, R2 CONTAINS THE TERMINATION 00843000 844 COUNT 01, AND R5 CONTAINS THE SERVO ERROR 0 . SEEK SERVO IS 00844000 845 IN EFFECT AND THE TERMINATION SEOUENCE IS IN ITS FIRST PHASE. 00845000 846 THE FOLLOWING CODE REGINS BY COMPARING THE SERVO ERROR WITH 00846000 847 TERRI.IF THE SERVO ERROR IS GREATER THAN TERR1, THE FOLLOWING 00847000 848 INSTRUCTION WILL BRANCH TO SK13 WHERE THE TERMINATION COUNT WILL 00848000 849 BE RESET TO TCNT1 OTHERWISE, THE TERMINATION COUNT R2 WILL BE 00849000 850 DECREMENTED BY THE FOLLOWING INSTRUCTION. IF THE COUNT HAS NOT 00850000 851 ET REACHED ZERO, THE NEXT INSTRUCTION WILL BRANCH TO SK14 WHERE 00851000 852 THE TERMINATION COUNT WILL BE PUT BACK ON THE STACK AND CONTROL 00852000 853 PASSED BACK TO THE SERVO LOOP. 00853000 854 IF THE IENMINATION COUNT HAS REACHED ZERO THEN THE FIRST PHASE 00854000 855 OF THE TE MINATION SEQUENCE IS ENDEN. THE NEXT INSTRUCTION SETS 00855000 856 THE FINE SERVO ICW VALDE FROM CICW WHICH WAS SET UP PRIOR TO 00856000 857 ENTERING THIS ROUTINE. THE NEXT INSTRUCTION OUTPUTS THIS VALUE 00857000 858 TO THE ICW THUS INVOKING FINE SERVO.THE FOLLOWING INSTRUCTION 00858000 859 SETS THE TER INATION COUNT R2 , WHICH IS CURRENTLY ZERO, TO THE 00859000 860 NEGATIVE VALDE OF TCNT2 BY SUBTRACTING 10 TCNT2 TCNT2 . THE 00860000 861 NEXT INSTRUCTION BRANCHES TO SK14 FOLLOWING WHICH THE TERMINATION 00861000 862 COUNT IS PUSHED ONTO THE STACK AND CONTROL GIVEN BACK TO THE 00862000 863 SERVU LOOP. 00863000 864 00864000 865 00865000 867 F884 A502 6 CMP R5,TERR1 TEST ERROR 00867000 868 F885 81CF 6 GOTO SK13 IF BRANCH IF TERR1 00868000 869 F886 6A01 6 R2 R2 1 DECREMENT TERMINATION COUNT 00869000 870 F887 B1D0 6 GOTO SK14 IF BRANCH IF 0 00870000 871 F888 C005 12 LOAD R5 CICW R5 FINE SERVO ICW 00871000 F889 0064 872 F88A 5825 8 XHO R5 SET ICW WITH FINE SERVO 00872000 873 F88B 9FF9 9 CALL SKCLB,1 ANALYSIS AICH 00873000 874 F88C 08 6 R2 R2 TCNT2 SET FINE SERVO TERM COUNT 00874000 875 F88D 8700 6 GOTO SK14 BRANCH 00875000 SEEK ROUTINE SEEK TERMINATION TESTS 877 00877000 878 00878000 879 AT SK101 STACK 00879000 880 R0 SSLIN VALUE FULL RANGE 00880000 881 R2 TERBINATION COUNT SEEK RETURN ADDRESS 00881000 882 R3 SCRATCH 00882000 883 R4 SCRATCH 00883000 884 R5 POSITIVE SERVO ERROR EIGHTHS 00884000 885 R6 R SERVO ERROR 00885000 886 R7 SCRATCH 00886000 887 00887000 888 00888000 890 00890000 891 00891000 892 AT ENTRY INTO THE FOLIOWING CODE. THE TERMINATION COUNT R2 00892000 893 IS NEDATIVE AND FINE SERVO IS IN EFFECT THE TERMINATION SEQUENCE 00893000 894 IS IN ITS SECOND PHASE . THE FIRST INSTRUCTION TESTS THE SERVO 00894000 895 ERROR R5 ABAINST TERR2.IF THE ERROR IS GREATER THAN TERR2, 00895000 896 THE NEXT INSTRUCTION BRANCHES TO SK12 WHERE THE IST PHASE OF THE 00896000 897 SEEK TERMINATION IS REINVOKED ELSE, THE NEXT INSTRUCTION TESTS 00897000 898 THE OFF TRACK FLAB. IF THE FLAB IS SET THE NEXT INSTRUCTION WILL 00898000 899 DROP TO THE MEXT THREE INSTRUCTIONS WHERE THE OFF TRACK COUNT IS 00899000 900 RESET AND THE OFF TRACK FLAB IS CLEARED FOLLOWED BY A BRANCH TO 00900000 901 SK14. IF THE FLAB IS CLEAN THEN THE CODE BRANCHES IN SK11 WHERE 00901000 902 THE OFF TRACK COUNT IS OPDATED AND TESIED. IF LESS THAN ZERO, 00902000 903 THE SEEK IS NOT DONE AND THE CODE BRANCHES TO SK14 WHERE THE OFF 00903000 904 THACK COUNT R2 IS PUSHED BACK ON THE STACK AND THE SERVO LOOP 00904000 905 IS REEXECUTED. IF THE COUNT HAS REACHE ZERO, THEN THE SEEK HAS 00905000 906 SUCCESSFULLY COMPLETED.SO THE CODE SETS R2 TO 1 FOR SUCCESSFUL 00906000 907 CONPLETION STATUS AND BRANCHES TO THE EXIT CODE. 00907000 908 00908000 909 00909000 911 F88E A504 6 SK10 CNP R5,TERR2 TEST ERROR 8 00911000 912 F88F 1CA 6 GOTO SK12 IF BRANCH IF TERR2 00912000 913 F8C0 2CEC 8 BISI R4 XR4 14 TEST OFF TRACK FLAB 00913000 914 F8C1 82C6 6 GOTO SK11 IF HRANCH IF ON TRACK 00914000 915 F8C2 E200 6 R2 0 CLEAR R2 TERMINATION COUNT 00915000 916 F8C3 A08 6 R2 R2 TCNT2 R2 TERMINATION COUNT 00916000 917 F8C4 EA06 7 XR2 6 CLEAR OFF TRACK FLAB 00917000 918 F8C5 87D0 6 GOTO SK14 BRANCH 00918000 919 F8C6 6201 6 SK11 R2 R2 1 INCREMENT TERMINATION COUNT 00919000 920 F8C7 84D0 6 GOTO SK14 IF BRANCH IF NOT DONE 00920000 921 F8C8 E201 6 R2 1 SET STATUS FOR SUCCESSFUL SEEK 00921000 922 F8C9 87F6 6 GOTO EXIT BRANCH TO EXIT CODE 00922000 SEEK ROUTINE SEEK TENRINATIN TESTS 924 00924000 925 00925000 926 AT SK12, SK13, OR SK14 STACK 00926000 927 RO SSLIN VALUE FULL RANGE 00927000 928 R2 TERMINATION COUNT SEEK RETURN ADDRESS 00928000 929 R3 SCRATCH 00929000 930 R4 SCRATCH 00930000 931 R5 SCRATCH 00931000 932 R6 K SERVO ERRO 00932000 933 R7 SCRATCH 00933000 934 00934000 935 00935000 937 00937000 938 00938000 939 AT SK12, FINE SERVO IS IN EFFECT AND THE TERMINATION SEQUENCE 00939000 940 IS IN ITS SECOND PHASE, BUT THE SERVO ERROR HAS EXCEEDED TERR2. 00940000 941 THEREFORE, THE CODE MUST REINITIALIZE THE TERMINATION SEQUENCE. 00941000 942 THE FIRST STEP IN DOING THIS IS TO REI VOKE THE SEEK SERVO. THE 00942000 943 FIRST INSTRUCTION GETS THE FINE SERVO ICW VALUE FROM CICW.THE 00943000 944 FOLLOWING TWO INSTRUCTIONS SET THE SEEK IT IN THE ICW VALUE R5 00944000 945 AND OUTPUT THIS VALUE IN THE ICW THUS INVOKINA SEEK SERVO. 00945000 946 AT SK13, SEEK SERVO IS IN EFFECT EITHER JUST SEI IN THE PRIOR 00946000 947 INSIRUCTIONS OR FROM THE FIRST PHASF OF THE TERMINATION SEQUENCE 00947000 948 SUT THE SEHVO ERROR HAS EXCFEDEN THE ERROR BOUND TERR1 OR TERR2 00948000 949 AND THERFORE. THE TERMINATION COUNT R2 RUST RE RESET TO TCNT1. 00949000 950 THIS IS DONE BY THE INSTRUCTION AT SK1 . 00950000 951 AL SK14, THE APPROPRI TE SERVO VALU IS IN THE ICW AND THE 00951000 952 APPHOPRIATE TERMINATION COUNT IS IN R2. THESE TWO INSTRUCTIONS 00952000 953 PUT THE TERMINATION COUNT R2 BACK ON10 THE STACK AND BRANCH TO 00953000 954 SK THUS EEXECUTING THF SERVO LOOP. 00954000 955 00955000 956 00956000 958 F8CA C005 12 SK12 LOAD R5 CIC R5 FINE SERVO ICW 00958000 F8CB 0064 959 F8CC 3095 7 BCPL R5 SET SFEK BIT OF ICW MASK 00959000 960 F8CD 5825 8 AR R5 SET ICW ITH SEEK 00960000 961 F8CE 9FF8 9 CALL SKSET,1 ANALYSIS PATCH 00961000 963 F8CF E203 6 SK13 R2 TCNT1 RESET TERMINATION COUNT 00963000 965 F800 002 6 SK14 PUS R2 SAVE TERMINATION COUNT 00965000 966 F801 8766 6 GUTO SK04 LOOP 00966000 SEEK ROUTINE SPECIAL MULTIPLICATION ROUTINE Z 968 00968000 969 00969000 970 AT ZMULTI STACK 00970000 971 R0 ZMULI RETUR ADDRESS 00971000 972 R2 SCHATCH SSLIM VALUE 00972000 973 R3 SION BIT OF R6 THRMINATION COUNT 00973000 974 R4 Z K E SEEK RETURN ADDRESS 00974000 975 R5 SCRATCH 00975000 976 R6 SERVU FRROR K K F 00976000 977 R7 SCRATCH 00977000 978 00978000 979 MOTE COMPENSATION GAIN 00979000 980 00980000 981 00981000 983 00983000 984 00984000 985 THE ZMULT ROUTINE IS USED IN THF SERVO LOOP TO MULTIPLY BY Z 00985000 986 7 .TO PERFOR THIS OPERATION ZMULT IS CALLED 3 TIMES. 00986000 987 THE PURPUSE OF ZMULT IS TO DIVINE R6 BY TWO AND ADD THIS TO R4, 00987000 988 IBUS IN CALLING ZMULT 3 TIMES WITH R6 GEING DIVIDEN BY TWO EACH 00988000 989 TIME, R4 IS SET AS FOLL9OWS R4 R4 R6 2 R6 4 R6 8. THUS, 00989000 990 SINCE R4 IS INITIALLY ZERD, R4 IS SFT R6 7 8. 00990000 991 THE FINST INSTRUCTION SHIFTS R6 RIGHT ONE PLACE, BUT THIS 00991000 992 CLEARS THE MAS OF R61 THEREFORE, THE NEXT INSTRUCTION ADDS THE 00992000 993 SIGN BIT R3 TO R6 THUS PROPASATING THE SIGN.THE FOLLOWING 00993000 994 INSTRUCTION ANDS R6 TO R4 AND THE ST INSTRUCTION RETURNS TO THE 00994000 995 SERVO LOOP. 00995000 996 00996000 997 00997000 999 F802 8540 6 ZMULT LSH R R6 R6 2 00999000 1000 F803 7623 7 R R6 R3 01000000 1001 F804 7420 7 R4 R4 R R4 RARIJAL SUM 01001000 1002 F805 100 10 RIRN HFTURN 01002000 SEEK ROUTINE SPECIAL MULTIPLICATION ROUTIME 7 1004 01004000 1005 01005000 1006 THE SIN14 ROUTINE IS USED IN THE SINIT ROUTINE TO PERFORM A 01006000 1007 SHIFT AND ADD OPERATION SHIF R5 AND ADD TO R6 . 01007000 1008 ICOMP IS AN INDIRECT LINK TO THE MCURP ROUTINE WHICH COMPUTES 01008000 1009 THE MODEL VALUE M. 01009000 1010 01010000 1011 01011000 1013 F8D6 B705 6 SIN14 LSL R5 R5 R5 2 01013000 1014 F8D7 7 25 7 R R6 R5 ADD TO PR UCT R6 01014000 1015 F8D8 B100 10 RIRN RFTURN 01015000 1017 F8D9 F960 ICOMP DATA MCONP LINK TO MCOMP ROUTINE 01017000 SEEK ROUTINE DELAY ROUTINE 1019 01019000 1020 01020000 1021 SHORT DELAY ROUTIME 01021000 1022 THE SHORT DELAY ROUTINE IS USED BY THE SEEK ROUTINE AT THOSE 01022000 1023 THOSE PLACES WHERE THE PROGRAM MUST PAUSE FOR A FIXED PERIOD OF 01023000 1024 TIME. THES OCCUNS IN THE ONE THACK OP LOOP SEEK CODE, IN THE 01024000 1025 ACK ADDRESS SA PLING CODE, AND IN THE SEEK FAILURE CODE. 01025000 1026 THE OPEN LOOP CODE THE TRACK TO TRACK SEEK ACCELERATES UP 01026000 1027 FOR A FIXED TIME PERIOD, AND THEN DEACCELERAITES FOR A FIXED TIME 01027000 1028 PERIOD.THESE TWO DELAYS USE THIS ROUTINE. 01028000 1029 THE TRACK ADDRESS SAMPLING CODE MUST PAUSE BRIEFLY AFTER THE 01029000 1030 T END OF BAP FLA HAS OCCURED IN OR ER TO INSURE THAT THE 01030000 1031 TRACK ADDRESS HAS GEEN LOADED INTO THE SPIRF XR3 . THIS DELAY 01031000 1032 ALSO SES THIS ROUTINF. 01032000 1033 THE SEEK FAILURE CODE RETRACTS THE A INTO THE LANDING ZONE 01033000 1034 FOLLOWING A SEEK FAILURE INABILITY TO LATCH UP ON TRACK . IT 01034000 1035 ACCOMPLISHES THIS BY SUPPLYING HALF ACCELERATION TOWARDS THE 01035000 1036 LANDING ZONE LONG ENOUGH TO INSURE THAT THE ARN IS THERE. THIS 01036000 1037 DELAY USES THIS ROUTINE AS WELL. 01037000 1038 AT ENTRI INTO THIS ROUTINE, R2 CONTAINS THE DELAY INDEX.THE 01038000 1039 DELAY IS PERFORMED BY LOOPING ON THE FLRST TWO INSTHUCTIONS UNTIL 01039000 1040 THE INDEX AS BEEN DECHEMENTED TO ZERO AT WHICH POINT THE CODE 01040000 1041 FALLS THROUGH TO THE THIRD INSTRUCTION WHICH RETURNS. IF THE 01041000 1042 INDEX IS EQUAL TO ZERO AT ENTRY, THE LOOP IS PERFORMED 64K TIMES. 01042000 1043 THE LOOP EXECUTES IN 12 MACHINE CYCLES. THE DVERHEAD INVOLVED 01043000 1044 IN CALLING THE ROUTINE AND RETURNING IS 19 MACHINE CYCLES. THUS 01044000 1045 FOR AN INDEX GHEATER THAN ZERO THE DELAY IS 19 12 INDEX MACHINE 01045000 1046 CYCLES. A MACHINE CYCLE IS FIXED AT 237.5 NANOSECONDS BY A 01046000 1047 CRYSTAL SCILLATORI THERFORE.FOR A DELAY INDEX GREATER THAN O, 01047000 1048 THE DELAY OF THIS ROUTIME IS 4.5125 2.R5 INDEX MICROSECONDS. 01048000 1049 01049000 1050 01050000 1052 F8DA 6 01 6 SDLAY R2 R2 1 DECHEMENT DELAY INDEX 01052000 1053 F8DB 85DA 6 BUTO SDLAY IF LOOP UNTIL ZERO 01053000 1054 F8DC 8100 10 RTRN RETURN 01054000 SEEK ROUTINE SECTOR GAP ROUTINE 1056 01056000 1057 01057000 1058 SGAP ROUTINF 01058000 1059 THE SGAP ROUTINE SERVES THE TRIPLE PURPOSE OF 1 WAITING FOR 01059000 1060 FOR A SECTOR GAP TO OCCU , THUS KEFPING TIME OEPENDENT PROCESSES 01060000 1061 SUCH AS THE SERVO LOOP IN STEPI 2 READING THE TRACK ADDRESS OUT 01061000 1062 OF THE SPI F FOLLOWING EDG END OF GAP AND 3 MONITORING THE 01062000 1063 UPBER OF SAMPLE TIMES SINCE THE SEEK BEGAN AND ABORTING THE SEEK 01063000 1064 AFTER A SPECIFIED GROSS TIMEOUT. THIS ROUTINE DOES NOT ALTER THE 01064000 1065 CONTENIS OF ANY REGISTER EXCEPT R2 IN WHICH IT RETURNS THE TRACK 01065000 1066 ADDRESS SAHPLE. 01066000 1067 THE ROUTINE BEGINS BY WRITING A TO THE FLAG REGISTER XR2 . 01067000 1068 THIS CLEARS THE EOG FLAB END OF GAP . THE NEXT TWO INSTRUCTIONS 01068000 1069 TEST THE EDF FLAG AND LOOPS UNTIL IT SETS, THUS WAITING FOR THE 01069000 1070 END OF THE SFCIOR GAP TO ARRIVE BEFORE CONTINUING. THE FOLLOWING 01070000 1071 INSTRUCTION LOADS THE FAILURE COUNT FCNT INTO R2.FCNT IS A 01071000 1072 IS A VALUE THAT WAS INITIALIZED TO THOUT AT THE START OF THE SEEK 01072000 1073 AND IS DECREMENTED EACH TIME THIS ROUTINE IS CALLED ONCE EACH 01073000 1074 SAMPLE TIME IF IT EVER REACHES ZERD BEFORE THE SEEK COMPLETES, 01074000 1075 THE SEEK IS ABORTED. THE NEXT INSTRUCTION DECREMENTS THE FAILURE 01075000 1076 COUNT R2 AND THE FOLLOWING INSTRUCTION BRANCHES TO THE FAILURE 01076000 1077 CODE IF THE COUNT HAS REACHED ZEHO OTHERWISE, THE FAILURE COUNT 01077000 1078 IS STORED BACK INTO MENORY BY THE FOLLOWING INSTRUCTION. 01078000 1079 THE NEXT TWO INSTRUCTIONS LOAD R2 WITH A DELAY INDEX AND CALL 01079000 1080 THE DELAY RODTINE. THIS SHORT DELAY IS NECESSARY TO INSURE THAT 01080000 1081 THE TRACK ADDRESS SANPLE HAS BEEN LOADED INTO THE SPIBF XR3 01081000 1082 BEFONE THAI REGISTEN IS FAD. THE FOLLOWING INSTRUCTION LOADS 01082000 1083 THE GROUND THUE TRACK ADDHESS INTO R2 FROM THE SPIRF XR3 . THE 01083000 1084 NEXT INSTROCTION COMPLEMENTS R2 LEVING IT WITH HIGH TRUE DATA. 01084000 1085 THE TRACK ADDRESS SAMPLE AS READ FROM THE SPIBF MAS THE TRACK 01085000 1086 ADDRESS VALUE IN THE HIGH ONDER 14 BITS WITH GARBAGE IN THE TWO 01086000 1087 LO ORDER BITS. THE NEXT TWO INSTHUCTIONS THEREFORE SHIFT OUT 01087000 1088 THE GARBAGE BIIS LEAVING R2 WITH THF THACK ADDRESS SAMPLE.THE 01088000 1089 NEXT INSTRUCTION RETURMS TO THE CALLING CODE. 01089000 1090 01090000 1091 01091000 1093 F8DD EA07 7 SGAP XR2 7 CLEAR FOG FLAG 01093000 1094 F8DE 2AFC 8 TST R2 XR4 15 TEST EDG FLAB 01094000 1095 F8DF 82DE 6 GOTO 1 IF LOOP UNTIL FLAG SETS 01095000 1096 F8E0 C002 12 LOAD R2 FCNT R2 TIMEOUT COUNT 01096000 F8E1 0068 1097 F8E2 A01 6 R2 R2 1 DECREMENT COUNT 01097000 1098 F8E3 82EE GOTO SFAIL IF BRANCH IF TIMEOUT FAILURE 01098000 1099 F8E4 D002 12 STOR FCNT R2 STORE UPDATED TIMEOUT COUNT 01099000 F8E5 0068 1100 F8E6 E201 6 R2 1 R2 DELAY INDEX 01100000 1101 F8E7 970A 9 CALL SDLAY CALI SHORI DELAY ROUTINE 01101000 1102 F8E8 522B 8 R2 XR3 R2 TRACK ADDRESS 16 01102000 1003 F8E9 B302 6 R2 NOT R2 R2 HIGM TRUE ADDRESS 16 01103000 1004 F8EA B542 6 LSR R2 R2 TRACK ADDRESS 8 01104000 1105 F8EB B542 LSR R2 R2 TRACK ADDRESS 4 01105000 1006 F8EC 9FF8 9 CALL TRSET,1 ANALYSIS PATCH 01106000 1107 F8ED B100 10 RTRN RETURN 01107000 SEEK ROUTINE SEEK FAILURE CODE 1109 01109000 1110 01110000 1111 AT SFAILI STACK 01111000 1112 R0 SGAP RETURN ADDRFSS 01112000 1113 R2 0 SSLIN VALUE 01113000 1114 R3 SCRATCH TERMINATION COUNT 01114000 1115 R4 SCRATCH SEEK RETURN ADDRESS 01115000 1116 R5 SCRATCH 01116000 1117 R6 SCRATCH 01117000 1118 R7 SCRATCH 01118000 1119 01119000 1120 01120000 1122 01122000 1123 01123000 1124 THE FOLLOWING CODE IS ENTERED FROM THE SGAP ROUTINE IF THE 01124000 1125 SEEK FAILS TO COMPLETE WITHIN 200 MSEC.THE PURPOSE OF THIS CODE 01125000 1126 IS TO PUT THE READ IN THE LANDING ZONE, TORN OFF CORRENT IN THE 01126000 1127 ARN, RETURN R2 EOUAL TO ZERO IN ORDER 10 REPORT SEEK FAILURE, AND 01127000 1128 HESTORE THE STACK BEFORE RETURNING TO THE CALLING PHOGRAN. 01128000 1129 THE FIRST INSTHUCTION LOADS R7 WITH A SEEK ICW VALUE. THE 01129000 1130 FOLLOWING INSTRUCTION OUTPUTS THIS VALUE TO THE ICW THUS INVOKING 01130000 1131 SEEK SERVO AND ENABLING THE SCW TO MOVE THE ARM TO THE LANDING 01131000 1132 ZUNE. THE FOLLOWING INSTRUCTION LOADS THE SCW WITH A VALUE THAT 01132000 1133 ACCELERATES THE ARM TO ARD THE LANDING ZONE AT HALF MAXIMUM 01133000 1134 ACCELERATION. THE NEXT INSTRUCTION CALLS THE DELAY ROUTINE WHICH 01134000 1135 SINCE THE DELAY INDEX R2 0 DEIAYS FOR ABOUT 187 MSEC.THIS 01135000 1136 IS SUFFICIENT TIME FOR THE ARM TO REACH THE LANDING ZONE, THE 01136000 1137 NEXT INSTRUCTION OUTRUTS A ZERO TO THE SCW WHICH TURNS OFF THE 01137000 1138 CURRENT IN THE ACTUATOR. THE NEXT TWO INSTRUCTIONS REMOVE THE 01138000 1139 TOP TWO ITEMS IN THE STACK SSLIM AND THE TERMINATION COUNT . 01139000 1140 01140000 1141 01141000 1143 F8EE B807 6 SFAIL LLIT R7 FVAL R7 ICW VALUE FOR SEEK FAILURE 01143000 F8EF AFFE 1144 F8F0 5827 8 XR0 R7 SET ICW 01144000 1145 F8F1 E910 7 XR1 SC 16 SET SCW TO HALF INWARD CURRENT 01145000 1146 F8F2 970A 9 CALL SULAY DELAY APPROX. 187 MSEC. 01146000 1147 F8F3 E900 7 XR SCW0 SET SCW TO NO ACCELERATION 01147000 1148 F8F4 8900 9 POP R0 R0 SSU N VALUE 01148000 1149 F8F5 8900 9 POP R0 R0 TER INATION COUNT 01149000 SEEK ROUTINE SEEK EXIT CODE 1151 01151000 1152 01152000 1153 AT EXIT STACK 01153000 1154 R0 SCRATCH 01154000 1155 R2 SEEK TERMINATION STATUS SEEK RETURN ADDRESS 01155000 1156 R3 SCRATCH 01156000 1157 R4 SCRATCH 01157000 1158 R5 SCRATCH 01158000 1159 R6 SCRATCH 01159000 1160 R7 SCRATCH 01160000 1161 01161000 1162 01162000 1164 01164000 1165 01165000 1166 AT ENTRI INTO THE FOLLOWING CODE.EITHER THE SEEK HAS BEEN 01166000 1167 SUCCESSFULLY COMPLETED AND THE EAD IS LATCHED U ON THE TARGET 01167000 1168 TRACK R7 0 OR THE SEEK FATLEU AND THE HEAD IS IN THE LANDING 01168000 1169 ZONE R7 NOT EQUAL 0 . THE PURPOSE OF THE FOLLOWING CODE IS TO 01169000 1170 RESTORE THE STACK AND RFTURN TO THE CALLING PROGRAM. 01170000 1171 THE FIRST INSTRUCTION RESTORFS THE STACK BY POPPING THE SEEK 01171000 1172 RETURN ADDRESS BACK TO THE TOP OF THE STACK R0 .THE FOLLOWING 01172000 1173 INSTRUCTION THEN NETURNS TO THE CALLING PROGRAM. 01173000 1174 01174000 1175 01175000 1177 F8F6 8900 9 EXIT POP R R0 SEEK RETURN ADDRESS 01177000 1178 F8F7 100 10 RTRN RETURN FRU SEEK 01178000 SEEK ANALYSIS PATCHES 1180 01180000 1181 01181000 1182 THE FOLLOWING DATA VALUES PROVIDE THE LINK RETWEEN THE SEEK 01182000 1183 ROUTINE ANALYSIS HODKS AND THE DATA EXIRACTION ROUTINES IN THE 01183000 1184 SEEK CONTROL PROGRAM. 01184000 1185 01185000 1186 01186000 1188 F8F8 FA01 SKSET DATA ORG 201 LINK TO SKSFT ROUTINE 01188000 1189 F8F9 FA02 SKCLA DATA ORG 202 LINK TO SKCL ROUTINE 01189000 1190 F8FA FA03 SCWST DATA ORG 203 LINK TO SCWST ROUTINE 01190000 1191 F8FB FA04 THSET DATA ORG 204 LINK TO TRSFT ROUTINE 01191000 1192 F8FC FA05 EKSET DATA ORG 205 LINK TO FRSFT ROUTINE 01192000 SEEK ROUTINE LINK TO SGAP ROUTINF 1194 PORG ORG 15F 01194000 1195 DOHG num 01195000 1197 01197000 1198 01198000 1199 LINK TO SGAP ROUTINE USED IN LOGICAL SEEK ROUTINE 01199000 1200 01200000 1201 01201000 1203 F95F F8DD IGAP DATA SGAP LTMK TO SGAP ROUTINE 01203000 SEEK ROUTINE MODEL CUMPUTATION ROUTINE 1205 01205000 1206 01206000 1207 THIS ROUTINE COMPUTES THE MODEL POSITION FROM THE ETASQ VALUE 01207000 1208 AND THE MOUEL ACCELERATION, AT ENTRY IMTO THIS ROUTINE, ETASQ IS 01208000 1209 CONTAINED IN R4 THE ETA SQUARE VA UE , AND THE PTARG VALUE IS 01209000 1210 CONTAINED IN R3.PTARG IS THE ADJUSTED TARGET VALUE FOR MODEL 01210000 1211 CORPUTATIONS IT IS POSTIVE FOR OUTWARD SEFKS AND NEGATIVE FOR 01211000 1212 IN ARD SEEKS. 01212000 1213 THE MODEL POSITION IS COMPUTED USING THE PTARG VALUE AND THE 01213000 1214 EQUATION X A T 2 2, WHERE X IS DISTANCE, A IS ACCELLERATION, AND 01214000 1215 IS TIME. IN THIS EQU TION IF T 2 IS EQUAL TO ETASQ AND A IS 01215000 1216 EQUAL TO THE MODEL ACCE ERATION, THEN x WILL BE THE DISTANCE 01216000 1217 FROM THE MODEL T RGET PTARG . SINCE THE MODEL POSITION IS TO BE 01217000 1218 CO PUTED IN FIGHTHS OF TR C S, THE FQUATION MUST BE MULTIPLIED BY 01218000 1219 EIGHT TO YIELD X 4 A ETASQ IN EIGHTHS OF TRACKS . ACCELLERATION 01219000 1220 OF THE MODEL IS EQUAL TO 75 OF THE FULL ACCELERATION OF THE ARN. 01220000 1221 THIS VALUE IS A CONSTANT EQUAL TO .1796875 TRACKS SAMPLE 2.THE 01221000 1222 VALUE OF 4 A IS THEREFORE EQUAL TO ,71875 TRACKS SAMPLE 2. THE 01222000 1223 EQUATION IS THEREFORE X ETASO .71875. THIS COMPUTATION IS DONE 01223000 1224 BY THE FIRST TEN INSTRUCTIONS WHICH MULTIPLY FTASQ R4 BY THE 01224000 1225 VALUE .71875 AND LEAVE THE ROUMDED RESULT IN R5. 01225000 1226 THE NEXT INSTRUCTION ADDS THIS VALUE TO PTARG. FOR OUTWARD 01226000 1227 SEEKS THIS VALUE IS PTARG.X WHICH EQUALS THE MODEL POSITION AND 01227000 1228 FOR INWARD SEEKS THIS VALUE IS ABSIPTARG X WHICH EQUALS THE 01228000 1229 NEGATIVE MODEL POSTION, THE NEXT TWO INSTRUCTIONS CONVERT THE 01229000 1230 MODEL POSITION TO A POSITIVE VALUF WHICH IS STORED IN M BY THE 01230000 1231 FOLLOWING INSTRUCTION.THE ROUTINE THEN RETURNS WITH THE MODEL 01231000 1232 POSITION I R5. 01232000 1233 01233000 1234 01234000 1236 F960 8524 7 M OMP R5 R4 R5 R4 .71875 M 8 01236000 1237 F961 8545 6 LSR R5 01237000 1238 F962 7524 7 R5 S5 R4 01238000 1239 F963 8545 6 LSR R5 01239000 1240 F964 7524 7 R5 R5 R4 01240000 1241 F965 8545 6 LSR R5 01241000 1242 F966 8545 6 LSR R5 01242000 1243 F967 7524 7 R5 R5 R4 01243000 1244 F968 8545 6 LSR R5 01244000 1245 F969 8225 6 ADDC R5 ROUND TO NE REST EIGHTH OF A TRACK 01245000 1246 F96A 7523 7 R5 R5 R3 ADD ADJUSTED TARGET VALUE 01246000 1247 F96B 816D 6 BOTO 2 IF SKIP IF PUSITIVE 01247000 1248 F96C B335 6 R5 R5 R5 NODEL POSITION 8 01248000 1249 F96D D005 12 STOR M R5 STOR NEW NODEL POSTION VALUE 01249000 F96E 006C 1250 F96F B100 10 RTHN RETURN 01250000 SEEK ROUTINE END OF ROUTINE 1252 01252000 1253 01253000 1254 END OF SEEK ROUTINE 01254000 1255 01255000 1256 01256000 1258 END 01258000 CROSS REFERENCE TARLECICW 100 LIT 78 950 871CTRK 102 LIT 77 782DLY1 408 LIT 118 741DLY2 556 LIT 119 745DOFF1 24 LIT 284 314DOFF2 11 LIT 285 316DOFF3 9 LIT 286 317ERSET F8FC ROM 1192 601 514ETA2 107 LIT 73 787 698 693 454ETASQ 106 LIT 74 702 699 452EXIT F8F6 RUM 1177 922FCNT 104 LIT 75 1099 1096FVAL 20482 LIT 112 1143ICDMP F8D9 ROM 1017 704 455IGAP F95F ROM 1203 M 108 LIT 72 1249 784 597MAXV 0 LIT 111 510HCOMP F960 ROM 1236 1017ORG 2048 LIT 28 1194 1192 1191 1190 1189 1188 121PTARG 103 LIT 76 703 325SCW0 0 LIT 108 1147SCW16 16 LIT 109 1145SCW31 31 LIT 106 202SCW63 3 LIT 107 156SCWMX 31 LIT 113 654 652SCWST F8FA ROM 1190 747 662 232SDLAY F8DA ROM 1052 1146 1101 1053 746 742SEEK F8OO ROM 152 SFAIL F8EE ROM 1143 1098SGAP F8OD ROM 1093 1203 598 502 500 499 164 163SINIT F81A ROM 314 SINTI F82A ROM 364 378 SINT2 F837 ROM 377 373SINT3 F846 ROM 446 451SINT4 F8D6 ROM 1013 408 406SK01 F8DF ROM 200 160SK02 F812 ROM 203 159SK03 F856 ROM 501 511 506SK04 F866 ROM 558 966 705SK05 F884 ROM 661 516SK06 F898 ROM 741 236SK07 F8A1 ROM 748 165SK08 F8A5 ROM 782 697SK09 F8AE ROM 834 695SK10 F8BE ROM 911 839SK11 F8C6 ROM 919 914SK12 F8CA ROM 958 912SK13 F8CF ROM 963 866SK14 F8D0 ROM 965 920 918 875 870SKCLR F8F9 ROM 1189 87 SKSET F8F8 ROM 1188 961 234SSLIM NO RE 79 TCNT1 3 LIT 114 963 153TCNT2 LIT 116 916 674TERR1 LIT 115 867TERR2 LIT 117 911TRSET F8F ROM 1191 1106ZHULT F8D2 ROM 999 564 567 561 NUMBER OF PASS 2 ERRORS 0 NUMBER OF PASS 2 WARNINGS 0