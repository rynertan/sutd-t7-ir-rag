# MULTI DIMENSIONAL CODING FOR ERROR REDUCTION

## Claims
Vorrichtung zur Kodierung von k Informationsbits mit k 4 in ein vierdimensionales Kodewort mit

## Description
This invention relates to coding information so as to reduce errors caused by transmission from being included in the received signal and, in particular, to multi dimensional coding. When information is sent from a transmitter over a channel to a receiver, the information signals are often distorted by noise and other causes. Sometimes the information signals are distorted to such an extent that the received signals do not duplicate the information sent. In order to reduce errors in the received signals, the information is coded at the transmitter. There are two basic coding schemes block coding and convolution coding. These coding schemes are explained in detail in a book entitled Error Control Coding Fundamentals and Applications by S. Lin et al. Simply stated, block coding introduces n k redundant bits to a block of k bits of information to derive a coded block of n bits which is transmitted to a receiver. For binary signals, there are 2 U. S. Patent No. 4,077,021 teaches a technique called set partitioning that assigns signal points to successive blocks of input data. More particularly, a code rate of 4 bits 2 dimensional symbol is shown. Also, a coding gain of 4 db over standard uncoded transmission is obtained. That is, noise immunity is obtained without increasing the power required for transmission. As will be described fully in the detailed description of the present invention, it is desirable to obtain a more efficient coding scheme. A paper by A. Gersho and V.B. Lawrence in IEEE International Conference on Communications, Amsterdam, l4th 17th May 1984, vol. 1, pages 377 380, entitled Multi dimensional Signal Design for Digital Transmission over Bandlimited Channels discloses a coding arrangement in which each word of, say, eight bits is divided into three groups of bits of variable length. The first group, which may contain from 2 to 4 bits, determines the numbers of bits in the other groups. The first and second groups together address an unsigned four dimensional code word and the third group determines the signs of the non zero components of the code word. This paper also discloses that a ROM table look up can be used to assign a code word to each word. IBM Technical Disclosure Bulletin, vol. 26, no. 2, July 1983, pages 662 664 discloses a coding scheme in which a 6 bit word is divided into two groups, containing four and two bits respectively. The two bits in the second group are expanded to three bits by an eight state convolutional code i.e. a convolutional code using three bits of memory . The three bits of the expanded second group are used to specify one of eight subsets into which a two dimensional constellation of 128 points is divided, and the four bits of the first group are used to determine which point within the specified subset is used. The invention as claimed in claims 1 and 4 provides a coding apparatus and method respectively which 1 reduces the power consumed, 2 achieves a high code rate, and 3 achieves efficiency in terms of low power use and low error in the received signal. More particularly, according to one embodiment of the present invention, an information block comprising eight bits of input to the coder is converted into any one of five hundred and twelve four dimensional code words. The eight bits are changed into an output having nine bits by retaining two input bits from the immediately preceding block and one input bit from two preceding blocks. The output is divided into two signal groups a first group comprises five bits and a second comprises four bits. The first group having five uncoded bits, addresses any one of thirty two 2⁵ 32 locations of a read only memory. Each location has a code word comprising four numbers, representing the coordinates of a point in four dimensional space. The numbers appearing in the thirty two code words include 1, 1, 3, 3, 5 and 5. These code words are shown in tables 1 and 2, included in the detailed description of the invention hereinbelow. The second group of four bits makes up a vector which determines the sign of the four dimensional code word read from the read only memory. This scheme is equivalent to having the code word read from any page of a code book having sixteen 2⁴ 16 pages, each page having thirty two code words entered therein. Thus, there is disclosed a trellis code with rate of eight bits per four dimensional symbol with a gain of 4.7 decibels over standard uncoded transmission. This 0.7 decibel increase over the aforesaid prior art code systems corresponds to improving the block error rate by a factor of 10. The signal constellation comprises five hundred twelve four dimensional signal points, that is, each symbol has a set of four numbers which defines a signal point in four dimensional space. By way of comparison, first, transmission of two consecutive two dimensional signals using one of the prior art codes with rate four bits per two dimensional symbol would require the equivalent of 1, 024 because 32² 1024 four dimensional signal points. That is, the size of the code is reduced. Second, the restriction of the five hundred twelve point constellation to the first two coordinates, or to the last two coordinates, requires only a set of thirty two signal points. This code rate of eight bits per four dimensional symbol is suggested for data transmission rates of 9.6 kbits sec. In another embodiment of the present invention, a trellis code with rate twelve bits per four dimensional symbol provides a gain of 4.9 db over standard uncoded transmission. This method is suggested for data transmission rates of 14.4 kbits sec. In the limit, when the number, k, of bits in a block approaches infinity, the coding gain is asymptotic to 4.9715 decibels. That is, the difference between the limiting gain and that provided with k 12 is very small. FIG. 1 is a prior art system for transmission of encoded signals FIG. 2 illustrates the concept of convolutional encoders FIG. 3 shows possible transitions of states between two instants in time FIG. 4 illustrates error events and the term Euclidean distance FIG. 5 shows a convolutional encoder of memory order three FIG. 6 shows a signal constellation for uncoded transmission at the rate four bits per two dimensional symbol FIG. 7 shows a convolutional encoder embodying the present invention FIG. 8 shows a rectangular constellation for uncoded transmission at six bits per two dimensional symbol and FIG. 9 shows a signal constellation for trellis codes at the rate four bits per two dimensional symbol. Referring to FIG. 1, there is shown a prior art system comprising a digital source 10 supplying a signal to encoder 12. The coded signal from encoder 12 is modulated by device 14 for transmission to a distant location where the signal is demodulated at device 18. The demodulated signal is thereafter decoded at device 20 and sent on to a digital sink 22. The use of encoder 12 reduces the errors caused by noise in the transmission facility 16. The present invention relates to an improvement in the aforesaid encoder 12. It is necessary to disclose the theoretical basis for the present invention in order to fully appreciate it. Assume that an input block of k bits from a serial bit stream is first converted by a series to parallel converter such as device 70 in FIG. 7, such converters being well known, to an input of k parallel bits function x of the v k variables is the state of the encoder and there are 2 Referring to FIG. 3, there is shown a state transition diagram from time i to time i 1 for a trellis code with k 3, v₁ 0, v₂ 1, and v₃ 2. Looking briefly ahead to FIG. 5, there is shown a coder, which is an application of FIG. 2, where the a i 1 sequence has no memory, that is, v₁ 0, or uncoded where a i 2 sequence has one bit of memory, that is, v₂ 1 and, where the a i 3 sequence has two bits of memory, that is, v₃ 2. Because three bits of memory exist, there are 2³ 8 eight states for the coder. The three bits shown at time i are the bits stored for a₂ at time i 1 , that is, a i 2 ¹ for a₃ at time i 1 , that is, a i 3 ¹ and a₃ at time i 2 , that is, a i 3 ². An edge joins two states at time i and i 1. Each edge is double in this case, as will be explained below, but only shown drawn singly to simplify the drawing. The state transition diagram can be understood by examining, for example, the transition from the state 010 at time i to a state at time i 1. Remembering that at time i the 1 in state 010 is a i 3 ¹, at time i 1 this i the 1 in state 010 is a i 3 ¹, at time i 1 this bit 1 will now be a i 3 ² and can be any one of the four codes which end in a 1 001, 101, 011, or 111 depending on the next value of a i 2 ¹ and a i 3 a i 3 ¹. Returning to the theoretical basis, noise in the transmission channel distorts the sequence of signals from the output of the coder The Viterbi algorithm, disclosed at An error event E of length 1 lasts from j to j l , the sequence x and Referring to FIG. 4, there is shown an error event for which the squared Euclidean distance is The average transmitted power is given by For small noise variance σ², the minimum distance d Basic to the trellis codes of the embodiment disclosed hereinbelow is a rate 3 4 binary convolutional code with a total memory 3 and free distance 4. A portion of the encoder is shown in FIG. 5 which has been disclosed in the aforesaid Lin book at page 292. The three parallel input sequences a i 1, a i 2 and a i 3 determine the output sequence v v i 1, v i 2, v i 3, v i 4 according to the rules The bits a i 2 ¹, a i 3 ¹, and a i 3 ² The binary notation 0,1 is then changed to 1, 1, respectively. An edge joining two states is then labelled with a pair of vectors w₁, w₂, w₃, I w₄ and w₁, w₂, w₃, w₄ where w Thus far, a trellis code at the low rate 3 bits 4 dimensional symbol was disclosed. Transmission at higher rates, say 8 bits 4 dimensional symbol or 12 bits 4 dimensional symbol requires more channel symbols. Indeed, as is readily apparent from the disclosure thus far, in order to achieve any coding gain, more symbols are needed than for uncoded transmission at the same rate. Referring to FIG. 6, there is shown a rectangular constellation comprising sixteen 2⁴ 16 signal points for standard uncoded transmission, of binary input, at the rate of 4 bits 2 dimensional symbol. For uncoded transmission of a 4 dimensional symbol, two copies of the constellation shown in FIG. 6 are needed, yielding 256 16 x 16 256 possible signals. Using the formula developed earlier herein, the average power or energy is For coded transmission, however, 512 signal points are used, namely, twice the signal constellation for uncoded transmission of 4 dimensional symbols. This is so because a block of eight input bits is converted to nine bits using three bits from prior blocks and 2⁹ is 512. This conversion will become clear by referring to FIG. 7, wherein is shown a stream of binary bits on lead 71 converted from serial to parallel in converter 70 and then sent on via two sets of leads 73 and 51. The first set of leads 73 carries five uncoded bits which are converted from binary form by changing a 0 to a 1 and a 1 to a 1 in a binary converter 72 and then sent on via leads 75 to address any one of thirty two 2⁵ 32 code words, representing signal points, from a storage device such as read only memory ROM 74. Because each code word defines a point in four dimensional space, four numbers are required for each code word. The numbers of the addressed code word are passed via leads 77 to multipliers 82 ... 88. Representative signal points are shown in Table 1 hereinbelow. The first column of Table 1 shows the code words representative of signal points in four dimensional space. The number of permutations for each representative code word is shown in column three, giving a total of thirty two code words stored in ROM 74. The list of thirty two code words is obtained by permuting the coordinates of the code words in column one. The second set of leads 51 from serial to parallel converter 70 carries three of the binary input bits to a device 50 which stores three bits from prior blocks as disclosed in detail earlier herein with reference to FIG. 5, and delivers four bits on leads 53 to a device 80. At device 80 the binary bit 0 is converted to 1 and a binary 1 is converted to a 1. The vector W of four bits W₁, W₂, W₃, and W₄ are then delivered to multipliers 82 ... 88. The amber y₁ of the accessed code word is then multiplied by W₁ from lead 81 at multiplier 82 to generate output x₁. Likewise, x₂, x₃, and x₄ are generated and sent over leads 89. Because there are four bits W₁, W₂, W₃, and W₄, and because there are two values 1 or 1 for each, together there can be sixteen 2⁴ 16 different permutations of these bits. Because there are thirty two signal points x₁ x₂ , x₃ x₄ in the set S w which satisfy the requirement x The set of coordinates x₁, x₂, x₃, x₄ representing the input block of 8 bits on leads 89 is then sent on to a modulator. The present invention relates to an encoder only and therefore other equipment cooperating with the encoder is not disclosed in any detail, beyond what was disclosed earlier with reference to FIG. 1. The distance d A, B between two sets of vectors A and B is given by the expression To verify M1 , let x x₁ Earlier hereinabove, a trellis code with rate 3 bits 4 dimensional symbol having a minimum squared distance d 2 m The properties M1 and M2 guarantee that the squared distance of any error event is at least 16. Consider any error event in the eight state trellis of length 1. If the squared distance for the low rate code is Referring to FIG. 8, there is shown a signal constellation comprising sixty four signal points which is used for standard uncoded transmission at the rate of 6 bits 2 dimensional symbol. To transmit a 4 dimensional symbol at a rate of 12 bits symbol, a constellation comprising two such copies are needed. The number of possible signals will be 4,096 64 x 64 4096 . The average signal power For coded transmission using three bits from prior blocks, 8,192 2 In order to obtain a transmission rate of 12 bits 4 dimensional symbol it is necessary to add nine uncoded bits to the four derived bits from FIG. 5, to obtain a total of 13. There are now 1024 parallel transitions between states a i 2 ¹ a i 3 ¹ a i 3 ² and and the coding gain is Summarizing the aforesaid disclosure, in order to achieve coded transmission at a rate of k bits per four dimensional signal, k 3 uncoded bits are added to the low rate trellis code, that is, 3 bits per four dimensional symbol, as disclosed hereinabove, with reference to FIG. 3. There are 2 Coded transmission requires 2 It can be shown that as k increases, that is, in the limiting case, the limiting coding gain is 10 log₁₀ π 4.914 db. That is, the maximum coding gain is 4.914 db. But the coding gain for twelve bits per four dimensional symbol is 4.904 db and the coding gain for eight bits per four dimensional symbol is 4.717 db. Thus, the scheme disclosed by the present invention is an efficient method of coding.