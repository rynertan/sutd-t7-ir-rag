# VOLTAGE CONTROLLED OSCILLATOR

## Claims
Spannungsgesteuerter Oszillator zum Erzeugen eines Ausgangssignales mit einer Frequenz entsprechend einer dort anliegenden Eingangsspannung, dadurch gekennzeichnet, daß der spannungsgesteuerte Oszillator aufweist

## Description
The present invention relates to a voltage controlled oscillator VCO for producing an output signal of a frequency corresponding to an input voltage applied thereto. In a PLL phase locked loop frequency synthesizer, for example, it is required that the frequency of the output signal always be equal to a preset frequency. To this end, a voltage controlled oscillator VCO is usually employed. A typical example of such a VCO is found in Fig. 1 and 3 in Japanese Patent Disclosure KOKAI No. 59 62215. The output frequency of this prior art tends to vary when process parameters are varied during manufacturing. For example, the thickness of the oxide film can vary and capacitances of the capacitors in the oscillator can change. Variation of the gate lengths of transistors results in variation of the current values for charging the capacitors of the manufactured oscillators. Consequently, the process parameters inevitably vary when the circuit is IC fabricated. This would suggest that the oscillating frequencies of the fabricated oscillators are not invariable for the chips containing them, and that the production yield is reduced. To solve this problem, Japanese Patent Disclosure KOKAI No. 59 29209 discloses an improved voltage controlled oscillator. A block diagram of the VCO shown in Fig. 2b of the KOKAI is shown in Fig. 1 of this specification. In Fig. 1, first and second oscillators 21 and 22 have equal circuit arrangements and circuit patterns. These oscillators 21 and 22 each oscillate at a frequency corresponding to a the sum of the voltages applied to voltage input terminals CONT and OFFSET. A reference voltage Vref is applied to the terminal CONT of the oscillator 21. The reference voltage Vref is obtained by dividing the power voltage by the resistance capaciters, for example. A signal Nref of the reference frequency f The output signal of a second phase comparator 25 is applied, as an input voltage Vin, to the voltage input terminal CONT through a second low pass filter 26. The signal output from the filter 24 is applied to the input terminal OFFSET of the oscillator 22. With such a connection, when a voltage equal to the reference voltage Vref is applied to the input terminal CONT of the oscillator 22, the oscillator 22 oscillates at a frequency equal to that of the first oscillator 21. In this way, the Fig. 1 circuit is controlled, independant of varied process parameters, so as to oscillate at the reference frequency when the input voltage to the second oscillator 22 is equal to the reference voltage. Thus, even if the process parameters vary, the Fig. 1 circuit constantly oscillates at the fixed frequency f However, if the input voltage Vin shifts to differ in value from the reference voltage Vref, the oscillating frequency is influenced by the change in the process parameters. The oscillating frequency of the Fig. 1 circuit is given by In the above equation, when the process parameters are varied, the proportional coefficient changes. The change of the α changes the inclination of a characteristic curve of the output frequency to input voltage. This is well illustrated in Fig. 2 in which the abscissa represents the input voltage Vin, and the ordinate, the output frequency f Further, in the Fig. 1 circuit, the process gain variation results in a change in a gain as defined by the ratio of change in the oscillating frequency to a change in the input voltage, and hence, a change in the loop gain of the PLL. The loop gain variation leads to variation in important characteristics such as damping and pull in characteristics as well as in the response characteristic. Accordingly, an object of the present invention is to provide a voltage controlled oscillator of which the input voltage vs. output frequency is not varied even if process parameters are varied when it is manufactured. To solve this object the present invention provides a voltage controlled oscillator as stated in claim 1. With such an arrangement, even if various process parameters, for example, capacitances of capacitors, gate lengths of transistors, threshold values of transistors are varied when the VCO circuits are integrated or fabricated, the output frequency of the circuit is free from the influence of the various process parameters. Therefore, a VCO circuit having an output frequency corresponding exactly to an input voltage can be fabricated. This invention can be more fully understood from the following detailed description when taken in conjunction with the accompanying drawings, in which A voltage controlled oscillator according to an embodiment of the present invention will be described referring to the accompanying drawings. The circuit arrangement of the voltage controlled oscillator will first be described referring to Fig. 3. In Fig. 3, an oscillating section 30 produces, at the output terminal OUT, a signal of a frequency as defined by voltages applied to first and second voltage input terminals IN1 and IN2. The output voltage Vc of an operational amplifier 31 is supplied as a first input voltage to the first voltage input terminal IN1. An input voltage Vin is supplied as a second input voltage to the second voltage input terminal IN2. The output frequency of the oscillating section 30 is controlled by the input voltage Vin. The output terminal of the operational amplifier 31 is also coupled with the gate of a P channel MOS transistor 32. The transistor 32 operates in a saturation region and serves as a constant current source for generating a current dependent on the output voltage Vc. The source of the transistor 32 is coupled with a terminal or a point to which power voltage VDD is applied. This terminal will frequently be called a VDD supply. The drain of the transistor 32 is connected to one of the fixed contacts of a first switch 33. The other fixed contact of the switch 33 is connected to one of the fixed contacts of a second switch 34. The other fixed contact of the second switch 34 is coupled with a terminal or a point to which ground potential VSS is applied. This terminal will be frequently called a VSS supply. A node 35 between the first and second switches 33 and 34 is coupled with one of the electrodes of a capacitor 36. The other electrode of the capacitor 36 is connected to the VSS supply. The one electrode of the capacitor 36 is additionally coupled with the input terminal of a sample hold circuit 37. The output terminal of the sample hold circuit 37 is connected to a positive input terminal of the operational amplifier 31. A reference voltage Vref is supplied to a negative input terminal of the operational amplifier 31. A timing control circuit 38 is provided for controlling timings of the operations of the switches 33 and 34 and the sample hold circuit 37. The timing control circuit 38 is connected to movable contacts of the first and second switches 33 and 34, and further to the sample hold circuit 37. The timing control circuit 38, thus coupled, supplies a first control signal S1 to the first switch 33, a second control signal S2 to the second switch 34, and third and fourth control signals S3 and S4 to the sample hold circuit 37. A circuit arrangement of the oscillating section 30 illustrated in block form in the Fig. 3 circuit will be given in detail referring to Fig. 4. The output terminal of the operational amplifier 31 is connected to the gate of a P channel MOS transistor 41. The transistor 41 is operated in the saturation region. As such it operates as a constant current source for feeding a current dependent on the output voltage Vc of the operational amplifier 31. The source of the transistor 41 is connected to the VDD supply. The drain of the transistor 41 is coupled with the source of a P channel MOS transistor 42. The drain of the P channel MOS transistor 42 is connected to the drain of an N channel MOS transistor 43. The source of the transistor 43 is connected to the VSS supply. The gates of the transistors 42 and 43, which serve as switches, are interconnected. Similarly, the drain of the transistor 41 is connected to the source of a P channel MOS transistor 44. The drain of the transistor 44 is connected to the drain of an N channel MOS transistor 45. The source of the transistor 45 is grounded. These transistors 44 and 45 are interconnected at their gates and act as switches. The connection point of the drains of the transistors 42 and 43 is connected to one of the electrodes of a capacitor 47. The capacitor 47 is connected to the VSS supply. Similarly, the connection point between the drains of the transistors 44 and 45 is connected to one of the electrodes of a capacitor 49. The other electrode of the capacitor 49 is connected to the VSS supply. The one electrode of the capacitor 47, i.e., the node 46 is connected to the positive input terminal of a first comparator 50. The one electrode of the capacitor 49, i.e., the node 48 is connected to the positive input terminal of a second comparator 51. The input voltage Vin is applied to the negative input terminals of the comparators 50 and 51. The output signal of the first comparator 50 is connected to the set input terminal of a flip flop FF 54. The output terminal of the second comparator 51 is coupled with the reset input terminal of the FF 54. The FF 54 is of the known type in which two NOR gates 52 and 53 are cross coupled with each other. The Q output terminal of the FF 54 is connected to the gates of the transistors 42 and 43. The The operation of the voltage controlled oscillator illustrated in Figs. 3 and 4 will be described referring to the timing charts of Figs. 5A to 5D and Figs. 6A to 6C. It is assumed that the FF 54 is set. On this assumption, the Q output signal of the FF 54 is logical 1 or high in level, while the As the increasing potential VB reaches the input voltage Vin, the second comparator 51 produces a signal of logical 1 . The logical 1 signal goes to the reset terminal of the FF 54. Then, the FF 54 is reset with the Q output being logical 0 and the Responsive to the level changes of the Q signal and the Turning on of the transistor 42 allows a current flow from the VDD supply to ground through the transistors 42 and the capacitor 47. The current 12 charges the capacitor 47. With progression of the charging, the potential VA at one side of the capacitor 47 increases linearly, as shown in Fig. 5A. As the increasing potential VA reaches the input voltage Vin, the output signal of the first comparator 50 becomes logical 1 . The result is that the FF 54 is again set, with the Q output signal being logical 1 and the In response to the level changes of the Q and Subsequently, an operation similar to the above is repeated. In this way, the Q and The oscillating frequency of the output signal can be varied by changing the output voltage Vc of either the operational amplifier 31 or the input voltage Vin. The frequency where C47 and C49 are capacitances of the capacitors 47 and 49. I41 is the current flowing through the transistor 41. TD0 is a signal delay time of the first comparator 50. TD1 is a signal delay time of the second comparator 51. If C47 C49 C, and TD0 TD1 TD, the equation 2 can be simplified as The operation of the overall VCO shown in Fig. 3 will be described. The timing charts shown in Figs. 6A to 6C illustrate the operation of the VOC except the oscillating section 30. The timing control circuit 38 produces the first and second control signals S1 and S2 at the timings shown in Figs. 6A and 6B. As shown, in the signal S1, a logical 0 state continues for a period T0. In the signal S2, the logical 0 state still continues for a predetermined period of time after the signal S1 is pulsed to the high level or logical 1 . The first switch 33 keeps an ON state during the period T0 that, the signal S1 is logical 0 . For the logical 0 period, current flows through a path of the transistor 32, the switch 33, and the capacitor 36. This current charges the capacitor 36. As recalled, the value of the current depends on the output voltage Vc of the operational amplifier 31. As the charge progreses, the potential Vd of the one electrode of the capacitor 36 increases at a fixed rate of change. Then, when the signal S1 is logical 1 , the first switch 33 is turned off, and the charging of the capacitor 36 stops. The capacitor 36 keeps the voltage Vd at the maximum value. Then, the second control signal S2 is pulsed from logical 0 to logical 1 , and the second switch 34 is turned on. The capacitor 36 is discharged and the voltage Vd drops to logical 0 . During the period that the signal S1 is logical 1 and the signal S2 is logical 0 , the sample hold circuit 37 operates to sample the maximum value of the voltage Vd and to produce it as the output voltage Ve. The held voltage, or the output voltage Ve of the sample hold circuit 37 is applied to the operational amplifier 31. The operational amplifier 31 compares the voltage Ve with the reference voltage Vref. The voltage Vc representing the result of the comparison is applied to the gate of the transistor 32. Such a sequence of operations is repeated, until, finally, the voltage Vc is controlled to have a value such that the voltages Ve and Vref are coincident with each other. It is assumed now that the capacitance of the capacitor 36 is C36, and the current flowing through the transistor 32 is I32. Since the capacitor 36 of capacitance C36 is charged by the current I32 for the period T0, the final value Vem of the voltage Ve is The gate of the transistor 32 is connected to the gate of the transistor 41 of the oscillating section 30. Therefore, the current I32 flowing through the transistor 32 is proportional to the current flowing through the transistor 41. It is assumed that G is a ratio of the currents I32 to I41, which depends on a ratio of geometrics between these transistors. With this relation, the equation 3 can be rewritten as Rearranging the equation 5 with respect to I32, we have Assuming that G 1, that is, the transistors 32 and 41 are equal in channel width and channels length, the capacitance of the capacitor C36 is C like the capacitors 47 and 49, and, further, the delay time TD is zero, the equation 7 can be simplified into In the equation 8 , the factor T0 can be set up exactly if a crystal oscillator for clock pulse oscillation is used for the timing control circuit 38, and an exact value of the reference voltage Vref can easily be realized. Hence, the equation 8 shows that the frequency of the output signal from the VCO under discussion depends solely on the input voltage Vin, that is, it is independent of the influences of the process parameters of MOS transistors. When Vin Vref, the oscillating frequency In connection with the IC fabrication of the VOC, the capacitances of the capacitors and the widths and lengths of the transistors in one chip are generally different from those in another chip. Within one chip, the absolute values of the capacitance and the gate length, may be changed, but the ratio of capacitances and gate lengths between or among the capacitors can be easily established as a constant. In the embodiment described above, the capacitors 36, 37 and 39 have the same capacitance C, and the current ratio G is 1. Nonetheless, the present invention is not limited to this embodiment. The capacitors may have different capacitances, and the gate length and other structural features of each transistor may be changed. Circuitry including the switches 33 and 34, the sample hold circuit 37 and the reference voltage Vref, will be described referring to Fig. 7. The first switch 33 is constructed with a P channel MOS transistor. One end of the current path of this MOS transistor is connected to the P channel MOS transistor 32, and the other end to the second switch 34. The gate of the MOS transistor of the first switch 33 is connected for reception to the first control signal S1. The second switch 34 is constructed with an N channel MOS transistor. One end of this MOS transistor is connected to the first switch 33, while the other end is connected to the VSS supply. The gate of the MOS transistor receives the second control signal S2. The sample hold circuit 37 is comprised of first and second CMOS analog switches 61 and 62, and capacitors 63 and 64. The first analog switch 61 is made up of P channel and N channel MOS transistors of which the current paths are connected in parallel. The node of the interconnection between one set of ends of the current paths of the paired transistors is connected to one of the electrodes of the capacitor 36. The third control signal S3 is supplied to the gate of the N channel MOS transistor in the analog switch 61. The control signal S3 is inverted by an inverter and supplied to the gate of the P channel MOS transistor of the same switch 61. The output terminal of the first analog switch 61 is connected to one of the electrodes of a capacitor 63. The capacitor 63 is earthed at the other electrode. The analog switch 62 has substantially the same circuit arrangement as that of the first analog switch 61, and is under the control of the fourth control signal S4. The input terminal of the analog switch 62 is coupled with the output terminal of the first analog switch 61 and the capacitor 63. A capacitor 64 is inserted between the output terminal of the second analog switch and ground. The node between the output terminal of the second analog switch 62 and the capacitor 64 serves as an output terminal of the sample hold circuit 37. The capacitor 64 may be a stray capacitance present in association with the output terminal of the second switch 62 and the input terminal of the operational amplifier 31. The reference voltage Vref applied to the negative input terminal of the operational amplifier 31 is derived from a node between resistors 65 and 66, which are connected in series between the VDD supply and ground. Thus, the VDD voltage is divided according to the resistance ratio of these resistors. The divided voltage is used as the reference voltage Vref. The operation of the voltage controlled oscillator as illustrated in Fig. 7 will be described referring to Figs. 8A to 8F. The control signals S1 to S4 are formed using the clock pulses CLK shown in Fig. 8A. In this embodiment, the trailing edge of the signal S1 Fig. 8B is delayed by a given period td behind the trailing edge of the signal S2. This indicates that the charge time of the capacitor 36 is T0 td . When the signal S1 is logical 0 , the first switch 33 is turned on. At this time, the signal S2 is logical 0 and the second switch 34 is in an off state. Under this condition, the capacitor 36 is charged. The charged voltage of the capacitor 36 rises linearly. When the signal S1 is logical 1 , the first switch 33 is turned off to terminate the charging of the capacitor 36. Then, the signal S3 becomes logical 1 , so that the charged potential across the capacitor 36 is kept by the capacitor 63. Subsequently, the signal S4 becomes logical 1 , and the voltage across the capacitor 63 is kept by the capacitor 64. After the signal S3 becomes 1 in logical level, the signal S2 is pulsed to logical 1 to allow the discharge of the capacitor 36. The signal S4 maintains logical 1 level during the period that the capacitor 36 is charged by the transistor 32, and discharged by the switch 34. The charged voltage across the capacitor 64 is applied, as the output voltage of the sample hold circuit 37, to the positive input terminal of the operational amplifier 31. The purpose of providing the delay time td in the signal S1 is to compensate for the delay time TD in each of the comparators 50 and 51. If the delay time td is equal to the delay time TD, the charge time of the capacitor 36 is T0 TD. Therefore, in the equation 7 , for example, the delay times TD and td are cancelled, remarkably reducing the effect by the delay time TD. Thus, even if the comparators 50 and 51 contain delay times, the VCO can produce an oscillating signal of an exact frequency. A detailed circuit arrangement of the timing control circuit 38 will be described referring to Fig. 9. In Fig. 9, the clock pulses CLK are inverted and applied to the clock signal input of the latch 71. The Q output terminal of the latch 71 is coupled with the D input terminal of the latch 72. The The NOR gate 75 receives the Q output signals from the FFs 73 and 74, and produces the second control signal S2. The NAND gate 76 receives the Q output signal of the FF 73, as well as the An arrangement of the delay circuit 80 will be given. The Q output signal of the FF 74 is input to the input terminal of a CMOS inverter 81 including a pair of P and N channel MOS transistors. One end of the current path of the P channel of the inverter 81 is connected to one end of the current path of a P channel MOS transistor 82. The other end of the current path of this transistor 82 is coupled with the VDD supply. The gate of the transistor 82 is coupled with the gate and one end of the current path of a P channel MOS transistor 83. The transistor 83 is connected at the other end of the current path to the VDD supply. The transistors 82 and 83 cooperate to form a current mirror circuit 84 which feeds a predetermined current to the P channel transistor of the inverter 81. The current path of an N channel MOS transistor 85 is inserted between the inverter 81 and a ground. The transistor 85 is biased to a fixed bias point by a bias source Vc. The transistor 85 feeds a fixed current to the N channel transistor of the inverter 81. The current path of an N channel MOS transistor 86 is inserted between the current mirror 84 and a ground. The same bias source Vc is applied to the gate of the transistor 86. The transistor 86 feeds a predetermined current to the current mirror 84. The output signal of the CMOS inverter 81 is input to an inverter 87. Both the output signal of the inverter 87 and the Q output signal of the FF 74 are applied to a NAND gate 88. The NAND gate 88 produces the first control signal S1. A second embodiment of a voltage controlled oscillator according to the present invention will be described referring to Fig. 10. This embodiment is different from the first embodiment of Fig. 3 in the following points. The output terminal of the sample hold circuit 37 is connected to the negative input terminal of the operational amplifier 31. The positive input terminal of the operational amplifier 31 is coupled with the reference voltage Vref. A capacitor is connected between the negative input terminal and the output terminal of the operational amplifier 31. The amplifier 31 and the capacitor comprise an integration circuit. The output terminal is connected to the gate of an N channel MOS transistor 91. Another p channel MOS transistor 92 whose gate and one current path are connected to one end of the transistor 91 and the gates of the transistors 32 and 41. The other end of the current path of the transistor 92 is coupled with the VDD supply. The other end of the current path of the transistor 91 is grounded. The transistor 92 serves as a current load for the transistor 91. The transistors 32, 92 and 41 form a current mirror. In operation, the output voltage Vc of the operational amplifier 31 determines the current flowing through the transistors 91. This current causes a voltage drop across both transistors 92. The transistors 92 and transistors 32 and 41 comprise current mirror circuits. The currents corresponding to the voltage Vc flow through the transistors 32 and 41. A detailed circuit arrangement which is available for the operational amplifier 31 and the comparators 50 and 51 in the oscillating section 30 Fig. 4 will be described referring to Fig. 11. In Fig. 11, one end of the current path of an N channel MOS transistor 101 is connected to one end of that of an N channel MOS transistor 102. These transistors 102 and 103 constitute a differential amplifier 103. The other end of the transistor 101 is connected to one end of that of a P channel 104. The other end of the current path of this transistor is coupled with the VDD supply. The other end of the current path of the transistor 102 is connected to one end of the current path of a P channel MOS transistor 105. Its other end is coupled with the VDD supply. The gates of these transistors 104 and 105 are connected to the connection point between the current paths of the transistors 102 and 105. The transistors 104 and 105 form a current mirror circuit 106, which serves as a load for the differential pair 103. The connection point between the current paths of the transistors 101 and 102 is connected to one end of the current path of an N channel MOS transistor 107. The other end of the current path of this transistor is grounded. The transistor 107 serves as a current source to feed the operating current to the differential pair 103. A node between the transistors 101 and 104 is coupled with the gate of a P channel MOS transistor 108. The output signal of the differential pair 103 is supplied to the gate of the transistor 108. One end of the current path of the transistor 108 is connected to the VDD supply. Its other end is connected to one end of the current path of a N channel MOS transistor 109 as a current load for the transistor 108. The gate of the transistor 109 is connected to the gate of the transistor 107, and its other end is grounded. The gates of the transistors 107 and 109 are biased by a bias source 110. In this circuit arrangement, the gate of the transistor 101 is used as the positive input terminal, while the gate of the transistor 102 is used as the negative input terminal. The output signal is derived from a node between the transistors 108 and 109. Another example of the operational amplifier will be given referring to Fig. 12. In the figure, one end of the current path of an N channel MOS transistor 121 is connected to one end of that of an N channel MOS transistor 122. These transistors form a differential pair 123. A node between the transistors 121 and 122 is connected to one end of the current path of an N channel MOS transistor 124. The other end of the current path of this transistor 124 is grounded, and its gate is applied with a fixed voltage for biasing purposes. The other end of the current path of the transistor 121 is connected to the gate and one end of the current path of a P channel MOS transistor 125. The other end of the current path of the transistor 125 is coupled with the VDD supply. The other end of the current path of the transistor 122 is connected to the gate and one end of the current path of a P channel MOS transistor 126. The other end of the current path of this transistor 126 is coupled with the VDD supply. The transistors 128 and 125 are interconnected at the gates. The transistor 125 and 128 form a current mirror 127. The gate of a P channel MOS transistor 130 is connected to the gate of the transistor 126. The transistors 126 and 130 form a current mirror 129. The ends of the current paths of these transistors 128 and 130 are applied with the VDD supply. The other end of the current path of the transistor 128 is connected to the gate and one end of the current path of an N channel MOS transistor 131. The other end of the current path of this transistor 131 is grounded. The other end of the current path of the transistor 130 is connected to one end of the current path of an N channel MOS transistor 132. The other end of the current path of the transistor 132 is connected to the gate of the transistor 131. The transistors 131 and 132 form a current mirror circuit 133. The gate of the transistor 121 serves as an inverting input terminal, while that of the transistor 122 serves as a noninverting input terminal. The output signal is derived from a node between the transistors 130 and 132. The oscillating section 30 may employ many circuit other arrangements other than that of Fig. 4. One of such candidates is illustrated in Fig. 13. In the figure, like reference numerals are used for indicating like or equivalent portions in Fig. 4. The two positive input terminals of a three input comparator 140 are coupled for reception with the potential VA of the capacitor 47 and the potential VB of the capacitor 49. The input voltage Vin is applied to the negative input terminal of the comparator 140. The comparator 140 operates so as to compare the voltage Vin at the negative input terminal with either of the potentials at the positive input terminals for the purpose of determining which is higher than the other. The output signal of the comparator 140 is supplied through an inverter 141 to a select circuit 150. The select circuit 150 is comprised of two AND gates 151 and 152, and an inverter 153. The input terminals of the AND gates 151 and 152 receive the output signal of the inverter 141. The other input terminal of the AND gate 151 is coupled for reception with the With such a connection, when the delay signal is logical 1 , the output signal of the inverter 141 is applied to the set input terminal of the FF 54. When the delayed signal is logical 0 , the output signal of the inverter 141 is supplied to the reset input terminal of the FF 54. The The operation of this embodiment is substantially the same as that of the Fig. 4 embodiment. The reason behind the provision of the delay circuit 160 will be given. A signal delay is inevitably involved in the comparator 140. Immediately after the logical state at the output of the FF 54 changes, it is returned to its original state due, as is highly possible, to the signal delay. In an extreme case, the FF 54 oscillates irrespective of the potentials VA and VB. This is an incorrect operation. To cope with this, the present embodiment forcibly places the output signal of the comparator 140 into logical 1 for the signal delay time and by the delay circuit 160. Then, the select circuit 150 is switched to another state. In this way, the undesired inversion of the FF 54 is prevented. The experiment was conducted for checking the operation of the voltage controlled oscillator as shown in Fig. 10. The results of the experiment were plotted in Fig. 14, where the abscissa represents the input voltage Vin and the ordinate represens the frequency fout of the output signal. In the experiment, the capacitance of each of the capacitors 36, 47 and 49 was 1010 pF the reference voltage Vref 2.5 V the VDD 5 V and the period T0 for logical 0 of the first control signal S1, 25 uS. As seen from Fig. 14, when Vin Vref, f