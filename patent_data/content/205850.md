# OPERATION UNIT WITH AN ERROR AMOUNT CALCULATING CIRCUIT FOR OUTPUT DATA THEREOF

## Claims
Rechenvorrichtung mit

## Description
The present invention relates to an operation unit for calculating floating point data of a computer and, more particularly, to an operation unit suitable for executing such a scientific technique calculation program described in a high level language as is suitable for numerical simulation of physical phenomena. In the execution of such a floating point calculation train, immigration of an error into initial data based on the finiteness of data length, and occurrence, propagation and amplification of a rounding error of each calculation are unavoidable on principle. Hence, evaluation of the error amount for ensuring reliability of the calculation result is indispensable for the numerical calculation. Here, the evaluation of the error amount is roughly divided into analytic and dynamic methods. Noting the function to solve a calculation train such as a simultaneous linear equation, the analytic method evaluates the error based on a global index such as the number of conditions of a coefficient matrix but does not enter into the detail of the calculation train so that it is convenient and has an excellent prospect. However, the analytic method has its applicable range limited partially to calculations having known functions and properties and has a tendency to make a worse evaluation than the actual one. In most cases, therefore, the dynamic method piling the evaluations while sequentially following the individual processes of the calculation is adopted. In one convenient phase, the dynamic method additionally executes a long precision calculation, in which the data length is doubled, and compares the results. The dynamic method is entangled with problems of explosive increase in the time period and data amount required for the long precision calculation. As methods for avoiding those problems, there are known the method of giving perturbations to input data and arithmetically intermediate data to observe the influences , the method based on partial derivative calculations according to the graph theory and the method of calculating the variance or standard deviation as disclosed in EP A 0018298. In these methods, however, the direction and amount of the perturbations or the error amount occurring in each calculation are statistically assumed. There is still left a problem of a failure in evaluating the actual error for the calculations using the individual data although the dynamic method is proper for evaluating the stability of the calculation method. FR A 1173175 describes a method for evaluating the actual error by program subroutines using linear equations and equations of higher order in the inputted error values. This method however is extremely time consuming. An object of the present invention is to provide an operation unit which has a mechanism for solving those problems in the error evaluation and for making the dynamic evaluation efficient and accurate. According to the present invention as set forth in claim 1, there is provided an operation unit which comprises first means for calculating an input data and for outputting an error data indicating an error generated as a result of the calculation by using such a mantissa data at a lower order as has been obtained midway of said calculation but is not used as an output result data and second means for outputting an error data of said calculation result data from the first named error data and an error data input accompanying said input data. Fig. 1A shows one embodiment of an operation unit for addition or subtraction according to the present invention Fig. 1B shows one embodiment of an operation unit for multiplication according to the present invention Fig. 1C shows one embodiment of an operation unit for division according to the present invention Fig. 2A is a block diagram showing a main addition and subtraction device to be used in the operation unit of Fig. 1A Fig. 2B is a block diagram showing a main multiplication device to be used in the operation unit of Fig. 1B and Fig. 2C is a block diagram showing a main division device to be used in the operation unit of Fig. 1C. The present invention will be described in the following in connection with the embodiments thereof. A first description is directed to a linear error approximating equation for operations known per se. Letters u and v denote input data for addition and substraction letter w denotes a result data and letters u, v and w denote their accompanying errors. Terms u From this equation, the error of the addition and subtraction can be approximated by the sum of the arithmetic result of the error generated by this calculation and the input error. Likewise, for the error w of the result of the multiplication of u and v, the following relationship holds if the term u v where denotes a multiplication is neglected For a division, the following equation holds In the present invention, the error evaluations are superposed in accordance with the calculating processes by using this approximating equation. For the initial data, a truncating rounding error using the format change when a zero or data is inputted is placed. In the following embodiment, the input operand data u and v and the arithmetic result data w are floating point data each of which is composed of a symbol part of 1 bit, an exponent part of 7 bits and a mantissa part of 56 bits, whereas the input error data u and v and the output error data w are floating point data each of which is composed of a symbol part of 1 bit, an exponent part of 7 bits and a mantissa part of 8 bits. Fig. 1A is a block diagram showing an operation unit for addition and subtraction. Reference numeral 5 denotes a main adder subtracter having a 64 bit width, and numeral 6 denotes an auxiliary adder subtracter having a 16 bit width for error evaluation. The difference between the main adder subtracter 5 and the auxiliary adder subtracter 6 resides in the bit width of the mantissa part such that the input output data of the main adder subtracter 5 has a symbol part of 1 bit, an exponent part of 7 bits and a mantissa part of 56 bits, whereas the auxiliary adder subtracter 6 has a symbol part of 1 bit, a mantissa part of 8 bits and an exponent part of 7 bits. This applies to other embodiments, as will be described with reference to Figs. 1B and 1C. The main adder subtracter 5 is constructed such that it conducts an addition or subtraction of the two arithmetic data u and v inputted to output the arithmetic result data w u v or u v to a line 23A and a rounded error u What is executed after the end of the main calculation is limited to u As shown in Fig. 2A, the main adder subtracter 5 is composed of pre shifters 14 and 15 for shifting the mantissa parts u The main adder subtracter 5 thus composed is similar to the adder subtracter of the prior art except the components denoted by reference numerals 17 and 18. For digital registration of the arithmetic data u and v, the pre shift control 13 feeds the absolute value u In the present embodiment, the input data of the pre shifters 14 and 15 has a bit width of 56 bits whereas the output data has a bit width of 64 bits, 8 bits larger than that of the input data. The outputs of the pre shifters 14 and 15 are inputted to the complementary number generation circuits 14A and 15A so that a complementary number of 2 is obtained in case the symbol bits u The adder subtracter 16A receives the outputs of 64 bits of the complementary number generation circuits 14A and 15A to output the data of 64 bits and the symbol value as a result of its addition or subtraction. In order to normalize these outputs, the post shift control 18 detects whether or not the digit 0 is present in the head of the output data, if the symbol value of the result is 0, and whether or not the digit 1 is present if the symbol value of the result is 1. If YES, the post shift control 18 outputs the digit number as the leftward shift amount to the post shifter 17 and the exponent part correction circuit 19. This exponent part correction circuit 19 subtracts this leftward shift amount from the maximum exponent data outputted from the pre shift control 13 to output the result as the exponent part data of the arithmetic result. On the other hand, the post shifter 17 shifts the output of the adder subtracter 16A leftward in accordance with the leftward shift amount outputted from the post shift control 18 to output it as the data of 64 bits. At this time, if the symbol of the result is 1 negative , the operation to complement the data again and to transform the complementary number into the expression of an absolute value is conducted at the same time. The output data u The lower 8 bits of the post shifter are used as the mantissa part of the rounded error u Thus, the calculation data u Fig. 1B is a block diagram showing an operation unit for multiplication according to the present invention. Reference numeral 7 denotes a main multiplier having a width of 64 bits, which is constructed to output the product of w u v of the data u and v and its error u v during the calculation of the product of the former numerals 8A and 8B denote auxiliary multipliers having a width of 16 bits for error evaluation and numeral 9 denotes a 3 input adder having a width of 16 bits. In parallel with the multiplication of the main multiplier 7, by using the auxiliary multipliers 8A and 8B, the product of u v of the data u and v is determined by using the 7 bits of the exponent part, the symbol of 1 bit and the upper 8 bits of the mantissa part of the input data u and the input error data v, and the product u v of the data u and v is determined by using the input error data v and the 7 bits of the exponent part, the symbol part of 1 bit and the upper 8 bits of the mantissa part of the input data v. Then, those results u v and u v and the rounded error u v obtained on a line 27 at the end of the main multiplication are added by using the 3 input adder 9 to obtain the resultant error value w. The auxiliary multipliers 8A and 8B and the adder 9 can be realized in a circuit scale of one tenth as large as or smaller than that of the main multiplier 7, and what operates after the end of the main calculation is limited to the adder 9. As a result, the high speed error calculation is executed. Fig. 2B is a block diagram showing the main multiplier 7. Reference numeral 16M denotes a circuit for multiplying the mantissa parts u The exponent parts u The symbol parts u Fig. 1C is a block diagram showing an operation unit for division according to the present invention. Reference numeral 10A denotes an approximate inverse generator numeral 10B denotes a main divider having a width of 64 bits and numerals 11 and 12 denote an auxiliary multiplier and an adder subtracter having a width of 16 bits for error evaluation. In the error equation 3 , an inverse approximating value R₀ is used in place of 1 v, and the evaluation is conducted by the following equation Since the circuit scales of the operation units 11 and 12 are one twentieth or less as large as that of the main operation unit and since what is executed after the end of the main calculation is limited to the final addition, an increase in the operation time by the error evaluation is slight. Fig. 2C shows one example of the construction of the main divider 10B. An operation unit 16X has adding, subtracting and multiplying functions. A selector 35A selects the input data v and the outputs 37A and 37B of the operation unit 16X to send the selected one to the operation unit 16X. A selector 35B selects the approximate inverse R₀ outputted from the approximate inverse generator 10A, the output 37A of the operation unit 16X and the input data 1 and 2 to send the selected one to the operation unit 16X. Those selectors 35A and 35B and the operation unit 16X are controlled to output the approximate inverse R₀ through the operation unit 16X. Then, R₁ 1 1 v R₀ 1 v R₀ Of the output of the multiplier 16M, the lower 8 bits are utilized as the mantissa part of the error data u v generated by the division. The length of the mantissa part of this error data is equal to the length of the symbol part and the result which is determined by subtracting the constant C from the exponent part of the multiplier 16M by the subtracter 20. The constant C is identical to that which has been described with reference to Fig. 2A. The multiplier 16M is constructed by eliminating the subtracter 20 from the multiplier of Fig. 2B and by outputting the lowermost 8 bits of the output of the post shifter 17 and the output w as the bits 64 to 71 and 0 to 63 of the multiplier 16M of Fig. 2C. Thus, even in the division, the rounded error can be calculated with neither any substantial addition of the circuit nor any augmentation of the arithmetic time period.