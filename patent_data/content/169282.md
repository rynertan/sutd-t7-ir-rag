# CONTROL APPARATUS

## Claims
Steuervorrichtung zum Steuern eines Arbeitsvorganges, wobei die Vorrichtung selektiv zumindest zwischen einer Einstell Betriebsart und einer Arbeits Betriebsart mit Hilfe einer Betriebsart WÃ¤hleinrichtung 20 schaltbar ist mit einer Voreinstellwert Eingabeeinrichtung 18 , um in der Einstell Betriebsart eine Mehrzahl von Voreinstellwerten I

## Description
The present invention relates to a control apparatus of the multi level setting type, for example for the control of machine tools, or possibly robots, or positioning means, where a number of successive dimensions, positions, or states have to be achieved in turn. Conventional control apparatus of this type sets and displays its preset values mechanically with the resulting inevitable increase in size, so that only 2 to 3 preset values are practicable. One object of the invention is to provide a control apparatus so designed that its preset values are set and stored electrically with the resulting increase in the number of preset values and decrease in the size of the apparatus. GB A 1 237 600 discloses a control apparatus of the general type to which this invention relates. Its flexibility is, however, limited, in that a particular sequence of operations always has to start at the beginning and continue through until the end. In addition, at each step of the process further control of the apparatus is entirely dependent upon the result of a single comparison between the desired and expected values of a parameter at the previous step. The first of these difficulties is overcome in the device shown in US A 3 689 892, a device which has those features set out in the pre characterising clause of Claim 1. A difficulty still remains, however, with this device in that at each stage control is determined by a single comparison between an expected and an actual parameter at the previous stage. There are many situations where this lack of flexibility causes problems one specific being the case where it is desired to stop operation of the device to be controlled when a moving part reaches a particular position. With the apparatus shown, there are likely to be difficulties with overrun if the instruction to stop is given only when the desired position is reached. Overrun can of course be reduced or eliminated if an instruction to decelerate is given in advance of the desired stop position, but this requires the user to enter a separate start decelerating position for each desired stop position. Every time a stop position is changed, the corresponding start decelerating position also has to be changed. According to the present invention a control apparatus of the known type defined in the preamble of claim 1 is characterised by the features set out in the characterising portion of Claim 1. The addition of a facility for storing a plurality of additional preset values, each applicable to more than one stage of the work to be carried out, means that, for example, the device may be programmed to start decelerating at a position a predetermined distance short of each of the desired stop points, this predetermined distance requiring to be entered and saved only once when the control apparatus is being set up. In addition to simplifying the set up procedure, and facilitating amendments to the stored preset values, there is also a consequential reduction in the amount of memory required. There may be means for restart operation after a stop part way through a multi stage operation, and means for resetting to terminate operation before all stages have been completed and restart at the beginning. The invention may be put into practice in various ways, but one specific embodiment will now be described by way of example, with reference to the accompanying drawings of which FIGURE 1 is a block diagram showing the overall arrangement of the control apparatus FIGURE 2 is a block diagram of the control apparatus of FIGURE 1 arranged to simplify understanding of its operation and FIGURE 3 is a flow chart showing the operation of the apparatus of FIGURE, 1 and 2. The control apparatus includes a counter 11, an input circuit 12 stage computing means 15, preset value input means 18, storage means 13, data transfer means 25, comparison means 21, an output circuit 16, mode selecting means 20, display selective driving means 35 and a display 17 which will be described hereunder. The counter 11 is a separate item of hardware which counts a digital input which may represent a position achieved by a work tool for example. The input circuit 12 is capable of being supplied with a reset signal, a stepping signal, a start signal, and a stage specifying signal. The stage specifying signal enables a selected stage to be specified. The stage specifying signal is a signal for specifying the starting stage and is always being input. For example, if the apparatus commences operation from the first stage, a numeral signal corresponding to it shall be input. For another example, if it becomes necessary in the course of operation to bring it back to n th stage or to skip it to x th stage after the operation has proceeded foreward or backward successively, a numerical signal corresponding to the n th or x th stage shall be input. The reset signal is a signal for resetting the output circuit 6 and the stage counter 23 which will be described later. When the stage counter 23 is reset, it is so arranged that a stage specifying signal is read in. The stepping signal is a signal for letting the stage go forward or backward by increasing or decreasing the value of the stage counter 23. The starting signal is a signal for instructing the stage set on the stage counter to commence the operation. The relationship between the foregoing signals is as follows As the stage specifying signal is always being input as aforesaid, when the apparatus is initially going to start, the reset signal, stepping signal and the starting signal are input in that order. When the apparatus has started the stepping signal and starting signal are input in that order. In order to bring the operation back to or skip to a specific stage, a stage specifying signal corresponding to that specific stage is first input and then a reset signal and a starting signal are input at a proper timing in that order. Thus, a stage corresponding to said stage is set in the stage counter and the apparatus commences the operation beginning with the specified stage. The preset value input means 18 is a means for inputting the preset values corresponding to the various stages of work, and it may for example be a keyboard. The values may represent dimensions in a machining operation, or positions in a sequence of movement. The storage means 13 stores a large number of the preset values corresponding to the stages of work. It comprises a stage counter 23 and a preset value storage means 33 and it usually includes a RAM. The step counter is reset based on a reset signal from the stage computing means, sets a corresponding stage based on a stage specifying signal , and adjusts the count value based on a stepping signal. The preset value storage means 33 memorises the preset value signals coming from the preset value input means 18. It memorises singular or plural preset values corresponding to each stage and it gives the relevant present value in accordance with an instruction coming from the stage counter 23. The stage computing means 15 is responsive to the signals from the input circuit 12. If a reset signal is input, the stage computing means sends signals to read the stage counter 23 and output circuit 6. If a stepping signal is input, the stage computing means 15 checks the status of the stage counter 23 and, if it is not in reset condition, sends a signal to the stage counter 23 to move the count value backwards or forwards. If it is in reset condition, the stage computing means 15 reads a stage specifying signal and sends a signal for setting the stage value corresponding to said stage specifying signal to stage counter 23. If a start checks the status of the stage counter 23 and if it is not in the reset condition sends a signal so that the stage indicated by the stage counter is performed. The data transfer means 25 writes the preset signals from the preset value input means 18 in the preset value storage means 33 and it also reads and transfers the preset value corresponding to the current stage of work shown in the stage counter 23 from the preset value storage means 33. The comparison means 21 compares the output of the counter 11 and the preset value from the data transfer means 25 as to relative magnitude and equality and generates a signal corresponding to the comparison. It is to be noted that in the operating mode, the comparison means 21 and the data transfer means 25 are each actuated in response to the supply of a start signal. The output circuit 16 is responsive to the output of the comparison means 21 to generate a control output. The mode selecting means 20 enables the user to select an operating mode or a setting mode. The setting mode is for effecting the storage of the number of the stages and their preset values in the storage means 33, and the operating mode is for normal operation to perform those stages. The display selective driving means 35 is responsive to the mode signals from the mode selecting means 20 so that the output of the counter 11 is generated in the operating mode and the preset value from the data transfer means 25 is generated in the setting mode. The display 17 is responsive to the output from the display selective driving means 35 to display the output of the counter or the preset value and it also displays the number of the running stage. These displays are usually made in the form of digital values. It is to be noted that the stage computing means 15, the data transfer means 25, and the display selective driving means 35, are formed by an ROM with permanently stored programs and a CPU operable in accordance with the programs. The comparison means 21 may be provided by the ROM and the CPU mentioned above or alternatively it may comprise a separate comparison computing unit. Also, while it is preferable to design the arrangement so that all the component elements excluding the preset value input means 18 are brought into operation when the operating mode is selected by the mode selecting means 20, and the preset value input means 18, the storage means 13, the data transfer means 25, the display selective driving means 35, and the display unit 17, are brought into operation when the setting mode is selected, the present invention is not of course limited to this arrangement. The control apparatus makes it possible to define a large number of preset values corresponding to the stages of work, while the apparatus can be small. The counter 11 is a separate item of computer hardware and is not a part of the ROM and CPU mentioned above, and so is a dedicated item and can count at a high speed. Referring to FIGURE 2, numeral 1 designates an up down counter which counts a digital input. Also in relation to FIGURE 1, the counter 1 incorporates comparators corresponding to the comparison means 21. Numeral 2 designates an input circuit which is supplied with input signals including a reset signal, stepping signals, a start signal and a stage specifying signal. Numeral 3 designates an RAM storing the preset values corresponding to the stages of work. Numeral 4 designates an ROM storing predetermined programs. Numeral 5 designates a CPU for performing various computational operations in accordance with the programs in the ROM 4. In relation to FIGURE 1, the CPU 5 includes the stage computing means 15, the data transfer means 25 and the display selective driving means 35. Numeral 6 designates an external output in accordance with the comparison result of the comparator in the counter 1 through the CPU 5. Numeral 7 designates a display unit for displaying the current stage and the output of the counter 1 or a preset value. Numeral 8 designates a keyboard which is used mainly for the purpose of writing the preset values in the RAM 3. In relation to FIGURE 1 the keyboard 8 forms the preset value input means 18. Numeral 9 designates a cassette interface which is used to write preset values in the RAM 3 in accordance with an externally reproduced input and to record the preset values of the RAM 3 as a recorded output on an external magnetic tape or the like. Numeral 10 designates a mode selector switch which is used for the selection of various modes. With the construction described above, the operation of the control apparatus as illustrated in the flow chart of FIGURE 3 will now be described assuming that the operating mode has been selected by the mode selector switch 10. The control signals to be input into the input circuit 2 are actually input as mentioned hereunder. A stage specifying signal is always being input as aforesaid. Other signals are input in the order a reset signal a stepping signal a starting signal... a stepping signal a starting signal . In order to change the flow of stages proceeding forwards and backwards one by one and to skip to a specified stage, a stage specifying signal corresponding to that specified stage shall be input beforehand and then a reset signal is input at a proper timing. Then, a stepping signal and a starting signal follow it as described above. The operating steps are as follows In order to change the ordinary flow of the stages, that is to say,for example, after the current stage is over, in order to commence the next operation not from the next stage but from the fourth stage skipping the next three stages, a stage specifying signal corresponding to said fourth stage shall be input beforehand and, when the current stage is over, a reset signal shall be input. Thereby said 1 and the following steps commence to proceed. The above mentioned steps are performed repeatedly so that each time the output of the counter 1 becomes equal to the preset value corresponding to each stage of work, a control signal is generated from the output circuit 6. While the flow chart does not include a stop step and has an endless form, this is because the embodiment is an endless example where a return is made to the initial stage after the final stage has been reached. Since in contrast to conventional control apparatus, the RAM 3 can store a large number of preset values, if the counter apparatus of this embodiment is used as a multipoint positioning apparatus for example, any given supplementary data for positioning control purposes can also be stored in the ram 3. For instance, in addition to being capable of receiving the various preset values I The above description of the flow chart was based on selection of the operating mode to select corresponding operation of the CPU 5 or the proper progam in the ROM 4. However, many different modes can be selected as occasion demands. In the operating mode when there is no reset input, it is necessary to provide first a stepping input and then a start input at 12, so that the flow chart follows paths B and then C in Figure 3. If a reset input is applied that is followed by a stepping and then a start input so that flow paths A,B, and C, in Figure 3 are followed in that order. Where the control apparatus of this embodiment is used as a multipoint positioning counter, it is conceivable to provide means for selecting such modes as stop, adjusting, setting, copying, and cassette modes in addition to the above mentioned operating mode. The stop mode stops the operation of the apparatus as a whole and the adjusting mode changes the preset values in the RAM 3, that is, during the continued operation alternative data are written in the RAM 3 by the keyboard 8. The setting mode writes the preset values in the RAM 3. The copying mode writes the current output of the counter 1 in the RAM 3 in accordance with the actual work The cassette mode effects the ensuring operations through the cassette interface 9. In other words, where the same part is produced by each of a large number of machines, the same preset values are written in the RAM of each machine and thus, after the data have been recorded on a magnetic tape, the data are written in the RAM 3 through the cassette interface 9. Also, the contents of the RAM of one machine can be written into the RAM of the other machine through the cassette interface 9. By providing a variety of modes in this way, it is possible to perform a variety of operations and thereby improve the versatility.