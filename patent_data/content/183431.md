# SYSTEM CONTROL NETWORK FOR MULTIPLE PROCESSOR MODULES

## Claims
Netzwerk aus einer Mehrzahl digitaler Einheiten aus Prozessoren und digitalen Modulen mit einem Steuersystem zum Bereitstellen von Datenübertragungsmöglichkeiten zwischen zwei beliebigen Einheiten in dem Netzwerk, wobei jede Einheit die Übermittlung ausgegebener Daten als sendende Einheit veranlassen und jede andere Einheit als Empfangseinheit zum Empfang der Datenübertragung adressieren kann, mit in dem Steuersystem enthaltenen Netzwerk Bus Mitteln zum Verbinden der Prozessoren und der digitalen Module untereinander, Logikelementen in jeder Einheit zum Erlangen des Zugriffes auf die Netzwerk Bus Mittel und zum Verhindern des Zugriffs auf die Busmittel durch andere Einheiten, Mitteln, welche in jeder Einheit als Sendeeinheit, zum Adressieren einer empfangenden Einheit und zum Übertragen der Mitteilungsdaten und der Steuerdaten zu der empfangenden Einheit wirken wobei die Datenkommunikation von der sendenden Einheit zu der empfangenden Einheit durch ein Format der übertragenen Mitteilungen erfolgt, welches enthält

## Description
This disclosure refers to a network of multiple processor modules wherein means are provided for instruction and control signals to be communicated from any one processor module to another processor module. Modern day computers and computer systems no longer sit alone and work in isolation. Today, processors and main computer operating systems are interconnected to form networks where coordination and communication between the operating systems is absolutely essential for accomplishing the tasks required of the network in an efficient manner. Many problems arise in the establishing of communications between the separate computer systems. Many networks are limited to fixed hierarchies of communication where only certain levels of processors can communicate directly with comparable levels but no direct paths of communication are available for subordinate or senior levels of processors. The presently described system network provides an organization whereby simple and direct communication channels can be freely established between any two units in the network in a simple non hierarchical direct manner. Thus, any unit has an equal opportunity to gain access to, and to communicate with, any other unit in a direct line without the need to have to make indirect connections or bridge through another unit which is not necessarily involved in the data transfer operation. US A 3 978 451 discloses a system for controlling communication between a plurality of computer devices via a common bus. The bus includes a data bus and lines for busy, strobe, and acknowledge signals. The system involves one universal interface unit associated with each respective computer device. Each device can initiate access to the common bus through its respective interface unit on a first come, first served basis. US A 4 085 448 discloses a data communication base structure where all module to module control information is grouped into two sets of lines defined as sub buses, wherein signal contents of the sub buses change only at well defined times under the control of two other lines which govern the transfer of control information relative to the communication. An independent bus monitor observes all communications and, when an improper signalling exchange takes place, isolates the module most responsible for the fault. SECOND SYMPOSIUM ON MICRO ARCHITECTURE, 1976, pages 299 303, North Holland Publishing Co. R. SOMMER Cobus, a firmware controlled data transmission system discloses a firmware controlled data interchange system for connecting intelligent terminals and computers in a network. The system is organised as a serial bus using a single coaxial cable for data transmission and control. The hardware is assisted by microprocessor firmwave to realise all the bus control and protocol functions. IBM TECHNICAL DISCLOSURE BULLETIN, vol. 26, no. 3B, August 1983, pages 1709 1711, New York, US D.A. BUESING et al. Interface bus configuration discloses an interface bus configuration for dealing with problems which arise when interconnecting high and low speed unbuffered devices together on a common bus. The bus configuration supports two types of data transfer cycles. The first type is under direct programme control and is used to load commands and parameters to the devices or to sense their status. The second type uses direct memory access to transfer data directly between the memory and the devices. ELECTRONICS INTERNATIONAL, vol. 57, no. 6, March 1984, pages 126 131, New York, US J. BEASTON Multiprocessor bus is ready to meet 32 bit applications of future discloses a bus architecture involving five buses comprising a parallel system bus, a local bus extension, a serial system bus, an input output expansion bus, and a direct memory access bus. The system moves high speed data to and from physically distributed custom peripherals such as mass storage devices or graphics display system. The present invention is set out in claim 1. FIG. 1 is a block diagram of the system control network showing multiple numbers of processor systems connected to a system and power interface master card unit. FIG. 1A is a block diagram of the Maintenance Interface Processor and its relation to the system control network. FIG. 1B is a signal connection drawing showing the system control network logic linking the maintenance processor to the system bus. FIG. 1C is a drawing showing the interface between the Maintenace Processor and the system network bus. FIG. 2 is a block diagram of the network interface logic which connects the master card unit of FIG. 1 to the system control network buses. FIG. 3 shows the relationship of certain communication phases involved in the communication of a message on the network. FIG. 4 shows a typical message format used in the system control network. FIG. 5 is a schematic drawing of how the message flows are accomplished. FIG. 6 is a block diagram of the system and power interface master card unit. As seen in FIG. 1, the system control network SCN involves multiple numbers of main processors, such as P1, P2, P3, etc. Each of the main processor systems is provided with a maintenance processor 10 The system control network is a dedicated, inexpensive high speed network which provides for the passing of messages, commands, and data files between the elements of the various maintenance processors. The system control network may have up to 15 connecting units. They may include future units such as a unit designated as a SCP DLP System Control I O Processor Data Link Processor which connects the Main Processor software with the maintenance processor software. In an alternate version the system control network of FIG. 1 may include a system control I O processor SCP not shown which can be connected to the bus 50. The system control network is implemented as a parallel, contention network having no single master or primary controlling element. Each element on the network has a unique address which is used for controlling message transmissions and for receiving messages. Any element on the network may be able to communicate with any other element on the network. The system control network SCN integrates the hardware elements for the multi processor computer system. These hardware elements include i the maintenance processors for each main processor system, which initialize and maintain the processors and ii the system control I O processors future which integrate the main processor system software with the software of the SCP and iii the system and power interface master card unit 100 which integrates the system remote power control and the maintenance subsystem as shown in FIG. 1. The system control and maintenance subsystem is organized to provide the following functions The system control network interconnects the various elements of the Maintenance Subsystem. The elements which connect on to the system control network are The system and power interface master card unit 100 in FIG. 1 provides interconnection between the system control, the power control and the remote support subsystems. The card unit 100 thus connects to the following items The maintenance subsystem involves The maintenance processor 10 FIG. 1A shows the maintenance processor itself together with its internal network interface logic 10 In FIG. 1A there are two work station terminals, S₁ and S₂, connected to the maintenance interface processor 10. The MIP 10 has four buses shown which include the UIO Universal Input Output test bus 10 The ergonomic work station EWS terminals in FIG. 1A can act both as a system supervisory operator SPO and as the intelligence for the maintenance processor 10. The ergonomic work station is a microprocessor base system which uses the Intel 8086 microprocessor. The Intel 8086 microprocessor is described in a publication entitled iAPX Users Manual , copyright 1981 by Intel Corp. of 3065 Bowers Avenue, Santa Clara, CA 95051. The System Control Network SCN interconnects the various elements of the maintenance subsystem and system control subsystem. In the described system, the SCN interface hardware is implemented in two ways, as indicated in 1B. In one version, the SCN interface is integrated into the structure of the MIP 10 maintenance interface processor . In the second version, dedicated control hardware is provided on the Power Interface Master Card 100. Thus the system control network logic block 53 of FIG. 1B can be implemented either as The system control network logic 10 In FIG. 1C, the maintenance interface processor 10 provides a two way connection with the Net Control Circuit 8 which functions to get control of the SCN and to control the handshake functions to other interfaces. A utility register which interfaces the microprocessor and writes data to the SCN data registers in processor 10 connects to data registers 12 which function to hold data to be transferred over the SCN and to receive data from the SCN. The net control circuit 8 and data registers 12 provide bidirectional data transfer to the Network Bus Driver Receivers 24. The network address switches 16 permit an operator to set the identification address on the Network MIP for communication addressing over the SCN. Circuits 12 and 16 connect to the S bus which allows the microprocessor 10 to read the network address switches and the SCN data registers. The power control master card 100 controls the system control network logic through dedicated net logic hardware. FIG. 2 shows a block diagram of the system control network logic for the control master card type network interface hardware. Similar to FIG. 1C, the logic of FIG. 2 includes data registers 12q and address switches 16q. Additionally, the FIG. 2 system has an address comparator 14q, a status register 18q and a command logic circuit 20q. As seen in FIG. 2, the network bus interface provides six signal interconnections designated as NET XX which provide the functions shown in TABLE I. These signals are defined as shown in the TABLE I hereinbelow. The system control network provides certain functions and commands which are listed hereinbelow in TABLE II. Communication over the network can be initiated by any network device. There is no primary controller which dictates the activities over the network. There are basically five communication phases involved in the communication of a message on the network. These five phases are In FIG. 3 there is shown the various relationships between these enumerated five phases. Thus, in the receiving device, there is the phase of WAIT FOR ADDRESS which then permits the phase entitled RECEIVE MESSAGE , after which a MESSAGE ACKNOWLEDGE signal is sent. In the transmitting device, there is the phase entitled GET BUS which then permits the phase TRANSMIT MESSAGE , which then allows for the MESSAGE ACKNOWLEDGE phase. The WAIT FOR ADDRESS phase is the normal situation, and is not a transmitting state of a network device. In this phase, the network data bus is monitored for the destination address byte, FIG. 4. The address byte is valid on the data bus when the address NETAS and the strobe NETSB signals are active TABLE I . If the address equals the net address switch value for this device, then the SCN interface logic FIG. 2 prepares to receive the message. Following this, the next phase would be the RECEIVE MESSAGE phase. This RECEIVE MESSAGE phase should follow the address detected condition from the WAIT FOR ADDRESS phase. The first byte of data received is the destination address FIG. 4 byte which is detected in the WAIT FOR ADDRESS phase . The handshake signals, STROBE and ACKNOWLEDGE NETSB and NETAK are used to send message bytes over the network. For each byte of data read including the address byte , a longitudinal parity LP total must be calculated. The last byte received will be a LP longitudinal parity byte in order to ensure message integrity FIG. 4 . The LP total is calculated doing the exclusive OR of a starting value of 00 hex and with each message byte. The longitudinal parity byte which is received at the end of the message should then cause the calculated total to be FF hex. The next phase will be the MESSAGE ACKNOWLEDGE RECEIVER phase. When a network device has a message to be transmitted over the network, it must first get control of the network. The GET BUS phase accomplishes this. The network signal LOCK, NETLK FIGS. 1B, 2 is used to control the System Control Network SCN by a transmittting device. This signal, when active, indicates that the network is busy. Any SCN device may activate it by following the procedure of the GET BUS phase. Thus, the network GET BUS address format will be reflected according to the following arrangement During this phase, the LOCK output signal must remain active. The first byte to be sent is the destination address byte FIG. 4 . The address signal must be activated with this byte. The address signal must be de activated for the remaining bytes of the message. The handshake signals STROBE and ACKNOWLEDGE are used to send message bytes over the network. The transmitting device places information on the data bus NETD 7 8 , and activates the strobe signal, NETSB. The receiving device reads the data bus and notifies the transmitter that it has received the information by activating the ACKNOWLEDGE signal, NETAK. The transmitter then de activates STROBE the receiver then de activates ACKNOWLEDGE. The transmitting device must calculate a longitudinal parity LP on all the bytes which are sent over the network. The byte sent following the final data byte of the message is the actual LP byte FIG. 4 . After the completion of the message transmission reception phase, the next phase must be the MESSAGE ACKNOWLEDGE TRANSMITTER phase. The network message format is shown in FIG. 4 whereby certain data bits are provided for the destination address, for the source address, for the command bytes, for the longitudinal parity byte and for a dummy byte. A schematic diagram of the message flow and relative delay times which are used for the GET BUS phase, the MESSAGE phase and the ACKNOWLEDGE phase is shown in FIG. 5. After the completion of the message transmission, there is now provided the MESSAGE ACKNOWLEDGE TRANSMITTER phase. After the transmission of the final message byte that is, the longitudinal parity byte , the transmitting device must wait for the receiving unit to acknowledge the OK reception of the message. As seen in FIG. 5, the transmitter delays and then sends a dummy byte . The dummy byte may be of any particular value. If the message was received OK , the receiving device will return the ACKNOWLEDGE signal in response to the STROBE signal for the dummy byte. If this does not happen within a preset period of time, then the transmitter will consider the message as not OK and the transmitter will transmit the message again. After the reception of the final message byte that is, the longitudinal parity byte LP , the receiving unit must prepare to acknowledge the message. The receiver must first check the integrity of the message including longitudinal and vertical parity. While doing this, it must not at this time return the ACKNOWLEDGE to the STROBE for the dummy byte sent by the transmitter. If the message is OK , then the receiver will ACKNOWLEDGE the dummy byte when it is received. If the message was not OK , the receiver will not respond to the dummy byte. This will also force a transmitter time out due to the not OK response. The transmitter receiver flow for the network is shown in TABLE III. As was seen in FIG. 4, there was shown a messge of N bytes. All messages transmitted on the network bus will follow this format. TABLE IV, shown hereinbelow, indicates the detailed structure of each byte of this format. The master card unit 100 provides the central interconnection point for the system control network and for the power control network, in addition to the central connection for the remote support center interface 300 which provides remote diagnostics. It is also the master control for the power network which can provide for power on off actions of all the units in the network. However, the master card unit 100 is just another device in the system control network and does not hold any priority or master status as such. In such a system as the multiprocessor system described herein, there may be only one active master at any given time. However, because of its importance to the system operation and maintenance, it is preferred that there should be a spare master card unit. FIG. 6 shows a block diagram of the system and power interface master card unit 100. The master card unit 100 provides a microprocessor such as the described Intel 8088 which runs at 8 megahertz. It executes its code out of the PROM 100 As seen in FIG. 6, a power control interface 100 The remote support interface 100 The system control network logic 100 The card unit 100 will provide the following software modules This module performs confidence test on the specific hardware of the processor systems P1, P2, etc. of FIG. 1C. The system control network interrupt vector is set and the system control network logic is put into the WAIT FOR ADDRESS phase. This module also checks contents of the electrically erasable PROM if required. This module performs all communications with the remote support center 300 for diagnostic purposes. The low level 8 bit protocol or BDLC protocol will be implemented in this module. The only remote support center command that the master card unit 100 must recognize and respond to, is the command to power on . All other messages will be shipped upstream over the system control network to the system control processors P1, P2, P3, etc. for processing. This module will manage all the free memory RAM in the master card unit 100. This module will allocate memory to the various requesting modules. If enough memory for a request is not available, the memory manager will inform the calling routine of how much is available. If the calling routine decides it cannot wait for its full request, it may request as much memory as is available. The memory manager will maintain the free memory in as large an area as possible. This module will manage all common timers betwen the power interface master card and the hardware of processors P1, P2, etc. These common timers include three 16 bit timers in the counter I O chip. This module manages the locking mechanism for each timer that is, if a timer is unavailable and one is required immediately, a software comparison on the timer day count will be used. This module is responsible for sending and receiving messages over the system control network. Half of this module is interrupt driven the receiver function and the other half of the module is user driven the transmitter function . The master card 100 will initiate transmission over the system control network only under two conditions 1 power conditions from the power control network, FIG. 1 2 message received from the remote support center 300. All other master card transmissions will be in response to messages received on the network. When a network interrupt occurs for example, the master card network address has been received on a network , this module will receive the message up through the length bytes. If the length of the message is non zero, enough memory will be obtained from the memory management module and the remainder of the message will be received. After reception of the entire message, the command per TABLE II will be executed by this module. This may include sending one or more messages back over the network. It may also include sending a message to the remote support module or to the power flow module. This module is the main program of the master card unit 100. When the master card unit has nothing else to do, it will monitor the power status of the installation. This is the chief function for the master card that is, the monitoring and controlling of cabinet power. This module will maintain a map of all corresponding cabinets in the system. Included in the map are cabinet addresses and failure report bits. This module monitors the margin conditions, the power failures, and power change requests for the entire installation. The power status and control system is described in a co pending application entitled Power Control Network for Multiple Digital Modules , inventors Bruce E. Whittaker, James H. Jeppesen III, and Larry D. Sharp. In the master card unit 100, there is provision for certain interrupts which are set to have the following priorities These operate to interrupt the microprocessor 100 There has thus herein been described a system control network where equal opportunity is provided for any digital unit to become a transmitter so it can access and transfer data directly to any other digital unit in the network which can become a receiver. While the described embodiment can accomplish these functions, these may be accomplished in other embodiments which still operate within the scope of the invention as defined in the following claims.