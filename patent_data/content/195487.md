# Multi pulse excitation linear predictive speech coder.

## Abstract
A multi pulse excitation linear predictive speech coder operates in accordance with an analysis by synthesis method for determining the excitation. The coder 10 comprises an LPC analyzer 11 , a multi pulse excitation generator 13 , means 12,14 for forming an error signal representative of the difference between an original speech signal s n and a synthetic speech signal n , a filter 15 for perceptually weighting the error signal and means 16 responsive to the weighted error signal e n for generating pulse parameters controlling the excitation generator 13 so as to minimize a predetermined measure of the weighted error signal. The LPC parameters and the pulse parameters of the excitation signal x n are encoded for efficient storage or trans mission. The bit capacity required for pulse position encoding of the excitation signal x n is considerably reduced by arranging the excitation generator 16 for an excitation signal x n which in each excitation interval L consists of a pulse pattern having a grid of a predetermined number q of equidistant pulses and by arranging the control means 16 for generating pulse parameters characterizing the grid position k relative to the beginning of the excitation interval L and the variable amplitudes b

## Claims
1. A multi pulse excitation linear predictive coder for processing digital speech signals partitioned into segments, com prising a linear prediction analyzer responsive to the speech signal of each segment for generating prediction parametesr characterizing the short time spectrum of the speech signal, an excitation generator for generating a multi pulse excitation signal partitioned into intervals, each excitation interval con taining a sequence of at least one and at most a predetermined number of pulses, means for forming an error signal representative of the differ ence between the speech signal and a synthetic speech signal con structed on the basis of the multi pulse excitation signal and the prediction parameters, means for perceptually weighting the error signal, means responsive to the weighted error signal for generating in each excitation interval pulse parameters controlling the exci tation generator to minimize, in a time interval at least equal to the excitation interval, a predetermined function of the weighted error signal, characterized in that the excitation generator is arranged for generating an excitation signal which in each excitation interval consists of a pulse pattern having a grid of a predetermined number of equidistant pulses, and the means for controlling the excitation generator are arranged for generating pulse parameters characterizing the position of the grid relative to the beginning of the excitation interval and the variable amplitudes of the pulses of the grid.

## Description
The invention relates to a multi pulse excitation linear predictive coder for processing digital speech signals partitioned into segments, comprising a linear prediction analyzer responsive to the speech signal of each segment for generating prediction parameters characterizing the short time spectrum of the speech signal, an excitation generator for generating a multi pulse excitation signal partitioned into intervals, each excitation interval con taining a sequence of at least one and at most a predetermined number of pulses, means for forming an error signal representative of the differ ence between the speech signal and a synthetic speech signal constructed on the basis of the multi pulse excitation signal and the prediction parameters, means for perceptually weighting the error signal, and means responsive to the weighted error signal for generating in each excitation interval pulse parameters controlling the ex citation generator to minimize, in a time interval at least equal to the excitation interval, a predetermined function of the weighted error signal. Such a speech coder which functions in accordance with an analysis by synthesis method for determining the excitation is known from the article by B.S. Atal The basic block diagram of this type of coder is shown in Fig. 4 of the article by B.S. Atal Several variants of the above described basic block dia gram are known. In accordance with a first variant, an error sig nal is produced, not by constructing a synthetic speech signal and comparing it with the original speech signal, but by comparing the multi pulse excitation signal itself with a prediction residual signal derived from the original speech signal with the aid of an LPC analysis filter which is the inverse of the LPC synthesis filter in addition the perceptual weighting filter is modified correspondingly see Fig. 4 of the article by P. Kroon When judging multi pulse excitation coders MPE coders three criteria play an important role the complexity of the coder, the required bit capacity of the code signal, the perceptual quality of the synthetic speech signal. The complexity of MPE coders is predominantly determined by the error minimizing procedure used for selecting the best pos sible position and amplitudes of the sequence of pulses in the ex citation intervals. The excitation pulse sequence is subject to severe constraints with a view to the encoding of the pulse para meters and the LPC parameters to form a code signal having a bit rate in the 10 kbit s region and, in their turn, these constraints affect the quality of the synthetic speech signal. Thus, it appears that digital speech signals having a sampling rate of 8 kHz can be encoded in their totality with 9.6 kbit s and that a good speech quality can be preserved during synthesis when, for example, only 8 excitation pulses are allowed in each 10 ms interval 80 samples . The optimum procedure for error minimization then con sists in determining the best possible amplitudes for all the pos sible combinations of the positions of the 8 excitation pulses in the 10 ms interval 80 samples and in selecting that excitation pulse sequence which results in the lowest value of the error criterion. The number of possible combinations of the pulse positions is however so high Yet, for all these MPE coders it continues to hold that the necessary encoding of the positions of the excitation pulses in an excitation interval requires an important portion of the available overall bit capacity of about 10 kbit s. Even when an efficient pulse position encoding method is used, as described in the article by N. Berouti The invention has for its object to provide a speech coder of the type defined in the preamble of paragraph A , which compared with known MPE coders requires a considerably lower bit capacity for encoding the pulse positions of the excitation signal. The speech coder according to the invention is character ized in that the excitation generator is arranged for generating an excitation signal which in each excitation interval consists of a pulse pattern having a grid of a predetermined number of equidistant pulses, and the means for controlling the excitation generator are arranged for generating pulse parameters characterizing the position of the grid relative to the beginning of an excitation interval and the variable amplitudes of the pulses of the grid. The saving in bit capacity for the pulse position en coding of the excitation signal obtained by the measures according to the invention renders it possible to allow a larger number of excitation pulses per unit of time and consequently to construct a synthetic speech signal with a perceptual quality which compares favourably with those of prior art MPE coders having a code signal of the same bit rate. In addition, the temporal regularity of the excitation pulse pattern offers the feature that the amplitudes of the exci tation pulses can be determined optimally in accordance with an error minimization procedure which can be expressed in terms of matrix calculation, which has as its advantage that the sets of equations can be solved particularly efficiently on account of the specific structure of their matrices. In addition, this low degree of computational complexity can be still further reduced without detracting from the perceptual quality of the synthetic speech signal at code signals having a bit rate in the region around 10 kbit s. One possibility for that purpose is to impose a Toeplitz structure on the matrices, an alternative possibility for that purpose is to truncate the impulse response of the perceptual weighting filter such that the matrices become diagonal matrices. An alternative for the last mentioned possibility is the choice of a fixed perceptual weighting filter which is related to the long time average of speech and in designing this filter such that the auto correlation function of its impulse response is zero at equi distant instants which have the same distance as the equidistant pulses of the excitation pulse pattern. Particulars and advantages of the speech coder according to the invention will now be explained in greater detail in the following description of exemplary embodiments with reference to the accompanying drawings, in which Fig. 1 shows a functional block diagram for the use of an MPE encoder in accordance with the first variant of paragraph A in a system comprising a transmitter 1 and a receiver 2 for transmitting a digital speech signal through a channel 3, whose transmission capacity is significantly lower than the value of 64 kbit s of a standard PCM channel for telephony. This digital speech signal represents an analog speech signal originating from a source 4 having a microphone or a dif ferent electro acoustic transducer, and being limited to a speech band of 0.4 kHz by means of a low pass filter 5. This analog speech signal is sampled at an 8 kHz sampling frequency and converted into a digital code suitable for use in transmitter 1 by means of an analog to digital converter 6 which at the same time effects part itioning of this digital speech signal in overlapping segments of 30 ms 240 samples which are refreshed every 20 ms. In transmitter 1 this digital speech signal is processed into a code signal having a bit rate in the region around 10 kbit s which is transmitted Transmitter 1 includes a multipulse excitation coder MPE coder 10 which utilizes linear predictive coding LPC as a method of spectral analysis. As MPE coder 10 processes a digital speech signal representative of the samples s nT of an analog speech signal s t at instants t nT, where In MPE coder 10 the segments of the digital speech signals s n are applied to an LPC analyzer 11, in which the LPC parameters of a 30 ms speech segment are calculated in known man ner every 20 ms, for example on the basis of the autocorrelation method or the covariance method of linear prediction see L.R. Rabiner, R. W. Schafer, Digital Processing of Speech Signals , Prentice Hall, Englewood Cliffs, 1978, Chapter 8, pages 396 421 . The digital speech signal s n is also applied to an adjustable analysis filter 12 having a transfer function A z which in z transform notation is defined by MPE coder 10 operates in accordance with an analysis by synthesis method for determining the excitation. To that end, MPE coder 10 comprises an excitation generator 13 producing a multi pulse excitation signal x n partitioned into time intervals of, for example, 10 ms 80 samples . In each 10 ms excitation interval 80 samples , this excitation signal x n contains a sequence of j pulses with 1 j J and, for example, J 8, each pulse having an amplitude b j and a position n j within this interval so 1 n 80 . In a difference producer 14, this excitation signal x n is compared with the residual signal r The weighted error signal e n is applied to a gene rator 16 which in each 10 ms excitation interval determines the pulse parameters b j and n j of the excitation signal x n for controlling excitation generator 13. In generator 16, the weighted error signal e n is squared and accumulated over a time interval of at least 10 ms so as to obtain a meaningful error measure E of the perceptual difference between the original speech signal s n and a synthetic speech signal n constructed in response to the excitation signal x n and the LPC parameters a i . In generator 16, the pulse parameters b j and n j are now determined such that the error measure E is minimized. For error measure E it holds that The most elementary form of transmission of the LPC parameter a i and the pulse parameters b j , n j is a direct transmission from transmitter 1 to receiver 2. Receiver 2 includes an MPE decoder 17 having an excitation generator 18 controlled by the transmitted pulse parameters b j , n j for generating the multi pulse excitation signal x n , and an adjustable synthesis filter 19 controlled by the transmitted LPC parameters a i for constructing a synthetic speech signal n in response to the excitation signal x n . The transfer function of synthesis filter 19 is 1 A z 5 A z being the transfer function of inverse analysis filter 12 in transmitter 1 as defined in formula 1 . In practice, the digital transmission of the LPC para meters a i and the pulse parameters b j , n j require quantizing and encoding. To that end, transmitter 1 comprises an encoding and multiplexing circuit 20 including an LPC parameter encoder 21, a pulse parameter encoder 22 and a multiplexer 23, and receiver 2 comprises a corresponding demultiplexing and decoding circuit 24 including a demultiplexer 25, an LPC parameter decoder 26 and a pulse parameter decoder 27. As is known, the use of inverse sine variables or theta coefficients ϑ i obtained by first converting LPC parameters a i into reflection coefficients k i and then to employ the transform For the transmission of each of the two types of pulse parameters b j and n j of the excitation signal x n several encoding methods are possible. Good results can be obtained by using for the amplitudes b j a simple adaptive PCM method, the maximum absolute value B of the amplitudes b j being determined in each 10 ms excitation interval and these amplitudes b j being uniformly quantized in a range B, B , Using an encoding with 3 bits per amplitude b j and a logarithmic encoding with 6 bits for maximum value B in a dynamic range of 64 dB, the bit capacity then required for encoding 8 amplitudes b j per 10 ms excitation interval is 3.0 kbit s. For encoding the pulse positions n j use can be made of the combinatorial encoding method mentioned in paragraph A , a number of In multiplexing the code signals for the theta coeffi cients 2.2 kbit s and for the pulse parameters b j and n j of the excitation signal 3.0 4.0 7.0 kbit s , 2 bits are added by multiplexer 23 to the 20 ms frame for synchronizing demulti plexer 25 so that a total bit capacity of 9.3 kbit s is required in the described example. This example clearly shows that an important part 43 of the overall bit capacity of 9.3 kbit s is used for encoding the pulse positions of the excitation signal. In accordance with the invention, a significant saving in the bit capacity for pulse position encoding is now achieved by arranging excitation generator 13 of MPE coder 10 in transmit ter 1 for generating an excitation signal x n which in each ex citation interval L samples L x 125 µs consists of a pulse pattern having a grid of a predetermined number of For a specific MPE coder 10 the numbers L and D are chosen optimally, but otherwise these numbers are fixed magnitudes. When the same excitation interval as in the described example is chosen so 10 ms, L 80 and the maximum number of pulses per ex citation interval of this example is chosen for the fixed number of pulses of the grid so q J 8 , then it appears that this grid can assume 10 different positions within the excitation inter val since D L q 10 and that the position of this grid can be encoded with only 4 bits since 1 k 10 2⁴ . For pulse position encoding of the excitation signal x n a bit capacity of only 0.4 kbit s is then required instead of the above mentioned value of 4 kbit s. With a substantially equal overall bit capacity the saving of 4.0 0.4 3.6 kbit s obtained by these measures, can now be utilized to increase the number of excitation pulses per unit of time by using, for example 2000 pulses per second in stead of 800 pulses per second as in the embodiment already de scribed. This implies that in a 10 ms L 80 excitation interval 20 excitation pulses now occur instead of 8, it being possible for the grid to assume 4 different positions D L q 80 20 4 and the position of the grid can be encoded with only 2 bits. When the amplitudes b In response to this excitation signal x n , in which the restriction in the degree of freedom of the pulse positions is combined with an increase in the number of excitation pulses per second, a synthetic speech signal n is obtained at the out put of synthesis filter 19 in MPE decoder 17 whose perceptual quality compares advantageously with the quality in the embodiment already described, in which the degree of freedom of the pulse positions was not restricted. Although in this excitation signal x n the spacing D between two consecutive pulses is constant within each excitation interval in the last case D 4 , this generally does not hold for the spacing between the first pulse of an excitation interval and the last pulse of the preceding excitation interval as the grid positions in these excitation intervals need not be the same. This prevents the excitation signal x n from having a long time regularity of 1 to D in its pulse positions. This is an advantage, it is known from literature that such a long time regularity of the excitation in the class of RELP coders Residual Excited Linear Prediction Coders may lead to audible metallic background noise known as tonal noise , being produced cf. the article by R.J. Sluyter in Proc. IEEE Int. Conf, on Commun. 1984, Amsterdam, the Netherlands, pages 1159 1162 . In this connection it is advantage ous to choose for the length of the excitation interval a value of, for example, 5 ms L 40 without changing the number of ex citation pulses per second. This implies that 10 excitation pulses now occur in a 5 ms excitation interval L 40 , it being possible for the grid to assume 4 different positions D L q 40 10 4 and the position of the grid being encoded with 2 bits. When the maximum absolute value of the amplitudes of the excitation pulses are again determined every 10 ms so now over 2 excitation inter vals and the further data of MPE coder 10 are not changed, then the pulse positioning encoding requires a bit capacity of 0.4 kbit s so that the total required bit capacity is in this case 6.6 0.4 2.2 1.1 9.3 kbit s and consequently is equal to the bit capacity required in the first described example. For the case in which the excitation signal x n is partitioned into 5 ms excitation intervals, in which 10 excitation pulses are produced with a mutual spacing of 0.5 ms, so for the values L 40, q 10 and D L q 4, Fig. 2 shows the excitation grids within an arbitrary excitation interval for the 4 possible grid positions k 1, 2, 3 and 4. The allowed pulse positions n j as defined in formula 9 are marked in each grid by vertical lines and the remaining pulse positions by dots. To illustrate the operation of MPE coder 10 according to the invention, Fig. 3 shows a number of time diagrams, all relating to the same 30 ms speech signal segment the portion shown has a length of approximately 20 ms . For an MPE coder 10 in accordance with the described prior art having not more than 8 pulses per 10 ms excitation interval, diagram Fig. 4 shows a functional block diagram of an MPE coder having a structure in accordance with the basic block diagram of paragraph A , which is also suitable for use in the system of Fig. 1. Elements in Fig. 4 corresponding to those in Fig. 1 are given the same reference numerals. The important difference with Fig. 1 is that in MPE coder 10 of Fig. 4 the original speech signal s n is directly applied to difference producer 14 and is compared therein with a synthetic speech signal n . This synthetic speech signal n is constructed in response to the excitation signal x n of generator 13 with the aid of a synthesis filter 28 controlled by the LPC parameters a i of LPC analyzer 11 and having a transfer function 1 A z , A z again being defined by formula 1 . This difference s n n is perceptually weighted by means of a weighting filter 15 which in this case has a transfer function W₁ z defined by W₁ z A z A z γ 10 with A z γ given by formula 3 . The measures according to the invention can be used with the same advantageous results in a MPE coder 10 of the type shown in Fig. 4 as in an MPE coder 10 in accordance with Fig. 1. For the case of Fig. 4 the same corresponding MPE decoder 17 can be used as in Fig. 1. Fig. 5 shows functional block diagrams of MPE coders 10 having a structure in accordance with the second variant of paragraph A applied to an MPE coder 10 as shown in Fig. 1, and further a functional block diagram of the corresponding MPE de coder 17. Elements of Fig. 5 corresponding to those of Fig. 1 are given the same reference numerals. As has already been stated in paragraph A , it is known that the quality of the synthetic speech signal is increased by not only calculating LPC parameters a i characterizing the envelope of the segment time spectrum of the speech signal but also LPC parameters characterizing the fine structure of this spectrum pitch prediction and by utilizing both types of LPC parameters for the construction of the synthetic speech signal. The ideal excitation for the synthesis is the pre diction residual signal r Block diagram A similar improvement in the speech quality can be achieved by means of an MPE coder 10 in accordance with block diagram Mutatis mutandis, the variant described with reference to block diagrams The corresponding MPE decoder 17 is shown in block dia gram The measures according to the invention can also be utilized in those variants of MPE coder 10 as described with reference to Fig. 5, the advantages described in the preceding paragraph D 1 then also being obtained. In that case the same corresponding MPE decoder 17 can be used as shown in block dia gram The procedure for determining grid period The L samples of the excitation signal x n weighted error signal e n and residual signal r When for grid position In addition, a matrix H having L rows and L columns is introduced, the j th row comprising the impulse response of weight ing filter 15 produced by a unit impulse δ n j , and the matrix product M Because of the memory hangover of weighting filter 15, a signal e When the values n 1 and n L are chosen as limits for the sum in formula 4 for error measure E and consequently the minimization interval is equal to the relevant excitation interval , then the object is to minimize E Basically, the procedure then consists of calculating the error measure E This basic procedure comprises solving D sets of linear equations of the type defined in formula 21 . However, on the basis of their specific structures, the matrix H In the procedure described so far, the minimization interval is equal to the excitation interval and the limits for the sum in formula 1 for the error measure E are equal to n 1 and n L. This minimization procedure consequently utilises a covariance method and the matrices H However, for the minimization procedure use can also be made of an auto correlation method. The limits for the sum in formula 4 for error measure E are then chosen on the basis of the following considerations. Weighting filter 15 with a transfer function W z defined by formulae 2 and 3 has a pulse response h n which rapidly decays for values γ less than 1 and consequent ly has a finite effective length N, so that in a proper approxi mation it may be assumed that h n 0 for n N. As the procedure is utilized for determining grid position Now a matrix H is introduced having L rows and L N column instead of L columns, the j th row again comprising the impulse response h n of weighting filter 15 produced by a unit impulse δ n j . When the matrix product M From the above considerations it can be seen that the minimization procedures in MPE coders according to the invention differ from the procedures in prior art MPE coders by their low computational complexity. This low complexity can be still further reduced without detracting from the perceptual quality of the syn thetic speech signal for code signals having a bit rate in the region around 10 kbit s. Thus, determining grid position Weighting filter 15 in Fig. 1 has a transfer function W z as defined in formulae 2 and 3 and an impulse response h n which can be simply reduced to the expression h n h₁ n γ Now it is possible to choose a different window function w₁ n with a much shorter effective duration than w When a linear window function w₁ n is used, impulse response h n of weighting filter 15 is given by h n h₁ n w₁ n 28 It then follows from formula 27 for w₁ n that h n 0 n D₁ 29 and consequently that impulse response h₁ n is truncated at the value n D₁ 1. If now the truncation value D₁ is chosen such that D₁ D L q 30 where D is the distance between two equidistant pulses of ex citation signal x n , then this choice results in a significant simplication of the minimization procedures described in paragraph D 3 , both in the case of the covariance method and in the case of the auto correlation method. Namely in both cases the matrix pro duct H In formula 32 , 33 vector e A second possibility to simplify the minimization pro cedures described in section D 3 is the use of a fixed weighting filter 15 which is related to the long time average of the speech. Experiments have shown that the subjective perception of a noise shaping effected by such a fixed weighting filter 15 is qualified as being at least as good as the noise shaping effected by an ad justable weighting filter 15 described in the foregoing, when for the transfer function W z of this fixed weighting filter 15 the following function G z is chosen The use of a fixed weighting filter 15 having a fixed impulse response g n results in a significant reduction of the computational complexity of the minimization procedures described in paragraph D 3 , both for the covariance method case and for the auto correlation method case. In both cases, matrix H becomes a fixed matrix and the D matrices H If now the impulse response g₁ n of this fixed weighting filter 15 is not multiplied by an exponential window function w It is however not always necessary to truncate the impulse response of a fixed weighting filter 15 with the object of obtaining a diagonal matrix H It is now possible to choose impulse response h n such that R m o for the values m D, 2D, 3D, ... 39 matrix H If now R m is written as The modification of weighting filter 15 as described in section D 4 , can alternatively be effected in MPE coders 10 having a structure as described with reference to Fig. 5, in which use is also made of the LPC parameters characterizing the fine structure of the short time speech spectrum pitch prediction . This holds for block diagram Between the MPE coders in which the modifications of the perceptual weighting filter have not been applied and the MPE coders in which these modifications have indeed been applied, small differences can be observed in the quality of the synthetic speech signals when the LPC parameters and the pulse parameters of the ex citation signal are represented with a high degree of accuracy. This accurate representation is, however, accompanied by a high bit rate of the code signal. With bit rates of the code signal in the region around 10 kbit s, the parameters are however quantized such that the quantization effects are greater than the small quality differences. Consequently these small differences have no practical significance. For the rest, it should be noticed that the aforesaid small differences relate to a synthetic speech signal quality of a level which is considered to be hardly different from toll quality. This quality level is achieved for code signals having a bit rate of about 10 kbit s.