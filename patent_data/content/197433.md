# SWITCHING SYSTEM HAVING A TONE TRUNK AND METHOD FOR GENERATING DIGITAL CODES THEREIN

## Claims
Schaltsystem mit

## Description
The present invention relates to a switching system, including a tone trunk TNT which produces a variety of digital tone signals to be supplied, after conversion into analog tone signals, to subscriber telephone sets, and to methods of generating digital codes for such a system. FR A 2 374 808 describes a process and a device for recognising coded multi frequency telephonic signals in digital form. The document discloses a digital switching centre having a circuit for interfacing between the centre and an analog network. The document contains no discussion of problems caused by quantizing noise. Generally, there are two methods of producing each tone signal from the tone trunk to the subscriber s telephone set. First, the tone trunk produces an analog tone signal and supplies it to the subscriber as is. Second, the tone trunk stores, in advance, a tone in the form of a digital signal, i.e. a digital tone signal, in its digital memory, and the digital tone signal is read therefrom. And then when required, the digital tone signal supplied, after conversion into the corresponding analog tone signal, to the related subscriber. Of the above mentioned two methods, the switching system of the present invention uses the tone signals produced as in the latter method i.e. digitally processed tone signals. The thus produced digital tone signals are supplied from the tone trunk to the subscribers in the form of a dial tone DT , a ring back tone RBT , a busy tone BT , a reorder tone ROT , a hold cone HT , and the like, selectively. These digital tone signals are stored in the digital memory of the tone trunk, such as a read only memory ROM . Usually, each digital tone signal is obtained by first sampling a corresponding analog tone signal and then coding the thus sampled analog tone signal with a predetermined coding rule, such as a known pulse code modulation PCM coding rule. In the usual PCM coding rule, each sampling analog tone signal level is quantized into a corresponding quantization level. Among the many different quantization levels, the quantization level is selected by determining a level which is closest to the sampling analog tone signal level. It is commonly known that the thus obtained digital tone signal is accompanied, when converted into the audible analog tone signal, by a quantizing noise, and from general experience, such a quantizing noise is inoffensive to the listener when the noise accompanies a random analog tone signal such as a voice signal. The problem in the prior art switching system having the digital tone trunk is that the quantizing noise is offensive to the listener when the noise accompanies a monotonous tone such as the dial tone DT , the ring back tone RBT and the like. Thus, the quantizing noise is not negligible with regard to the dial tone and so on, and is heard as a single tone superimposed on the analog tone to be communicated. Although the level of the single tone is considerably low, it is offensive to the ears of the subscribers. An object of the present invention is to provide a switching system including a tone trunk TNT , in which the tone trunk stores, in its digital memory, a particularly processed digital tone signal which does not produce an offensive single tone caused by quantizing noise when converted into an analog tone signal. To attain the above object, the digital memory of the tone trunk stores therein a digital tone signal which is particularly processed in such a way that the analog tone signal, converted from the digital tone signal, has a frequency spectrum in which a white noise is exhibited in an audio frequency range other than at the frequency or frequencies inherent to the related analog tone signal. According to one aspect of the invention, there is provided a switching system comprising a plurality of telephone sets for subscribers a network which is operative to achieve a switching operation of digital signals to be communicated between the plurality of telephone sets by way of respective line circuits having a coder and decoder and a tone trunk which is operative to store, in a digital memory thereof, at least one predetermined digital tone signal, in the form of digital codes, for supplying, by way of the network and said decoder, the corresponding analog tone signal to the telephone sets, characterized in that the digital codes are coded in such a way that the decoded analog tone signal is accompanied by a quantizing noise, created during a conversion from the analog tone signal to the digital tone signal, which quantizing noise is substantially the same as a white noise said digital codes being composed of usual digital codes or modified digital codes, in which each of the usual digital codes is determined by allotting a quantization level which produces a lowest quantizing noise level, while each of the modified digital codes is determined by allotting a quantization level which produces a quantizing noise level which is higher than the lowest quantizing noise level, i.e. next higher quantizing noise level and said digital codes are selected such that the related analog tone signal is accompanied by quantizing noise having a low fundamental frequency, so that the higher harmonics of the quantizing noise results in said white noise. Preferably, each of said digital codes for respective sampling analog tone signal levels to be coded, which is analogous to the sampling levels of said analog tone signal, is determined to conform with a characteristic of a low pass filter which is applied to the preceding quantizing noise levels at each preceding sampling point. Preferably, each of the digital codes corresponding to respective said sampling analog tone signal levels, is determined according to a prediction of the quantizing noise level P n , at the sampling point According to another aspect of the invention, there is provided a method for generating digital codes to be stored in a digital memory of a tone trunk in a switching system having a network, the digital codes are supplied, by way of the network, in the form of a digital tone signal to telephone sets of subscribers pertaining to the switching system, after a conversion to the corresponding analog tone signal, and the digital codes are composed of usual digital codes or modified digital codes, characterized in that each modified digital code is generated by the steps of a supplying a sampling analog tone signal level, which analog tone signal is analogous to said analog tone signal to be supplied to the subscribers b determining a usual quantization level Q According to a further aspect of the invention, there is provided a method for generating digital codes to be stored in a digital memory of a tone trunk in a switching system having a network in which the digital codes are supplied, in the form of a digital tone signal, to telephone sets of subscribers pertaining to the switching system, by way of the network, after a conversion to the corresponding analog tone signal, characterized by the steps of a supplying each sampling analog tone signal level F n , which analog tone signal is analogous to said analog tone signal to be supplied to the subscribers b selecting a corresponding quantization level Q The above object and the features of the present invention will be more apparent from the following description of the preferred embodiments with reference to the accompanying drawings wherein, wherein Before describing the embodiments of the present invention, the problem of the prior art will be first described with reference to the related figures. Figure 1 is a general view of a known switching system. In the switching system 10, the present invention particularly relates to a tone trunk 14 having a digital memory, preferably a read only memory ROM 15. The tone trunk is provided by a network NW 13 and supplies a digital tone signal S The ROM 15 stores a variety of digital tone signals S Figure 2 is a more detailed general view of the switching system shown in Fig. 1. Members identical to those of Fig. 1 are represented by the same reference numerals and characters. The telephone set 11 is connected with the network 13 via a line circuit LC 21, which is mainly comprised of the decoder DEC 23, the coder COD 24, both forming the CODEC 12, and a hybrid circuit HYB 22. An analog voice signal generated from the telephone set 11 is transmitted to a multiplexer MUX in the network 13 by way of the hydrid circuit 22 and the coder 24, which produces a digital voice signal. It should be understood here that many identical telephone sets 11 and the corresponding line circuits 21 are commonly connected with the multiplexer 13, but only one telephone set and also only one line circuit are illustrated herein for brevity. The thus multiplexed digital voice signals are assigned to respective time slots and fed to a speech path memory SPM 32 in which a desired switching operation of the multiplexed digital voice signals is achieved with the use of a speech path control memory SCM 33, which stores address data, under control of a central control equipment CC 34, so that the speech path control memory 33 produces the address for accessing the speech path memory 32 in order to establish a required switching. The thus switched digital voice signals are distributed, by means of a demultiplexer DMUX 35, to the other side telephone set similar to the telephone set 11 by way of the decoder similar to the decoder 23 which converts the received digital voice signal into the analog voice signal to be actually heard with the telephone set. The multiplexer 31 also multiplexes, together with the received digital voice signals, the digital tone signal S Figure 3 depicts waveforms of analog tone signals. The waveform at right side indicates the analog tone signal S As mentioned previously, the single tone due to the quantizing noise is offensive to the ear when the monotonous analog tone, such as the dial tone DT is given to the subscriber. This will be clarified with reference to Fig. 4. Figure 4 is a graph of a frequency spectrum actually measured with the use of an analog tone decoded from the conventional digital codes. The analog tone used for the measurement is the analog dial tone DT according to the aforesaid U.S. standard. Accordingly, two strong spectra are exhibited at the frequencies 350 Hz and 440 Hz. In the graph, attention should be paid to the fact that there are some spectrum peaks at frequencies other than the inherent frequencies 350 Hz and 440 Hz in the range between 0 Hz and 1 kHz, which peaks, such as SP1 and SP2, have relatively high spectrum levels within the audio frequency range. If the spectrum peak SP1 is strongest among the spectrum peaks, an offensive monotonous tone is heard as a tone of about 600 Hz. The present invention is featured by the following fact. That is, under a conventional coding rule, each of the digital codes to be stored in the digital memory refer to the ROM 15 1, 15 2, ..., 15 n for the corresponding sampling analog tone signal is determined in such a manner that the predetermined quantization level is selected by a level closest to the level of the sampling analog tone signal to be coded, so that the thus determined digital code is given, in the form of the digital tone signal, to the decoder in the line circuit to feed the corresponding decoded analog tone signal to the subscriber. According to the present invention, the digital codes to be stored in the digital memory are composed of the usual digital codes, as mentioned above, and or the modified digital codes. The modified digital codes are not determined through usual coding, but are determined such that either the usual or modified digital codes produce, when decoded into the corresponding analog tone signal, a quantizing noise in the form of a white noise. The thus produced white noise effectively hides the aforesaid peaks shown by SP1 and SP2 in Fig. 4 of the spectrum which are offensive to the ear. This will be immediately comprehended, at a glance, with reference to Fig. 5. Figure 5 is a graph of a frequency spectrum actually measured with the use of an analog tone decoded from digital codes composed according to the present invention. In the example, an analog dial tone DT is used, as in the measurement for the spectrum of Fig. 4. As apparent from the graph of Fig. 5, the quantizing noise is formed as the white noise. The white noise is a random acoustic noise that has equal energy per cycle over a specified total frequency band. This creation of the white noise as the quantizing noise is a unique idea based on the present invention. To be specific, the modified digital codes are determined such that the modified digital codes or the usual digital codes produce, when both digital codes are decoded into the analog tone signal, the quantizing noise having a lower frequency than that of the usual quantizing noise. In this case, the quantizing noise of a low frequency necessarily generates higher harmonics, compared to the fundamental frequency, which results in the generation of the intended white noise, as shown in the graph of Fig. 5. To be more specific, the modified digital codes are determined as follows. When a sampling analog tone signal level is given, the corresponding digital code is created by coding a certain quantization level for the given sampling analog tone signal level, which quantization level is different from the usual quantization level therefor. This will be clarified with reference to Fig. 6. Figure 6 is a level chart for explaining the modified digital code according to the present invention. In the level chart, a part of the analog tone signal S Figures 7A and 7B are flow charts of successive steps for determination of the modified quantization level to obtain the modified digital codes according to the present invention. In step 71, an analog tone signal level Z is supplied by sampling a given analog tone signal to be coded. In step 72, usual quantization level Q Another example for realizing the present invention will be mentioned below. Figure 8 is a graph for explaining a sampling of an analog tone signal to be coded. Figure 9 is a graph for explaining a digital coding of the levels sampled according to the process shown in Fig. 8. Figure 10 is a graph for explaining a variation of the quantizing noise. Figure 11 is a graph for the modified quantizing noise which features the present invention. In Fig. 8, a curve S The analog tone signal S The relationship between the PCM digital codes and the linear levels for each sampling analog tone signl level Na, Nb, ..., Nf of Fig. 8 is clarified with reference to Fig. 9. The sampling analog tone signal levels a and b Na and Nb of Fig. 8 are transformed into the PCM digital code of level 81. The sampling analog tone signal levels c , d , e , and f are transformed into the PCM digital code of level 80. The PCM digital codes of levels 81 and 80 are decoded in the decoder 23 Fig. 2 and become the linear levels of 1087 and 1023, respectively. Thus, the change in waveform from the curve of Fig. 8 to the curve Fig. 9 necessarily produces the quantizing noise having the waveform of Fig. 10. In other words, the differences Na, Nb through Nf with respect to the center levels X₀ and X₁ cause the quantizing noise of Fig. 10 having the frequency defined by the change of the differences Na, Nb, ..., Nf in time series. The essential point of the present invention is well understood from Fig. 11. The quantizing noise curve of Fig. 11 is a part of the curve of Fig. 10. In Fig. 11, the inherent quantizing noise is defined by the solid line curve G and the broken line curve H, as illustrated in Fig. 10. However, the inherent quantizing noise curve H is transformed into a modified quantizing noise curve which is defined by the solid curve I. The modification of the quantizing noise curve G H is performed by selecting, at the sampling point n, not the usual noise level Nc but the modified noise level Nc . The selection of Nc , instead of Nc, has already been explained with reference to Fig. 6. Thus the modified PCM digital code is obtained by particularly using the quantization level X₁ in Fig. 8 for the sampling analog tone signal S The above mentioned shift in frequency of the quantizing noise into a low frequency can be attained by selecting the quantization levels so as to produce the related quantizing noise having a waveform substantially identical to the waveform inherent quantizing noise obtained through a low pass filter LPF . The above mentioned low frequency quantizing noise can be practically obtained by selecting each quantizing level for each sampling analog tone signal level with the use of a prediction means having a characteristic of a low pass filter. The prediction predicts the quantizing noise level with the use of at least two preceding quantizing noise levels in accordance with the characteristic of the low pass filter. Assuming that the two predicted preceding quantizing noise levels are P n 2 and P n 1 , the next expected quantizing noise level P n is predicted by using the two noise levels P n 2 and p n 1 so as to conform with the characteristic of the low pass filter. Then the actual quantizing level at the sampling point n, is determined to be a quantizing level which is closest to the predicted quantizing level P n . The above mentioned prediction according to the low pass filter is performed most simply under the equation Taking the curve of Fig. 11 as an example, when the preceding predicted quantizing noise levels P n 2 and P n 1 assume the levels Na and Nb, respectively, the next quantizing noise level P n is predicted as which is the level indicated by the broken line X in Fig. 11. Then, the actual quantizing level, at the sampling point n, is determined to be that which is closest to the predicted level X , which is equivalent to a case, in Fig. 8, where the larger level difference, i.e., Nc , is used instead of the smaller level difference, i.e., Nc, which would have been used under the usual coding rule. The above mentioned prediction can be performed, in general, by using a known transversal filter, i.e., a transversal type low pass filter. The transversal type low pass filter operates to predict the quantizing noise level P n by the equation where T Figures 12A and 12B are flow charts of successive steps, according to the present invention, for the generation of the digital codes including the modified digital codes to be stored in the digital memory. It should be understood that the example concerned is based on the modification performed in Fig. 11. In the example, the analog tone signal S In step 122, a variety of the prescribed PCM data concerned are prepared. A part of the prescribed PCM digital codes, according to the known µ law, is shown in Table I below. A part of the linear levels to be decoded in the decoder 24 Fig. 2 is shown in Table II below. According to the prior art method, it is not necessary to use the data of the above Table II, however, in the present invention, the data concerned are needed for the calculation of the quantizing noise levels refer to Na through Nf in Fig. 10 , which will be achieved later in step 124. In step 123, the amplitudes at each sampling point for the analog tone signal S t denotes a sampling period, for example, under an 8 kHz sampling rate, and In step 124, each quantizing noise level P n is predicted by using at least two preceding quantizing noise levels P n 2 and P n 1 according to a characteristic of a low pass filter. Practically, as mentioned previously P n is simply predicted by the expression where P 2 and P 1 are zero. In step 125, a quantization level Q n at the sampling point In step 126, the modified sampling analog tone signal level G n is transformed into the corresponding PCM digital code. Then, the thus transformed PCM digital codes are once loaded in a magnetic tape MT and supplied to the digital memory ROM 15. Figure 13 is an example of a data format of the PCM digital code. The PCM digital code represents, as an example, the sampling analog tone signal level allotted to the range 7391 through 7647 reciated in the Table I. Figures 14A and 14B are flow charts of successive steps which are more practical embodiments of the steps of Fig. 12B. In step 141 of Fig. 14A, the quantization level Q In step 142, the quantizing noise level P n , at the sampling point which represents the characteristic of the transversal type low pass filter. In step 143, whether or not the sign of Q In step 144 of Fig. 14B, if the result of step 143 is YES , a modified or nonmodified quantization level G n is determined, which G n is equal to either Q In step 145 of Fig. 14B, if the result of step 143 is NO , a modified or nonmodified quantization level G n is determined, which G n is equal to either Q In step 146, the thus determined G n , as for Q In step 147, the PCM digital code PCM n is stored in the digital memory ROM 15, via a suitable buffer, such as the magnetic tape MT. In step 148, the previous P n 2 is replaced with the previous P n 1 . Further, the difference between F n , i.e., original sampling analog tone signal level, and C n , i.e., determined in step 144 or 145, is used as a new preceding level P n 1 . In step 149, if all of the sampling points, for example, 800 points, are not yet processed NO , the next PCM coding operation starts again from step 141. If the result is YES , the digital memory 15 is fulfilled with the PCM digital codes for the corresponding analog tone which will be heard at the subscribers telephone without a single tone offensive to the ears. As mentioned above in detail, according to the present invention, a high quality switching system is realized in view of the tone trunk TNT , since the digital memory thereof contains digital codes therein which do not produce, when converted into the corresponding analog tone signal, a single tone offensive to the ear.