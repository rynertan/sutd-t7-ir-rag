# Floating point arithmetic unit.

## Abstract
A data processing system includes multiple floating point arithmetic units, for example, an adder and a multiplier 2, 4 . Two putaway busses 6, 10 and two bypass busses 12, 13 are connected to a register file 8 and waiting stages, associated with the arithmetic units, respectively. A special source register 32 is included for keeping track of the source of any result on the busses so that the registers may be connected to the appropriate bus on which the result is to appear in accordance with a busy or mark bit set in each register in the file and in the waiting stage. This allows multiple data items to exit the pipes during any cycle. Therefore, two or more results are produced each cycle. Fig. 1 .

## Claims
1. A floating point arithmetic unit, characterized by the conbination of

## Description
The present invention is in the field of arithmetic units for computing systems, and is in particular directed to floating point arithmetic units. Many computer programs are characterized as having a large number of floating point arithmetic operations. As a consequence, a large number of the instructions executed by the machine are floating point instructions floating add, floating subtract, floating multiply, floating compare, etc. . For such programs, the greater the number of floating point arithmetic instructions that can be executed per cycle, the faster the machine speed of operation. Arithmetic results produced by the floating point arithmetic unit must be saved, in a register file, for instance, for later use and for eventual storage into memory. Although many designs for arithmetic units allow multiple arithmetic operations to be in execution at once, most allow only one actual result be produced each cycle. The IBM model 360 91 is an example of a machine with multiple floating point arithmetic units. As arithmetic results exit from one of the arithmetic units, they are placed on a putaway result bus where they travel to the register file and enter a predetermined register for which they are destined. In addition, the results travel along a special bypass bus which is connected to the waiting stages associated with each arithmetic unit. If any instruction in a waiting list is waiting for the newly produced result, the result is entered into one of the buffers in the waiting stations. In this way, performance is increased by not requiring waiting instructions to wait while the needed result is first gated into the register file and then gated from the register file into the waiting station. A complete description of this scheme may be found in An Efficient Algorithm for Exploiting Multiple Arithmetic Units by R. M. Tomasulo, IBM Journal, January 1967, pp. 25 33. Since there is only one putaway bus and one bypass in the Tomasulo scheme, only one floating point result may be produced each cycle. U. S. Patent 4,075,704 to O Leary describes a floating point data processor for high speed operation, which includes two arithmetic units and two putaway busses. Both busses pass back to both arithmetic units. However, each bus enters only one side of each arithmetic unit. Although the drawings in O Leary illustrate multiple entries into each side of the arithmetic unit, these are controlled by the decoder central control . Thus, O Leary s scheme allows only a single data item, that is a result, to enter a given side of the pipeline during any cycle, and O Leary s scheme requires central control. U. S. Patent 3,697,734 to Booth et al sets forth a digital computer utilizing a plurality of parallel asynchronous arithmetic units, which include a bussing scheme similar to O Leary, in that only one arithmetic result is produced each cycle. IBM Technical Disclosure Bulletin, Vol. 14, No. 10, March 1972, pp. 2930 2933 in an article by Sofa et al sets forth a floating point arithmetic scheme in which a single arith metic result is allowed onto the pipeline during each cycle. In an article by Ramamoorthy in Computing Surveys , Vol. 9, No. 1, March 1977, pp. 61 85, various schemes are set forth for making floating point arithmetic operations, with each of the schemes allowing only one arithmetic result to enter the pipeline during each cycle. It is an object of the invention to provide an improved floating point arithmetic unit which can produce two arithmetic results per cycle of operation. It is another object of the invention to provide an improved floating point arithmetic unit having separate adder and multiplier putaway busses which can produce an add result on the adder putaway bus and a multiply result on the multi plier putaway bus during each cycle of operation. The present invention describes an apparatus for producing two or more arithmetic floating point results in a given cycle of operation. The arithmetic unit includes an adder and a multiplier and two putaway busses and two bypass busses which are connected to a register file and waiting stages associated with the respective floating point arith metic units. A special source register keeps track of the source of any result on the busses so that the registers may be connected to the bus on which the result is to appear in accordance with a busy or mark bit set in each register in the file and in the waiting stages. This allows multiple data items to exit the pipe during any cycle, such that two or more results are produced each cycle. The invention will now be described with reference to accompanying drawings, where FIG. 1 is a block diagram representation of a floating point arithmetic unit according to the present invention, in which dual putaway bypass busses are utilized FIG. 2 is a detailed block diagram representation of the register file illustrated generally in FIG. 1 and FIG. 3 is a detailed block diagram representation of the ad der and multiplier units which are shown generally in FIG. 1. FIG. 1 is a block diagram of a floating point arithmetic unit according to the present invention. The unit is comprised of an adder pipeline unit 2, a multiplier pipeline unit 4, with the output of the adder pipeline unit being connected via an adder putaway bus APB 6 to a register file 8, with the output of the multiplier pipeline unit being connected via a multiplier putaway bus MPB 10 to the register file 8. The adder putaway bus is also connected to an adder bypass bus ABB 12 which is connected to a left adder wait station 14 and a right adder wait station 16 as well as a left multiplier wait station 18 and a right multiplier wait station 20. The multiplier putaway bus 10 is also connected to a multiplier bypass bus MBB 13 which is connected to the left adder wait stations 14, the right adder wait station 16, the left multiplier wait station 18 and the right multiplier wait station 20. The register file 8 is connected via a left register input bus LRI 22 to the left adder wait station and the left multiplier wait station 14 and 18, respectively, with a right register input bus RRI 24 being connected to the right adder wait station and right multiplier wait stations 16 and 20, respectively. An instruction register 26 is connected via an instruction operand bus IOB 28 to the respective wait stations, as well as being connected via a bus 30 to the register file 8. The central processing memory unit 32 provides an input to the instruction register 26 via a bus 34, and an input to the register file 8 via a register load bus RLB 36, and receives an input from the register file 8 via a register store bus RSB 38. The instruction register 26 and memory 32 are included in the overall central processing unit CPU , not shown, and are operative with, but not part of the arithmetic unit herein described. The instruction register 26 sequentially receives instructions from the central memory 32 and executes them. As the instructions are executed, floating point numbers are transferred between the register file 8 and memory 32, and certain operations on these numbers are initiated within the arithmetic unit. Although many types of arithmetic instructions are allowed, such as, addition, subtractions, inversions, comparisons, multiplications, divisions, and so on, instructions are divided into two classes adder type instructions and multiply type instructions, although more classes are permissible given one pipeline unit for each class. All instructions executed by the arithmetic unit are assumed to be of the form FLOP SR1, SR2, TR where FLOP specifies the floating point operation to be performed add, subtract, etc. , SR1 and SR2 designate the two source registers or operands, and TR specifies the target register. SR1, SR2, and TR are all registers in the register file. For example, FADD R1, R7, R12, specifies that the value in register 1 is to be added to the value in register 7 and that the result is to be stored in register 12. In normal execution, when an arithmetic instruction is executed, the two specified source registers are gated out of the register file and are sent to the appropriate pipeline execution unit based on the class of operation. Some number of cycles later, the result of the operation is produced by the pipeline unit and stored away in the specified target register. It is possible for new instructions to be entered into a pipeline unit before all previous instructions in the unit have completed execution. Furthermore, results can emerge from a pipeline unit in an order different than the order in which they enter. Finally, a result can emerge from one pipeline before a result from the other pipeline even though the instruction for the second result was initiated first. The register file 8 is shown in detail in FIG. 2. There are included therein a number of floating point registers, denoted as R1 through Rn. Each register has a value field which holds the register value, a source bit, and a busy bit. The n registers together comprise the register file. Three busses, the adder putaway bus 6, the multiplier putaway bus 10 and the register load bus 36 enter the register file, and three busses, the left register input bus 22, the right register input bus 24 and the register store bus 38 leave the register file, although these may actually be multiplexed into two input or two output busses. Data values can be stored from the register file 8 into memory 32 over the register storage bus 38. Data values can be loaded from the memory 32 into the register file 8 over the register load bus 36. As values are produced by the adder unit, those values are stored into the register file 8 via the adder putaway bus 6. Similarly, values produced by the multiplier unit are stored into the register file 8 over the multiplier putaway bus 10. When a floating point operation is decoded, in general, two source registers are specified, SR1 and SR2. Either of these may designate any of the registers R1 through Rn. The designated register for SR1 is output onto the left register input bus 22, and the de signated register for SR2 is output onto the right register input bus 24. In addition, an immediate operand in the instruction register 26 can be used in place of either SR1 or SR2. In this instance, the operand is provided over the instruction operand bus 28 to either of the left register or right register input busses 22 and 24 respectively. The two values placed on the left register input and right register input bus pass to either the adder unit or the multiplier unit. Simultaneously, the busy bit for the specified target register, denoted by BUSY TR , is set on. Further, if the operation is an adder class operation, SOURCE TR is set to ZERO if it is a multiplier class operation, it is set to ONE. All the actions described thus far occur in one cycle, the cycle in which the instruction is decoded. Some number of cycles later, the value for register TR will be produced. If the value is produced by the adder unit, the result is returned over the adder putaway bus 6 and if it is produced by the multiplier unit, the result is returned over the multiplier putaway bus 10. Therefore, if the source bit is ZERO, indicating an add operation, only the adder putaway bus 6 is monitored by register TR, and conversely if the source bit is ONE, indicating a multiply operation, only the multiplier putaway bus is monitored. Each cycle, results may be placed on the adder putaway 6 or the multiplier putaway bus 10. Every register with its busy bit on has an invalid value field since the correct current value is being produced by one of the adder or multiplier units. As a result, each busy register expects its new value to return over the adder putaway bus or the multiplier putaway bus 10. If the busy bit is on, and the corre sponding source bit is ZERO, the value will return over the adder putaway bus 6. If the source bit is ONE, the value will return over the multiplier putaway bus 10. As values return over a bus, a register designation accompanies the value. If a waiting register sees its register designation appear on the appropriate putaway bus, the new value is gated into the register value field and the busy bit is turned off. The busy bit for a register stays on from the time an instruction is decoded that designates that register as a target and until the time the new value returns over the appropriate putaway bus for that register. During that time, if a new instruction attempts to decode which also specifies that register as the target register, that in struction is not allowed to decode. Refer now to FIG. 3 which is a detailed diagram of the adder and multiplier pipeline execution units. Each waiting station register includes a plurality of bits of informa tion. For example, a valid V bit which is indicative of whether the register stage is turned on for each left waiting station a RDY1 bit which is indicative of whether or not that operand is ready for execution purposes an S1 bit which is indicative of whether a result for this register is to appear on the adder or multiplier bypass bus, and an R1 field which is the operand value likewise the right waiting station registers include bits RDY2, S2, and R2 a target register TR is included as well as an OP field which is indicative of which type of arithmetic operation is to be performed. When a new adder type instruction is decoded, the in struction is entered in encoded form into one of the adder wait stations 14 and 16. When the instruction is entered, the valid V bit of the station is turned on and the TR field is set to the TR value specified in the instruction. The instruction also specifies the two source registers, SR1 and SR2 in the register file 8 See FIG. 2 . If BUSY SR1 is false, VALUE SR1 is output from register file 8 onto the LRI bus 22 and enters the R1 field of the adder wait station unit 14, and RDY1 is set true to indicate that the left operand is ready. However, if BUSY SR1 is true, VALUE SR1 is invalid at this time. Since it is invalid, it is being produced by one of the arithmetic units. If source R1 is ZERO, then the adder produces the new VALUE R1 and the new value will appear on the adder putaway bus 6 if SOURCE R1 is ONE, the multiplier produces the new VALUE R1 and the new value will appear on the multiplier putaway bus 10. BUSY SR1 is true, RDY1 is set to false, and Sl is set to SOURCE SR1 . Similarly, the right half of the wait station is set up depending on the value of BUSY SR2 . At each cycle, if a wait station unit has V, RDY1, and RDY2 all true, then the instruction in the wait station unit can enter the arithmetic pipe and begin producing its result. If V is true, but one or both or RDY1 or RDY2 if false, one or both operands are not yet produced. Suppose RDY1 is false. Then, the needed value appears eventually on either the adder bypass bus 12 or the multiplier bypass bus 13. If RDY1 is false but S1 is ZERO, the value appears on the adder bypass bus 12. Each unready half of a valid wait station monitors the appropriate bypass bus, and when the needed value appears, designated by a TR value, the register value is entered into the wait station and the ready bit is set. Additionally, the register file accepts the new register value and turns off its corresponding busy bit. Each register in the register file 8 and each wait station unit portion can accept a value each cycle from any one of the input busses. Significantly, however, each must monitor only one bus. Which bus to monitor is designated simply by the one bit source designation. Two results can be produced and put away each cycle, as long as they are from different units, that is one from the adder unit and one from the multiplier unit. Clearly, this scheme can be extended to more than two pipelines by utilizing fields larger than one bit.