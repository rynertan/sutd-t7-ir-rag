# ELECTRICAL SIGNAL DISCRIMINATION

## Claims
Verfahren zum Simulieren der zeitveränderlichen Hintergrundsignalkomponente 19 der elektrischen Reaktion eines Wandlers, dessen Reaktion zumindest ein datenlieferndes Signal 12, 14, 16 aufweist, welches dem Hintergrundsignal 18 überlagert ist, wobei das Hintergrundsignal eine erste abnehmende Komponente aufweist, die einem Nachhall des Wandlers zuschreibbar ist, und eine zweite, ständig vorliegende elektrische Rauschkomponente aufweist, deren Beitrag von der Elektronik herrührt, die dem Wandler zugeordnet ist, mit folgenden Schritten Betrieb des Wandlers zur Erzeugung einer ersten Reaktion anfängliches Speichern, in digitaler Form, mehrerer Schwellenwerte, die kollektiv die Umhüllende der ersten Reaktion Figur 1C approximieren Betrieb des Wandlers, um eine zweite Reaktion mit einer unterschiedlichen, datenliefernden Signalverteilung zu erzeugen und Modifizieren der gespeicherten Schwellenwerte, so daß sie kollektiv eine Umhüllende approximieren, die der Wandlerhintergrundsignalkomponente entspricht, welche von den datenliefernden Signalen befreit wurde, die in der ersten und zweiten Reaktion vorhanden sind, wobei das Verfahren ein Kombinieren der anfänglich gespeicherten Schwellenwerte Figur 1C mit der zweiten Reaktion umfaßt, um ein Ausgangssignal Figur 1D zu erzeugen, bei welchem die datenliefernde Signalkomponente bzw. die datenliefernden Signalkomponenten der ersten Reaktion invertiert ist bzw. sind in bezug auf die datenliefernde Signalkomponente bzw. die datenliefernden Signalkomponenten der zweiten Reaktion, und das Modifizieren der Schwellenwerte umfaßt, um von dem kombinierten Ausgangssignal die datenliefernde Signalkomponente bzw. die datenliefernden Signalkomponenten zu annullieren.

## Description
This invention relates to the processing of electrical signals so as to discriminate between signal components of interest and unwanted background signal noise. The invention is particularly but not necessarily exclusively applicable to ultrasonic pulse echo techniques where the background noise is largely attributable to reverberation effects resulting from pulsing of the pulse transmitter coupled with the random electrical noise level of the conditioning electronics. The reverberation effects accompany the transmitted pulse and decay in an approximately exponential manner, being superimposed on the electrical noise level of the electronics. The echo pulses are likewise superimposed on the electrical noise level and are required to be distinguished from the background noise. In general, the output signal is gated for a suitable interval of time during which the echo pulses are expected to be available for detection. Such gating will usually eliminate the larger amplitude reverberation effects as these will have decayed substantially before the commencement of the gating interval. Nevertheless, in many cases, the gating interval will embrace some of the reverberation components as well as the electrical noise component. One approach of achieving discrimination is to impose a fixed level threshold of suitable amplitude and, to avoid spurious signals, the threshold level must be selected to be above the largest amplitude reverberation effects that are likely to occur during the gating interval. This is subject to a number of drawbacks however the magnitude of the threshold level may result in loss of low amplitude echo signals the threshold level may need to be modified if the gating interval is changed or shifted useful information may be lost in case of signal components not falling within the gating interval and the reverberation effects vary from one ultrasonic transducer to another with the consequence that the threshold levels may likewise differ for different transducers of the same design. The object of the present invention is to provide improvements in signal discrimination. A prior method system of simulating the time variable background signal component of the electrical response of a transducer whose response includes at least one data providing signal superimposed on said background signal is known from document GB A 2 007 061 Further features of the invention will become apparent from the following description and appended claims. To promote further understanding of the invention, one example will now be described with reference to the accompanying drawings, in which The system shown in Fig. 2 is primarily intended for use in ultrasonic imaging in liquid metal cooled fast breeder reactors wherein echos from a group of sodium immersible pulse echo transducers are collected and stored, the transducers being pulsed sequentially as they are moved progressively over the target to be imaged. Efficient scanning of the target depends on maximising the amount of data collected in a given time. Figure 1A illustrates a typical transducer response obtained which consists of echos 12, 14, 16 superimposed on a background noise level comprising electrical noise produced by the electronics associated with the transducers and reverberation effects resulting from firing of the transducer. The electronics noise is present at all times whereas the reverberation component which is indicated by reference numeral 18 decays substantially exponentially with some superimposed fine structure to the level of the electronics noise. Thus, at the left hand side of the trace, the reverberation component predominates whereas the electronics noise dominates at the right hand side. The signal may be gated as shown by reference numeral 21 to define the area of interest. To discriminate between background noise and the signal components of interest, ie. the echos, a fixed threshold level may be imposed. For best sensitivity with this approach, it will be seen that the threshold level must be set slightly above the maximum amplitude peaks, eg. 22, of the background noise otherwise background peaks can be confused with echos. However, the use of a fixed level may result in loss of useful data since relatively small amplitude echos will be masked. It will be seen that during typical gating period, the background may contain a significant contribution from the decaying reverberation component. In accordance with the invention, the drawbacks associated with the use of a fixed threshold level are largely overcome by producing a threshold trace which follows closely the variations in the background signal reverberation plus electronics noise . Derivation of the threshold trace will be described herein below. The threshold trace is derived for each transducer and is stored in digital form as a large number of threshold values in assigned memory addresses of an electronic memory 30 see Fig. 2 , each threshold level being associated with a particular interval of time relative to a datum, eg. the transmitted pulse. Thus, the group of memory locations corresponding to a particular transducer will store a series of threshold values which, when taken in the appropriate sequence, will collectively approximate the envelope of the background characteristic of that transducer so that the real time background can be nullified by the threshold trace. As shown in Fig. 2, the circuitry comprises a central control 32 which receives, via input lines 34 and 36, the transmit signals from the transducers as they fire and data enabling the transducers to be identified. As mentioned, certain memory locations are reserved in the memory 30 for each transducer and the identification signals received on input line 36 enable the control 32 to address, via 38, those memory locations associated with the respective transducer whereby the contents of those memory locations can be loaded into an up down counter 40 via input output device 42. Line 44 from the control 32 allows counting pulses to be applied to the counter for the purposes explained below. The input output device 42 is also connected to a level shift amplifier 46 via D A converter 48 whereby the signal level of the amplifier may be shifted in dependence upon the analogue counterparts of the digital signals obtained from the memory 30. The transducer signals are applied to the amplifier 46 via input line 49 and the output 50 of amplifier is connected to a pair of discriminators 52, 54. The discriminator 54 serves to detect echos which are supplied to echo processing circuitry via output line 56 for analysis using conventional techniques whereby, for instance, the time intervals elapsing between echo signals and a datum signal eg. the transmitted signal can be determined. The discriminator 52 is connected to the counter 40 via line 58 and determines the direction of counting according to whether the output on line 50 is greater or smaller than a reference signal which may be produced by the control 32 applied to input 60 of the discriminator 52. After initial calibration, the memory locations associated with each transducer will store a large number of digital values which can be applied sequentially via the D A converter 48 to the level shifting input of the amplifier 46 so that level of the latter is continually varied in dependence upon the contribution made by the background component of its signal trace. In this way, the background component is effectively nullified so as to leave only the data providing signal, ie. the echos, which can then be supplied to the echo processing circuitry via discriminator 54. The calibration procedure for one transducer will now be described. Typically the signal trace of the transducer is as shown in Fig. 1A which has been described earlier. The first stage in the calibration procedure involves storing, in an assigned area of memory 30, a digital simulation of the transducer trace shown in Fig. 1A. It will be understood that each time the transducer is fired, it will generate the same trace provided all other factors, eg. transducer position etc., remain unchanged. Initially, the contents of the memory 30 will all be zero or some other arbitary value. Each time the transducer is fired, the control 32 initiates a sequence of steps in which the contents of different addresses in the memory are loaded into the counter 40 and also into the converter 48. It will be appreciated that the time interval in which each step of the sequence is executed will be very short, ie. a few milliseconds, so that during each sequence a large number of steps will be involved. During the first stage of calibration, a predetermined reference signal is applied to the input 60 of the discriminator 52. Each step of the sequence involves shifting the level of the amplifier 46 according to the digital value loaded into the converter 48 and comparing the output on line 50 with the reference signal on line 60. If the comparison shows that the amplifier output exceeded the reference level, the discriminator produces a signal on line 58 which places the counter 40 in a decrement mode. If not, a signal is applied to line 58 to place the counter in an increment mode. During each step, a predetermined number of pulses eg. 1 is supplied to the counter 40 by the control 32 so that the counter is decremented or incremented by that number of pulses, depending on the mode signal applied via line 58. The updated contents of the counter 40 are then loaded back into the respective memory address in the memory 30. This procedure is repeated for each successive memory address until the entire span of the transducer trace over the time interval of interest has been covered and the cycle is then repeated until the digital values stored by the memory addresses substantially correspond to respective analogue values of the transducer trace. The result of the first stage can be seen from Figures 1B and 1C. Figure 1B shows the compensated output on line 50 which will be seen to fluctuate to a small extent only about the reference level indicated by reference number 70. Figure 1C shows the simulated transducer trace provided collectively by the digital values stored in the memory 30, each digital value being shown as a dot in Figure 1C. Although as described above, the contents of each memory address is loaded into the counter and then returned to that address after incrementing or decrementing during the same step, in practice the arrangement may be such that incrementing or decrementing of the contents of one address and return to memory takes place while the next address is being loaded into the converter 48. Also, after the calibration procedure has reached the point where the echos are zeroed out by the compensating signals stored in memory, the decrement mode of the counter may be inhibited temporarily so that only incrementing is possible. In this way, stored digital value can be adusted so that the compensated output on line 50 is just above the reference level 70 applied to input 60. From Figure 1C, the simulated trace can be seen to contain echos 12, 14, 16 as well as reverberation and electrical noise components. The second calibration stage involves freeing the simulation of the echo components and this is achieved by causing the transducer to produce a trace with differently positioned echos, eg. by changing the positional relationship between the transducer and a scanned target. In general, such a change will only alter the positions of the echos and the envelope of the reverberation and electrical noise components will remain substantially the same for a given transducer and associated conditioning circuitry. Thus, for example, the changes made result in the compensated output on line 50 being of the form shown in Figure 1D in which the old echos 12, 14, 16 are seen in inverted form even though they are no longer present in the transducer trace and a new echo 72 is superimposed on the otherwise substantially constant output. At this time, the procedure of the first calibration stage is repeated but with decrementing of the counter 40 disabled so that stored digital values in memory are adjusted to eliminate only the inverted echos. The resulting output on line 50 is indicated in Figure 1E and the corresponding digital simulation collectively represented by the stored digital values is shown in Figure 1F which, at this time, will be a close approximation to the envelope of the reverberation and electrical noise components of the transducer. Although the simulation provided by the first two stages of calibration may suffice in some instances, a further sophistication is possible. Close examination of the output on line 50 reveals that the background level tends to rise with time, especially in that part of the trace dominated by the electrical noise component. This is illustrated by Figure 1G which shows part of the trace magnified. At the left hand side, the reverberation component predominates and the signal level in this region is close to the reference level 70. At the right hand side, the electrical noise component predominates and because of random fluctuations, the signal peaks in this region tend to be somewhat above the reference level 70. To compensate for this effect, in the third calibration step, the transmitter pulse is inhibited as a result of which the compensated output on line 50 will appear as shown in Figure 1H. Incrementing of the counter 40 is also inhibited and the procedure of the first stage is then repeated but with the increment inhibit imposed and a second reference level 75 applied at input 60 of the discriminator 52. The second reference level 75 may be selected so that it is slightly above the peaks of the reverberation dominated part of the background level. The resulting decrementing of the contents of the memory leads to a compensated output on line 50 of the form shown in Figure 1I and when transmitter firing is resumed, the output will be as shown in Figure 1J in which all of the background peaks are substantially masked by the second reference level 75. At this time, the digital simulation may be shown in Figure 1K. It will be understood that following derivation of a digital simulation for each transducer, that simulation may be used for the respective transducer in subsequent scanning operations so as to effectively eliminate the background level and facilitate detection of the data providing signals. In the foregoing description with reference to the drawings, compensation of the transducer output is achieved by combining the digital simulation following conversion to analogue form with the transducer output by means of a level shift amplifier wherein the level shift is determined by the stored digital values. However, other ways of combining the digital simulation with the transducer output may be employed, eg. instead of modulating the level or gain shift of an amplifier, the digitally stored values may be used to modulate the discriminator 52.