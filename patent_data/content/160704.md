# DATA INPUT OUTPUT METHOD FOR APPLICATION SYSTEM IN NUMERICAL CONTROL APPARATUS

## Claims
Numerisches Steuersystem mit einem einen Prozessor 6 zum Ausf√ºhren eines Anwenderprogramms und eine an den Prozessor 6 gekoppelte Speichereinrichtung 8 zum Speichern des Anwenderprogramms aufweisendes Anwendersystem AS und einer einen numerischen Steuerprozessor 3 zum Ausgeben des Anwenderprogramms an das Anwendersystem AS und eine an den numerischen Steuerprozessor gekoppelte Eingabeschnittstelle 5 aufweisende numerische Steuereinrichtung NC ,

## Description
The present invention relates to a data input output system for an application system in a numerical control system A maker who manufactures and sells numerically controlled machine tools usually implements them by combining machine tools of their own making with numerical control equipment developed and manufactured by a numerical control equipment maker. In this case, since the numerical control equipment is not a special one applicable only to a certain type of machine tool, but a versatile one applicable to various types of machine tools, it is difficult for the numerically controlled machine tool maker to exhibit their own characteristic feature in functional parts of the numerical control equipment of the numerically controlled machine tool built by themselves, and their own features are limited specifically to functional parts of the machine tools. For this reason, there has been a strong demand for development of numerical control equipment of the type that will permit the numerically controlled machine tool maker to easily present their characteristic features in the functional parts of the numerical control equipment. Fig. 1 is a functional block diagram of a numerical control system proposed to meet the above demand, in which an application system AS is added to a part equivalent to conventional numerical control equipment NC. This application system ranks with the NC in an NC machine tool system in terms of the priority for software execution and permits the machine tool maker to prepare, by themselves, some of the NC functions such as sequence control between the NC and the machine tool, conversion of input data, control of an MDI Manual Data Input device and a CRT, etc. Incidentally, the application system AS is formed, in practice, by a processor system comprising a processor, a memory and so forth. Accordingly, its operation is defined by a program stored in the memory. Therefore, it is desired that it is possible to input the program into the application system AS and, conversely, to read out the program for output. An object of the present invention is to enable the application system AS side to input and output a program and so on through use of an RS232C or like interface provided on the NC side. Another object of the present invention is to make it possible to command the NC from the application system AS side. EP A1 35322 discloses a numerical control system according to the preamble of the attached claim. According to the present invention there is provided a numerical control system comprising an application system including a processor operable to execute an application program, and memory means coupled to the processor for storing the application program and numerical control equipment including an NC processor for delivering the application program to said application system, and an input interface coupled to the NC processor, characterised in that the processor of the application system is operable to deliver a program which the NC processor can receive and execute, the interface coupled to the NC processor is an input output interface, and coupled between the application system processor and the NC processor there is at least one data buffer, at least one flag for indicating that data has been stored in said at least one data buffer, at least one pointer for indicating the data in said at least one data buffer which is currently being referred to and a control flag for indicating the purpose for which said at least one data buffer is being used, whereby the application system can take partial charge of the NC functions of the numerical control equipment, and data can be input to and output from the application system via the input output interface provided in the numerical control equipment. Fig. 1 is a functional block diagram of a numerical control system which has an application system AS Fig. 2 is a block diagram illustrating the principal part of an example of the hardware construction of a numerical control system embodying the present invention and Figs. 3 to 8 are flowcharts of the operation of Fig. 2. In Fig. 2, reference numeral 1 indicates a ROM for storing a system program, 2 a RAM for storing a cutting program and 3 an NC processor which has its general operation defined by the system program stored in the ROM 1 and interprets and executes the cutting program stored in the RAM 2 to drive a servo motor 4, effecting numerical control of a machine tool not shown. Reference numeral 5 designates an input output interface such as RS232C, through which interface 5 a main program is stored in a RAM 2 and, conversely, the contents of the RAM 2 are output to a tape puncher or the like, as is well known. Reference numeral 6 identifies a processor for the application system AS , which is connected via a bus 7 to peripheral circuits such as a writable readable memory, for instance, a magnetic bubble memory 8, a control flag 9, data buffers 10 and 11, flags 12 and 13 and pointers 14 and 15. These peripheral circuits are connected via a bus 16 to the NC processor 3. The right hand side of the one dot chain line 17 in Fig. 2 is the NC side and the left hand side the application system side. The data buffers 10 and 11 are buffer registers for data transmission and reception between the NC side and the AS side. The flags 12 and 13 are one bit flags which indicate that data has been set in the data buffers 10 and 11, respectively. The pointers 14 and 15 are one word pointers which indicate the data of the data buffers 10 and 11 which is currently being referred to. The control flag 9 is a flag which indicates for what purpose the data buffers 10 and 11 are used. These peripheral circuits 9 to 15 are accessible from either of the NC processor 3 and the AS processor 6. Figs. 3 and 4 are flowcharts showing examples of operations for sending a program from the NC side to the AS side, Fig. 3 showing processing by the AS processor and Fig. 4 processing by the NC processor. S1 to S4 and S11 to S16 are respective steps involved, When issuing a read command to the AS processor 6 and the NC processor 3 by means not shown, the AS processor 6 sets the control flag 9 to request the NC side to read S1 , and upon receipt of this request S11 , the NC processor 3 starts to read a program through the input output interface 5 S12 . That is, the processor checks whether the data buffers 10 and 11 are empty or not S13 , and if so, it sets data program in them S14 . Such an operation is continued to final data, and when the final data is reached, its flag is set S15, S16 . By checking the flags 12 and 13, the AS processor 6 decides whether data has been set in the data buffers 10 and 11 S2 , and if so, it reads the data S3 . Such an operation is continued to the final data S4 . Incidentally, the data buffers 10 and 11 may also be used alternately with each other, and either one of them can also be used as a ring buffer. Figs. 5 and 6 are examples of flowcharts for sending a program from the AS side to the NC side for punching the program, Fig. 5 showing processing by the AS processor 6 and Fig. 6 processing by the NC processor 3. S21 to S25 and S31 to S34 indicate respective steps involved. When issuing a punch command to the AS processor 6 and the NC processor 3 by unshown means, the AS processor 6 sets the control flag 9 to request the NC side to punch S21 and sets data in the data buffers 10 and 11 which are empty S22, S23 . Upon accepting the punch request S31 , the NC processor 3 reads out the contents of the data buffers 10 and 11 and sends them via the input output interface 5 to a puncher not shown , carrying out punch processing S23 . In this way, the As side can input and output a program via the input output interface 5 provided on the NC side. Accordingly, for example, a program for controlling a DI DO an input output device can be input into the AS side and output as a paper tape from the AS side. Further, by using an arrangement which sends NC command data, in place of the above program, from the AS side to the NC side, it is also possible to drive the servo motor from the AS side and to prepare in the NC the program that the AS desires. Figs. 7 and 8 are flowcharts showing an example of NC command program readout processing, Fig. 7 showing processing on the AS side and Fig. 8 processing on the NC side. S41 to S45 and S51 to S56 indicate respective steps involved. A request for program setting is made from the NC side by setting the control flag 9, and the transmission and reception of the NC command program are performed in the same manner as described above. In this case, however, the NC processor 3 reads out data of the data buffers 10 and 11 and then interprets it to make preparations for execution S54 , thereafter carrying into execution S56 . As described above, according to the present invention, since a program can be input to and output from an application system via an input output interface of numerical control equipment, the invention has the advantage that the inputting of a program or the like to the application system and the entering of a punch command to a puncher can be achieved with a more economical arrangement than in the case where an input output interface is provided separately. Moreover, since a command to the NC can be issued from the application system AS side, it is possible to actuate the servo motor from the AS side via the NC and to prepare in the NC a program desired by the AS side.