# APPARATUS FOR MEASURING ULTRASONIC CHARACTERISTIC VALUES OF A MEDIUM

## Claims
Vorrichtung zum quantitativen Messen charakteristischer Werte eines Mediums durch Senden eines Ultraschallimpulsstrahles in das Medium, Empfangen reflektierter Wellen, die als Ergebnis von Reflexionen des Ultraschallimpulsstrahles in verschiedenen Tiefen z in dem Medium auftreten, wobei die so reflektierten Wellen zu verschiedenen Zeiten empfangen werden, die den verschiedenen Tiefen in dem Medium entsprechen, in welchen die Reflexion aufgetreten ist, und Verarbeiten des resultierenden Empfangssignals, das von den empfangenen reflektierten Wellen abgeleitet ist, welche Vorrichtung enthält

## Description
The present invention relates to an apparatus for quantitatively measuring characteristic values of a medium by sending an ultrasonic wave pulse beam into the medium, such as a human body, etc., receiving pulse waves as sequentially reflected from respective depths in the medium and by processing the resultant received signal, and particularly to apparatus having a signal processing system where an error resulting from the fact that the degree of convergence divergence of the ultrasonic beam changes non uniformly as a function of depth in the medium can be corrected on a realtime basis in the time region without obtaining spectrum shape by FFT, etc. First, changes in convergence of an ultrasonic beam in dependence upon depth in a medium will be explained. In Fig. 1 a , 1 denotes an ultrasonic wave transducer consisting of a piezoelectric element such as PZT, etc., and 2 is a medium such as a human body. A primary ultrasonic pulse sent from the transducer 1 travels in the depth direction z axis direction in the Figure of the medium, generates secondary waves as a result of reflections from the medium at respective depths and finally disappears in transmission. The reflected waves from respective depths travel in the direction opposite to the direction of travel of the primary pulse and are received again by the transducer 1 . A wave reflected from a shallow depth in the medium reflected at a small value of z reaches the transducer 1 quickly, but a wave reflected from deep in the medium at a large value of z reaches the transducer with a delay. Therefore, the resultant received signal has a continuous waveform. Characteristic values, such as ultrasonic wave attenuation coefficient, etc., of the medium, for example a living body tissue, can be obtained by processing such received signal wave. It is obvious that attenuation coefficient is proportional to frequency in living body tissue, etc., and the proportional coefficient is called the slope of attenuation coefficient and therefore it is often used as a characteristic value of a medium. When primary ultrasonic pulses used are reflected from different depths into the same medium as explained above, the shape of the spectrum and the intensity of the wave must always be constant, irrespective of the depth, in order to check the frequency characteristics of the medium, if there is no attenuation in the transmission function of the medium and it does not depend on frequency. In reality, however, the shape of an ultrasonic beam formed depending on the sending and receiving sensitivity of ultrasonic pulse is not constant as a function of depth regarding some frequency components and for one frequency component changes as shown in Fig. 1 a . Moreover, sound pressure on the centre axis is distributed as shown in Fig. 1 b . Said beam is also formed as indicated by broken lines in Fig. 1 a for another frequency component and therefore sound pressure on the centre axis is distributed differently from the distribution shown in Fig. 1 b . This is because the degree of convergence namely, degree of divergence of the beam changes geometrically in three dimensions. If this effect is neglected, a large error is introduced into the distribution in the depth direction of measured characteristic values of the medium. With a view to correcting such error, the inventors have proposed the following system Namely, a reference medium, such as water, which exhibits attenuation to such a small degree that it can be neglected, is used. It is desirable that acoustic impedance of and sound velocity in the reference medium are as similar as possible to acoustic impedance of and sound velocity in a medium to be measured but if there are differences, this can be corrected. An ultrasonic pulse is transmitted from the same transducer as will be used for measurement, and a reference reflector a solid flat plate or ball having a smooth or rough surface is placed in various depths z distance between the transducer and the reflector along the beam line of the transducer is taken to be z , and the respective reflected waves are received and spectrums Sz f are also obtained. f represents frequency. As a reference depth, a depth z₀, for example, near the focus shown in Fig 1, is used and the spectrum of reflected waves from the depth z₀ is considered as Sz₀ f . In the spectrum region, Sz f ² is standardised by Sz₀ f ². A value Gz f obtained by such standardisation is called a geometrical factor G factor as indicated below. Here, S z f ² is defined as a power spectrum as indicated by the equation 2 . In this case, S z f has the same shape of spectrum and intensity, namely Sz₀ f , for every depth. Error due to the geometrical factor can be corrected by measuring and processing characteristics values of the medium through investigation of how S z f changes in accordance with the medium to be measured. A concept similar to that of reference Thereafter, this concept was applied in other proposals However, the references In the reference In case n is large in the reference The inventors of the present invention have proposed a signal processing system where characteristics values of a medium are extracted from a receiving signal in the time region without converting it to the frequency region In a reference Reference A reference The reference However, it is naturally necessary to correct for the G factor even in the case of reference EP A 0 076 168 discloses a system with the features of the pre characterising part of claim 1, for quantitatively measuring characteristic values of a medium by sending ultrasonic waves into the medium, receiving reflected waves, arising as a result of reflections of the ultrasonic waves at different depths in the medium, the reflected waves thus being received at different times corresponding to the different depths in the medium at which reflection occurred, and processing the resultant receiving signal, derived from the received reflected waves. The system includes a memory storing compensating signals. The compensating signals are employed for eliminating adverse effects on the received waves arising due to frequency dependency of acoustic field shape. A reference medium which is homogeneous, has almost the same sound velocity as that of the medium to be measured and has no or very weak frequency dependent attenuation and reference reflector are employed to obtain signals derived from waves reflected from respective depths in the reference medium. Such reflected wave signals are obtained from ultrasonic waves, transmitted into the reference medium, of respective different centre frequencies. The signals are filtered on the different centre frequencies, analysed and the compensating signals are generated, which are intended to compensate for relative intensity variations due to frequency characteristics of the measuring system. Compensating signals relating to each different centre frequency are stored in the memory. When measurement is carried out in respect of a measurement medium, the gain of a filter circuit used to extract the relevant frequency component from a reflected wave is compensated by the compensating signals derived as above and read from memory, so that the filter circuit provides a compensated output. The compensated output is converted to an energy value. Energy values are thus obtained of each of the ultrasonic waves of different centre frequencies. These energy values are stored, with time values. Medium characteristic values are obtained from the stored energy and time values. EP A O 076 168 indicates that instead of two frequency bands two centre frequencies use may be made of a continuous full spectrum, but what is involved is not explained. US A 4 197 750 discloses the use and switching of filters in ultrasonic imaging apparatus. According to the present invention there is provided apparatus for quantitatively measuring characteristic values of a medium by sending an ultrasonic pulse beam into the medium, receiving reflected waves, arising as a result of reflections of the ultrasonic pulse beam at different depths in the medium, the reflected waves thus being received at different times corresponding to the different depths in the medium at which reflection occurred, and processing the resultant receiving signal, derived from the received reflected waves, the apparatus including It is an object of the present invention to provide a simplified, small size, high precision and economical apparatus for measuring characteristic values of a medium, which apparatus realizes high speed correction on a real time basis by providing a system for realizing correction in the time region and in such a form as to allow scalloping correction without converting a received signal into the frequency region when effecting G factor correction, needed as a result of three dimensional change of ultrasonic beam focusing degree depending on the depth. In an embodiment of the present invention a received reflection signal, as a function of time t corresponding to depth in a medium, is input to a filter which changes its frequency characteristic with time so that it has the G factor correcting coefficient corresponding to respective time depth and obtains a corrected time signal as the output of said filter. Fig. 2 is a block diagram of essential parts of apparatus for measuring characteristic values of an ultrasonic medium to which the present invention is applied. In addition to the circuits shown in Fig. 2, circuits for two dimensional scanning of an ultrasonic beam and circuits for displaying a two dimensional distribution image of characteristic values of the medium obtained by such scanning can also be provided. 2 is a medium to be measured, such as a living body. 1 is a piezoelectric transducer made of PZT, etc. 3 is a circuit for generating a voltage pulse to drive the transducer 1 in order to generate an ultrasonic pulse. Generally, an ultrasonic pulse including a centre frequency of 2 to 5 MHz is generated. 4 is a switch for transmission and reception. Switch 4 connects the transducer 1 to the drive circuit 3 during transmission of an ultrasonic pulse, and to an amplifier 5 after the transmission, thereby receiving a reflected wave from the medium. 5 is a wideband amplifier. When the sending centre frequency is set at 3 MHz, for example, the band width of a received pulse generally ranges from 2 to 4 MHz. Amplifier 5 covers such band width of 2 to 4 MHz with sufficient margin. 6 is a wide band amplifier which controls amplification degree with time and is called a TGC Time Gain Control circuit or STC Sensitivity Time Control circuit, for example. A signal reflected from a deeper area of the medium is more attenuated as it travels its propagation path and the strength of the received signal is reduced. Therefore, this amplifier 6 has the lowest gain immediately after a signal pulse has been transmitted and thereafter has a gradually increasing gain with time. The degree of increase of the gain can be controlled manually or automatically and thereby an output of amplifier 6 is always maintained at an optimum level for subsequent correcting filter processing in a correcting filter 7. This amplifier is necessary for optimising S N ratio in a case where a sufficient dynamic range which is a ratio of maximum input signal of correcting filter 7 to noise signal cannot be obtained and the amplifier 6 must always be provided in a stage preceding the correcting filter 7. 71, 72, 73 form correcting filter 7. 8 is a signal processor including program processing by a microcomputer, etc. which processes a received and corrected signal and extracts characteristic values of the medium, such as attenuation coefficient slope of living body tissue. 9 is a clock controller which generates clock and timing signals for operations explained above and also controls the system as a whole. 10 is a unit such as a display or recorder to give information to operators. It is sufficient for signal processor 8 to execute only processing as indicated in reference The correcting filter 7 will now be explained in detail. Fig. 3 shows the shape of the G factor Gz f . From the definition of equation 1 , Gz₀ f 1. If the reference depth z₀ is selected at the maximum sound pressure point on the centre axis as shown in Fig. 1 b , such G factor is smaller than the absolute value of spectrum in the other deeper areas z₁, z₂ and in the shallower area z z₀ . Therefore, Gz f changes the shape thereof as the function of z as indicated regarding z z₁, z z₂. It is a matter of course that Gz f can be defined only for the band width for example, 2 to 4 MHz where sufficient signal spectrum exists and it must not be obtained outside this band width because it would then be obtained from noise components. A square root value of the inverse of Gz f gives a spectrum correction coefficient. Here, a square root value is obtained because Gz f is defined with respect to power. If Gz f Where a The filter 7 must have the characteristic shown by the equation 4 but it is convenient to control a Hereinafter, the correcting filter 7 is assumed to execute the correction Uz f of the frequency characteristic only. Uz f for z z₀, z₁, z₂ are shown in Fig. 4. Here, it is supposed that variable filter 71 is realized by a circuit combining an inductance L, a capacitance C and a resistance R, which are variable with voltage or current, with fixed L, C and R. As examples of such elements, there are an unsaturated reactor which is variable with superposition of a DC voltage, a variable capacitance diode and an MOS transistor. Here, it is also supposed that such voltage control parameter elements variable L, C, R are used in number n. The frequency characteristic of a filter which changes with time as shown in Fig. 4 can be realized by applying a programmed voltage, which charges with time, to n parameter control terminals. 73 is a correction coefficient parameter conversion storage which stores n parameter voltages previously calculated for realizing Uz f corresponding to depth, namely as a function of time, and this circuit can be realized with a microcomputer and ROM, RAM, etc., in case a voltage is digitized. 72 is a parameter read circuit which sequentially reads digital values of parameter control voltage corresponding to time from the circuit 73 in accordance with a time signal sent from the circuit 9, and generates n parameter control voltages through D A conversion. As explained above, the correcting filter 7 composed of the circuits 71, 72 and 73 realizes the characteristic of Uz f . The necessity for storing the correction coefficients or parameters as a continuous function of time results in need for a large amount of storing capacity of the circuit 73, and increase in size and price of system. Therefore, changes of Uz f with time can be approximated by changes in the form of a staircase. Namely, Uz f is switched to change with fine time steps for a range of sudden changes, whilst it changes with coarse time steps for a range of gradual changes. In this case, storage capacity can be saved remarkably. If a filter requires a longer period for switching of Uz f in accordance with time, a plurality of filters are provided, one filter is switched while another filter is being used and such filters can be used alternately or sequentially. In such a case, the outputs can be switched with the input used in common or the inputs can be switched with the outputs used in common. In the above embodiment, a filter is an analog filter utilizing analog elements such as L, C, R. However, a digital filter which can be formed by A D conversion digital processing, D A conversion, can also be used. In the case of analog filter, it is difficult to freely design the phase on the frequency region, and an error is not generated when it is employed with the system of reference As another embodiment of the filter 7, a convolution type filter is explained with respect to Fig. 5 a . It is used to replace the correcting filter 7 consisting of the circuits 71, 72 and 73 shown in Fig. 2. DL indicates delay elements and required delay time δ may be 50 to 100 ns in a case in which the centre frequency of ultrasonic pulse is 3 MHz. M indicates analog multiplication circuits. D A indicates digital to analog conversion circuits. R indicates registers. MEM is a digital memory, RC is a read controller which reads a set of correcting data from the memory MEM when required and sets the data to all registers R. RC is explained in further detail with respect to Fig. 5 b . This read controller is composed of an address counter 72a which advances by receiving clock signals from the clock controller 9 Fig. 2 and an address converter 72b which determines the gradualness of time change of filter by receiving an output of said address counter 72a. Returning to Fig. 5 a , Σ is an adder. Operations are explained below. When the spectrum of a signal i t to be input to the filter is assumed to be I f , an output O t of the filter is given by the inverse Fourier transform of a product of I f and Uz f . In case the inverse Fourier transform of Uz f is given by uz f in accordance with the theory of mathematics, O t is given by the convolution of i t and uz f . Therefore the waveform of uz f for each z, namely for respective times, is stored in MEM with time steps δ, corresponding to the required steps in z, and the waveform uz t corresponding to z is read as a group and then it is set to the registers R. The digital values set in the registers are converted to analog values, and then multiplied with input signals delayed respectively by δ by the delay elements DL , and all multiplied outputs are added by the adder Σ. Above operations represent just the convolution of input i t and time waveform u t obtained by inverse Fourier transformation of correction coefficient Uz f . Uz f has a band width of several MHz and u t has a waveform of about several µs extent and DL, M, D A and R are required in a number such as several tens to a hundred. Recent LSI s available in the marketplace integrate about 128 elements including DL, M, D A and R and thereby are reduced in size and are more economical. In this case, however, the signals cannot be input in parallel to the register group R. The signals are input in series and therefore setting time, namely the switching time of z is increased. This can be mitigated by also employing the method for sequentially switching a plurality pairs of filters as explained above. When the send pulse has a Gaussian distribution spectrum S₀ f with the centre frequency f₀ and divergence σ, a medium to be measured is a living body tissue such as a human body, and attenuation coefficient is α z β z f β is a constant of proportionality , it is known that the spectrum of the waveform reflected from a certain depth z is only deviated by an amount indicated by equation 5 at the centre frequency f This equation indicates that the time corresponding to depth and the centre frequency f Such a method can be adopted in any case in which the shape of the spectrum is determined when a typical parameter of the spectrum is defined. In the above example, the centre frequency This method realizes correction by correct multiplication with similar simplified processings, while multiplication is approximated to addition, for the correction of centre frequency, in reference According to the present invention, the G factor which represents spectrum distortion resulting from three dimensional non uniformity in the degree of convergence on an ultrasonic beam can be corrected in the time region without Fourier transformation of the received signal in a way which also realizes correction of spectrum scalloping. Accordingly, a simplified, small size and economical apparatus for measuring characteristic values of a medium can be obtained for highly accurate and high speed real time characterization.