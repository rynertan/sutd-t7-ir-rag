# Method and apparatus for estimating halftone image from binary image

## Claims
Verfahren zur Verarbeitung von ein binäres Bild darstellenden digitalen Daten zur Bereitstellung einer Schätzdarstellung eines ursprünglichen Halbtonbildes von dem binären Bild, mit folgenden Schritten

## Description
The present invention relates to a method and apparatus for estimating a halftone image from a binary image and, more particularly, to a method and apparatus for effectively estimating an original halftone image from a binary image displayed as a pseudo halftone image. Most existing output devices such as display devices and printers reproduce images using binary notation, i.e., black and white. A density or concentration pattern method brightness pattern method and a dither method are known as ways to represent a pseudo halftone image using such an output device. These methods are both types of an area gradation method, which changes the number of dots recorded within a predetermined area matrix . According to the density pattern method, a portion corresponding to one pixel of an original is recorded by a plurality of dots using a threshold matrix, as shown in Fig. 41 b . According to the dither method, a portion corresponding to one pixel of an original is recorded with a single dot, as shown in Fig. 41 a . Dither data outputs are obtained as shown in Figs. 41 a and 41 b , respectively. These data outputs represent pseudo halftone images using black and white dots. If a binary pseudo halftone image can be reconverted to the original halftone image, various types of data processing can be performed to provide versatility in image conversion. In the case of the density pattern image, the original halftone image can be immediately obtained if pattern level distribution is known. However, density pattern images suffer from low resolution despite requiring a large amount of data. On the other hand, dither images have higher resolution but cannot be easily reconverted to original halftone images. Therefore, various types of image conversion cannot be performed using only dither images. It is an object of the present invention to provide a method and apparatus for effectively estimating an original halftone image from a binary image e.g., a dither image . EP A 0024902 describes a method of processing digital data representative of a binary image to provide an estimated representation of an original halftone image from the binary image, comprising The present invention is characterized by Embodiments of the invention will now be described, by way of example, with reference to the accompanying drawings, in which Preferred embodiments of the present invention will be described in detail with reference to the accompanying drawings. A 4 x 4 Bayer matrix is exemplified as a threshold matrix according to a systematic dither method. Figs. 1 a to 1 f show matrices useful in explaining the present invention. More specifically, Fig. 1 a shows an original halftone image converted to digital data, Fig. 1 b shows a Bayer dither threshold matrix, and Fig. 1 c shows a dither image i.e., a binary image of the original image Fig. 1 a converted to a black and white binary image i.e., a dither image by the threshold matrix Fig. 1 b the black value is represented by a hatched portion for the sake of clarity . The Bayer threshold matrix has a dither pattern having dispersed dots, as shown in Fig. 1 b . Fig. 1 d shows a unit area set in the dither image of Fig. 1 c to scan the dither image Fig. 1 c in the row and column directions. The unit area Fig. 1 d has a 4 x 4 matrix, which is the same as the threshold matrix in Fig. 1 b . However, the unit area need not be a 4 x 4 matrix but can be a 2 x 2 matrix. The unit area defined as shown in Fig. 1 d is placed in the initial position the first column of the first row of the dither image, preferably such that the pixels are completely included in the unit area. In other words, preferably, a given pixel does not partially lie outside the unit area. The number of white pixels included in the unit area is counted and the count is given as an estimated value of the halftone image. In the state of Fig. 1 e , seven white pixels are included in the unit area and the estimated value of point 1, 1 , i.e., the first row and the first column, is 7. The unit area is shifted by one pixel one column in this case . The number of white pixels included in the unit area is counted as 7. This operation is repeated for all column pixels of the first row. When scanning of the first row is completed, the unit area Fig. 1 d is shifted to the second row. Halftone estimation is started with point 2, 1 , i.e., the second row and the first column. When the unit area is shifted to the last row to obtain all halftone estimated values, halftone estimation is completed. Fig. 1 f shows the estimated values of the respective pixels in the halftone image. Since the halftone image is estimated from a dither image Fig. 1 c having less data than the original halftone image, the estimated halftone image cannot completely reproduce the original halftone image. However, except for portions where the density level of the original halftone image changes abruptly, the estimated halftone image is very similar to the original halftone image. In particular, when density does not change within the unit area, the estimated halftone image values completely coincide with the original halftone image values. The above method is described with reference to a flow chart in Fig. 2. The unit area is initially set at point 1, 1 and the number of white pixels is counted. The count is given as a halftone density estimated value for the pixel at point 1, 1 . The unit area is shifted by one column and the number of white pixels within the shifted unit area is counted to obtain a halftone density estimated value for point 1, 2 . When halftone value estimation for the last column of the first row is completed, estimation is started from the pixel of point 2, 1 . When the above operation is completed through the last column of the second row, estimation advances to the next row. When the halftone image estimated value for the pixel of the last row and the last column is obtained, the program sequence is ended. Fig. 3 shows an apparatus for estimating a halftone image with the method of Fig. 1. Referring to Fig. 3, reference numeral 1 denotes a black and white binary image. The dither image in Fig. 1 c is used as such a binary image. The binary image may be displayed on a display device such as a CRT or recorded on a recording sheet. Reference numeral 2 denotes a focusing lens. A lens drive mechanism 3 drives the focusing lens 2 in the row and column directions. The lens drive mechanism 3 may be constituted by a closed loop mechanism with a DC servo motor, an open loop mechanism with a stepping motor, or the like. A photoelectric transducer 4 converts to an electrical signal optical information from the binary image 1 focused by the focusing lens 2. The photoelectric transducer 4 comprises 4 x 4 photoelectric transducer elements units corresponding to the size of the 4 x 4 unit area. The photoelectric transducer 4 together with the focusing lens 2 scans the binary image 1. The photoelectric transducer 4 can be constituted by photo cells, photodiodes, phototransistors, CdSs, or the like. In this embodiment, the photoelectric transducer 4 comprises 4 x 4 photoelectric transducer elements. However, the transducer 4 may comprise a single photoelectric transducer element having a size corresponding to the 4 x 4 matrix. A scanner 5 switches the outputs from the units in the photoelectric transducer 4. An amplifier 6 amplifies the output signals from the units in the transducer 4. An A D converter 7 converts the output from the amplifier 6 to digital data. A CPU 8 receives the output from the A D converter 7, counts the number of white pixels within the unit area, and calculates a halftone image estimated value. The A D converter 7 only needs sufficient resolution i.e., a few bits to discriminate white values from black values. The CPU 8 comprises, for example, a microcomputer. The operation of the apparatus having the arrangement described above will be described below. The unit area formed by the focusing lens 2, the lens drive mechanism 3 and the photoelectric transducer 4 is given such that the extended sides of the area scan the binary image 1, which is substantially uniformly irradiated with light. The initial position of the unit area is the point at the first row and column of the binary image 1. In this state, the optical information within the unit area e.g., the region defined by the 4 x 4 matrix of the binary image 1 is mapped on the photoelectric transducer 4 through the focusing lens 2 without modifications. The scanner 5 switches the outputs from the units in the photoelectric transducer 4 and supplies each output to the amplifier 6. The amplifier 6 amplifies the input signal to a predetermined level. An output from the amplifier 6 is supplied as an input signal to the A D converter 7. The A D converter 7 converts the photoelectric transducer signals of the units sequentially switched by the scanner 5 to digital data. The CPU 8 receives the output from the A D converter 7, counts the number of white pixels within the unit area, and outputs the count as the halftone density estimated value of point 1, 1 , i.e., the first row and the first column of the binary image 1. When the above operation is completed, the unit area is shifted to point 1, 2 , i.e., the first row and the second column. A halftone density estimated value within the shifted unit area corresponding to coordinates 1, 2 is calculated in the same manner as for coordinates 1, 1 . The unit area is thus shifted from column to column in the first row to obtain the halftone density estimated values for the first row. When scanning of the first row is completed, the unit area is shifted to point 2, 1 , i.e., the second row and the first column, to calculate a halftone density estimated value within the unit area corresponding to coordinates 2, 1 . Subsequently, scanning continues through the last column of the second row, thus obtaining all halftone density estimated values for the second row. Similarly, all halftone density estimated values up to the last row are calculated, and the halftone density estimation sequence is completed. The halftone density estimated values corresponding to the pixels and output from the CPU 8 are given as shown in Fig. 1 f . Using the estimated halftone image data, various types of image processing can be performed. Fig. 4 shows another apparatus for estimating a halftone image from a digital image by using the method of Fig. 1. In this case, the binary image is a digital binary image. The halftone image of the digitized binary image is estimated. Referring to Fig. 4, random access memories to be referred to as RAMs hereinafter , i.e., RAM0 to RAM3 store binary image data in a divided manner. These RAMs are semiconductor ICs such as MOS ICs. The relationship between the binary image data stored in these RAMs and the addresses is shown in Fig. 5. The binary image data may be obtained by reading an image with a scanner or the like and converting the image to binary data using a dither method. Alternatively, the binary image data may be prepared by a computer. It should be noted that the unit area, in this case, comprises a 4 x 4 matrix. Assume that the RAM areas for storing digital binary image data are represented by a matrix of rows and columns, as shown in Fig. 5. The first RAM0 stores data of every fourth rows, i.e., row 0, row 4,..., the second RAM1 stores data of different every fourth rows, i.e., row 1, row 5,..., the third RAM2 stores data of different every fourth rows, i.e., row 2, row 6,..., and the fourth RAM3 stores data of last every fourth rows, i.e., row 3, row 7,.... Reference symbols L₀ to L₃ denote row address generators for supplying row address signals to the RAMs and C, a column address generator for supplying the common column address signal to the RAMs. The RAMs RAM0 to RAM3 generate outputs d₀ to d₃. A first adder 11 receives and adds the outputs d₀ to d₃ from the RAMs and outputs three bit D₀ to D₂ data. A 3 bit shift register SR₁ receives the outputs D₀ to D₃ from the adder 11. 3 bit shift registers SR₂ to SR₅ receive the preceding shift register outputs. A 5 bit shift register 12 outputs a total number count of white pixels within the unit area having a predetermined size 4 x 4 in this embodiment . Outputs from the shift register 12 are Q₀ to Q₄. A subtracter 13 receives outputs q₀ to q₂ from the fifth shift register SR₅ and the output from the register 12 and subtacts the output from the shift register SR₅ from the 5 bit output from the register 12. A second adder 14 adds the 3 bit output from the first adder 11 and the 4 bit output from the subtracter 13. The 5 bit output from the second adder 14 is temporarily stored in the register 12. The operation of the apparatus having the arrangement described above will be described below. The row address generators L₀ to L₃ in the respective RAMs are enabled in response to row clocks in Fig. 6 and the RAMs are accessed in response to the outputs from the row address generators L₀ to L₃. The relationship between the selected line address and the corresponding RAM number NO. is given in Fig. 5. For example, when row address 0 is accessed, data of row 0, data of row 1, data of row 2, and data of row 3 are respectively read out from the RAM0, RAM1, RAM2, and RAM3. When row address 1 is accessed, data of row 4, data of row 5, data of row 6, and data of row 7 are respectively read out from the RAM0, RAM1, RAM2, and RAM3. The RAMs are simultaneously accessed in response to the column address signal from the common column address generator C. When the row and column address signals are supplied to the respective RAMs, binary data d₀ to d₃ stored at the accessed addresses is read out from the RAMs. The outputs from the RAMs are simply added by the first adder 11. A sum signal from the adder 11 appears as three bit signals D₀ to D₂. The number of output bits from the adder 11 is 3 since a decimal number 1 1 1 1 4 maximum sum value , i.e., binary 100 of outputs d₀ to d₃ cannot be expressed by two bits. Three bits allow expression of numbers up to 7 decimal . The outputs D₀ to D₂ from the first adder 11 are supplied to the first shift register SR₁. In this case, the outputs preceding by four clock pulses and generated by the fifth shift register SR₅ are q₀ to q₂. The halftone image data Q₄Q₃Q₂Q₁Q₀ ₀ estimated by the previous calculation is stored in the register 12. Since a maximum value of the estimated value is 4 x 4 16 , it cannot be expressed by four bits. Thus, the number of output bits from the register 12 is selected to be 5. The subtracter 13 receives the three bit signals q₀ to q₂ from the shift register SR₅ and the previous 5 bit data Q₄Q₃Q₂Q₁Q₀ ₀ from the register 12 and performs the following calculation A result given by calculation 1 is supplied as 4 or 5 bit data to the second adder 14. The second adder 14 receives the output D₂D₁D₀ from the first adder 11 and the output from the subtracter 13 and performs the following calculation A value obtained by calculation 2 becomes an updated halftone image estimated value Q₄Q₃Q₂Q₁Q₀ The above calculations are explained mathematically below. Assume that the dither image binary data within the unit area is given as data d The estimated halftone image Q and Assuming that Equation 5 can be rewritten as The immediately preceding estimated halftone image Q and₀ can be estimated from equation 7 Equations 7 and 8 with reference to Fig. 6 yield the following equation for Equation 9 coincides with equation 3 , thus proving that the apparatus in Fig. 4 can calculate the estimated values of the halftone image. In the above, the halftone image is estimated from the binary image. However, a new binary image can be obtained by gradation conversion, filtering, and enlargement and reduction conversion of the estimated halftone image. Fig. 8 is a flow chart when gradation conversion gradation processing of the estimated halftone image is performed. The halftone image estimated by the method of Fig. 1 is gradation converted and the converted halftone image is updated to produce a new binary image by using threshold matrices. The gradation conversion characteristics are exemplified, as shown in Fig. 9. Reference symbols f₁ and f₂ denote gradation conversion characteristic curves. The input is plotted along the abscissa and the output is plotted along the ordinate. Numerical values in the graph represent density levels. Fig. 10 a shows a halftone image obtained by gradation converting the image Fig. 1 f with the characteristic curve f₁ in Fig. 9. Fig. 10 b shows a halftone image obtained by gradation converting the image Fig. 1 f with the characteristic curve f₂ in Fig. 9. Fig. 10 c shows a binary imaqe of the image in Fig. 10 a , and Fig. 10 d shows a binary image of the image in Fig. 10 b . It is apparent that the resultant binary images greatly differ from each other according to the different gradation conversion characteristics. Fig. 11 is a flow chart for filtering the estimated halftone image. The halftone image estimated by the method of Fig. 1 is filtered and the filtered halftone image is converted to a binary image by using threshold matrices. The filtering characteristics are shown in Figs. 12 a and 12 b , respectively. Fig. 12 a shows the characteristics of a high pass convolution filter and Fig. 12 b shows the characteristics of a low pass convolution filter. When the estimated halftone image in Fig. 1 f is filtered by the filtering characteristics in Figs. 12 a and 12 b , high and low pass halftone images in Figs. 13 a and 13 b are obtained. When the high and low pass halftone images are digitized using dither matrices of Figs. 13 c and 13 d , binary images dither images shown in Figs. 13 e and 13 f are obtained. Fig. 14 is a flow chart for enlarging and reducing an estimated halftone image. The halftone image estimated by the method of Fig. 1 is enlarged or reduced, and the obtained halftone images are converted by binary images using threshold matrices. The enlargement and reduction schemes can be exemplified by extrapolation and interpolation. Fig. 15 a shows a 1.25 times halftone image obtained by enlarging the halftone image in Fig. 1 f according to a nearest neighborhood method. Fig. 15 b shows a 0.75 times halftone image obtained by reducing the halftone image in Fig. 1 f . The enlarged or reduced halftone images are digitized using dither matrices in Figs. 15 c and 15 d to obtain binary images in Figs. 15 e and 15 f . When a halftone image is estimated by a binary image, the binary image is preferably a dither or density pattern image. More preferably, the binary image is a dither image. In this case, the dither image is preferably a systematic dither image rather than a random dither image or a conditional dither image. The size of the unit area is preferably equal to a dither threshold matrix so as to assign each block of the matrix with each one of all threshold values. The above description exemplifies the case wherein the number of white pixels within the unit area is counted to estimate the halftone image. However, the present invention is not limited to this estimation mode or any other specific modes. It is essential to estimate the halftone image on the basis of a ratio of the white regions to the black regions within the unit area. In the above description, each pixel is scanned to obtain a halftone image. However, at least two pixels can be scanned to obtain a halftone image. A method of estimating a halftone image according to a first embodiment of the present invention will be described with reference to Figs. 16 to 22. Figs. 16A to 16D show different unit areas used in the first embodiment of the present invention. Fig. 16A shows a 2 rows x 2 columns unit area A, Fig. 16B shows a 2 rows x 4 columns unit area B, Fig. 16C shows a 4 rows x 2 columns unit area C, and Fig. 16D shows a 4 rows x 4 columns unit area D. A black dot at the enter of each unit area represents the center of shifting when the corresponding unit area is shifted on the dither image in Fig. 1 c . When the unit areas shown in Figs. 16A to 16D are independently used and shifted on the dither image of Fig. 1 c and the numbers of black or white pixels white pixels in this case within the unit areas are counted to calculate estimation values of the resultant halftone images, the corresponding halftone images shown in Figs. 17 a to 17 d are obtained. A method of calculating the estimated halftone image shown in Fig. 17 d will be described below. The unit area in Fig. 16D is located at the dither image initial position i.e., the center of shifting is located at a point of the second row and column and the point is referred to as 2, 2 hereinafter , as shown in Fig. 18. In this case, preferably, the pixels are completely included in the unit area. In other words, part of a given pixel should not extend outside the unit area. The number of white pixels within the unit area is counted to give the count as the halftone estimated value. In this case, the count is 7. The estimated value of point 1, 1 of the halftone image is 7. The unit area is shifted by one pixel one column in this case and the number of white pixels within the shifted unit area is counted as 7. The same operation is performed for all columns of the first row. When scanning of the first row is completed, the unit area in Fig. 16D is shifted by one row and halftone density estimation for the next row is started. In this case, the center of the unit area is located at point 3, 2 . When estimation is completed up to the last column of the last row, estimation is completed, thus obtaining the halftone image in Fig. 17 d . A method of estimating the halftone image in Fig. 17 b by using the unit area in Fig. 16B will be described below. In this case, the center of the unit area B must be the same as that of the largest unit area D. The unit area B is initially set, as shown in Fig. 19. In this state, the number of white pixels within the unit area B is 2. In order to set the unit area B equal to the unit area D, the number of white pixels must be doubled, i.e., 2 x 2 4. In this case, the unit area B has a gain of 2. The gains of other unit areas A and C are 4 and 2, respectively. The gain conversion calculation is performed whenever the unit area B is shifted by one pixel. The estimated halftone image in Fig. 17 b can be obtained. The same operation is applicable to the cases in Figs. 17 a and 17 c , and a detailed description thereof will be omitted. The halftone image can be effectively estimated by the method described above. The data in Fig. 17 a to 17 d represents the resultant halftone images. According to this method, the halftone image is estimated from the dither image in Fig. 17 c having a smaller number of data than that of the original halftone image in Fig. 1 a . As shown in Fig. 17 d , the estimated halftone image cannot be completely converted to the original halftone image. However, except for a portion where the pixel level of the original halftone image abruptly changes, the estimated halftone image can be very similar to the original halftone image. In particular, when a density change does not occur within the unit area D, the estimated halftone image values completely coincide with the original halftone image values. Man s sense of vision has a higher gradation discrimination capability in a low spatial frequency region the region where pixel level changes are small but a lower gradation discrimination capability in a high spatial frequency region the region where pixel level changes are large . Based on this, a larger unit area is used in the low spatial frequency region to estimate a halftone image portion with a high gradation discrimination capability, thus obtaining an image of a high resolution. Better halftone image estimation can then be performed compared to that in Figs. 17 a to 17 d . The method according to the first embodiment of the present invention will be described in more detail. This method is based on storage of a digital binary image in a storage means. Different unit areas are set for the digital binary images, and the digital binary image is operated according to predetermined processing. An optimal one of the different unit areas is selected for each pixel. The number of white pixels or black pixels within the selected unit area is counted to obtain an estimated value of the halftone image. The predetermined processing is performed using an algorithm for selecting a large unit area in the low spatial frequency region the region where pixel level changes are small and a small unit area in the high spatial frequency region the region where pixel level changes are large . The basic principle of this embodiment is to select largest possible unit areas unless density changes within the unit area are detected. Therefore, the unit areas A to D are selected in an order of D, C, B, and A as shown in Fig. 20. Figs. 21 a to 21 d show steps of the method according to the first embodiment. The unit area D is first selected. When the unit area D is located at the initial position Fig. 1 c , as shown in Fig. 18, the unit area D has a state shown in Fig. 21 a . The number of white pixels within the unit area D is counted to be 7. 7 is given as the average pixel level and 7 s are filled in pixel positions of the image in Fig. 21 b . When the average pixel level image in Fig. 21 b is digitized by a threshold matrix shown in Fig. 21 c , the resultant binary image shown in Fig. 21 d is obtained. When the dither image Fig. 21 a is compared with the binary image Fig. 21 d , they do not coincide with each other. The noncoincidence means that the pixel level change occurs. In this case, the unit area D cannot be suitably used. Since the unit area D in step 1 is not selected, processing advances to step 2 . The unit area C is selected in step 2 . The unit area C is placed in the initial position Fig. 1 c , as shown in Fig. 21 a . The number of white pixels within the unit area C is counted to be 4. The count 4 is multiplied with a gain of 2 to obtain 8, i.e., the average pixel level. 8 s are filled in the pixel positions of the image, as shown in Fig. 21B. The average pixel level image in Fig. 21 b is digitized by a threshold matrix i.e., a threshold matrix within the unit area in Fig. 21 c corresponding the second and third columns of the matrix in Fig. 1 b to obtain a binary image in Fig. 21 d . The dither image in Fig. 21 a is compared with the binary image in Fig. 21 d and no coincidence can be established. The noncoincidence indicates that the pixel level change occurs. The unit area C is discriminated not to be suitable. Since the unit area C is not selected in step 2 , processing advances to step 3 . The unit area B is selected in step 3 . The unit area B is located in the initial position of Fig. 1 c , as shown in Fig. 21 a . The number of white pixels within the unit area is counted to be 2. The count 2 is multiplied with a gain of 2 to obtain 4 as the average pixel level. The average pixel level image is shown in Fig. 21 b . This image is digitized using a threshold matrix of Fig. 1 c to produce a binary image in Fig. 21 d . The dither image in Fig. 21 a is compared with the binary image in Fig. 21 d and coincides therewith. The coincidence indicates that no pixel level change occurs within the unit area. The unit area B is discriminated to be suitable. However, if no coincidence is established in step 3 , the smallest unit area A is selected. Since the unit area B is selected in step 3 , the number of white pixels within the unit area B is 2. The gain of the unit area B is 2 and the estimated value is thus obtained as 4 2 x 2 . The pixel level in Fig. 21 b in step 3 is given as the image estimated value. The above operation is performed for all pixels of the dither image in Fig. 1 c and the estimated halftone image in Fig. 22 can be obtained. The actual use of the unit areas for the first row is as follows. The unit area B is used for 1, 1 of the estimated halftone image B, for 1, 2 A for 1, 3 B for 1, 4 B for 1, 5 D for 1, 6 and D for 1, 7 . For the estimated halftone image in Fig. 22, the large unit area is used in the region where pixel level changes are small, and the small unit area is used in the region where pixel level changes are large. This estimation scheme is compatible with man s sense of vision. Therefore, the estimated halftone image extremely resembles the original halftone image in Fig. 1 a . In the above description, a halftone image is estimated from a dither image. However, gradation conversion, filtering, or enlargement reduction conversion of the estimated halftone image can be performed to obtain a new binary image. Fig. 23 is a flow chart for performing gradation conversion gradation processing of the estimated halftone image. The halftone image estimated by the method according to the first embodiment is gradation converted and the converted halftone image is digitized to a new binary image according to a threshold matrix. The gradation conversion characteristics are shown in Fig. 24. Reference symbols f1 and f2 denote gradation conversion characteristic curves. The input is plotted along the abscissa and the output is plotted along the ordinate. The numerical values in the graph represent pixel levels. Fig. 25 a shows a halftone image obtained by gradation converting the image Fig. 22 with the characteristic curve f1 in Fig. 24. Fig. 25 b shows a halftone image obtained by gradation converting the image Fig. 22 with the characteristic curve f2 in Fig. 24. Fig. 25 c is a binary image obtained by digitizing the image Fig. 25 a using the 4 x 4 Bayer dither matrix. Fig. 25 d is a binary image obtained by digitizing the image Fig. 25 b using the same matrix. The binary images greatly differ from each other according to the different gradation conversion characteristics. Fig. 26 is a flow chart for filtering the estimated halftone image. The halftone image estimated by the method according to the first embodiment is filtered and the filtered halftone image is digitized to a new binary image by using a threshold matrix. The filtering characteristics are shown in Figs. 12 a and 12 b . Fig. 12 a shows the characteristics of the high pass convolution filter and Fig. 12 b shows the characteristics of the low pass convolution filter. When the estimated halftone image in Fig. 22 is filtered by the filtering characteristics in Figs. 12 a and 12 b , high and low pass halftone images in Figs. 27 a and 27 b are obtained. When the high and low pass halftone images are digitized using dither matrices of Figs. 27 c and 27 d , binary images dither images shown in Figs. 27 e and 27 f are obtained. Fig. 28 is a flow chart for enlarging or reducing an estimated halftone image. The halftone image estimated by the method according to the first embodiment is enlarged or reduced and the obtained halftone images are converted by binary images using threshold matrices. The enlargement and reduction schemes can be exemplified by extrapolation and interpolation. Fig. 29 a shows a 1.25 times halftone image obtained by enlarging the halftone image in Fig. 22 according to a nearest neighborhood method. Fig. 29 b shows a 0.75 times halftone image obtained by reducing the halftone image in Fig. 22. The enlarged or reduced halftone images are digitized using dither matrices in Figs. 29 c and 29 d to obtain binary images in Figs. 29 e and 29 f . In this case, the dither image is preferably a systematic dither image rather than a random dither image or a conditional dither image so as to uniformly set threshold values in the pixel positions of the largest unit area. Alternatively, a distributed dither image for uniformly setting the threshold values in the pixel positions of the smallest unit area is preferred. A distributed Bayer dither image is particularly preferable. The first embodiment exemplifies the case wherein the number of white pixels within the unit area is counted to estimate the halftone image. However, the present invention is not limited to this estimation mode or any other specific modes, and the number of black pixels can be counted. In the above description, each pixel is scanned to obtain a halftone image. However, at least two pixels can be scanned to obtain a halftone image. Four different unit areas are used in the first embodiment. However, the number of unit areas is not limited to four but can be extended to any number. The sizes of the unit areas are not limited to the illustrated ones, but can vary. A method of estimating a halftone image according to a second embodiment of the present invention will be described with reference to Figs. 30 to 32. The pixel of the first row and column of the dither image in Fig. 1 c is exemplified to show how to use the unit areas in Figs. 16A to 16D. Assume the following conditions for no pixel level changes The relationship between B₁, B₂, C₁, and C₂ is given in Fig. 30. B₁ and B₂ are the numbers of white pixels within the adjacent unit areas B in Fig. 16B and C₁ and C₂ are the numbers of white pixels within the adjacent unit areas C in Fig. 16C. B₁, B₂, C₁, and C₂ are arranged in Fig. 30 to check if inequalities 10 and 11 are satisfied. If satisfactory, a circle is given but if not, a cross is given. The unit areas are determined according to the conditions, as shown in Fig. 31. Referring to Fig. 31, when both inequalities 10 and 11 are satisfied, pixel level changes are small and a large unit area is used to provide a high gradation discrimination capability. Thus, the unit area D is selected. If inequality 1 is satisfied but inequality 2 is not satisfied, the unit area C is selected since the pixel level change in the vertical direction the Y direction in Fig. 30 is small and the pixel level change in the horizontal direction the X direction in Fig. 30 is large. If inequality 2 is satisfied but inequality 1 is not satisfied, the unit area B is selected since the pixel level change in the horizontal direction the X direction in Fig. 30 is small and the pixel level change in the vertical direction the Y direction in Fig. 30 is large. If neither inequalities 1 and 2 are satisfied, the smallest unit area A is selected to obtain a high resolution since the pixel level changes along the horizontal and vertical directions the X and Y directions are large. According to the method of the second embodiment, the optimal unit area is selected for each pixel. The number of white pixels or black pixels within the selected unit area is counted. In a matrix Fig. 30 corresponding to the upper left corner of Fig. 1 c , B₁ 2, B₂ 5, C₁ 3, and C₂ 4. In this case, inequality 2 is satisfied but inequality 1 is not satisfied. Therefore, an optimal unit area is B according to the table in Fig. 31. When the unit area B is set in the initial position in Fig. 19, the number of white pixels within the area B is 2. The gain of B is 2 and thus the halftone image estimated value of point 2, 2 of the dither image is 4 2 x 2 . The unit area is selected for the location having the central point 2, 3 to calculate its estimated value. The optimal unit area is selected for each point to obtain all estimated values. Fig. 32 shows a halftone image estimated in the manner as described above. The actual use of the unit areas for the first row of the estimated halftone image is as follows the unit area B is selected for point 1, 1 B for 1, 2 B for 1, 3 A for 1, 4 C for 1, 5 , D for 1, 6 and D for 1, 7 . In the estimated halftone image in Fig. 32, the halftone image portion with small pixel level changes is estimated using a large unit area, and the halftone image portion with large pixel level changes is estimated using a small unit area. Such estimation is compatible with man s sense of vision. Therefore, the estimated halftone image extremely resembles the original halftone image in Fig. 1 a . In the above description, a halftone image is estimated from a binary image. However, gradation conversion, filtering, or enlargement reduction conversion of the estimated halftone image can be performed to obtain a new binary image. Fig. 23 is a flow chart for performing gradation conversion gradation processing of the estimated halftone image. The halftone image estimated by the method according to the second embodiment is gradation converted and the converted halftone image is digitized to a new binary image according to a threshold matrix. The gradation conversion characteristics are shown in Fig. 24. Reference symbols f1 and f2 denote gradation conversion characteristic curves. The input is plotted along the abscissa and the output is plotted along the ordinate. The numerical values in the graph represent pixel levels. Fig. 33 a shows a halftone image obtained by gradation converting the image Fig. 32 with the characteristic curve f1 in Fig. 24. Fig. 33 b shows a halftone image obtained by gradation converting the image Fig. 32 with the characteristic curve f2 in Fig. 24. Fig. 33 c is a binary image obtained by digitizing the image Fig. 33 a using the 4 x 4 Bayer dither matrix. Fig. 33 d is a binary image obtained by digitizing the image Fig. 33 b using the same matrix. The binary images greatly differ from each other according to the different gradation conversion characteristics. Fig. 26 is a flow chart for filtering the estimated halftone image. The halftone image estimated by the method according to the second embodiment is filtered and the filtered halftone image is digitized to a new binary image by using a threshold matrix. The filtering characteristics are shown in Figs. 12 a and 12 b . Fig. 12 a shows the characteristics of the high pass convolution filter and Fig. 12 b shows the characteristics of the low pass convolution filter. When the estimated halftone image in Fig. 32 is filtered by the filtering characteristics in Figs. 12 a and 12 b , high and low pass halftone images in Figs. 34 a and 34 b are obtained. When the high and low pass halftone images are digitized using dither matrices of Figs. 34 c and 34 d , binary images dither images shown in Figs. 34 e and 34 f are obtained. Fig. 28 is a flow chart for enlarging or reducing an estimated halftone image. The halftone image estimated by the method according to the second embodiment is enlarged or reduced and the obtained halftone images are converted by binary images using threshold matrices. The enlargement and reduction schemes can be exemplified by extrapolation and interpolation. Fig. 35 a shows a 1.25 times halftone image obtained by enlarging the halftone image in Fig. 32 according to a nearest neighborhood method. Fig. 35 b shows a 0.75 times halftone image obtained by reducing the halftone image in Fig. 32. The enlarged or reduced halftone images are digitized using dither matrices in Figs. 35 c and 35 d to obtain binary images in Figs. 35 e and 35 f . A method of estimating a halftone image according to a third embodiment of the present invention will be described below. The method of the third embodiment is similar to that of the second embodiment. An algorithm of the third embodiment selects a large unit area in a low spatial frequency region the region where pixel level changes are small and a small unit area in a high spatial frequency region the region where pixel level changes are large . The unit areas A to D in Figs. 16A to 16D are used in the same manner as in the second embodiment. The numbers of white pixels within the unit areas are represented by If these inequalities are satisfied, circles are given. Otherwise, crosses are given. According to the combination of the circle and the cross, an optimal unit area is selected, as shown in Fig. 36. An asterisk represents a circle or cross. If neither inequalities 12 and 13 are satisfied, the unit area A is selected without checking inequalities 14 and 15 . If inequality 12 is satisfied but inequality 13 is not, the unit area B is selected. If inequality 12 is not satisfied but inequality 13 is satisfied, the unit area C is selected. If all inequalities 12 to 15 are satisfied, the unit area D is selected. An optimal unit area is determined as follows when the centers of the unit areas are located at point 2, 2 of the dither image in Fig. 1 c . Since a 1, b 2, c 4, and d 7, we have Inequalities 12 and 13 are thus satisfied and the optimal unit area is given as B according to the table in Fig. 36. An estimated value of the pixel of the first row and first column of the halftone image upon selection of the unit area B is estimated. The number Fig. 37 shows a halftone image estimated in the manner as described above. The actual use of the unit areas for the first row of the estimated halftone image is as follows the unit area B is selected for point 1, 1 B for 1, 2 B for 1, 3 A for 1, 4 C for 1, 5 , D for 1, 6 and D for 1, 7 . In the estimated halftone image in Fig. 37, the halftone image portion with small pixel level changes is estimated using a large unit area and the halftone image portion with large pixel level changes is estimated using a small unit area. Such estimation is compatible with man s sense of vision. Therefore, the estimated halftone image extremely resembles the original halftone image in Fig. 1 a . In the above description, a halftone image is estimated from a binary image. However, gradation conversion, filtering, or enlargement reduction conversion of the estimated halftone image can be performed to obtain a new binary image. The gradation conversion gradation processing of the estimated halftone image is performed according to the same flow chart in Fig. 23. The gradation conversion characteristics are shown in Fig. 9 in the same manner as in the second embodiment. Fig. 38 a shows a halftone image obtained by gradation converting the image Fig. 37 with the characteristic curve f1 in Fig. 9. Fig. 38 b shows a halftone image obtained by gradation converting the image Fig. 37 with the characteristic curve f2 in Fig. 9. Fig. 38 c is a binary image obtained by digitizing the image Fig. 38 a using the dither matrix. Fig. 38 d is a binary image obtained by digitizing the image Fig. 38 b using the same matrix. The binary images greatly differ from each other according to the different gradation conversion characteristics. The estimated halftone image in Fig. 37 is filtered in the same flow as in Fig. 26. The halftone image estimated by the method according to the third embodiment is filtered and the filtered halftone image is digitized to a new binary image by using a threshold matrix. The filtering characteristics are shown in Figs. 12 a and 12 b . Fig. 12 a shows the characteristics of the high pass convolution filter and Fig. 12 b shows the characteristics of the low pass convolution filter. When the estimated halftone image in Fig. 32 is filtered by the filtering characteristics in Figs. 12 a and 12 b , high and low pass halftone images in Figs. 39 a and 39 b are obtained. When the high and low pass halftone images are digitized using dither matrices of Figs. 39 c and 39 d , binary images dither images shown in Figs. 39 e and 39 f are obtained. The estimated halftone image in Fig. 37 can be enlarged or reduced and the obtained halftone images are converted by binary images using threshold matrices. The flow chart of this processing is the same as in Fig. 28. The enlargement and reduction schemes can be exemplified by extrapolation and interpolation. Fig. 40 a shows a 1.25 times halftone image obtained by enlarging the halftone image in Fig. 37 according to a nearest neighborhood method. Fig. 40 b shows a 0.75 times halftone image obtained by reducing the halftone image in Fig. 37. The enlarged or reduced halftone images are digitized using dither matrices in Figs. 40 c and 40 d to obtain binary images in Figs. 40 e and 40 f . In the second and third embodiments, when a halftone image is estimated by a binary image, the binary image is preferably a dither or density pattern image. More preferably, the binary image is a dither image. In this case, the dither image is preferably a systematic dither image rather than a random dither image or a conditional dither image. In this case, the dither image is preferably a systematic dither image rather than a random dither image or a conditional dither image so as to uniformly set threshold values in the pixel positions of the largest unit area. Alternatively, a distributed dither image for uniformly setting the threshold values in the pixel positions of the smallest unit area is preferred. A distributed Bayer dither image is particularly preferable. Among the different unit areas, the largest unit area is preferably equal to the threshold matrix of the systematic dither image. More specifically, digital binary images are stored in a storage means such as a memory. The different unit regions are set for these digital binary images. The digital binary image is operated according to predetermined processing. An optimal unit area is selected for each pixel. The number of white pixels or black pixels within the selected unit area is counted to obtain an estimated value of the halftone image. The predetermined processing is performed by an algorithm of the second or third embodiment. The second and third embodiments exemplify the case wherein the number of white pixels within the unit area is counted to estimate the halftone image. However, the present invention is not limited to this estimation mode or any other specific modes. It is essential to estimate the halftone image on the basis of a ratio of the white regions to the black regions within the unit area. In the above description, each pixel is scanned to obtain a halftone image. However, at least two pixels can be scanned to obtain a halftone image. Four different unit areas are used in the second and third embodiments. However, the number of unit areas is not limited to four but can be extended to any number. The sizes of the unit areas are not limited to the illustrated ones, but can vary.