# MULTIPLE QUADRATURE PHASE AMPLITUDE MODULATING SYSTEM CAPABLE OF REDUCING A PEAK AMPLITUDE

## Claims
Vielfachphasenquadratur Amplitudenmodulationssystem zum Modulieren eines Paars von Quadraturphasen Trägersignalen durch ein erstes bzw. ein zweites digitales Eingangssignal S₁₀ und S₂₀ in ein Vielfachphasenquadratur amplitudenmoduliertes Signal S ₃ , wobei jedes der ersten und zweiten digitale Eingangssignale ein i Bit binäres digitales Signal ist und daher fähig ist, höchstens N Niveaus, wobei N 2

## Description
This invention relates to a quadrature phase amplitude modulating often abbreviated to QAM system and a quadrature phase amplitude demodulating system for use as a counterpart of the modulating system. In the QAM system, a pair of quadrature phase carrier signals are amplitude modulated by a first and a second digital input signal into a quadrature phase amplitude modulated signal of a certain transmission power. When each of the first and the second digital input signals in an i bit binary signal, the digital input signal is capable of representing at most N levels where N is equal to 2 When transmitted from the QAM system to a quadrature phase amplitude demodulating system through a transmission medium, the quadrature phase amplitude modulated signal is inevitably subjected to a symbol error of a certain symbol error rate. The symbol error rate depends on a separation between two adjacent signal points. On the other hand, the transmission power is dependent on a peak amplitude of the quadrature phase amplitude modulated signal, namely, a distance between the origin and a signal point placed at each vertex of the square. The peak amplitude increases in proportion to an increase of the signal points. It is desirable to reduce the transmission power. The separation, however, decreases and results in an increase of the symbol error rate if the peak amplitude is reduced in order to reduce the transmission power. A hexagonal signal arrangement is exemplified in an article contributed by Marvin K. Simon and Joel G. Smith to IEEE Transactions on Communications, Vol. COM 21, No. 10 October 1973 , pages 1108 to 1115, under the title of Hexagonal Multiple Phase and Amplitude Shift Keyed Signal Sets. The hexagonal signal arrangement is capable of reducing the peak amplitude as small as possible. The hexagonal signal arrangement is, however, hard to realize a circuit for arranging the signal points on the phase plane. A data modem using multiple QAM is described in the Proceedings of the 1984 International Zürich Seminar on Digital Communications, Zürich, 6th 8th March 1984, pages 113 120, IEEE, New York, USA J. D. Brownlie et al. Duplex transmission at 4800 and 9600 BIT S on the general switched telephone network and the use of channel coding with a partitioned signal constellation . In this known system the modulated signal points are arranged in a modified 16 X 16 square, on the phase plane, in which 6 points have been shifted from each corner. This modification reduces the increment in average power and the peak to mean ratio. It is therefore an object of this invention to provide a multiple quadrature phase amplitude modulated system capable of producing a multiple quadrature phase amplitude modulated signal which has a least possible peak amplitude and can be transmitted through a transmission medium with a least possible symbol error. It is another object of this invention to provide a multiple quadrature phase amplitude demodulating system for use as a counterpart of the modulating system of the type described above. Referring to Figs. 1, 2, 3, and 4, description will be made as regards a conventional multiple QAM system and a conventional multiple quadrature phase amplitude demodulating system in order to facilitate an understanding of this invention. In Fig. 1, the conventional multiple quadrature phase amplitude modulating system is for use in a sixteen by sixteen quadrature phase amplitude modulating system, namely, 256 QAM system. It is readily understood under the circumstances that In order to produce the first and the second carrier signals C₁₀ and C₂₀, the QAM system comprises an oscillator not shown for producing a carrier oscillation signal C₀₀. The carrier oscillation signal C₀₀ is divided into two parts one of which is given through a π 2 phase shifter 27 to the first amplitude modulator 25 as the first carrier signal C₁₀ and the other of which is given to the second modulator 26 as the second carrier signal C₂₀. The first and the second amplitude modulators 25 and 26 produce first and second modulated signals S₁₂ and S₂₂ and deliver the first and the second modulated signals S₁₂ and S₂₂ to a multiplexer 28. The multiplexer 28 is for multiplexing the first and the second modulated signals S₁₂ and S₂₂ into a multiple quadrature phase amplitude modulated signal S₃. The signal S₃ has two hundred fifty six signal points on a phase plane as will later be described. The signal S₃ is amplified by a transmission power amplifier not shown and transmitted to the multiple quadrature phase amplitude demodulating system through a transmission medium. Referring to Fig. 2, the two hundred fifty six signal points shown by dots are arranged in a lattice structure on the phase plane defined by an origin O and orthogonal coordinate axes which are usually referred to as real and imaginary axes X and Y crossing at the origin O. The real and the imaginary axes X and Y represent the first and the second modulated signals S₁₂ and S₂₂ for the respective channels P and Q Fig. 1 . Each of the first and the second modulated signals S₁₂ and S₂₂ has sixteen amplitudes. Referring to Fig. 3, a conventional multiple quadrature phase amplitude demodulating system is for use as a counterpart of the 256 QAM system described above. The demodulating system comprises first and second phase detectors 31 and 32 supplied with the multiple quadrature phase amplitude modulated signal as a demodulator input signal S₄. The first and the second phase detectors 31 and 32 carry out phase detection of the demodulator input signal S₄ with reference to first and second local carrier signals C₁₁ and C₁₂ which may generally be called reproduced carrier signals. The second local carrier signal C₁₁ has a quadrature phase difference relative to the first local carrier signal C₁₁. As a result of the phase detection, the first phase detector 31 produces a first analog signal as a first demodulated signal S₁₅ for the channel P. Similarly, the second phase detector 32 produces a second analog signal as a second demodulated signal S₂₅ for the channel Q. Each of the first and the second demodulated signals S₁₅ and S₂₅ has an amplitude dependent on each input digital signal S₁₀ and S₂₀ Fig. 1 . In order to produce the first and the second local carrier signals C₁₁ and C₁₂, the demodulating system comprises a voltage controlled oscillator 33 responsive to a phase control signal S₆ to be later detailed for producing a local oscillation signal. The local oscillation signal is divided into two parts one of which is given to the first phase detector 31 as the first local carrier signal C₁₁ and the other of which is given through a π 2 phase shifter 34 to the second phase detector 32 as the second local carrier signal C₁₂. The first and the second demodulated signals S₁₅ and S₂₅ are supplied to first and second analog digital converters 35 and 36, respectively. The first and the second analog digital converters 35 and 36 are for converting the first and the second demodulated signals S₁₅ and S₂₅ into first and second output digital signals S₁₇ and S₂₇, respectively, each of which has five bits numbered from a first bit to a fifth bit. The first through the fourth bits of the first output digital signal S₁₇ are produced as a reproduction of the first input digital signal S₁₀ Fig. 1 . The fifth bit of the first output digital signal S₁₇ is produced as a first phase deviation signal E Both of the first bits of the first and the second output digital signals S₁₇ and S₂₇ serve to distinguish the first through the fourth quadrants of the phase plane as illustrated in Fig. 2 and are delivered to a phase deviation detecting circuit 37 as first and second data signals D The first and the second phase deviation signals E Turning to Fig. 4, the phase deviation detecting circuit 37 produces the phase control signal S₆ in response to the first and the second data signals D Turning back to Fig. 3, the phase control signal S₆ is delivered to the voltage controlled oscillator 33. The local oscillation signal of the voltage controlled oscillator 33 is controlled and phase locked in response to the phase control signal S₆. Thus, the illustrated demodulating system comprises a phase locked loop which is constructed by the first and the second phase detectors 31 and 32, the first and the second analog digital converters 35 and 36, the phase deviation detecting circuit 37, the voltage controlled oscillator 33, and the π 2 phase shifter 34. Referring back to Fig. 2, it is supposed that the above mentioned separation between two adjacent signal points is equal to 2d. Under the circumstances, the peak amplitude of the two hundred fifty six quadrature phase amplitude modulated signal is equal to a length of a diagonal between the origin and each vertex of the quadrants and given by 15 2d or about 21.2d. In the manner pointed out heretobefore, a peak transmission power which is required to transmit the multiple quadrature phase amplitude modulated signal is in proportion to a square of the peak amplitude. Accordingly, it is necessary to reduce the peak amplitude in order to save the transmission power. In a square signal arrangement illustrated in Fig. 2, the separation becomes narrow as the peak amplitude decreases. Therefore, the conventional multiple QAM system has a disadvantage as described hereinabove. On the other hand, the transmission power amplifier in the QAM system generally has a saturation characteristic. Accordingly, the multiple quadrature phase amplitude modulated signal of a high peak amplitude is inevitably subjected to amplitude and phase distortion in the transmission power amplifier. Such a modulated signal is accompanied by a symbol error resulting from the saturation characteristic. Referring to Fig. 5, a 256 QAM system according to an embodiment of this invention is similar to that illustrated in Fig. 1 except for a converting circuit 40. The converting circuit 40 is for converting the first and the second input digital signals S₁₀ and S₂₀ to first and second analog signals in a manner to be described below. Like in Fig. 1, each of the first and the second input digital signals S₁₀ and S₂₀ has four bits and can therefore represent up to sixteen different levels. The converting circuit 40 comprises a code converting unit 41 and first and second digital analog converters 42 and 43. The code converting unit 41 is for arranging two hundred fifty six signal points as illustrated in Fig. 2 into a nearly circular shape on the phase plane in accordance with a predetermined rule, as will later be described in detail. More specifically, the first and the second input digital signals S₁₀ and S₂₀ are converted by the code converting unit 41 to first and second modified digital signals S₁₀ and S₂₀ . Each of the first and the second modified digital signals S₁₀ and S₂₀ has five bits and can represent thirty two levels at maximum. In the example being illustrated, only eighteen levels can be specified by each modified digital signal in a manner to be described later. As a result, the first and the second modified digital signals S₁₀ and S₂₀ are converted to the first and the second analog signals each of which has an amplitude determined by eighteen levels of the first and the second modified digital signals S₁₀ and S₂₀ . The first and the second analog signals are delivered through the first and the second low pass filters 23 and 24 to the first and the second amplitude modulators 25 and 26 as first and second modulating signals S₁₁ and S₂₁ , respectively. The first and the second amplitude modulators 25 and 26 amplitude modulate the first and the second carrier signals C₁₀ and C₂₀. The first and the second carrier signals C₁₀ and C₂₀ are generated like in the conventional modulating system shown in Fig. 1. The first and the second amplitude modulators 25 and 26 produce first and second modulated signals S₁₂ and S₂₂ . The multiplexer 28 multiplexes the first and the second modulated signals S₁₂ and S₂₂ into a multiple quadrature phase amplitude demodulated signal S₃ . The signal S₃ has an amplitude related to two hundred fifty six signal points arranged on the phase plane. Referring to Fig. 6, description will be made as regards the predetermined rule used in the code converting unit 41. Although restricted to the first quadrant of the phase plane, the description applies to the remaining quadrants. In Fig. 6, sixty four signal points for the first and the second input digital signals S₁₀ and S₂₀ are mapped on the first quadrant in the form of a square of eight by eight, like in Fig. 2. In other words, the outermost signal points, fifteen in number, of the signal points are arranged along two sides of the square before the first and the second input digital signals S₁₀ and S₂₀ are subjected to code conversion carried out in accordance with the predetermined rule. The outermost signal points has a vertex signal point depicted at AP₁ and is placed at a corner of the square opposite to the origin O. A distance between the origin O and the vertex signal point AP₁ is equal to a length of a diagonal of the square and can be represented by 15 2d, as described in conjunction with Fig. 2. Briefly, the predetermined rule is for shifting the vertex signal point AP₁ and the adjacent one or ones of the signal points along the real axis X and or the imaginary axis Y so as to reduce the peak amplitude described in conjunction with Fig. 2. The resultant signal points are arranged nearly at a circle on the phase plane. The shifted signal points must be located within a circle having a radius equal to the diagonal. Otherwise, the peak amplitude can not be reduced. As readily understood by considering the second through fourth quadrants similar to the first quadrant illustrated in Fig. 6, a relationship between the number N and a radius In order to arrange the resultant signal points within the circle, the number of levels must be calculated with respect to the real and the imaginary axes X and Y and is equal to N 2n , where In the example being illustrated, the vertex signal point AP₁ and two of the outermost signal points AP₂ and AP₃ vertically adjacent to the vertex signal point AP₁ are shifted towards the real axis X and rearranged into resultant signal points AP₁ , AP₂ , and AP₃ , respectively. An area for the signal points AP₁, AP₂, and AP₃ may be called a first area A₁ while another area for the resultant signal points AP₁ , AP₂ , and AP₃ may be called a second area A₂. As shown in Fig. 6, the resultant signal points AP₁ , AP₂ , and AP₃ are positioned at ninth signal points along the real axis. In addition, three additional ones AP₄, AP₅, and AP₆ of the signal points are located in a third area A₃ and shifted towards a fourth area A₄ adjacent to the imaginary axis Y. The three additional signal points AP₄ to AP₆ are diagonally adjacent to the vertex signal point AP₁ and horizontally adjacent to the vertex signal point AP₁. They are rearranged into resultant additional points AP₄ to AP₆ which are placed in the fourth area A₄ and which are positioned at ninth signal points along the imaginary axis Y. In addition to the first quadrant, Tables 1 through 4 are illustrated along the real and the imaginary axes X and Y to describe the predetermined rule in detail. Table 1 shows a relationship between the eight signal points arranged along the real axis X and four bit codes assigned to the first digital input signal S₁₀ at the respective signal points. The four bit codes of the first digital input signal S₁₀ are converted by the code converting unit 41 into five bit codes p₀ to p₄ as illustrated in Table 2. As shown in Table 2, zeroth bits p₀ of the five bit codes p₀ to p₄ take the logic 1 level only when ninth signal points AP₁ to AP₃ are specified. Otherwise, the zeroth bits p₀ take the logic 0 level. Thus, the four bit codes of the first input digital signal S₁₀ are modified into the five bit codes of the first modified digital signal S10 in the manner illustrated in Table 2. Likewise, the four bit codes of the second input digital signal S₂₀ which are illustrated in Table 3 are modified into five bit codes as illustrated in Table 4. The five bit codes are produced as the second modified digital signal S₂₀ and have zeroth bits q₀ attached to the four bit codes. The zeroth bits q₀ take the logic 1 level only when the ninth signal points AP₄ to AP₆ are specified. The above mentioned code conversion is possible by monitoring a combination of the first and the second input digital signals S₁₀ and S₂₀ by the code converting unit 41. For example, the vertex signal point AP₁ is shifted to the resultant signal point AP₁ and represented from Tables 2 and 4 by a combination of 10000 and 01010 . Likewise, the signals AP₂ and AP₃ are shifted to the resultant signal points AP₂ and AP₃ which are represented by 10000 and 01001 and by 10000 and 01000, respectively. The above mentioned code conversion is readily possible by the use of a usual logic circuit and a microprocessor. Therefore, no description will be made about the code converting unit 41 any longer. Referring to Fig. 7, it will be supposed that the separation between two adjacent signal points is given by 2d along the real and the imaginary axes X and Y. A maximum or peak amplitude of the above described signal point arrangement is given by Furthermore, the multiple quadrature phase amplitude modulated signal S₃ according to this invention has a least possible peak amplitude, so that the amplitude and phase distortion does not arise in the transmission power amplifier. Referring to Fig. 8, a multiple quadrature phase amplitude demodulating system is for use as a counterpart of the 256 QAM system illustrated with reference to Figs. 5 and 6. The demodulating system comprises similar parts designated by like reference numerals as in Fig. 3 except a converting circuit 50. The converting circuit 50 comprises first and second analog digital converters 51 and 52 and a code converting unit 53 which are operable in the manner which will later be described in detail. The first and the second phase detectors 31 and 32 are supplied with a multiple quadrature phase amplitude modulated signal as a demodulator input signal S₄ . When the demodulator input signal S₄ is mapped on the phase plane, two hundred fifty six signal points appear nearly at a circle on the phase plane, as mentioned before. The first and the second phase detectors 31 and 32 carry out phase detection of the demodulator input signal S₄ with reference to a pair of quadrature phase local carrier signals which consist of first and second local carrier signals C₁₁ and C₁₂ which are produced in a manner to be described. The first and the second local carrier signals C₁₁ and C₁₂ have a quadrature phase difference relative to each other, as are the cases with those described in conjunction with Fig. 1. First and second demodulated signals S₁₅ and S₂₅ for P and Q channels are produced from the first and the second phase detectors 31 and 32, respectively. Each of the first and the second demodulated signals S₁₅ and S₂₅ can indicate eighteen levels, differing from that illustrated in Fig. 3. The first and the second demodulated signals S₁₅ and S₂₅ are supplied to first and second analog digital converters 51 and 52 to be converted into first and second digital signals S₁₆ and S₂₆ , respectively. The first and second analog digital converters 51 and 52 are similar to those illustrated in Fig. 3 except that each of the converters 51 and 52 Fig. 8 produces each digital signal of six bits numbered from the zeroth bit namely, most significant bit to the fifth bit namely, least significant bit . As described in conjunction with Fig. 3, the least significant bit represents a phase deviation while each of the remaining five bits represents a reproduction of each modified digital signal S₁₀ , S₂₀ Fig. 5 . In the example being illustrated, the zeroth through fifth bits of the first digital signal S₁₆ is depicted at P₀ through P₅ , respectively, while the zeroth through fifth bits of the second digital signal S₂₆ are depicted at Q₀ through Q₅,, respectively. The code converting unit 53 converts the first and the second digital signals S₁₆ and S₂₆ to first and second output digital signals S₁₇ and S₂₇ in accordance with a prescribed rule as will later be described in detail. Each of the first and the second output digital signals S₁₇ and S₂₇ has five bits numbered from a first bit to a fifth bit. Like in Fig. 3, the first through the fourth bits of the first and the second output digital signals S₁₇ and S₂₇ are reproductions of the first and the second input digital signals S₁₀ and S₂₀ Fig. 5 , respectively. Besides, the first bits of the first and the second output digital signals S₁₇ and S₂₇ are produced as first and second data signals D The code converting unit 53 can carry out the above mentioned operation in a manner described below. Referring to Figs. 9 and 10 together with Fig. 8, the signal points of the demodulator input signal S₄ Fig. 8 can be mapped on the phase plane, as illustrated in Fig. 9. More particularly, the signal points of 256 are arranged nearly at a circle on the phase plane. The above described circular arrangement must be converted by the code converting unit 53 to a square arrangement Fig. 10 in order to produce the reproductions of the first and the second input digital signals S₁₀ and S₂₀. The signal points of 256 illustrated in Fig. 9 are divisible into modified or shifted signal points of twenty four and the remaining unmodified signal points, as illustrated in conjunction with Fig. 6. The modified signal points of twenty four will be called specific first through twenty fourth signal points and depicted at SP₁ through SP₂₄, respectively. As shown in Fig. 9, the specific signal points SP₁ to SP₂₄ are positioned at ninth levels placed along the real and the imaginary axes X and Y. In order to convert the circular arrangement of Fig. 9 into the square arrangement of Fig. 10, the first through twenty fourth specific signal points SP₁ to SP₂₄ must be moved or returned back to first through twenty fourth original signal points SP₁ to SP₂₄ illustrated in Fig. 10, respectively. The original signal points SP₁ to SP₂₄ will be referred to as predetermined signal points. Referring to Figs. 11 and 12 together with Figs. 9 and 10, operation of the converting circuit 50 Fig. 8 will be described more in detail. Codes of the first and the second digital signals S₁₆ and S₂₆ are enumerated in Figs. 11 and 12, respectively, in correspondence to the first through the twenty fourth specific signal points SP₁ to SP₂₄. In Figs. 11 and 12, each code of the first and the second digital signals S₁₆ and S₂₆ has the zeroth through fifth bits, as mentioned before, and is produced by each of the first and second analog digital converters 51 and 52. When the zeroth bit P₀ or Q₀ of each of the first and second digital signals S₁₆ and S₂₆ takes the logic 0 level, the sixth bit P₅ or Q₅ is indefinite. Therefore, indefiniteness of the sixth bit P₅ or Q₅ is represented by To the contrary, the sixth bit P₅ or Q₅ takes the logic 0 level when the zeroth bit P₀ or Q₀ takes the logic 1 level. This implies that the logic 0 level is forcibly placed at the fifth bit P₅ or Q₅ when the ninth level is indicated along each of the real and the imaginary axes X and Y. In other words, no phase deviation is detected by the first and the second analog digital converters 51 and 52 on occurrence of the logic 1 level at the zeroth bit P₀ or Q₀ . More specifically, the phase deviation is detected as regards the specific signal points SP₁ to SP₃ SP₇ to SP₉ and SP₁₆ to SP₂₁ with reference to the first digital signal S₁₆ Fig. 11 . On the other hand, the phase deviation of the remaining specific signal points SP₄ to SP₆ SP₁₀ to SP₁₅ and SP₂₂ to SP₂₄ is detected with reference to the second digital signal S₂₆ Fig. 12 . The above mentioned operation is readily possible in a known manner. For example, each of the first and second analog digital converters 51 and 52 may be a combination of a usual analog digital converter for five bits and a logic circuit for detecting the zeroth bit to decide the fifth bit. Each of the first and the second digital signals S₁₆ and S₂₆ is sent to the code converting unit 53 Fig. 8 and is subjected to code conversion illustrated in Figs. 9 and 10 in accordance with a prescribed rule. In Figs. 11 and 12, the prescribed rule is for converting each code of the first and second digital signals S₁₆ and S₂₆ into a corresponding code of the first and second output digital signals S₁₇ and S₂₇ which has five bits as illustrated in Figs. 11 and 12. The five bits of each output digital signal S₁₇ and S₂₇ comprise the first through the fourth bits depicted at P₁ to P₄ and Q₁ to Q₄ and the fifth bit depicted at E It is mentioned here that each of the first and second phase deviation signals E On the other hand, the first and second phase deviation signals E The illustrated code converting unit 53 monitors both of the zeroth bits P₀ and Q₀ of the first and second digital signals S₁₆ and S₂₆ to produce specific signals as the first and second deviation signals E In Fig. 8, the first through fourth bits of each output digital signal S₁₇ and S₂₇ are produced as reproductions of the first and second digital input signals E₄ . The first and second deviation signals E The voltage controlled oscillator 33 has a reference voltage level at which the local carrier signal C₁₁ has a predetermined frequency. The phase control signal S₆ is selected so that the average level thereof becomes equal to the reference voltage level. Accordingly, the voltage controlled oscillator 33 delivers the local carrier signal C₁₁ of the predetermined frequency to the first phase detector 31 and to the second phase detector 32 through the π 2 phase shifter 34 when the specific signals Thus, the synchronization is established in the illustrated phase locked loop without any false phase synchronism. While this invention has thus far been described in conjunction with a preferred embodiment, it will readily be possible for those skilled in the art to put this invention into practice in various other manners. For example, the number M N² may be 1024, 4096, or so. A prescribed number of the signal points may be shifted on the phase plane from the corners of the square towards the real and the imaginary axes and may not be restricted to twenty four, if shifted signal points are placed within a circular area determined by a diagonal of the square and a square arrangement of the signal points is near to a circular arrangement.