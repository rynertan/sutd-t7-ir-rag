# Method of and device for recording data down hole in a well bore.

## Abstract
A down hole temperature, pressure and time measuring and digital data storage tool, utilizing self contained microprocessor based data taking and data reduction, with power conservation realized by processor controlled powering of data transducers only during sample periods and control of the rate at which samples are taken as an inverse function of dynamically calculated data rate of change. Data storage is effected only for data samples representing a significant change in data magnitude as established by a processor program defined significant data criteria.

## Claims
CLAIMS 1. The method of storing data versus time down hole in a well bore from a self contained tool comprising parameter sensing transducer means, a power source, and an associated microprocessor computer characterised by the steps of 1 initiating via said microprocessor, an analog read out sample of said transducer means 2 converting each said analog output sample to a digital format and storing same in a register of said microprocessor 3 determining the differential between each instant stored sample and the next preceding sample and storing those instant samples effecting a differential with absolute value exceeding at least count value inRAM storage means1 4 storing at time tag associated with each sample stored in step 3 5 computing the data rate of change from said samples 6 adjusting the rate of taking rd samples as a direct function of said data rate of change and 7 repeating steps 1 through 6 ., above. 2. A method of storing data versus time down hole in a well bore from a self contained tool comprising temperature and pressure transducers, a pressure transducer reference bridge, a power source, and an associated microprocessor computer characterised by the steps of 1 initiating a preselected program defined initial time out period 2 upon completion of said preselected initial time out period, initiating via said microprocessor, a time multiplexed analog read out sample of each of said transducers and reference bridge 3 converting each said analog output sample to a digital format and storing same in a register of said microprocessor 4 determining the differential between each instant stored sample and the next preceding like sample and storing those instant samples effecting a differential with absolute value exceeding a least count value in RAM storage means 5 storing a time tag associated with each sample stored in step 4 6 computing the data rate of change from successive pairs of samples, 7 adjusting a next successive time out period as an inverse function of each next preceding data rate of change computation and 8 repeating steps 2 through 7 , above. 3. A method according to Claim 2, characterised in that step 4 comprises the sequential steps of 4a computing from each pressure transducer sample and the associated multiplexed sample output of said reference bridge, a temperature corrected value of said pressure transducer sample 4b storing said temperature corrected sample in said RAM storage means of said microprocessor. 4. A method according to Claim 1, 2 or 3, characterised in that said time multiplexed samples are effected by a computer interfaced power control, and said transducers and reference bridge are sequentially powered by said power source to effect each said time ultiplexed sampling sequence. 5. A method according to Claim 4, wherein said microprocessor computer comprises programmable read only memory means storing calibration and temperature correcting defining data for each of said transducers and said bridge, characterised by the additional sub step in step 4 of using said microprocessor to linearize and temperature correct said data samples taken from said transducers and bridges prior to being stored in said computer RAM storage means. 6. A method according to Claim 5, characterised in that step 5 comprises the sub step of storing a confidence time tag in said RAM storage means after a predetermined number of successive data samples fail to meet the criteria defined by step 4 . 7. A down hole measured parameter recorder of the type employing analog to digital conversion of analog signal outputs from periodically sampled transducers and subsequent storage of digital data in solid state memory characterised by first comparing means for comparing each transducer output sample with a next previously stored sample, second comparing means for comparing the absolute value of the output from said first comparing means with a reference value, and control means, responsive to the output of said second comparing means, to effect writing into memory only those samples having magnitudes at least as great as said reference value. 8. A recorder according to Claim 7, characterised by computer means for calculating from successive sample pairs, and the lapsed time therebetween, the rate of change of the sampled parameter, and by further control means responsive to said calculated rate of change to alter the sample periodicity as a direct function of said rate of change. 9. A recorder according to Claim 8, characterised by control means selectively applying power to said transducers and analog to digital conversion means only during the sample time period. 10. A recorder according to Claim 9, characterised in that one of said transducers comprises a pressure sensitive bridge and in that the recorder comprises a reference bridge means like that of said pressure transducer and not subjected to ambient pressure, said reference bridge means being sampled with said pressure transducer bridge output, and means responsive to said reference bridge samples to remove temperature drift from said pressure samples prior to storage in said memory. 11. A recorder according to Claim 10, characterised by programmable read only memory means storing calibration characteristics of each said transducer over the range of parameter to be measured, and by said computer means being programmed to utilize said stored calibration characteristics to linearize sampled data prior to storage thereof. 12. A recorder according to Claim 11, characterised in that said computer means is programmed to effect an initial time out period of selected duration prior to effecting a first sample taking sequence and to adjust the time out period prior to each of successive sample taking sequences as an inverse function of the rate of change of magnitude of a next preceding pair of successive samples. 13. A variable parameter timing recorder instrument, characterised in that it includes storage means for storing periodically taken samples of at least one variable parameter, means responsive to said samples to calculate the rate of change of magnitude thereof, and means responsive to the absolute value of said calculated rate of change to alter the rate at which samples are taken as a direct function of said rate of change of magnitude. 14. An instrument according to Claim 13, characterised by means differentially comparing an instant sample with a next previously taken sample, and means responsive to the differential between successive sample pairs exceeding a reference value to effect storage of said instant sample. 15. An instrument according to Claim 14, characterised by time recording means effecting a storage of time at which all stored samples are taken. 16. An instrument according to Claim 15, characterised by said time recording means further effecting a storage of time at periodic intervals defined by a predetermined number of successive samples, as differentially compared with next preceding samples, defining a differential not exceeding said reference value. 17. An instrument according to any of Claims 13 to 16, characterised in that the variable parameters are temperature and pressure. 18. An instrument according to Claim 17, characterised by being in the form of a down hole in a well bore electric powered tool.

## Description
METHOD OF AND DEVICE FOR RECORDING DATA This invention relates to a method for recording data, especially temperature and pressure in a well bore Temperature and pressure readings down hole in a well bore having long been used to provide useful information in the oil industry. These parameters, along with rate of flow, etc. provide invaluable information about the geological characteristics of the well. Early devices were mechanical and electromechanical in nature, and as such, provided packaging problems. Spring clock driven charts used delicate mechanisms and sensitivity was poor. With the advent of solid state electronics, reduction in power requirements was significant, and self contained devices employing solid state memory systems were employed as a means of recording down hole temperature, pressure and time. Devices, as, for example, described in U.S. PatentSpecification No. 4,033,186, process down hole gauge signals from plural sensors through a multiplexer and analog todigital converter and store binary data in a solid state memory for subsequent readout upon retrieval of the tool from the well bore. In the device disclosed in U.S. Patent SpecificationNo. 3,977,245, a digital system is employed to convert analog gauge readouts to digital format for storage in memory for subsequent readout. Systems of the above referenced type, in employing solid state techniques and employing digital storage, offer a decided improvement over early electro mechanical devices, and are capable of reading and storing appreciably more data for a given run because of the appreciable reduction in battery supplied power. Systems employing such solid state memory systems are, however, essentially a means for efficiently storing temperature and pressure data and time of obtaining raw, uncorrected data. For example, pressure transducers have temperature characteristics which must subsequently be considered and the uncorrected data stored must subsequently be corrected. Analog to digital converters employed to process analog readings into binary format for memory storage have zero drift as do temperature and pressure transducers, and these errata must subsequently be considered in processing stored data containing attendent errors into useful, accurate information. While solid state memory systems are inherently power conservative, as compared to early electromechanical devices, the ultimate utility of such devices may be limited by the memory storage capacit. Known solid state memory systems operate on a predetermined fixed data sampling and storing sequence as defined by clock oscillator countdown dividers.To conserve battery power, the devices are shut down when memory is full, with remaining power utilized to retain stored data in memory. Thus, the length of time for a given data taking run is limited by memory storage capacity and the sampling rate. Under conditions of static pressures and temperatures, the memory is inefficiently utilized in recording redundant, like readings. Systems employing fixed data sampling and storing intervals may fail accurately to record dynamics of the parameters being measured and, while a particular fixed sam p ling rate may be grossly high for static conditions of measured parameters, the same fixed rate may be grossly inadequate to record rapidly changing parameters accurately. It is therefore a principle object of this invention to provide a time referenced down hole temperature and pressure reading tool employing microprocessor based programmed data sampling and storage, whereby data is corrected and linearized prior to memory storage. A further object is to provide a microprocessor controlled data taking and reduction system which calculates significant data change and adjusts sampling rate accordingly, to thereby conserve both battery power and more efficiently utilized memory storage capacity. A still further object is to provide such a data taking and storing device in which sampling rate is effected by power control to analog transducers and associated analog to digital conversion circuitry, with these devices being powered only during the sampling intervals associated therewith. Still another object is to provide a microprocessor based measuring and storing device with interchangeable plug in PROM capability by means of which programming may selectively be altered as to determination of what constitutes significant data changes upon which sampling rate is determined and memory storage decision is predicated for a given run in a given well bore. Features of this invention useful in accomplishing the above objects include, in a down hole temperature, pressure and time measuring and digital data storage device, a micoprocessor based data taking and storage device employing time multiplex data. taking of temperature and pressure transducer bridges along with a temperature reference bridge. Data sampling sequences are effected at a rate which varies with the rate of change of the data being sampled by a microprocessor program which, for example, might compare each data sample with the next previous sample, divide the difference by existing time out interval, and adjust the program time out interval for a next successive sample taking program sequence accordingly.The absolute value of the changes between successive data samples is compared, by a program defined criteria, to a program defined significant data change reference value, with only those instant samples meeting and exceeding the program defined criteria being stored in memory along with a time tag. Power conservation is attained by controlled power turn on of transducer and reference bridges during sample times. Microprocessor associated programmable read only memory devices hold pre written linearity and temperature correction data unique to each transducer, with the microprocessor program providing data correction prior to storage. A specific embodiment of the invention is illustrated in the accompanying drawings, in which Figure 1 represent a functional block diagram of the microprocessor based down hole temperature, pressure and time measuring and data storage tool Figure 2 is a functional schematic block diagram of the power control interface and transducer portions of the system of Figure 1 Figure 3 is an alternative switching arrangement useable in the system of Figure 2 Figure 4 is a program flow chart depicting data sampling and channel time out adjustment Figure 5 is a more detailed diagram of the read and calculate block of the flow chart of Figure 3 Figure 6 is a program flow chart generally depicting data readout from memory and Figure 7 is a functional physical make up diagram, a down hole tool packaging the microprocessor based temperature, pressure, and time data recorder. With reference to the functional system diagram ofFigure 1, the recorder of the present invention is shown as comprising a control interface between a data processing and storage system and analog transducers which are sampled by computer activated power control electronics. The upper depicted data processing and storage system 10 comprises a microprocessor including a central processing unit CPU 12 along with random access memory RAM 14, programmable read only memory PROM 16, randon access memory RAM 18, and programmable read only memories PROMS 20, 22 and 24.Also shown is a readout interface unit 26 providing a data readout 27 under control of readout control line 28. RAM 14 interfaces to a common data bus 29, a common address bus 30, and a common control bus 31. PROM 16 interfaces with address bus 30 and control bus 31 and CPU 12, RAM 18, andPROMS 20, 22, and 24 interface with each of the data, address and control buses 29, 30, and 31. As depicted functionally, RAM 14 is utilized in calculations required by CPU 12 PROM 16 provides program steps of the CPU RAM 18 provides non volatile data storage memory and PROMS 20, 22 and 24 hold linearity correction data for the respective temperature transducer, pressure transducer, and reference bridge elements of the system. The above described data processing section is interfaced, through data, address, and control bus interfaces with an interface control 32. Power from battery source 34 is supplied interface control 32 via interconnect 36 and selectively via line 38 to a power control circuitry 40. Power control circuitry 40, as will be further des cribbed, time multiplexes power application to temperature transducer 42, pressure transducer 44 and reference bridge 46 via lines 48, 50, and 52 respectively, under control of a digital multiplexing control line 54 between interface 32 and power control circuitry 40. When energized upon application of power on line 48, temperature transducer 42 develops a temperature analog output on line 54. Likewise, pressure transducer 44, when supplied power on line 50, develops a pressure analog output on line 56 and reference bridge 46, when supplied power on line 52, develops a bridge reference analog output on line 58. Analog outputs 54, 56 and 5 are applied in time multiplexed sequence to an analog multiplexer 60, which, under control of multiplexing data control input 62 from interface control 32, applies each analog output in sequence on line 64 to analog to digital converter 66 to output digital data corresponding to the sampling of the temperature, pressure and bridge references on data line 68 to interface control 32 from which it is applied to the common data bus 29. Referring now to Figure 2, wherein certain portions of the interface control and power circuitries are exampled in more detail, battery source 34 is depicted by negative battery terminal 34a and positive battery terminal 34b.With transistor switches 70 and 72 energized by power on control line 74 from control latch circuitry 32 , negative battery power is switched to a negative regulator 76 to provide regulated negative voltage on line 38a and positive battery power is switched to a positive regulator 78 to provide regulated positive voltage on line 38b. Negative regulated power on line 38a, as will be further described, is connected directly to first power junctions of the bridges associated with temperature transducer 42 and pressure transducer 44, and also to a first power junction of reference transducer 46. As shown in Figure 2, positive power on line 38b is not applied directly to the other power junctions of the bridges, but is applied selectively through respective bridge associated transistor switches. Thus selective switching is accomplished in time multiplexed fashion for each bridge output sampling sequence. Power on line 38b is selectively applied through energized switch 80 onto line 48 associated with temperature transducer 42 through energized switch 82 onto line 50 associated with pressure transducer 44 and through energized switch 84 onto line 52 associated with reference transducer 46.Positive regulated power on line 38b is sequentially switched onto lines 48 , 50 and 52 under control of respective outputs from 1 of N decoder 86 which receives a binary address on line 54 from an address decoder 32 . Thus, for example, under control of addresses on common address bus 30 of the microprocessor, a two bit address may be sequentially incremented to provide sequential switch enabling outputs on output lines 88, 90, and 92 from 1 of N decoder 86 to sequentially activate transistor switches 80, 82, and 84, and thus sequentially apply positive power on lines 48 , 50 and 52 . With power on line 48 , temperature bridge 94 of transducer 42, as well as amplifier 95 to which the output from bridge 94 is applied, are operated to develop an amplifier output 96 which is a voltage analog of temperature.Likewise, with power on line 50 pressure bridge 98 of transducer 44, as well as amplifier 100 to which the output from bridge 98 is applied, are operable to develop an output 102 from amplifier 100 which is a voltage analog of pressure. Reference bridge 104 and its associated amplifier 106 are operable upon power applied to line 52 to develop an amplifier output 108 which is a voltage analog of the temperature drift of pressure transducer 42 reference bridge 104 being a bridge identical with bridge 98 of pressure transducer 44, but not subject to ambient pressure. Analog outputs from each of the pressure and temperature transducers, and from the reference bridge, are applied as respective separate inputs to analog multiplexer 60, which, under control of incremented binary addresses on line 62 from address decoder 32 , sequentially applies analog outputs from the bridges, as they are developed through power on activity, onto multiplexer output line 64 for application to analog to digital converter 66. Digital outputs on converter 66 Output line 68 are thus sequentially applied, via data buffer 69, to the microprocessor common data bus 29 for processing and storage in memory. Associated with each of the temperature and pressure transducers, and the reference bridge, is an auto zeroing feature by means of which zero offset for the bridge output amplifiers may be determined, which offset may be obtained and stored by the computer for program defined correction of the samples received during the repeated sampling sequences. Referring to Figure 2, a relay 110 and associated contact pairs llOa and liOb is shown in relaxed unenergized state with contact pair llOa closed to apply the output from bridge 94 to amplifier 95. Relay contact pair llOb, which shunts the amplifier input terminals, is open in the depicted relaxed state. This depicted state is maintained relay 110 drawing no power under normal operating conditions.Output 96 from amplifier 95 may be offset, i.e., experience zero state drift under changing ambient temperature, and this offset must be ascertained in order that the processor may correct the transducer output sample. For this purpose, relay 110 may be periodically energized, as defined by computer programming, to open up the bridge output as applied to amplifier 95, and short the input terminals of amplifier 95, with any then experienced amplifier output defining a then existing offset error in samples of the temperature transducer output. Relay 110 is selectively energized by the output from AND gate 112.Inputs to AND gate 112 comprise the positive power on bridge input line 48 and an enabling output 114 which may be selectively caused to appear from control latch 32 such that a zero command on line 114 during any time interval when power is switched onto line 48 to energize bridge 94, will cause relay 110 to operate for determination of zero offset via any output from amplifier 95. Relay 115, associated with pressure transducer 44, is similarly energized by AND gate 116 via power switched onto bridge input line 50 and an enabling signal on line 114. Relay 118 and AND gate 120, associated with reference bridge transducer 46, likewise provide for a zero offset determination for the reference bridge output from amplifier 106. Zero offset from all three depicted bridge amplifiers may then be selectively determined by computer program command for subsequent utilization in the processor program in correcting subsequently taken data samples from the bridges. The above described auto zeroing feature, embodies relay operated switch contacts to effect the offset determination. Mechanical switch contacts offer the advantage of precluding the switch elements themselves from introducing offset error. The relays 110, 115, and 118 embodied in Figure 2 offer this advantage, and commercially available low power consumption relays contemplated for use age in Figure 2 would not introduce sufficient battery power drain to be inconsistent with the power conservation aspect of the recorder. Alternatively, as functionally shown inFigure 3, the switching functions provided by the relays of Figure 2 may be accomplished by solid state switching means. Referring to Figure 3, a solid state switching arrangement is depicted for temperature transducer 42 as being typical of that which might be associated with each of the bridges in Figure 2.Solid state switching means 122 may replace the relay contact pair llOa associated with the temperature transducer 42, and solid state switching means 124 may replace the relay contact pair llOb associated with transducer 42. Each of switches 122 and 124 might comprise a switching element which is energized in response to a logic 1 input. In the depicted relaxed state, AND gate 212 produces a logic 0 output enabling input on line 114 not present . The logic 0 output 126 from AND gate 112 is applied through inverter 128 as an energizing input to solid state switch 122 and thus closes the bridge output line to amplifier 95, while the AND gate 0 output level applied directly to solid state switch 124 does not energize switch 124.With an enabling logic 1 level on input line 114, and power applied on line 48 , AND gate provides a logic 1 output which deactivates switch 122 and activates switch 124 to thereby open the bridge output line and short the input to amplifier 95. It should be noted that use of solid state switching may introduce switch associated offsets which, unless recognized, may themselves produce offset and drift errors in the data sample outputted by the transducer amplifier. For this reason, the relay switch implementation, in offering mechanidal contacts, might be considered preferable and more than compensative for any attendant increased power drain over solid state switching. The system, as described above, is seen to provide interface with a microprocessor by responding to processor generated control signals to produce digital data sample readouts of pressure, temperature and reference bridges in repeated time multiplexed sequences. Provision for bridge offset determination has been described, such that data is presented the microprocessor which may permit the processor to correct the data samples prior to storage. Power conservation techniques have been described whereby the bridge outputs are sampled by controlled application of power thereto, and thereby powered only during sampling periods.Consistent with power conservation, is the feature of having a variable sample rate of the measured variables in the well, where, under relatively static conditions of measured parameters, the sampling rate is low and under rapidly changing state the sample rate is high. This feature, along with the storage in memory of significant data only, results in maximized useage of memory storage capability as well as power conservation. In accordance with the present invention, the power conservation and efficient memory utilization features may be implemented by appropriate programming of the tool microprocessor. Unique data reduction, and sample rate adaption to measured parameter change rate, may be implemented by microprocessor programming. The data reduction capability of the microprocessor based tool herein described would allow the calibration curve and temperature correction curve for the temperature and pressure transducers and reference bridge to be put into a non erasable PROM before the tool is run see PROMS 20, 22 and 24 of Figure 1 . The microprocessor, via state of the art programming techniques, may then use the information stored in these PROMS to linearize and correct the data taken from the transducers and bridges before it is entered into the memory of the tool. The contemplated variable sample rate feature may be accomplished by a sub routine in the processor program that causes the sample rate to vary, for example, with the changing rate of pressure samples. This routine, as exampled by the flow chart of Figure 4, starts with a time out interval, effects a sequence of time multiplexed power application to each of the transducers and reference bridge, inputs data to the CPU, calculates data rate of change for subsequent time out adjustment, and makes a determination of whether an instant sample constitutes a significant data change which should be stored in memory. Figure 5 shows a flow chart definitive of the read data and calculate parameters block of Figure 4, where input data sample Sun, for example, a pressure sample, is compared to the next previously taken sample Sun 1 If the absolute value of Sn Sun 1 is greater than a predetermined least count, Sn is stored with time tag in memory, whereupon data rate of change may be calculated by division of Sn Sun 1 by the current time out, and a subsequent timeout adjustment made, based upon a programmed criteria.The flow chart further depicts provision for discard of insignificant data which does not represent sufficient change to meet the least count criteria, along with provision for storing a coincidence time tag should, for example, some preselected number of sample periods occur within data samples meeting the least count criteria. Time out may then be, according to a program defined algorithim, adjusted as a selected function of data sample rate of change. With slowly varying sample change rate, time out may be increased, while with increasing sample change rates, the time out may be decreased accordingly, thus effectively changing the rate at which the routine of Figures 4 5 is performed and thereby adapting the rate of sampling to the dynamics of the measured variable. Data written into memory RAM data storage 18 ofFigure 1 would contain a pressure reading, a temperature reading, and a time reading. As above discussed, the memory entries would be minimized by varying the sample rate, and by noting significant changes in measured variables as a criteria for writing into memory. Upon retrieval of the tool from a well bore upon completion of run, surface equipment of commercially purchased type may be used to decode the memory of the down hole recording tool. For this purpose, Figure 1 generally depicts a readout interface 26 communicating with thedata and address busses, along with a readout control line 28 and data output bus 27. Readout might be applied to a minicomputer or microcomputer programmed to reconstruct the pressure versus time and temperature versus time data that,existed in the well during the time that the down hole tool was in place. It may be appreciated that the entire characteristic of the well is not stored in the tool memory, rather an abbreviation of the characteristic is stored, due to the significant data criteria imposed on data storage. The stored data does include time keeping however, such that the running pressure versus time and temperature versus time characteristics may be reconstructed such that they can be displayed, printed or plotted. An exampled data output flow chart is shown in Figure 6. Any number of output formats might be employed to retrieve the stored data in the tool upon completion of a down hole run. Figure 7 functionally depicts a mechanical configuration of the tool herein described as it might be packaged in, for example, a 1.5 inch diameter housing, with downhole end packaging a transducer section 130 followed sucessively by power switching section 132, multiplex section 134, analog to digital converter section 136, interface section 138, CPU, RAM and PROM section 140, transducer characteristics PROM section 142, power section 144, readout interface section 146, and upper end lock mandrel, fishing neck and connector 148.