# PROCESS CONTROL APPARATUS

## Claims
Prozesssteuerapparat mit einer ersten Prozesssteuerungs Betriebseinrichtung 4 zur Steuerung eines Prozesses 1 , wenn die Charakteristika des Prozesses 1 in einem eingeschwungenen Zustand sind, eine Impulsübertragunsfunktion Identifiziereinrichtung 8 , die eine Impulsübertragungsfunktion ϑ k bezeichnend für die Parameter eines geschätzten Modells des gesteuerten Prozesses aus Prozesssteuerungssignalen u k und abgetasteten Prozessausgangssignalen y k identifiziert, und eine Steuerungskonstanten Betriebseinrichtung 10 , die Steuerungskonstanten für die erste Prozesssteuerung Betriebseinrichtung 4 aus der identifizierten Impulsübertragungsfunktion ϑ k berechnet,

## Description
The present invention relates to a process control apparatus which possesses a function that can precisely control a process in accordance with the state of the process characteristics. In process controlling the temperature, flow, pressure, and the like of a plant, the PID control method is being employed widely. In particular, for steady states, the operation signals from the PID control apparatus are stable so that the control performance of the method has reached a high level of skill in engineers in charge, having been implemented extensively for a long time. On the other hand, in order to appropriately execute the control with a process control system that employs the PID method, it is necessary to adjust, or tune, suitably the control constants of the PID control apparatus in compliance with the characteristics of the process. However, the tuning for an appropriate PID control, at all times, of a process in which the characteristics vary frequently due to external distrubances, load, and so forth is a difficult job which is a serious burden to the operator. For this reason, there has been proposed a sampling PID control apparatus described, for example, in Japanese patent No. 90704 1982 which is equipped with an auto tuning mechanism for automatizing the tuning work for the PID control. As an improvement over this, there has been a demand for an apparatus that can provide a satisfactory control performance even for cases where the process characteristics vary frequently, such as the case where the process chasacteristics change during the period in which the characteristics of the process is being identified. On the one hand, it has been known, for processes in which the characteristics vary frequently, that an adaptive process control that employs the minimum variance control method, deadbeat control method, pole assignment control method, or the like is effective. Description of these control methods can be found, for example, in H. Kurz et al., Development, Comparison and Application of Various Parameter Adaptive Digital Control Algorithms Proceeding of the 7th IFAC Congress, Helsinki 1978 , pp. 443 452 or in K. J. Astrom et al., On Self Tuning Regulators Automatica, 1973, No. 9, pp. 185 199 . On the other hand, there are disadvantages in these control methods that they may shorten the life of the control equipments and the like due to the tendency of greatly modifying the operation signals for the reason of their controlling the process, even in steady states where these are no changes in characteristics. Furthermore, in contrast to the number of three, at the most, of the control constants for the PID control apparatus, the corresponding number for these methods may exceed ten, making the manual tuning of the apparatus extremely difficult. These factors represent the obstacles in introducing the adaptive control methods into the practical scheme of process control. The object of the present invention is to offer a process control apparatus which operates satisfactorily for situations where the process characteristics vary frequently as well as for the situations where they are in steady states. In order to achieve the above and other objects, advantages, and effects, the present invention provides a process control apparatus with a first process control operational means for controlling a process when the characteristics of said process are in a steady state, a pulse transfer function identification means which identifies a pulse transfer function indicative of the parameters of an estimated model of the controlled process from process control signals and sampled process output signals, and a control constant operational means which computes control constants for said first process control operational means from the identified pulse transfer function, characterized by a second process control operational means for controlling the process when the characteristics of the process vary rapidly a switching means for selecting either the output of said first process control operational means or the output of said second process control operational means as the process control signal and a mode control means adapted for driving said control constant operational means to output said control constants and for driving said switching means to select the output signal of said first process control operational means as the process control signal when the process characteristics are detected by said mode control means to be in a steady state, said detection depending upon a value of a prescribed factor obtained from said pulse transfer function identification means, said mode control means further being adapted for driving said switching means to select the output signal of said second process control operational means as the process control signal when a change in the process characteristics is detected by said mode control means, said detection depending upon the pulse transfer function, the process control signal, and the process output signal. According to the present invention the process control system is provided with the first process control means which is adapted to sample controlling the process when the characteristics of the process to be controlled are in a steady state and the second process control means which is adapted to sample controlling the process when the process characteristics are varying frequently. The process control apparatus is arranged in such a way that when the process characteristics are not constant the control is carried out with the second process control means, whereas when the characteristics are constant the control is carried out with the first process control means based on the control constants for the first control means as determined by the process characteristics that are identified while the process is controlled by the second process control means, so that it is possible to execute a control appropriate for the state of the process characteristics, permitting one to have a satisfactory control performance for processes whose characteristics vary frequently as well as for processes whose characteristics are constant. Moreover, when a steady state is realized, the control constants of the control system due to the second process control means are designed automatically by using the process characteristics that are identified while the process is controlled by the second process control means, which causes the control action to shift to the first process control means so that the control sigfnals for the process suffer no large change, allowing the life of the operation terminals to extend longer. This invention can be more fully understood from the following detailed description when taken in conjunction with accompanying drawings, in which Referring to Fig. 1 there is shown an embodiment of this invention. In order for the reference signal r k , which is sampled by the second sampler 2, to be controlled by the PID or minimum variance method, the process 1 to be controlled is connected via the 0 th order hold 3 to one of the PID control operational means 4 in the process control operational means 40 or said self tuning regulator STR 5, through the action mode alteration switch 6 which constitutes the switching means. The switching of said connection is controlled by mode control means 9 based on the result of operation in which the input data comprises the process signal y k sampled from the output signal y t of the process 1 with the first sampler 7, the control signal u k to the process 1 which is sample held by the 0 th order hold 3, the identification signal ϑ k which is the output of the least squares identification filter 8 that constitutes the STRs to be described later, and the forgetting factor λ k . On the other hand, the control constants for said PID control operational means 4 are computed by the control constant operational means 10, upon receipt of the opeation execution signal from the mode control means 9, by using, as the input, the identification signal ϑ k which represents the output of the least squares identification filter 8. Here, the sampling interval of the first sampler 7 and second sampler 2 is γ, the discrete time is k, and the continuous time t is given by k τ . The PID control operational means 4 computes the output signal u The deviation e k is computed at the deviation computer 11 by the following expression from inputs represented by r Self tuning regulator 5 consists of two parts the first is the least squares identification filter 8 which identifies the pulse transfer function representing the dynamic characteristics of process 1 from the process signal y k and the operation signal u k to the process 1 that is sample held by the 0 th order hold and the second part is the minimum variance control operational means 13 which computes the control signal u₁ k for controlling the process 1 by the minimum variance control method by using said identification coefficient signal ϑ k and the reference value signal r k that is sampled by the second sampler 2 as the input. The operation signal u₁ k delivered by the minimum variance control operational means 13 is determined in accordance with the state of the characteristics for the process 1, and said state of characteristics can be modeled as follows, in terms of the operation signal u k to the process 1 and the output y k of the process 1 Further, upon using a relation represented by Eq. 9 , Eq. 5 can constitute an estimated model for the process as given by Eq. 10 . On the other hand, although it was described in the foregoing that the minimum variance control operational means 13 computes the operation signal u₁ k with the understanding that the parameters q₀....,q In this way, the output u₁ k of the minimum variance control operational means 13 is computed at STR 5 by Eqs. 15 and 16 using the parameter ϑ k identified by the least squares identification filter 8 based on the data obtained at each sampling period . Moreover, as the algorithm for computing the operation signal to the process for realizing a minimum variance control based on the parameter identification result for the estimated model for the process, one may employ, in addition to the method described in the foregoing, such a method, as found, for example, in H. Kurz, Development, Comparison and Application of Various Parameter Adaptive Digital Control Algorithms Proceeding of the 7th IFAC Congress, Helsinki 1978 , pp. 443 452 . The mode control means 9 consists of the following three parts the characteristics change detection unit 14 which detects the characteristics of the process 1 by inputting the control signal u k for the process, the process signal y k , and the unknown parameter vector ϑ k identified by the least squares filter 8 the steady state judging unit 15 which detects, based on the foregetting factor λ k determined in the identification process with the least squares filter 8, that the characteristics of the process reached a steady state and the action mode control unit 16 which controls the switching of the action mode alteration switch 6 and at the same time drives the control constant operational means 10 that is to be explained later. In what follows each constituent element will be explained referring to the time charts shown in A through F of Fig. 6. In Fig. 6 curve A represents the waveform of the error in the estimated model η k , B the dynamic characteristics change proving pulse Δr k , C the demand signal for action mode switch which is the output of the characteristics change detection unit 14, D the demand signal for action mode switch which is the output of the steady state judging unit 15, and E and F give the curves showing the states of the minimum variance control and the PID control, respectively. The characteristics change detection unit 14 detects the change in the characteristics of the process 1 in the manner as explained below see Figs. 7 and 8 . First, the detection unit 14 computes the error η k of the estimated model for the process 1, based on the parameter ϑ k of the estimated model that is identified by the least squares filter 8, from the operation signal u k for the process 1 and the process signal y k , as defined by the following expression see Fig. 6 A . In the result of this operation, the expectation value of the estimated model error η k will vanish if the characteristics of the process 1 do not change, whereas it will not vanish but will give rese to a direct current component if the characteristics change. Then, the characteristics change detection unit 14 suspects that there occurred a change in the characteristics of the process 1 if the estimated model error η k satisfies the condition η k L₁ when compared with the first threshold value L₁ fined by Eq. 27 given below see Fg.6 A . The characteristics change detection unit 14, then delivers its output to the action mode control unit 16, and the control unit in turn delivers an output, the confirmation pulse of a change in the dynamic characteristics Δr k , to the deviation computer 11 see Fig. 6 B . Accordingly, in the event that the dynamic characteristics of the process change, the error in the estimated model η k will undergo noticeable fluctuations under the influence of said confirmation pulse Δr k . Then, if these fluctuations satisfy the condition, compared with a second threshold value L₂ defined by Eq. 28 see Fig. 6 A , the characteristics change detection unit 14 judges that there occurred a change in the dynamic characteristics of the process 1 and delivers a demand signal for action mode switch to the action mode control unit 16 in order to shift the control of the process 1 from the PID control to the minimum variance control due to STR 5 See Fig. 6 C . Also, in case no fluctuation occurred in the estimated model error η k and a change is observed only in the direct current component d as a result of applying said confirmation pulse in the dynamic charactertics Δr k , said detection unit judges that no change is generated in the dynamic characteristics of the process 1. Hence the characteristics change detection unit 14 corrects the direct current component d to a value like, for example, in order to adjust the estimated model error η k to vanish. Here, we set n 5 in the more general average over k i , i 0, ... , N . In addition, the quantity F in Egs. 27 and 28 represents a prescribed factor a number, for example, in the range 0.005 0.05 . The steady state judging unit 15 judges, as was mentioned earlier, that the characteristics of the process 1 is stable, based on the result of inputting the foregetting factor λ k from the least squares filter 8. This observation follows by noticing the fact that, as the characteristics of the process 1 approach a constant level, in accordance with the diminishing of the residuals ε k given by q. 22 , said forgetting factor λ k approaches unity as a result. Therefore, the steady state judging unit 15 judges that the process 1 reached a steady state as soon as it detects that the forgetting factor λ k exceeded a certain prescribed threshold value 0.98, for example , and it provides the action mode control unit 16 with both of an action mode switch demand signal in order to shift the control of the process 1 from the minimum variance control due to STR 5 to the PID control see Fig. 6 D and an operation execution command signal in order to drive the control constant operational means 10. The action mode control unit 16 atters the connection contact of the action mode alteration switch 6 when provided with an action mode switch demand signal from the characteristics change detection unit 14 or the steady state judging unit 15 see Figs. 6 E and 6 F , and it also outputs an operation execution signal to the control constant operational means 10 in order to PID control the process 1 based on the PID control constants upon receipt of an operation execution command signal from the steady state judging unit 15 see Fig. 9 . The control constant operational means 10 consists of two parts, namely, the s transfer function operational unit 17 which computes, upon receipt of said operation execution signal, the s domain transfer function for the process 1 by receiving the parameter signal ϑ k that was identified by the least squares filter 8, and the PID control constant operational unit 18 which computes the proportional gain K Upon receipt of an operation execution signal from the action mode control unit 16, the s transfer function operational unit 17 computes the lower dimension parameters g andi i 0,1,2,3,.. of the s transfer function G and s in the manner explained below see Figs. 10 a and 10 b . First, by eliminating F z ¹ , C z ¹ , and J z ¹ through substitution of Eqs. 9 , 11 , and 12 into Eq. 8 , the pulse transfer function G z ¹ of the procesl can be found in the following form by using the parameter k identified by the least squares filter 8. Based on the pulse transfer function G Z ¹ thus found the s transfer function G and s can readily be evaluated as given below by employing a known method see, for example, An Investigation on Methods of Deriving Low Frequency Characteristics of s Domain Transfer Function from the Pulse Transfer Function, Paper No. 1110, The Twentieth Scientific Meeting of SICE, 1981 . Using the s transfer function Eq. 31 evaluated at the s transfer function operational unit 17, the PID control constant operational unit 18 computes the PID control constants namely, Kc, Ti, and Td in the following way from the roots of the cubic equation given by Eq. 36 that follows from a design method based, for example, on model matching see Design Method for PID Control Systems with the reference signal Filter, paper No. 1071, The Twentyfifth Scientific meeting of the Automatic Control Federation, 1982 see Fig. 11 . Here, the root used for Eqs. 37 through 39 is to be understood as the smallest positive root of the cubic equation Eq. 36 . Further, by increasing the response shape factor from zero to unity it is possible to set arbitrarily the response of the control system to a step change of the reference value from a response with no overshoot, via those with slowly increasing rise, to a response with an overshoot of about 10 in accordance with the specification of the control system, as shown in Fig. 12. Next, the working of the present embodiment is explained by referring to the action flow charts shown in Figs. 13 a and 13 b . The control of the process starts after initial set up of the prescribed parameters or filter. In the initial stage of the control it is possible that the charactiristics of the process 1 are still unstable due to their transistional nature and the like so that the process 1 is at first controlled by the minimum variance method by replacing the operation signal u k to the process 1 by the minimum variance control signal u₁ k Steps 100 120 . When it is detected by said minimum variance control that the characteristics of the process 1 reached a steady level Steps 130 and 140 , the PID control constants Kc, Ti, and Td are computed Steps 150 and 160 and a PID control is also started based on said control constants Kc, Ti, and TD for the process 1 by changing the operation signal u k to the process 1 to a PID control signal u During this period of PID control the state of the characteristics of the process 1 is being watched, under the confirmation that said control system is not in a bypass state, based on the estimated model error η k . However, when a change in the characteristics is detected by the fact that the estimated model error η k exceeded the first threshold value L₁ Steps 210 and 220 , a dynamic characteristics change confirmation signal r k is impressed on the control system to decide whether said characteristics change is generated due to a change in the dynamic characteristics of process 1 Step 230 . If the change in the estimated model error η k is detected to have exceeded the second threshold value L₂ as a result of impressing the dynamic characteristics change confirmation signal Δr k S Steps 2409 and 250 , the dynamic characteristics of the process 1 are judged to have changed and a shift to the minimum variance control of the process 1 takes place by altering the operation signal u k of the process 1 to the minimum variance control signal u₁ k by driving the action mode alteration switch 6 Step 260 . Moreover, if the change in the estimated model error η k did not exceed the second threshold value L2 Step 250 , the PIP control is carried out uninterrupted by correcting for the direct current component d so as to make the estimated model error η k to vanish Step 270 . Therefore, in this embodiment of the invention, it is arranged in such a way that when the dynamic characteristics of the process are judged to have changed, the STR mode is selected in order to have the process controlled according to the minimum variance control method, whereas when the dynamic characteristics are found to be in a steady state, the PID mode is selected to have the process controlled according to the PID control method based on the PID control constants tuned to the process characteristics that are identified by STR. Thus, based on this process control apparatus it is possible to realize automatically an extremely satisfactory control system for various changes in the process characteristics that might take place during a closed loop control. Further, although the control apparatus for the process 1 in the present embodiment consists of discrete circuits, it may be replaced by a construction that handles the matter with microcomputers based on Fig. 13 a or 13 b . Moreover, the identifiability conditions are satisfied by carrying out said process identification with the iterative type least squares identification filter that employs an estimated model together with the minimum variance control method so that it becomes unnecessary to have a means for generating identification signals for process identification. As explained in the foregoing, according to the present embodiment with a PID control means and a minimum variance control means in the process control system, an arrangement is made in such a way as to have the identification of the estimate model and the minimum variance control for those cases where the process characteristics are not constant, and to have the PID control based on the PID control constants determined by the coefficients of the estimated model for the process that are identified during the minimum variance control for those eases where the process characteristics are constant, so that an appropriate control becomes available in accordance with the state of the process characteristics, making it possible to obtain a satisfactory control performance for processes with frequently varying characteristics as well as for processes with constant characteristics. In addition, when a steady state is reached the control operation is shifted to the PID control, because the control constants for the PID control system are designed automatically from the process characteristics that are identified during the minimum variance control, so that the control signals to the process are not subject to large excursions and hence the life of the operation terminals can be extended further. In the embodiment of the present invention described in the foregoing, explanation was given by employing the PID control operational means as the first process control operational means. However, it works equally well even if the PID control operational means is replaced by the I PD control operational means 41 as shown n Fig. 14. The I PD control operational means 41, as a sampled value I PD operational unit, consists principally of an I compensation operation circuit 42 and a PD compensation operation circuit 43 wherein the I compensation operation circuit 42 receives, as its input, both of the output signal from the airthmetic unit 44 which adds the proving signal Δr k from the action mode control unit 16 to, and subtracts the output signal y k of the process 1 from, the reference signal r k and the control constant signal from the I PD control constant operational unit 45. Further, the PD compensation operation circuit 43 receives as its input both of the output signal y k of the process 1 and the control constant signal from the I PD control constant operational unit 45. The output of the I compensation circuit 42 and the output of the PD compensation circuit 43 are so arranged as to yield an output signal u₀ k via the arithmethic circuit 46 which carries out the arithmetic operation on them. With such a construction the effectiveness of the present invention can be brought into full play be being endowed with the well known special quality characteristic to the I PD control method. Further, in the embodiment of the present invention described in the foregoing, the minimum variance control operational means was employed as a constituent component of STR 5, but this arrangement is not exclusive so that replacing STR 5 by an STR 48 that employs the deadbeat control operational means 47 or by another STR 50 that employs the pole assignment control operational means 49 will give rise to an equally satisfactory result. While the invention has been described with respect to one particular embodiment, it is apparent that various modified embodiments will be obrious to those skilled in the art in view of the foregoing description. Thus, this scope of the invention should not be limited by the foregoing description, but rather, only by referene to the claims appended hereto.