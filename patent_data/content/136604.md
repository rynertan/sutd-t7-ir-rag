# Decoding method and system.

## Claims
Decodiersystem für einen Produktcode mit Minimalabstand 2t, bei dem in bezug auf eine Information von in einer Matrix mit k Reihen und ℓ Spalten angeordneten k x ℓ Symbolen, wobei jedes Symbol aus einer vorbestimmten Anzahl von Bits besteht,

## Description
The present invention relates generally to a decoding method and system, and particularly to a decoding system capable of high speed decoding suitable for use in parity checking in digital information data transmission or recording with high reliability. In transmission or recording and reproducing of digital information data, in order to prevent erroneous transmission or recording reproducing of digital signal, a data sequence is blocked into blocked data of a predetermined length, and coding is performed for each blocked data. When a reliability and error characteristic of the transmission line or recording medium is not sufficient, there is a need to correct compound error wherein random error and burst error may exist together. Then, by randomizing the burst error into random error by means of interleaving the random errors are corrected. When the object of error correction is only the random errors, or the compound errors, higher error correction capability for random errors contribute to higher reliability of digital information data. A product code has a characteristic that decoding the component code is easy with respect to its correction capability, and is good in harmonizing with the interleaving for correction of the compound error. Therefore the product code is being used more often for error correction in the system of transmission or recording of digital information data. In the code comprised of two or more component codes such as the product code, however, it is necessary that decodings of the component codes of the code must organically cooperate. For instance, in decoding of a product code constituted by two component codes, such repeated operation becomes necessary that after decoding a first component code, decoding a second component code is carried out by utilizing the result of the first decoding, and when necessary, decoding the first component code is repeated. Accordingly, in the decoding of the product code, though decoding of code of respective component codes are relatively simple, processing of the organic cooperation of the decoded results is complicated, and a general practical process has not yet been available in the prior art. When the code of n k r bits is made by adding r bits of redundancy to k bits of data, 2 The above mentioned principle of the error correction has been generally known among the person ordinary skilled in the art. For instance, it is disclosed in page 9 11 of THEORY AND PRACTICE OF ERROR CONTROL CODES written by R.E.Blahut and published by ADDISON WESLEY PUBLISHING COMPANY in 1983. Copies of this document are enclosed. In the above mentioned error correction code, distance between the code words is the most important parameter. and especially the minimum distance of all distances, namely t of the present invention, is the parameter to determine the ability of correction for this code. The distance from the code word means number of errors from that, and the code of the minimum distance t means that none of the code words becomes to other code words unless more than t errors occur. Also, it may happen that changing to other code word does not occur in spite of occurrence of more than t errors. That is, there exist many cases depending on many error patterns. Therefore, a distance to the nearest code word i.e. number of apparent errors is not determined. As clearly shown in the above mentioned principle of correction, correct operation is performed only at the time when errors of less than t 1 2 occur in the code word in the correction circuit that the minimum distance is t. But, when more than t 1 2 errors occur, correct operation is not guaranteed. That is, when more than t 1 2 errors occur, both the nearest code word to the received sequence and the distance number of errors to this code word are not determined. If it happens that the distance to a non corresponding code word becomes less than t 1 2 . wrong correction is made to the code word, and if there are two or more code words of the nearest, such a state is detected that correction can not be performed. It is dependent upon the error pattern that which state is selected. The object of the present invention is to provide a decoding system capable of high speed decoding of a product code of minimum distance 2t constituted with two codes with minimum distance 2 and minimum distance t, wherein, with respect to information of kxℓ symbols arranged in a matrix with k rows and ℓ columns, in each row a checksum symbol of ℓ symbols is added for constituting code with minimum distance 2, and in each of ℓ 1 columns including a column for said added checksum symbols a set of parity check symbols are added for constituting a code with minimum distance t. This object is solved by a decoding system as stated in claims 1, 3 and 5 and by a decoding method as stated in claim 7. Advantageous further features of the decoding system are subject of the dependent claims. In order to attain the above mentioned object, the decoding system in accordance with the present invention performs a first decoding of ℓ 1 column codes in column direction by a first decoder, and then a deciding on the decoding mode among three decoding modes by statistical processing of the error number flags issued from the first decoder, and finally a second decoding in which, responding to the decided decoding mode, the decoding is made as assertion of simple error detection, or single erasure error correction by using row codes, or error detection by using codes in row direction. FIG. 1 is a diagram showing principle of constitution of a product code to which the decoding system in accordance with the present invention is applied. FIG. 2 is a flow chart showing process of decoding in the decoding system in accordance with the present invention. FIG. 3 is a set of schematical diagrams showing error corrections of various kinds in the decoding system in accordance with the present invention. FIG. 4 is a block diagram showing one embodiment of the decoding system in accordance with the present invention. FIG. 5 is a block diagram of an inner code decoder 4 of FIG. 4. FIG. 6 a is a block diagram showing an example of error number flag counter 7 of FIG. 4. FIG. 6 b is a waveform diagram showing waveform of input signal to the error number flag counter of FIG. 6 a . FIG. 7 is a circuit diagram showing one example of circuit configuration of a pointer generator 9 of the decoding system of FIG. 4. FIG. 8 is a circuit block diagram of another embodiment in accordance with the present invention. Firstly,the principle of decoding procedure to be used in the decoding system in accordance with the present invention is explained. FIG. 1 is a diagram showing a construction of a product code to which the present invention is applied. As shown in FIG. 1, the information data 1 are disposed in a matrix having k rows and ℓ columns. The component elements of the matrix are referred to as symbols here, wherein one above mentioned symbol is represented by i bit tuple. The checksum symbols 2 are obtained by performing exclusive ORs between respective i bit elements of ℓ symbols in each row of the matrix. Then, the next coding is made with respect to each column of the matrix comprising the symbols k x ℓ 1 for making a column code of minimum distance t, and parity check symbols 3 consisting of r symbols are added to each of the ℓ 1 columns, thereby obtaining rows of distance k r symbols. The matrix having k r x ℓ 1 becomes a product code having minimum distance 2t. Here it is to be noted that, parity check symbols 3 for each of the r symbols are added to the ℓ 1 th column to constitute checksum symbols 2 for the k 1 th row through k r th row. Also, it is to be noted that even when the order of coding of the rows and the columns may be interchanged, quite the same code can be constituted. Accordingly, the order of the coding between the rows and the columns does not limit the gist of the invention. Hereinafter, however, for the sake of simplicity of description, coding in rows is referred to as outer code and coding in columns are referred to as inner code but these namings are not limited to the above mentioned,and may be interchanged. Decoding of the product code in accordance with the decoding system embodying the present invention is carried out along the process shown in a decoding flow chart of FIG. 2. Firstly, a decoding process is carried out for the inner codes. Error number flags are issued as a result of the decoding of the inner codes. In an inner code which has a minimum distance t, error correction can be made for When an error which is beyond the correction capability of the inner code takes place, it is indeterminate which of setting a flag Nextly, ℓ 1 error number flags obtained in the above mentioned process are statistically processed, and as a result the following operations are classified into the following three modes. Firstly, error number flags Fi are counted for each of the error numbers. Provided that a number of occurrences of error number flags Fi is Ci, then the following equation 1 holds Firstly, priorities are given to the flags in the order of from largest i sequentially to smallest i of Ci. Then, the following operations are classified in the below mentioned correction modes. This decoding is referred to as the first type decoding method. Then, error correction processing to be carried out by utilizing outer codes corresponding to the abovementioned decoding modes I, II and III are as follows A pointer is put on a column of the inner code whereat an error number flag Fi for the Ci of the highest priority order in non zero Ci s is 1. Then, k r pieces of checksums are obtained by making exclusive OR operation between every corresponding bits of the ℓ 1 symbols of each row which are outer codes of the received sequence or the read out sequence, and each of the checksums is added to the column, on which the pointer is put, through the exclusive OR operation. Alternatively, the checksum of the outer codes of respective rows except the column on which the pointer is put is obtained, and the resultant checksum is substituted in place of the column on which the pointer is put. k r pieces of checksums are obtained by making exclusive OR operation between every corresponding bits of the ℓ 1 symbols of each row which are outer codes of the received sequence or the read out sequence. As has been described in the above, by decoding the product codes, error correction for symbols t 1 in length or less and error detection for symbol t becomes possible for product codes of minimum distance 2t. By utilizing data processing method different from the above mentioned, other statistical processing can be proposed. In a proposed second type decoding method, by limiting the error number flag to be noted only to Error correction and error detection operation by using the outer codes for these three modes are carried out as follows A pointer is put on a column of the inner code whereat an error number flag Fi for the Ci of the highest priority order in non zero Ci s is 1. Then, k r pieces of checksums are obtained by making exclusive OR operation between every corresponding bits of the ℓ 1 symbols of each row which are outer codes of the received sequence or the read out sequence, and each of the checksums is added to the column, on which the pointer is put, through the exclusive OR operation. Alternatively, the checksum of the outer codes of respective rows except the column on which the pointer is put is obtained, and the resultant checksum is substituted in place of the column on which the pointer is put. k r pieces of checksums are obtained by making exclusive OR operation between every corresponding bits of the ℓ 1 symbols of each row which are outer codes of the received sequence or the read out sequence. As described above, by decoding the product codes, though not absolutely equal to the above mentioned first decoding method, the substantially utilizable performance almost similar to that of the first type decoding method is obtainable. This second type decoding method can be considered as a method which is simplified to the utmost extent from the first type decoding method. In other words, in the first type decoding method, in classifying of the decoding mode, all of Fi for i within the range of Hereafter, the process of decoding in accordance with the present invention is elucidated on an actual example werein the minimum distance t of the inner code is 5 and hence the minimum distance of the product code is 10. In this example, since the product code has the minimum distance 10, error correction of 4 symbols or less and error detection of 5 symbols are theoretically possible. FIG. 3 shows patterns for all cases of errors of 5 or less symbols. In FIG. 3, cases are classified by error number e occurring in the whole of the product code and further by error numbers of inner code in respective colums. The error number flags generated by decoding of the inner code are shown at the position below the respective columns. Though in the columns having no error the flag F0 is generated, the flag F0 is shown only for the case of e 0, and in the cases of e 1 or larger e the flags F0 are omitted from the drawing for simplicity. Furthermore, since the minimum distance of the inner code is 5, error correction for 2 symbols or less is possible for respective columns of the inner code. But in case of an error for 3 symbols or more, which is beyond the error correction capability, the error detection flag F3 is not necessarily generated. When errors of 3 symbols are generated in one column of the inner code like the CASEs 7, 10, 14 and 17, since the minimum distance of the inner code is 5, there are two liabilities of processing, namely, error correction being impossible or erroneous correction of two symbols being made. In the former processing a flag F3 is generated and in the latter processing a flag F2 is generated. In the similar way, in 4 symbol errors of CASEs 11 and 16, either one of flags F3, F2 or F1 is generated and in the 5 symbols errors of CASE of 18, either one of the flags F3, F2, F1 or F0 is generated and classified. Classification of decoding mode in accordance with the aforementioned first type decoding method yields the following results. When it is classified into the decoding mode II. in the case 2. 4. 6, 9 and 13 of FIG.3 and at the decoding of the inner code, all the occurred errors are corrected, and further the error correction using the outer code is carried out. At that time, there is no fear of addition of a new error by such error correction. In other respective cases classified as the decoding mode II, other columns except the column on which the pointer is put are corrected. Since non corrected column is only one on which the pointer is put, this column can be also corrected by process of the erasure error correction using the outer code. The decoding mode III is for detecting whether the error is appropriately corrected or not using the inner code, and detection of an uncorrectable errors are asserted only for the CASEs 16 iii 17 ii and 18 iv . As has been described, in the example product code of the minimum distance 10, errors correction of 4 or less symbols and error detection of 5 symbols which is theoretically possible can be done according to the decoding method of the present invention. In the similar way, for the cases of the minimum distances 2, 3, 4 and 6 or more of the inner code, the theoretical possibility of error control ability can be proved. When the product code having minimum distance 10 as described in the preceding example is transmitted or decoded in the direction of a row, namely in the direction of the outer code, and the decoding method in accordance with the present invention is used, error correction is possible even when a compound error consisting of a burst error of 2 rows, i.e. 2 x ℓ 1 symbol length or less and 1 symbol random error, or burst error of 1 row, i.e. ℓ 1 symbol length or less and 2 symbol random errors, or the like, arise at the same time. When the cases of error patterns are classified with decoding modes in accordance with the second type decoding method, classification becomes as follows. In each of the CASEs classified into the decoding mode II, it is different from the decoding mode II of the first type decoding method that the error always remains in the column on which the pointer is put, whereas other columns except the column on which the pointer is put are corrected. Since non corrected column is only one on which the pointer is put, this column can be also corrected by process of the erasure error correction using the outer code. In the decoding mode III, in the CASEs 7 ii 10 ii , 11 ii , 11 iii , 14 ii , 16 ii , 16 iii , 17 ii , 18 ii , 18 iii , 18 iv , detection of uncorrectable errors, is asserted. However, when the minimum distance of the inner codes are sufficiently large, for instance, in the example of using the inner code of minimum distance 5, even at occurrence of errors beyond the correction capability of the inner code the probability of making undesirable erroneous correction or erroneous detection is very small. As a result, the performance this second type decoding method is almost the same as the performance of the first type decoding method. As a third type decoding method, which is an intermediate decoding method between the first type decoding method and the second type decoding method, a decoding method noticing the occurrence of two error number flags of As is obvious from the comparison with the first type decoding method and the second type decoding method,in the third type decoding method too, detections of uncorrectable errors are asserted for the CASEs 11 iii , 16 iii ,17 ii ,18 iii and 18 iv . Accordingly, the performance of this third type decoding method is evaluated as that between the first type decoding method and the second type decoding method. Hereafter, one actual embodiment of a decoding system embodying the present invention is described with reference to FIG. 4 and thereafter. FIG. 4 is a block diagram of the actual embodiment of the decoding system in accordance with the present invention. An input signal to this decoding system is a product code which has been transmitted or recorded in the direction of the row, that is, in the direction of outer codes which are sequentially received or reproduced is inputted. The input information data are firstly stored in a memory in the form of a matrix shown in FIG. 1, and the information data are sequentially read out in the direction of columns and input as the input signal 101 to the inner code decoder, wherein decoding of the inner code is carried out for k r symbols in every column. Then the decoded sequence data 102 are stored in a temporary memory 6. At the same time, the checksum generator 5 receives the decoded data sequence 102 and generates a checksum signal for each row. When all of the decoded sequence data 102 are input into the checksum generator 5, checksum symbols 103, which are obtained through exclusive OR operation of ℓ 1 symbols at every row, are completed. On the other hand, the inner code decoder 4 issues error number flags 104 upon decoding of the inner code. The error number flag counter 7 counts error number flags 104 in every class and sends the occurrence number data 105 of the error number flags to the decoding mode decision circuit 8 upon completion of the decoding of the input sequence data 101 having ℓ 1 x k r symbols by the inner decoder 4. The decoding mode decision circuit 8 decides the decoding modes corresponding to the occurrence number data 105 of the error number flags. The decoding mode decision circuit 8 will determine a decoding mode as one of the aforementioned first type decoding method, second type decoding method or third type decoding method. When the case is the decoding mode I, the error detection flag generator 11 issues uncorrectable error detection flag 106 to the output terminal. When the case is the decoding mode III, a zero criterion circuit 10 decides whether the checksum data 103 is zero or non zero, and if the decision result is zero a no error condition in the temporary memory 6 is determined. At this time, the data contents of the temporary memory 6 are issued as the output data sequence 107 to the external output terminal. On the other hand, when the decision result is not zero, the zero decision circuit 10 issues a signal to cause an error detection flag generator 11 to issue an uncorrectable error detection flag 106 to the output circuit. In the case of the decoding mode II, each content of k r pieces of symbols of the column, which is designated by the pointer determined in the pointer generation circuit 9 by the error number flags 104, is transmitted to the checksum generator 5 by means of the temporary memory 6, and the content of the symbols is added to the content of the corresponding symbols to checksums of respective rows through the exclusive OR operation. The resultant EX OR data are stored in the temporary memory at the address designated by the pointer 108, and thereafter the contents of the temporary memory are issued as the output data sequence 107 to the external output terminal. Hereupon, when the inner codes are made into BCH code or Reed Solomon code, the decoders described in detail in the texts of coding theory such as Algebraic Coding Theory by E. R. Berlekamp, McGraw Hill Book Company, 1968 can be used for the inner decoder 4. The inner decoder 4 can be schematically represented as shown in FIG. 5. The input sequence 101 is input to a sequential buffer 401 and error enumerator 402, and the error enumerator 402 issues error position and error value of the codeword upon every completion of input of code word of one inner code. During that process the error enumerator 402 issues a number of errors occurring in the codeword as the error number flags 104 comprising The most important process in the decoding system of the present invention is the determination of the decoding mode through statistical processing of the error number flags. Here, one practical example to carry out the statistical processing of the error number flags for the product code having the minimum distance 10 is described. FIG. 6a shows one example of the error number flag counter 7 for the error number flag Fi. This circuit is provided respectively to count the occurrences of each of the error number flag outputs The decoding mode decision circuit 8 decides the decoding mode using the following logic. Here the decoding mode I, decoding mode II and decoding mode III are represented respectively by M1, M2 and M3. Nextly, one example of an address latch signal generating circuit which is a main part of the pointer generator 9 is elucidated with reference to FIG. 7 The pointer is necessary only when the case is the decoding mode II, and the decoding mode is not determined until completion of the decoding of ℓ 1 inner codes. Therefore, a provisional pointer is put on the inner code allowing the possibility of the pointer being put on, and when error number flags of higher priority order arise , the provisional pointer is revised. Fig. 7 is an example of an actual circuit of the pointer generation circuit. The circuit has three D flip flops 121, 122 and 123, output terminals which are connected to a 4 bit cascadeable priority register 13 SN74278, made by TEXAS Instrument Inc. , and the D flip flops 121, 122 and 123 are cleared up by initial clear signal and set by the error number flags initially input thereto. The error number flags F1, F2 and F3 are input to the D flip flops 121, 122 and 123, respectively, and the outputs from the flip flops 121, 122 and 123 are input to the 4 bit cascadeable priority register 13 in the priority order of the error number flags. The register 13 changes its output only when an input of a higher priority order is inputted thereto. Output signals of the 4 bit cascadeable priority register 13 are given to the D flip flops 141, 142 and 143 and also to the HAND gates 151, 152 and 153, which when the output of the register 13 is changed from L level to H level, issue a short pulse. The short pulse is given to the AND gate 16, which accordingly issues output short signal Optical information recording reproducing apparatus or the like does not necessarily have satisfactory reliability, and there is inherent error characteristics in its recording medium. Accordingly, there is a severe demand to correct compound errors wherein random errors and burst errors should exist mixed together. Accordingly, in order to obtain error correction of the optical recording reproducing apparatus, the product codes on which the decoding system in accordance with the present invention is applicable is very suitable. For instance, a case where a sector of error correction unit consists of 525 bytes which is the total of 512 bytes user data and 13 byte control data is considered. Herein, the control data is that which is to be used in sector identification or file identification or sector management by the optical information recording reproducing apparatus, and for instance, this is data which is not accessible to users. The 525 bytes of data to be decoded is considered by symbol units of 4 bit symbols, and 1050 symbols are arranged to be represented by a matrix of 10 rows and 105 columns. Nextly, in each row of 10 rows, checksums of 105 symbols are obtained, and the resultant checksums are added to the right ends, namely, at the 106 columns as the checksum symbols. And at each row of the 106 rows, the codings are made with a Reed Solomon code of code length 15, information symbol number 10 and minimum distance 6 defined on Galois field GF 2⁴ wherein generator polynominal G x of the Reed Solomon is given Since the decoding system of the product code in accordance with the present invention has rather simple decoding procedure and the decoding is completed by sequential decoding of two kinds of code, the configuration is simple and high speed operation is possible. Transmission or recording reproducing of digital information data at high speed and with high reliability is possible and the system has a great industrial utility.