# Tone generator.

## Abstract
A tone generator in which tones are stored in a digital format each tone being stored as a number of samples of specified amplitude the number of samples of each tone ex actly corresponding to a whole number of cycles of that tone.

## Claims
CLAIMS 1. A tone generator for a telecommunication exchange in which the tones are stored in digital form in a memory, each tone being stored as a variable number of samples exactly corresponding to a whole number of cycles of each tone. 2. A tone generator for a telecommunication exchange as claimed in claim 1 in which the tones are stored in digital form in a tone PROM each tone being stored as a series of values the number in each series varying to conform closely to the desired output frequency. 3. A tone generator for a telecommunication exchange as claimed in claim 2 in which the tone PROM is controlled by a cycle position RAM which controls the position in each of said series of values which is addressed to ensure continuity of the generated tone. 4. A tone generator for a telecommunication exchange as claimed in claim 3 in which the tones are stored in an n bit PCM linear format for greater accuracy and are converted to an m bit PCM format for the exchange wherein ffl n.EMI9.1 EMI9.2

## Description
Tone Generator This invention relates to Tone Generators and more particularly to tone generators for a Digital PCM TDM telecommunication exchange. Tones are required in an exchange to indicate to subscribers the condition of their line and also for signalling purposes within the exchange. In previous telephone exchanges such tones have been produced by combining together in various combinations the outputs of two or more frequency generators. It is an object of the present invention to provide tone signals for a telecommunication exchange by storing the signals digitally in a memory. The digital PCM samples are then switched through the Digital Telephone exchange before going to a digital to analog converter to produce the tones. According to the present invention there is provided a tone generator for a telecommunication exchange in which the tones are stored in a digital form in a memory, each tone being stored as a variable number of samples exactly corresponding to a whole number of complete cycles of each tone. Assuming sine waves are to be generated. Embodiments of the present invention will now be described, by way of example with reference to the accompanying drawings in which, Figure I shows in block diagrammatic form a tone generator according to the present invention, Figure 2 shows the tone generator of Figure 1 in greater detail and, Figure 3 shows a table of generated tones as an example. The tones produced are programable due to the lookup tables used, Figure 4 shows a table of actual frequencies produced and, Figure 5 and 6 show general timing diagrams of the tone generator to the system data address bus as described in co pendimg British Patent Application No 8323782, The tone generator shown in Figures 1 and 2 produces all supervisory tones required by a PABX telephone system.Lt generates 8 bit A law coepanded PCM signals at an 8 Hz rate although other rates could be generated to conform with other PABX system clock rates. Also p law or linear. This tone generator can be used in an exchange such as described in our co pending British PatentApplication No 8323782. The tone generator receives commands fron an address bus such as ABI and in the above exchange and transmits bytes of data 8 bit PCM samples onto the data bus. This digital PCM sample goes through a CODEC to produce analog supervisory tones. The tone generator operation is automatic and has 128 channels enabling any one of 32 tones to be sent to 128 different CODECS. The described tone generator is programmed to produce any one of 27 tones at one of nine transmission levels. But up to 32 tones at 32 different levels may be produced by simply re programming the lookup tablePROMS. The method of production of each tone involves the storage of a complete number of cycles of a given tone in a PROM. The tone generator then cycles through thePROM to produce the required output. In order for this technique to operate an exact number of cycles of tone must effectively fit into the 8KHz or other chosen sampling rate. Hence as shown in Figure 4 the number of samples stored depends on the actual frequency required and a compromise of precise frequency generated against lookup table size is used. thus for example 1000 Hz fits exactly into 8 samples 400 Hz fits exactly into 20 samples 450 Hz is stored as 449.438 Hz which is 89 samples As 450 Hz would require 160 samples . 1209 Hz is stored as 1209.302 Hz which is 86 samples. In a preferred embodiment the largest number of samples stored is 255 samples per tone. 1336 Hz is stored as 1338.645 Hz which is 251 samples which represents an error of only 0.19 . As dual frequency tones are produced by the generator there are two sets of lookup PROMS. The first generates the low tones and the second generates the high tones. These are then added together before being companded into A law format or p law or 8 bit linear. It should be noted that this technique can be used to produce virtually any output waveform required ranging from ramps to special waveform shapes. With reference now to Figure 1 the tone generator is shown in block diagrammatic form as connected into a telephone exchange such as described in our co pendingBritish Patent Application No 8323782. Thus to enable a desired tone to be generated at a correct time the upper portion of Figure 1 comprises an address header circut 102 defining which shelf in the telephone system the tone generator is allocated. This is connected to an address compare circuit 104 which compares the address stored in header 102 with an incoming address stored in an address latch 106 to see if a tone is required. A tone request is received on an address bus AB1 which is a 16 bit parallel bus. The interconnection lines in Figure 1 are nearly all parallel busses with varying bits shown by adjacent numerals. Where no numeral is shown the connection is by a single wire and is normally a control signal. Thus only 5 of the 16 bits are required for the comparison of addresses as shown. The address compare circuit 104 is connected to a timing state logic control circuit 108 which controls the transmit and receive timings of the tone generator in synchronism with other system clocks ACLK DCLK SYN and TSO. This ensures that the tones are emitted at the correct instances for the rest of the exchange system. For generation of tones in isolation from a TDM telephone exchange this synchronism would not be required and since it is not a part of the inventive concept the exact synchronism timings will not be described in great detail. In outline however with reference to Figures 5 and 6 it may be seen that the time delay between a shelf command at T1 and data being transmitted at T2 to an individual time slot requires synchronism.The delay is required to enable the tone generator to generate the desired output tone. Two further bits from the input are fed via address latch 106 to an up down logic circuit 110 which performs a card enable disable function. The timing state logic circuit 108 provides output signals to update a counter 112 which in conjunction with an address multiplexer 114 controls the stepping through the PCM lookup tables. The address multiplexer 114 received a 5 digit address from the address latch 106 which identifies the tone required in a particular time slot and multiplexes under the control of an update control logic circuit 115 between a tone request from the address bus AR1 and a PCM lookup table pointer update cycle. The tone generation is carried out by two similar circuits which generate the upper and lower level tone.Since the operation of each circuit is identical except for the tones addressed in the tone PROMS then only one will be described. Initially in a given time slot the start addressPROM 116 is addressed to provide the start address in the tone PROM 118 of each of the various PCM sine wave lookup tables corresponding to the required frequency which when added to the frequency produced by the other tone PROM will produce the desired tone. A cycle position RAM 120 stores the individual position of each pointer in each of the various sine wave lookup tables. In the practical embodiment described 32 pointers displacements into each lookup table are stored. A latch 122 stores and forwards the cycle position of each table to an adder circuit 124. The latch 122 adds 1 to the current value of the pointer into the sine wave lookup table and this is also used to update the cycle position RAM 120 via anuadd 1 circuit 126 and a write control 128. The adder circuit 124 adds the start address onto the displacement value to address the tone PROM 118. The tone PROM 118 stores the various sine wave lookup tables. A whole number of cycles of each sine wave is stored. The exact number of PCM samples is varied in order to store a whole number of cycles. The output from the tone PROM 118 is fed to an adder 130 where it is added to the output from the other tone PROM 128. The adder 130 adds together the two tones generated or possibly one tone and silence. The output of the adder 130 is fed to a companding PROM 132 which compands the 12 bit linear produced tones to 8 bit linear or 8 bit A law or 8 bit p law as required, The output of the companding PROM 132 is fed to a latch 134 and then to a bus driver 136 which supplies the required 8 bit coded tone signal to the exchange system. In a practical system the lookup tables in the tone PROMS 118, 1181 may contain up to 256 PCM samples per tone number any wave shape may be generated by the system of the present invention. Thus for example triangular or other waveforms may be generated. For different amplitudes of tone a further complete set of amplitude values may be stored using the 256 samples available thus obviating the requirement for any analogue amplification.