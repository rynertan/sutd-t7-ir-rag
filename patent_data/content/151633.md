# AN INTERRUPTIBLE VOLTAGE CONTROLLED OSCILLATOR

## Claims
ECL Gatter mit gesteuerter Ausgangssignal Abfallzeit, mit

## Description
This invention relates to an ECL gate having a controllable fall time and voltage controlled oscillators utilising such gates, and to phase locked loops using much oscillators. In conventional phase locked receivers, such as used in data communication systems using Manchester encoded data signals, the acquisition time for such a receiver to acquire and to lock into a received signal is a predictable function of the receiver s phase locked loop time constants. These phase locked loops are usually of the analog type, that is, they use a continuously variable voltage signal for controlling the frequency of the voltage control oscillator. One particular problem associated with analog phose locked loop receivers is that phase lock cannot be obtained if the input signal is precisely out of phase with the receiver local oscillator signal. In applications of phase locked loops to communication systems, wide loop bandwiths are desirable for acquisition, while much narrower bandwidths are required for tracking. Previously used techniques, such as switching various capacitors into the circuit, to obtain suitable bandwidths are not suitable and are often impractical to implement in high speed data communication systems. Manchester encoded communication systems are used to communicate digital information because they permit a received signal to be quickly acquired and tracked. Signals encoded in conformity with a Manchester encoding scheme, are self clocking, that is, every bit cell of encoded information has a logic level transition occurring at its midpoint so that a Manchester encoded signal contains a significant clock frequency component which is separable from the data information. Manchester systems often transmit a preamble prior to actual data information being transmitted so that a receiver can acquire and lock on the input signal and establish a clock reference signal. A system for deriving a clock signal must effectively operate in the presence of noise and jitter. Many Manchester encoded data communications systems, such as the Ethernet Local Area Network system, are operated intermittently, that is, in stop and start applications. Packets of encoded information occur at random intervals, so that there are many time intervals when a signal line is inactive and has only random or impulse noise signals present. A conventional analog phase locked loop receiver operating under such conditions has difficulty operating because fast acquisition requires wide loop bandwidths while operation with noisy signals requires narrow loop bandwidths. which requires a compromise bandwidth to be used. For integrated circuits, accurate time delays for pulses, that is, delays controllable to a predetermined time, plus or minus a few percent, are not easily obtained. For fixed delays discrete delay lines have been used. When relatively long or when variable delays are desired, discrete delay lines have become quite large and difficult to vary. In many digital systems which operate over a range of frequencies, it would be very convenient to have pulse delays which would automatically track with the pulse frequency. United States Patent Specification 3,431,505 discloses an ECL gate through embodying a capacitor connected between the gate output and a current source, the rate of change of charge in which is controlled by a constant current source, the current through which is determined by a reference voltage shared with the emitter couple pair of transistors of the basic gate. Thus the rate of change of charge in the capacitor can not be changed independently of the switching level of the gate. The paper by AV Kutsenko el al in Instruments and experimental Techniques vol 16 No4 part 1 of July August 1983 published in New York, U.S.A., discloses the use of INVERTER gate in a ring to form an oscillator the frequency of which is dependant upon the number of gates utilized and the delay in each gate, but which can not be otherwise varied or controlled. We will describe an ECL gate stage having a controlled fall time. We will describe a circuit which provides a precise time delay proportional to the frequency of a reference signal. We will describe an interruptible voltage controlled oscillator. We will describe a frequency to voltage converter utilizing a phase locked loop. We will describe a voltage controlled oscillator which has its frequency separately controlled from its phase. We will describe a clock recovery system useful with intermittently sent data packets. We will describe a frequency reference signal having its frequency accurately controlled by one voltage controlled oscillator circuit while its phase is controlled by a second voltage controlled oscillator. We will describe a voltage controlled oscillator having a wide frequency tracking bandwidth but yet a narrow locking bandwidth. We will describe a circuit which provides a decoding clock from a Manchester encoded data signal. We will describe a circuit for discriminating between noise and a desired signal. We will describe a circuit for detecting the presence of Manchester encoded data signal on a signal line. The present invention claim 1 provides an ECL gate having a controlled output fall time, including We will thus describe an ECL gate stage having a controlled fall time is provided which is especially useful in voltage controlled oscillators and phase locked loop circuits. A timing capacitor and a current source are coupled to the output of the ECL gate stage. The current source controls the amount of current charging the timing capacitor to thereby control the fall time of the output signal at the gate output terminal. Both inverting and noninverting transistors are provided for the ECL gate the noninverting input transistor is used to disable the ECL gate. A voltage controlled oscillator is provided according to the invention Claim 4 which utilizes a number of the ECL gate stages, timing capacitors, and current sources described above arranged in a ring oscillator configuration. A noninverting input transistor for one of the gates is used to provide interrupted operation of the voltage controlled oscillator, a feature particularly useful with intermittently operated systems. A voltage controlled oscillator assembled in accordance with the invention Claim 9 is combined with a phase detector in a phase locked loop configuration. The phase detector compares the voltage controlled oscillator signal to a reference signal and provides an output voltage proportional to the frequency of the input signal. A time delay proportional to a reference frequency is provided for a pulse signal by an ECL gate. a timing capacitor, and a current source controlled by a reference frequency. A first time delay circuit receives an inverted input pulse and a second time delay circuit receives the input pulse. The inverted, signal is fed to the clear input of an edge triggered flip flop while the other time delay signal is fed to the clock input of the edge triggered flip flop. A Manchester encoded data signal can be detected when the delays are appropriately set. A system is also provided according to the invention Claim 16 for producing a receiver clock reference signal from a received signal. Two phase locked loops are used. Each has a voltage controlled oscillator with its output coupled to one input of a respective phase detector. The first phase locked loop phase detector locks to the frequency of the system reference signal. The phase detector output is utilized as a control voltage for the first phase locked loop. This control voltage is also used as an additional control voltage in the second phase locked loop. The second phase locked loop has its own voltage controlled oscillator and phase detector, which receives a noisy or jittery received signal. The output of the second phase detector is a control voltage for the phase of the second voltage controlled oscillator. As mentioned above, the second voltage controlled oscillator also receives another voltage control signal from the first phase locked loop. Thus, the second voltage controlled oscillator receives two control signals, one constraining its frequency to be near that of the system reference signal and the second being used to control the phase of the second phase locked loop to be that of the received signal. The second phase locked oscillator is interruptible and this two oscillator system is particulary useful for providing a receiver clock reference signal for a Manchester encoded data signal. Additional objects, advantages and novel features of the invention will be set forth in part in the description which follows, and in part will become apparent to those skilled in the art upon examination of the following or maybe learned by practice of the invention. The objects and advantages of the invention will be realized and obtained by means of the instrumentalities and combinations particularly pointed out in the appended claims. The accompanying drawings which are incorporated in the formal part of the specification, illustrate the invention and, together with a description, serve to explain the principles of the invention. In the drawings Figure 1 is a block diagram showing a gated ring oscillator using two inverter stages and a gated NOR inverter stage. Figure 2A is a schematic diagram of an ECL inverter stage according to the invention. Figure 2B is an ECL NOR gate stage according to the invention. Figure 3 is a schematic diagram of a more complex ECL inverter stage according to the invention. Figure 4 is a schematic diagram of a gated voltage controlled oscillator stage according to the invention. Figure 5A is a logic diagram showing a first phase locked loop circuit receiving a system reference signal and using a voltage controlled oscillator according to the invention. Figure 5B is a block diagram of a second interruptible phase locked loop which provides as an output a system reference clock locked in frequency to the system reference signal and in phase to a received signal. Figure 6 is a logic diagram of a delay generator according to the invention. Figure 7 shows voltage waveforms as a function of time at several points in the logic diagram of Figure 6. Figure 8 is a logic diagram for a Manchester signal detector according to the invention. Figure 9 shows waveform diagrams for the logic diagram of Figure 8. Figure 10 is a schematic diagram of a noninverting delay circuit according to the invention. Figure 11 is a schematic diagram of an inverting delay generator according to the invention. Reference is now made in detail to the present preferred embodiments of the invention which illustrate the best mode presently contemplated by the inventor for practicing the invention, the preferred embodiments of which are illustrated in the accompanying drawings. The inventions described herein are part of a single integrated circuit device identified as the Advanced Micro Devices, Inc., AM7991 Serial Interface Adaptor designed for use in a ten megabit per second packet switched local area network system. This device detects the presence of received data on a transceiver cable and transforms a received Manchester encoded data signal into a data output signal and a clock output signal. Precision pulse delays, which are locked to the frequency of a reference signal are utilized within this integrated circuit device. Figure 1 shows a gated ring oscillator circuit comprised of three inverter stages. A first inverter stage 12 and a second inverter stage 14 are cascaded to feed one input terminal of a NOR gate 16 which has its output terminal connected through a signal line 18 to the input of the inverter 12. The other input terminal 19 of the NOR gate 16 is used to gate the ring oscillator circuit on and off. Generally, gated ring oscillators of this type use n inverter stages where n is an odd integer. When the gate input at terminal 19 is low, the oscillator 10 runs with a period of When the gate input at terminal 19 is high, the output of the NOR gate 16 is forced low so that the output of inverter 14 gives low after a time delay of Figure 2A shows a circuit diagram for an emitter coupled logic ECL inverter stage 20 and Figure 2B an emitter coupled ECL NOR gate stage 22 such as used in the ring oscillator of Figure 1. Figure 3 shows a more complex ECL inverter stage while Figure 4 shows a more complex NOR gate. Referring to Figure 2A, the inverter stage 20 is an emitter coupled logic ECL gate inverter stage circuit having a pair of emitter coupled transistors 30, 32 having their emitter terminals tied together and supplied with current from a current source 34. Inverting transistor 30 has its collector terminal coupled to a positive voltage supply V Operation of the inverter stage of Figure 2A is as follows A logic low level at input terminal 38 turns off transistor 30. The base of output driver transistor 42 is then turned on by current flow from the positive voltage supply V A logic high at input terminal 38 turns on transistor 30, which causes transistor 42 to be turned off, leaving terminal 44 at a voltage near V The current through transistor 48 is controlled by the control voltage V Figure 3 shows a more complex inverter stage circuit 20, with elements common to Figure 2A having the same reference numerals. A current source transistor 34 provides the same function as the current source 34 of Figure 2A. Terminal 60 connected to the base terminal of the current source transistor 34 has a reference voltage V Figure 3 includes a more complex current source circuit 70, shown in dotted lines, having control terminals 71, 72, and 73 for controlling the current, nominally 250 microamperes, provided through transistor 74 from output terminal 44. Terminal 71 has a voltage signal V An oscillator with an output frequency which is a linear function of current is provided by forming a ring oscillator as in Figure 1. Ignoring base currents and finite current gains and for C46 and other capacitances constant and for fixed voltage levels, the discharging current I is Thus, the discharging current is almost a linear function of the control voltage. Referring to Figure 2B, a NOR gate circuit 22 corresponding to the NOR gate 16 of Figure 1 is shown. A pair of transistors 80, 82 have their emitter terminals tied together and are fed with current from a current source 84. Transistor 80 is an inverting input transistor which has its collector coupled to the supply voltage V Figure 4 shows in more detail the circuit diagram for the NOR gate circuit 22 of Figure 2B with the same numerals being used for components common to both circuits. The left hand side of the circuit of Fig. 4 is very similar to the circuit of Fig. 3 with the addition of the second inverting input transistor 102. Fig. 4 also shows a parallel inverter gate circuit 110 without a charging capacitor and having a positive supply voltage ECL VCC and an output YY for interfacing with other logic circuits. Referring to Figure 5A three inverter stages 120, 122, 124 as described above are shown with timing capacitors 121, 123, 125 in a ring oscillator configuration. With reference to Figures 2A and 3, the inverter turn time t The configuration of Figures 5A and 58 is provided in integrated circuit form to provide, among other things, a voltage controlled ring oscillator. In the Advanced Micro Devices, Inc., AM 7991 circuit, used for Manchester encoders, the ring oscillator operates at 40 MHz and is divided by four to provide clock signals at one quarter bit intervals. The controlled fall times are 7.6 nanoseconds, the voltage differences are 0.5 volts, and the total fixed and parasitic charging capacitances are 3.8 picofarads. Portions of a phase locked digital data receiver of the AM 7991 circuit are shown a first voltage controlled oscillator VCO and a second reference VCO provide frequency limits and phase control for a reference frequency signal. This communication receiver has been designed to utilize matched integrated circuit components and is designed to meet the timing and acquisition requirements set forth in various standards. In addition, the recovered reference frequency must not exceed the transmit frequency by 15 under any conditions. Figures 5A and 5B are the logic diagrams for a clock reference generator for decoding Manchester encoded data signals. The Master Reference Generator MRG circuit 120 of Figure 5A is an analog phase locked loop which produces a control voltage X4. The MRG 130 includes a VCO 132 having inverters 120, 122, 124, which feeds a divide by four circuit 134. A VCO output buffer stage similar to the parallel inverter circuit 110 of Figure 4 is provided. The edge triggered D flip flop divide by four circuit 134 divides the output signal which is delayed through a delay circuit 136 to provide a VCO signal FCK to one input of a phase reference circuit 137. A second input signal TCK to the phase reference circuit 136 is the transmit reference frequency clock which is provided from a crystal oscillator source not shown for the system. The phase reference circuit uses two D flip flops as a pulse position phase detector and the D flip flop output signals are inputted to a phrase correction, level shaping circuit 138. The output of which is signal X4 which is the VCO voltage control signal corresponding to V The VR3 and VR4 inputs corresponding to inverter stages 120, 122, 124 are connected together and to an internal bias voltage which is set at one half the integrated circuit supply voltage V Referring to Figure 5B, the DVCO 140 is similar to the MRG VCO 132 of Figure 5A. The VR2 terminals for the DVCO are connected to X4 from Figure 5A. VR3 of the DVCO is connected to a separate bias voltage to minimize cross talk between the two oscillators set at one half V Input logic signals to the DVCO phase locked loop 142 include a valid received signal detect signal VCOG and a received line actively signal PL2. The transmit clock reference signal, TCK, is crystal controlled and functions as a system reference signal. The recovered Manchester clock signal MNCK is also provided to the DVCO loop 142. The clock reference recovery loop 142 includes the decoder VCO 140, controlled in frequency range by VR2 from the VCO 132 of the MRG circuit 130 of Figure 5A. The VCO 140 includes three ECL inverter stages 144, 146, 148, a parallel output inverter 149, and corresponding charging capacitors 145, 147, 149. The output of the VCO circuit 140 is provided from a terminal 150 to a divide by four circuit 152 and THEN AS receiver clock RCK to one input of a pulse position phase circuit 154 which provides an appropriately delayed two times receiver. The other input to the phase detector circuit 154 is either the system reference signed transmit clock TCK or the received Manchester clock signal MNCK, as gated by signal PL2 through selection gates 153A and 153B. The output of the phase detector 154 is level shifted through level shift circuit 156, which provides a phase control voltage signal VR4 for the decoder VCO 140. The decoder VCO 140 also receives a frequency control voltage signal as VR2 from the VCO loop of the MRG circuit 132, which bounds the frequency of the DVCO loop within limits for easy lock on to a received signal. Operation of the system is as follows for matched integrated circuit VCO circuits When the received data channel is idle, PL2 is low so that DVCO is locked to TCK. When a signal is detected on the data line, VCOG goes to a logic high level which sets the output of inverter stages 148, 149 low, clears the counter of divider 152 and clears the phase detector 154 stages at the negative clock transition of a Manchester data cell. This clock transition also produces a signal VCOG which enables the incoming clock at the following negative input transition. At the next negative input transition, VCOG goes low restarting DVCO 140 synchronized to this negative input transition and PL2 is enabled to accept clock signals from the incoming data. After a delay to hold the preset count in the stages of the divider 154, the clear input signal thereto is removed from the divider 154 and phase detector 154. DVCO 140 cycles through its first period and the second rising edge at terminal 150 of the parallel stage 149 clocks the divider 152 to produce RCK. The 5th rising edge at terminal 150 is compared to the incoming clock MNCK. A phase error correction signal for the loop 142 is provided as X3 of V DVCO, then, is locked on the incoming clock MNCK and tracks MNCK from the VCOG high to low transition. When the incoming signal stops, PL2 is removed and the DVCO loop 142 resumes tracking TCK. When connected in a phase locked loop, the control voltage changes, as needed, to maintain the VCO frequency. Each inverter stage of a VCO provides a precisely controlled fall time. Figure 6 shows a time delay circuit 200 which is used to generate precise time delays for pulse signals appearing at an input terminal A thereof. Recall that the control voltage X4 in the phase locked loop of Figure 5A is very nearly directly proportional to the frequency of the reference signal, that is, as the frequency of the reference signal changes, the control voltage X4 changes. This relationship is used to provide fairly precise delays with accuracies to a predetermined delay of a few percent. To a good approximation the control voltage is proportional to the fall time of a VCO gate stage. Figure 6 shows a noninverting ECL stage 202 which has an output terminal B with a delay timing capacitor 204 coupled between thence and a positive supply voltage V A hysteresis circuit 214 has its input connected to terminal B and an output signal is provided at terminal C. Voltage waveforms at terminals A, B, and C of figure 6 are shown in Figure 7. A time delay t The second input pulse with a pulse width PW2 has a duration too short for the signal at terminal B to fall below RO and trigger the hysteresis circuit 214. Consequently, no output pulse at C is produced. The circuit of Figure 6 can thus be used as a pulse width discriminator, with input pulses at terminal A having a width, or time duration, of less than a prescribed value not triggering a delayed output pulse at terminal C. Similarly, this circuit can be used to detect that a valid signal is present with a frequency below some predetermined maximum frequency or its complement by cascading two circuits as in Figure 6 to detect pulses within a certain range. When the frequency of a desired signal is known, delay circuits of this type are useful in rejecting out of band noise and for detecting the presence of a desired carrier signal. Figure 8 shows such a combination used in conjucntion with an edge triggered D flip flop 216. An input signal IN appears at an input terminal 218 of an ECL inverter stage 220 which has its output terminal coupled to the input terminal of a noninverting ECL inverter stage 222 having an output terminal 226 fed by an appropriate current I Input terminal 218 is also connected to the input terminal of another ECL noninverting ECL stage 232 having an output terminal 236 fed by another current I₂ from a current source. A C2 capacitor 234 is connected between the output terminal 236 and a positive voltage reference terminal 238. The input of another hysteresis circuit 240 is connected to terminal 236 and the output terminal F of the hysteresis circuit 240 is connected to the clock input of the D flip flop 216 which has a Q output terminal G at which appears a signal CARR for an input pulse signal in having sufficient on time Figure 9 shows waveforms at various terminals for the circuit of Figure 8. Figures 10 and 11 are circuit diagrams, respectively, for a noninverting and an inverting time delay circuit. The noninverting circuit of Figure 10 corresponds to the logic diagram of Figure 6. The inverting circuit of Figure 11 corresponds to the delay circuits of Figure 8. Similar reference numerals are used in each circuit for similar components. Q1, Q2, Q4, Q5, Q6, and C form an ECL stage similar to those shown in Figure 2A. Q7, Q9, and Q11 form a hysteresis circuit. Operation of the circuit of Figure 10 is as follows Q1 is initially on, Q2 off and the emitter of Q4 high. When input A transitions low Q2 turns on and turns Q4 off. The base of Q7 then charges toward ground at a rate determined by the current through Q5 and C. When the base of Q7 and the base of Q11 approach 0 volts difference, current flow is shifted from Q7 to Q11. Transistor Q9 provides a reference voltage for the base of Q11, and, as conduction starts, in transistor Q11 its threshold is lowered to provide a positive feedback signal to the differential input Q7, Q11. At the onset of current flow in Q11 the feedback signal shifts the threshold of this gate so that the output at the emitter of Q14 switches high to low. The input terminal at A accepts normal logic voltage swings and the output at the emitter of Q14 provides normal logic voltage swings. The internal signal at the base of Q4 is 3 2 logic swing. The logic 0 threshold at the base of Q7 is 1 logic swing and the logic 1 threshold is 1 2 logic swing. The hysteresis voltage is 1 2 logic swing and internal noise margins are 1 2 logic swing for any conditions at input terminal A. The circuit of Figure 11 functions the same as that of Figure 10 except that the output is taken from the collector of Q7 through Q15. This produces a delayed rising output. Diode connected transistor Q16 provides a level shift to drive lower level ECL inputs. Delays using these circuits have been fabricated for 20, 35, 112, and 175 nanoseconds. These delay generators have been measured to track design value within 2 over the temperature and supply environment of an IC chip. In summary, the invention provides the following features The fall time of an ECL gate stage is controlled by the value of a charging capacitor, a controlled pull down current, and the voltage over which the capacitor charges. A voltage controlled ring oscillator comprised of ECL gate stages having controlled fall times can be constructed with a wide frequency range. Such an oscillator can be interrupted, or operated in a start and stop mode, without affecting the oscillator period. A phase locked loop constructed of such ECL gate stages serves as a frequency to voltage convertor. Two such phase locked loops are utilized such that the second VCO is independently controlled in phase, but the second VCO is bounded in its frequency range by the first VCO. A Manchester data decoder using matched VCO circuits has a wide tolerance to noise and provides a clock reference signal for decoding data signals from noisy received signals. Carrier activity on a Manchester data line is detected using circuits described above. Using precision delay circuits permits descrimination between noise signals and valid signals. Precise pulse delays are obtained which are proportional to the frequency of a reference signal. A Manchester decoder clock is quickly synchronized in phase by interrupting and starting a VCO. The frequency of a reference clock signal is multiplied. Wide variation of integrated circuit parameters are tolerated.