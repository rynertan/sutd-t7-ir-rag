# METHOD AND APPARATUS FOR DIGITALLY INTEGRATING DIGITAL SIGNALS, IN PARTICULAR FOR SCINTILLATION GAMMA CAMERA

## Claims
Verfahren zur digitalen Integration sequentiell auftretender Gruppen von digitalen Signalen 220 , wobei jede Gruppe eine Mehrzahl sequentiell auftretender digitaler Signale beinhaltet, wobei das erste digitale Signal einer vorgegebenen Gruppe eine Zeitspanne nach dem ersten digitalen Signal einer Gruppe auftritt, die der vorgegebenen Gruppe unmittelbar vorhergeht, aber nicht notwendigerweise nach dem letzten Signal der unmittelbar vorhergehenden Gruppe auftritt, mit folgenden Schritten

## Description
The invention relates to a method and integrator circuit for integrating signals. In particular the invention relates to a method and integrator circuit for integrating signals derived from a radiation detector, such as a scintillation gamma camera. The US Patent 3,984,689 describes a scintillation camera for high activity sources comprising an analog integrator circuit for receiving an integrating pulses emanating from photo detectors. One integrator circuit is provided for each analog position coordinator signal and each analog energy signal. Sample and hold circuit are connected to the outputs of the integrator circuits. Input switches of the integrator circuit allow the integrator circuits to be disconnected from the photodetectors from the time said single scintillation in the crystal is detected until processing of the resulting pulses is completed. If another scintillation occurs while the integrator information from the prior scintillation is being analyzed, the second event will not change the values in the integrator circuits. The commonly owned copending patent application US A 4,486,663 entitled Dual Integrator for a Radiation Detector of Roger E. Arseneau depicts a similar analog integrator circuit for each analog signal which includes two alternatively switchable integrators. The US Patent 3,904,530 Martone et al. illustrates a scintillation camera which comprises an analog to digital converter for each position coordinate signal. However, the digitalized signals are not integrated. Integration, if any, is provided prior to digitalization. The book Tietze Schenk , Halbleiter Schaltungstechnik , pages 201 and 202, discloses a lowpass filter with a subtractor and a shift register whose input is connected to the output of the subtractor. The input signal is fed to a first input of the subtractor and the second input of the subtractor is connected to the output of the shift register. It is an object of this invention to provide an integration circuit which can selectively store and integrate at least parts of two scintillation events separately. According to this invention a method for digitally integrating sequentially occurring groups of digital signals is provided, each group including a plurality of sequentially occurring digital signals wherein the first digital signal of a given group occurs at a time after the first digital signal of the group which immediately precedes that given group but not necessarily after the last signal of said immediately preceding group, comprising the steps of Also, according to this invention an integration apparatus for digitally integrating sequentially occurring groups of digital signals is provided, each group including a plurality of sequentially occurring digital signals wherein the first digital signal of a given group occurs at a time after the first digital signal of the group which immediately precedes said given group but not necessary after the last signal of said immediately preceding group, comprising The method and integration apparatus according to this invention allow high speed digital integration and therefore are especially applicable for use in a radiation detector, such as a scintillation gamma camera. In a preferred embodiment analog signals can be digitalized by means of a high rate analog to digital converter and the digitalized signals are then integrated according to this invention. In case of a radiation detector such as a scintillation camera, the differential linearity becomes smoothed out by the analog to digital converter, since the sample rate prior to integration is much higher e.g. approximately 20 samples per event compared with the sample rate e.g. 1 sample per event after integration. The foregoing and other objects, features and advantages of the invention will be apparent from the following more particular description of a preferred embodiment of the invention, as illustrated in the accompanying drawings. In the drawings Fig. 1 illustrates in a schematic circuit a digital scintillation gamma camera which comprises an analog circuit portion 10, Fig 1A and a digital circuit portion 12 Fig. 1B . According to Fig. 1A which is very similar to Fig. 2A of the aforementioned US Patent 3,984,689 the analog circuit portion 10 comprises a number N e.g. N 19 37 of photomultiplier tubes PM 1 to PM N which are arranged in a hexagonal array behind a not shown scintillation crystal. The outputs of the photomultiplier tubes are connected in conventional manner via preamplifiers A1 and threshold amplifiers A2 with a matrix of weighting resistors e.g. only R11 through R35 are indicated for the first three photomultiplier tubes PM 1, PM 2, PM 3 . Each preamplifier A1 comprises a feedback loop with a capacitor C1 and an ohmic resistor R62, R63, R64, etc. The thresholds of the threshold amplifiers A2 can be adjusted by means of amplifier circuit A23, R46, R47, R48, R49 and dynamic threshold generator 14 which is illustrated in more detail in Fig. 11 via threshold generator output 16. An input 18 of the dynamic threshold generator 14 is connected with the output of amplifier A24 which comprises feedback resistor R52. The output signal of amplifier A24 is the total energy signal Z The total energy signal Z The output signals X, Y and Z As illustrated in Fig. 1B the position coordinate signals Y, X, and the threshold energy signal Z at the outputs 24, 26, 28 of summing amplifiers A9, A10, A11 and the energy signal E at output 20 of buffer amplifier A25 are supplied to inputs 30, 32, 34 and 36 of a first digital integrator 38, a second digital integrator 40, a third digital integrator 42 and a fourth digital integrator 44, respectively. Each digital integrator 38, 40, 42 and 44 which comprises an input analog to digital converter as will be described in more detail with respect to Fig. 2 together with an integrator control circuit 46 forms an integrator circuit. The integrator control circuit 46 is connected with each digital integrator 38, 40, 42 and 44 by means of a first output bus 48, a second output bus 50 and a third output bus 52. A first and second outputs 54, 56 for the digitally integrated position coordinate signal Y The output 94 and the further input 104 of the signal processing circuit 92 are connected via a microprocessor 106 with the front panel 108 of the scintillation gamma camera control unit not shown for communication. The outputs 96 and 98 of the signal processing unit 92 are connected via gate 110 with a digital processing and or display unit 112 and the outputs 100 and 102 are connected via a digital to analog converter 114 with an analog processing and or display unit 116. The multiplexer 86 comprises further inputs 118 to 128. The inputs 118, 120 are connected with the second and third output buses 50 and 52, respectively, of the integrator control circuit 46. The inputs 122, 124, 126 and 128 are connected with a fourth, fifth, sixth and seventh output buses 130, 132, 134 and 136 of the integrator control circuit 46, respectively. The integrator control circuit 46 also comprises inputs 138 to 144 which are connected with outputs 146 152 of a pulse pile up detector circuit 154. A first input 156 of the pulse pile up detector circuit 154 is connected via line 22 with the output of amplifier A24 Fig. 1A . This first input 156 therefore receives the total energy signal Z Fig. 2 illustrates in more detail the internal structure of the first digital integrator 38. The second, third and fourth digital integrators 40, 42 and 44 in Fig. 1B have the same structure, respectively. According to Fig. 2 the integrator 38 comprises an analog to digital converter 200. It further comprises a digital adder 202 and a digital storing device 204. The digital storing device 204 includes a first digital register 206, a second digital register 208 and a switch 210 selector switch . The digital adder 202 comprises a first digital input 212 and a second digital input 214. It further has a digital output 216. The analog to digital converter 200 includes an input 218 and an output 220. It further includes a control input 222. The first digital register 206 comprises a digital input 224, an enable input 226, and a digital output 228. In the same manner the second digital register 208 contains a digital input 230, an enable input 232 and a digital output 234. According to Fig. 2 the output 220 of the analog to digital converter 200 is connected with the first digital input 212 of the digital adder 202. The second digital input 214 of the digital adder 202 is connected with the digital output 228 of the first digital register 206 when switch 210 is in switch position I. The second digital input 214 of the digital adder 202 is connected with the digital output 234 of the second digital register 208 when the switch 210 is in position II. The digital output 216 of the digital adder 202 is connected with both the digital input 224 of the first digital register 206 and the digital input 230 of the second digital register 208. By enabling the first digital register 206 via enable input 226 and non enabling the second digital register 208 the first digital register 206 takes over digital data from digital adder 202. By enabling the second digital register 208 via enable input 232 and non enabling the first digital register 206, the second digital register 208 correspondingly takes over digital information from digital adder 202. The first and second digital registers 206 and 208 are alternatingly enabled on an event to event basis by integrator control circuit 46 via second and third output buses 50, 52 for time periods which correspond with the time periods being necessary for integrating a radiation event. For example the enabling time period for each digital register 206 or 208 is approximately 700 ns. However, in case of a pulse pile up situation an earlier switching from one register to the other one is triggered by the integrator control 46 as will be described later in more detail. The digital outputs 228 and 234 of the first and second digital registers 206 and 208 are switched simultaneously by switch 210. That means that in time periods where the first digital register 206 is enabled, the digital output 228 of the first digital register 206 is connected with the second digital input 214 of the digital adder 202. Therefore the digital output signals of enabled first digital register 206 during first register enable time period are refed via second digital input 214 to the digital adder 202 for being added to a succeeding digital signal delivered from output 220 of the analog to digital converter 200 to the digital adder 202 via first digital input 212. Correspondingly, in time periods where the second digital register 208 is enabled, the digital output 234 of this register 208 is switched to the second digital input 214 of the digital adder 202. The digital output signals of the second digital register 208 are now added in digital adder 202 to succeeding digital output signals of the analog to digital converter 200. The sample rate of the analog to digital converter 200 which is controlled by the integrator control circuit 46 via bus 48 is for example 30 MHz, i.e. approximately 21 samples for a normal unpiled event. The number of samples can be decreased for the reason of detection of a pulse pile up which will be explained later in more detail. The digital output signals of the first and second digital registers 206, 208 are also supplied to integrator outputs 54 and 56 register read out outputs and from there via multiplexer 86 to the signal processing circuit 92 for further processing. Therefore, alternatingly in time periods where one register is fed with new information from digital adder 202 the other register can be read out via its associated read out output 54 or 56. Fig. 3 depicts the signal processing circuit 92 in more detail. According to Fig. 3 the signal processing circuit 92 comprises in line with its input 90 a first in first out memory 250 FIFO which has a signal input 252 and a signal output 254. The signal output 254 of the FIFO 250 is connected with the data bus input 256 of a high speed processor 258. The data bus output 260 of the high speed processor 258 is connected with data bus input 262 of a position calculator 264, data bus input 266 of a ZLC calculator 268 and data bus input 270 of another first in first out memory 272 FIFO . The data bus output 274 of the position calculator 264 and the data bus output 276 of the ZLC calculator 268 are connected via bus 278 with the data bus input 256 of the high speed processor 258. The signal processing circuit 92 also comprises an energy window memory 280 and an auto peak control unit 282 for calibrating purposes. The energy window memory 280 has a first data bus input 284, a second data bus input 286 and a data bus output 288. The auto peak control unit 282 has a data bus input 290 and a data bus output 292. According to Fig. 3 the first data bus input 284 of the energy window memory 280 is connected with input 104 and the output 292 of the auto peak control unit 282 is connected with output 94 of the signal processing circuit 92. Input 104 of the signal processing circuit is also connected with another input 294 of the high speed processor 258. Under these circumstances the high speed processor 258, the energy window memory 280 and the auto peak control unit 282 are able to communicate with the front panel 108 via microprocessor 106. The second data input 286 of the energy window memory is connected with a further output 296 of the high speed processor 258. The data bus input 290 of the auto peak control unit 282 is also connected with still another output 298 of the high speed processor 258. Furthermore, the data bus output 288 of the window memory 280 is connected with the data bus input 256 of the high speed processor 258. The high speed processor 258 also comprises a clock output 300 with clock transmission line 302. The data bus output 304 of the FIFO 272 is connected with outputs 98 and 102 of the signal processing circuit 92. In the signal processing circuit according to Fig. 3 the FIFO 250 takes over output information from integrators 38, 40, 42 and 44 via multiplexer 86 and supplies it to the high speed processor 258 via data bus input 256. The data information leaving the high speed processor 258 at data bus output 260 is first fed to the position calculator 264 for position calculation and event correction in case of pulse pile up as will be later described in more detail in connection with Figs. 8 and 9. The data information at data bus output 274 of the position calculator 264 is refed to the data bus input 256 of the high speed processor 258. The high speed processor 258 now transfers the data information to the ZLC calculator 268 via data bus input 266 for digital energy and position coordinate linearity correction in the manner as described for example for analog processing in US Patent 4,298,944 Stoub et al. , 4,316,257 Del Medico et al. and 4,323,977 Arseneau . The way the ZLC calculator 268 works will later be illustrated in more detail in connection with Fig. 10. After data correction in the ZLC calculator 268 the corrected data is again refed from data bus output 276 of the ZLC calculator 268 to the high speed processor 258 via data bus input 256. The high speed processor 258 then supplies the data to FIFO 272 via data bus output 260. From FIFO 272 the data is then fed to outputs 98 and 102 of the signal processing circuit 92 for being transferred to the digital processing and or display unit 112 via gate 110 and the analog processing and or display unit 116 via digital to analog converter 114. During each resupply of an E energy signal data the high speed processor 258 checks whether or not the signal data lies within the energy window stored in digital numbers for energy range of the energy window memory 280. In case the signal data does not lie within the energy window the data is dumped as invalid. However, in case the signal data lies within the energy window it is further processed as a valid signal data. Fig. 4 shows a more detailed diagram of the inner structure of the integrator control circuit 46. According to Fig. 4 the integrator control circuit 46 comprises a logic start control 320 and a 120 MHz oscillator 322. The logic start control 320 has an input 324 which is connected with the input 138 of the integrator control circuit 46. The logic start control 320 also comprises a first output 326 and a second output 328. The second output 328 is connected with the output 162 of the integrator control circuit 46. The input signal at input 138 of the integrator control circuit 46 and thus also at input 324 of the logic start control 320 is an event trigger pulse ET which is generated when an occurring event exceeds a given threshold as will later be described in more detail in connection with Figs. 6 and 7. The signal at second output 328 of the logic start control 320 and therefore the signal at output 162 of the integrator control circuit 46 is a feed back pulse F generated by the logic start control 320 in response to an incoming event trigger pulse ET. The feed back pulse F holds the event trigger as will later be explained in more detail in connection with Figs. 6 and 7. The logic start control 320 also produces a start pulse ST at its first output 326. This start pulse ST is supplied to the lead input 330 of a first transparent latch 332 which together with a second transparent latch 334 and an exclusive OR gate 336 forms a phase controlled gate 338 for the output signals of the 120 MHz oscillator 322. The start pulse ST of the logic start control 320 is also fed to an enable logic circuit 340 via input 342, to the reset input 344 of a sample counter 346 and to the enable intput 348 of a first register 350 for a subphase count. The sample counter 346 comprises a counter input 352 which is connected with the counter output 354 of a down counter 356. The counter input 358 of the down counter 356 is connected with the output 360 of the exclusive OR gate 336. The down counter 356 is subdivided in a 60 MHz portion 362 and a 30 MHz portion 364. It also comprises a 120 MHz output 366, a 60 MHz output 368 and a 30 MHz output 370. All three outputs 366 370 are connected with corresponding 120 MHz, 60 MHz and 30 MHz inputs 372, 374 and 376 of the first register 350 for a subphase count. They are also connected with corresponding 120 MHz, 60 MHz and 30 MHz inputs 378, 380 and 382 of a second register 384 for the subphase count. The enable input 386 of the second register 384 for the subphase count is connected with input 140 of the integrator control circuit 46. At this input 140 a pulse pile up detection signal PP appears in a pulse pile up situation. The input 140 of the integrator control circuit 46 is also connected with an input 388 of the enable logic circuit 340. The sample counter 346 comprises a first counter output 390 and a second counter output 392. The first counter output 390 is connected with the output 164 of the integrator control circuit 46. The sample counter 346 generates an activating signal APP for pulse pile up detection as will later be more described in connection with Figs. 6 and 7. The activating signal APP is supplied from output 164 of the integrator control circuit 46 to the pulse pile up detector circuit 154. The second counter output 392 of the sample counter 346 is connected with the input 394 of a first register 396 for the sample count and with the input 398 of a second register 400 for the sample count. The first register 396 for the sample count has an enable input 402 which is connected with the first output 404 of the enable logic circuit 340. Correspondingly, the second register 400 for the sample count has an enable input 406 which is connected with a second output 408 of the enable logic circuit 340. The first output 404 of the enable logic circuit 340 is also connected with the output bus 50 of the integrator control circuit 46. Each register 396 and 400 for the sample count has also an output 410, 412, respectively. The output 410 of the first register 396 for the sample count is connected with the output bus 130 of the integrator control circuit 46. The output 412 of the second register 400 for the sample count is connected with the output bus 132 of the integrator control circuit 46. The 30 MHz output 354 of the down counter 356 is also connected with output bus 48 of the integrator control circuit 46. Furthermore, the first register 350 for the subphase count comprises an output 414 which is connected with output bus 134 of the integrator control circuit 46. Accordingly, the second register 384 for the subphase count has an output 416 which is connected with the output bus 136 of the integrator control circuit 46. The integrator control circuit 46 also comprises input 142 for a first dumping signal D1 and input 144 for a second dumping signal D2. The dumping signals D1 and D2 are supplied to a dump enable circuit for resetting the sample counter 346 and the first register 350 and the second register 384 for the subphase counts in case of the occurrence of an event which has an abnormal high level dumping signal D1 and in case of the occurrence of a pile up pulse which has a relatively low level dumping signal D2 . In Fig. 4 the first transparent latch 332 comprises a signal input 420 and a signal output 422. Accordingly, the second transparent latch 334 comprises a signal input 424 and a signal output 426. It also comprises a lead input 428. The signal inputs 420 of the first transparent latch 332 and the signal input 424 of the second transparent latch 334 are connected with the output 323 of the 120 MHz oscillator 322. The signal output 422 of the first transparent latch 332 is connected with a first input 430 of the exclusive OR gate 336. Accordingly, the signal output 426 of the second transparent latch is connected with a second input 432 of the exclusive OR gate 336. The operation of the integrator control circuit 46 according to Fig. 4 is as follows The phase controlled gate 338 works such that the signal at output 422 of the first transparent latch 332 is always opposite to the signal at output 426 of the second transparent latch 334. When a start pulse ST in response to an event trigger pulse ET appears at lead input 330 of the first transparent latch 332 the phase controlled gate 338 becomes conductive for output signals of the 120 MHz oscillator 322 such that the next phase change of the 120 MHz oscillator 322 will cause a positive edge at output 360 of the exclusive OR gate 336 independent on the oscillator pulse polarity. This means the down counter 356 always starts under the same initial conditions at the occurrence of an event trigger pulse ET. The time information of the initial condition is memorized in the first register 350 for the subphase count which has been enabled at enable input 348 by means of the start pulse ST of the logic start control 320. The 30 MHz output signal at output 354 of the down counter 356 is transferred via output bus 48 of the integrator control circuit 46 to the analog to digital converters 200 in the digital integrators 38 44. This causes each analog to digital converter 200 to sample the incoming event at a 30 MHz rate which means about 21 samples per event as mentioned before. The 30 MHz output signals of down counter 356 are also supplied to sample counter 346 via counter input 352. After a certain number of counts, for example 10 counts, the sample counter 346 generates an activating signal APP for pulse pile up detection at its first counter output 390. The pulse pile up detector circuit 154 is now enabled for detecting a pulse pile up situation, if there succeeds any. The start pulse ST of the logic start control 320 resets the sample counter 346 via reset input 344 always at the occurrence of an event trigger pulse ET. At the same time the start pulse ST triggers the enable logic circuit 340 via input 342 to generate an enabling signal at output 404 or 408. For example, a first start pulse ST at the occurrence of a first event trigger pulse ET triggers the enable logic circuit 340 to produce an enable signal at the first output 404, the second start pulse ST at the occurrence of a second event trigger pulse ET triggers the enable logic circuit 340 to generate an enable signal at second output 408 a third start pulse ST at the occurrence of a third event trigger pulse ET triggers the enable logic circuit 340 to generate an enable signal again at first output 404, etc. According to alternatingly generating enable signals at first and second outputs 404 and 408 the first and second registers 206 and 208 in each digital integrator 38 44 are alternatingly enabled via output buses 50 and 52 and enable inputs 226 and 232, as previously described. Correspondingly, switch 210 in each digital integrator 38 to 44 is alternatingly switched from position I to position II. The enable signals at outputs 404 and 408 of the enable logic circuit 340 also enable the first and second registers 396, 400 for the sample count via enable inputs 402 and 406 to alternatingly take over count information from sample counter 346 via inputs 394 and 398. For example, for the first event the first register 396, for the second event the second register 400, for a third event again the first register 396 etc., takes over the count information from sample counter 346. The contents of registers 396 and 400 can be read out alternatingly on demand of FIFO 250 in the signal processing circuit 92 via output buses 130 and 132 of the integrator control circuit 46 and multiplexer 86. The enable logic circuit 340 works on an event to event basis in 700 ns time periods time which is approximately needed for the integration of one event as long as their does not occur a pulse pile up situation. In case a second event is piled up on a first event in a pulse pile up situation succeeding a pulse pile up detection activating signal APP at output 164 of the integrator control circuit 46, a pulse pile up detection signal PP is supplied to input 140 of the integrator control circuit 46. The pulse pile up detection signal PP triggers the enable logic circuit 340 via input 388 to change the enable signal output situation. For example, when at the occurrence of the pulse pile up detection signal PP an enable signal has been generated at the first output 404 of the enable logic circuit 340 the enable logic circuit 340 now switches from the first output 404 to the second output 408 to generate an enable signal at the second output 408 instead of the first output 404. Accordingly, the first register 206 in each digital integrator 38 to 44 becomes disabled and instead the second register 208 becomes enabled. Also switch 210 in each digital integrator is switched from position I to position II. The digital output signals of the adder 202 are now supplied to the second register 208 and the output signals of the second register 208 are resupplied via switch 210 to the second digital input 214 of adder 202 for integration. Simultaneously with the enable logic circuit 340 the pulse pile up detection signal PP also enables the second register 384 for the subphase count via enable input 386 to memorize the output status of down counter 356 at outputs 366, 368 and 370 at the time of the occurrence of the pulse pile up detection signal APP. In case the pile up event remains on a low amplitude level a dumping signal D2 is generated at input 144 of integrator control circuit 46 and the sample counter 346 and the second register 384 for the subphase count are reset to dump the piled up second invalid event. The preceeding valid event, however, continues to be processed in normal manner in the position calculator 264 of the signal processing circuit 92. Under the circumstances described above, in an unpiled situation the first register 206 of each digital integrator 38, 40, 42 and 44 stores the information Y In a pulse pile up situation the second register 384 for the subphase count memorizes the time of the occurrence of a pulse pile up detection signal PP. Therefore, the output signal at output 416 of the second register 384 for the subphase count includes time information for the exact starting time of a second event piled up on a first event. In the pulse pile up situation the status of registers 206, 208, 396 and 400 has been changed by means of enable logic circuit 340 at the occurrence of the pulse pile up detection signal PP as described above. The information stored in the first registers 206 of the digital integrators 38, 40, 42 and 44 corresponds with the information Y The pulse pile up situation as previously described is illustrated in more detail in Fig. 5. Fig. 5 shows in a diagram the shape of radiation events P dependent upon time t. A first event P₁ is succeeded by a piled up second event P₂. The noise threshold is indicated with TH. An event trigger pulse ET is generated at time τ₁ and a pulse pile up detection signal PP is generated at time τ₂. The time τ₁ is memorized in the first register 350 for the subphase count of the integrator control circuit 46. The time τ₂ is memorized in the second register 386 for the subphase count of the integrator control circuit 46. As described above, the signals Y As indicated in Fig. 5 each event is subdivided in 21 samples S1 to S21. In case of first event P₁ the last sample prior to the occurrence of a pulse pile up detection signal PP at time τ₂ is the sample which is designated with the number S12. This number is stored in the first register 396 for the sample count of the integrator control circuit 46. The thirteenth sample S13 is the first sample of the piled up event P₂ including the tail T of the first event P₁. The Y and of the first event P₁ by means of the position calculator 264. However, the information with respect to energy signal E Piled up event P₂ can be corrected correspondingly. The samples of tail T which are added to E For each event P the position coordinate signals X Fig. 6 shows a more detailed circuit diagram of the inner structure of the pulse pile up detector circuit 154 in Fig. 1B. According to Fig. 6 the pulse pile up detector circuit 154 comprises an event detector 450, a pulse pile up detector 452, a high level detector 454 and a pulse pile up low level detector 456. A still more detailed circuit diagram of the inner structure of the pulse pile up detector circuit 154 according to Fig. 6 is illustrated in Fig. 7. According to Fig. 7 the signal Z The signal Z Finally, the signal Z Referring now to Fig. 8, this figure shows a more detailed circuit diagram of the position calculator 264 in Fig. 3. The input lines 530, 532 and 534 form together the data bus input 262 of the position calculator 264. Correspondingly the output lines 536, 538 and 540 form the data bus output 274 of the position calculator 264. The input line 530 is connected with the input 542 of a first latch 544. The input line 532 is connected with the input 546 of a second latch 548. The input line 534 is connected with a first input 550 of a multiplexer 552 which has a second input 554 which is connected with the input line 530. The output 556 of the multiplexer is connected with the input 558 of a third latch 560. The first, second and third latches 544, 548 and 560 have each an output 562, 564 and 566, respectively. Output 562 of the first latch 544 is connected with the first input 568 of a first multiplier 570. The output 564 of the second latch 548 is connected with a first input 572 of a second multiplier 574. The output 566 of the third latch 560 is connected with the input 576 of a first ROM 578, with the input 580 of a gate 582 and with the input 584 of a second ROM 586. The first multiplier 570 comprises a second input 588 which is cnnnected with the output 590 of a decoder 592. Also the second multiplier 574 comprises a second input 594 which is connected with the output 590 of the decoder 592. The decoder 592 comprises a first, second, third and fourth inputs 596, 598, 600 and 602. The first input 596 is connected with the output 604 of gate 582. The second input 598 is connected with a first output 606 of the second ROM 586. The third input 600 of the decoder 592 is connected with a second output 608 of the second ROM 586. The fourth input 602 is finally connected with the output 610 of the first ROM 578. The output 612 of the first multiplier 570 is connected with the input 614 of a first output gate 616. Correspondingly, the output 618 of the second multiplier 574 is connected with the input 620 of a second output gate 622 and with the input 624 of a third output gate 626. The first output gate 616 comprises an output 628 which is connected with output line 536 of the position calculator 264. Correspondingly, the second output gate 622 comprises an output 630 which is connected with output line 538 and the third gate 626 comprises an output 632 which is connected with output line 540 of the position calculator 264. The operation of the position calculator 264 according to Fig. 8 is in light of the diagram of Fig. 9 as follows is formed from the signal Z is delivered via decoder 592 to second input 588 of the first multiplier 570 and to the second input 594 of the second multiplier 574. The signal Y The first multiplier 570 multiplies the signal Y of first ROM 578. Correspondingly, the second multiplier 574 multiplies the signal X The output signal of the first multiplier 570 is delivered via first gate 616 to output line 536 of the position calculator 264. Correspondingly, the output signal of the second multiplier 574 is supplied via second gate 622 to output line 538 of the position calculator 264. In a second processing cycle CY2 for the first event P₁ the signals τ₁, N₁ and N The signal Z For the piled up second event P₂, which starts at time τ₂, the position coordinate signals and are calculated again in a first cycle CY1 in the same manner as described above for X All output signals on output lines 536, 538 and 540 are refed from data bus output 274 of the position calculator 264 to the data bus input 256 of the high speed processor 258. The high speed processor 258 then feeds signals Y A more detailed circuit diagram of the ZLC calculator 268 is illustrated in Fig. 10. According to Fig. 10 the input lines 650, 652 and 654 form together the data bus input 266 of the ZLC calculator 268. Accordingly, the output lines 656, 658 and 660 form the data bus output 276 of the ZLC calculator 268. The first input line 250 is fed with the signal Y After passing an input latch 662 the signals Y The signals Y The signal E An LC gate for scale factors is generally designated with 696. All elements 690 to 696 are connected with output lines 656, 658 and 660 of the ZLC calculator 268 by means of a first multiplier 698, a second multiplier 700, a first and second LC latches 702 and 704, a first and second LC gates 706 and 708, a Z map gate 710 and the first, second and a third gates 670, 672 and 712 in the manner as illustrated in Fig. 10. The LC gate 690 allows E The LCLY gate 684 and the LCLX gate 686 transfer the signals Y All corrections are digitally executed according to the same algorithms as described in US Patents 4,298,944 Stoub et al. , 4,316,257 DelMedico et al. and 4,323,977 Arseneau for the correction of analog signals. The energy E Fig. 11 finally illustrates a more detailed circuit diagram of the inner structure of the dynamic threshold generator in Fig. 1A.