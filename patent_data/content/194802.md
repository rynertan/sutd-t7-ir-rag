# APPARATUS FOR GENERATING A HEADING SIGNAL FOR A LAND VEHICLE

## Claims
Vorrichtung 10 zur Erzeugung von Daten zur Ausrichtung eines Landfahrzeuges mit

## Description
The present invention relates generally to an apparatus for providing accurate information regarding the heading of a land vehicle. A variety of automatic vehicle navigation systems has been developed and used to provide information about the actual location of the vehicle as it moves over streets. For example, one general approach to such vehicle navigation systems is known as dead reckoning , in which the vehicle is tracked by advancing a dead reckoned position from measured distances traveled and headings of the vehicle. Central to all of the dead reckoning navigation systems for vehicles is the need to generate data regarding the heading of the vehicle as it travels through constantly changing conditions. Any error in the heading information generated by the system translates directly into an error in the positioning of the vehicle for dead reckoning type systems. Some prior art systems employ an absolute heading sensor, such as a magnetic compass or gyrocompass, to generate data regarding the heading of the vehicle. Gyrocompasses are expensive, and inappropriate for use in vehicles, such as automobiles or other land vehicles, that rapidly maneuver. Magnetic compasses also do not work ideally for land vehicles because for instance, the streets may be surrounded with large steel structures which cause anomalies in the magnetic field of the earth around the structures which will in turn deflect a magnetic compass reading as the vehicle drives past. Further, the roads may be banked, inclined, or crowned and thereby cause other errors, such as magnetic dip error, which are reflected in the signals generated by the sensor. If the magnetic compass is gymballed, accelerations of the vehicle affect the alignment of the compass and thereby create apparent magnetic dip error. Another type of direction sensor measures relative heading. Examples include directional gyro compass, gas turning rate sensor, laser ring gyro compass, vibrating rod turning rate sensor, and differential odometer. This sort of sensor measures turning rate from which the relative heading of the vehicle is calculated at a given time given the heading at a prior time. Relative heading sensors are likewise subject to a variety of errors caused by temperature, component drifts, and component offsets. Differential odometers are subject to errors due to characteristics of the streets, the wheels of the vehicle or the vehicle itself, such as crowning of the roads, bumpy roads, uneven ride of the wheels over the streets, misalignment of the wheels, and so on. For these and other reasons, the accuracy of this sort of sensor is difficult to maintain. For any given type of heading sensor, the sources of errors in the signal generated are for a large part external to the sensor itself, so calibration of the sensor cannot compensate for some sources of heading inaccuracy in land vehicles. Because all heading sensors are subject to errors caused by some combination of the conditions of the vehicle, of the sensor and of the streets or terrain over which the vehicle travels, prior art navigation systems have been unable to generate accurate data regarding the heading of a land vehicle. Accordingly, there is a need for an apparatus for generating accurate data regarding the heading of a land vehicle as it travels through constantly changing conditions, such as when the land vehicle travels over varied surfaces and through varying environments. US A 4032758 discloses a compensated vehicle heading system. In this system, heading information is provided by a magnetic sensor and movement sensors. Data from the movement sensors is combined and compared with data from the magnetic sensor to produce the heading data. US A 4351027, US A 3749893 and GB A 2144007 all describe the use of filters for navigation apparatus. The present invention relates to an apparatus for generating data regarding a heading of a land vehicle which comprises, as is known per se, a plurality of sensor means for generating a plurality of independent direction signals including heading information indicating a heading of the land vehicle, wherein the direction signals include errors, and processing means responsive to said plurality of independent direction signals for generating an estimated heading of the land vehicle. In accordance with the invention the processing means including filter means responsive to a filter control signal for reducing the effects of said errors and means for generating the filter control signal in response to a parameter indicating an estimated error magnitude of at least one of the directional signals. The plurality of independent direction signals respectively typically include errors having essentially independent spectral characteristics. In other words, the errors suffered by each of the plurality of sensor means are reflected in the independent direction signals with frequency characteristics that are different from the frequency characteristics suffered by others of the independent direction signals. In one embodiment, the controlled filter means selectively filters at least one of the plurality of independent direction signals according to the spectral characteristics of the errors included in said at least one directional signal. Thereby the heading information from this directional signal is recovered essentially error free. In another embodiment, the plurality of independent direction signals include at least a first direction signal including errors having primarily first spectral characteristics and a second direction signal including errors having primarily second spectral characteristics that are different from the first spectral characteristics. In this embodiment, the processing means includes a first means for combining the first direction signal and the second directional signal to generate a combined error signal isolating the first and second errors from the heading information. This combined error signal is used as the filter control signal so that the filter means filters the combined error signal according to the first spectral characteristics to generate a filtered error signal which includes essentially the second errors only. The filtered error signal and the second direction signal can then be supplied to a second combining means in which the second errors are offset by the filtered error signal, thereby providing an improved estimate of the heading information. In another aspect, the vehicle navigation system can include a storage means for storing a map data base which includes data regarding the heading of streets within the map. The vehicle navigation system provides a means for recognizing that the vehicle is on a particular street and for generating a signal regarding the heading of a vehicle recognized to be on the particular street. Provided in this aspect of the invention is a means, responsive to a control signal, for selecting between the heading data supplied from the map data base and the heading data generated by one of the heading sensors. The sensor means may comprise a first sensor means for generating a relative direction signal having a heading component indicating a heading direction for the land vehicle relative to a prior heading of the land vehicle and a first error component and second sensor means for generating an absolute direction signal having a heading component indicating a heading direction for the land vehicle relative to the earth and a second error component. In this case the processing means may be in communication with the first means and the second means, and includes means for assigning weights to the relative direction signal and the absolute direction signal and there is further provided means for combining the relative direction signal and the absolute direction signal according to the assigned weights, and means for supplying the parameter in response to an estimated magnitude of the error component of one of said absolute direction signal or relative direction signal. Further features of the invention are defined in the dependent claims. Embodiments of the invention will now be described by way of example with reference to the following description and drawings. Fig. 1 is a system overview block diagram of the present invention. Figs. 1A 1C illustrate various embodiments of the present invention. Fig. 2 is a block diagram of a preferred embodiment of the present invention. Figs. 3A 3E are graphs of signals used in describing the apparatus of Fig. 1. Fig. 4 is a block diagram of a filter control means used in conjunction with the apparatus shown in Fig. 2. Fig. 5 is a block diagram of a selector control means used in conjunction with the apparatus of Fig. 2. Fig. 6 is a chart used for illustrating the map data base. Fig. 7 is a flowchart showing a subroutine for determining whether the vehicle is traveling parallel to a particular street in the map data base. Figs. 8 and 8A 8H are flowcharts illustrating a method according to the present invention. With reference to the figures, a system overview of the present invention is provided, followed by a discussion of the basic theory of operation and a description of a preferred embodiment. The components of an apparatus 10 according to the present invention can be seen in the system overview shown in Fig. 1. The apparatus 10 of the present invention includes a plurality 5 of sensor means including at least a first sensor means 11 for generating a first direction signal including heading information on line 12 and a second sensor means 13 generating a second direction signal including heading information on line 14 that is independent of the first direction signal. The first and second direction signals include first and second errors in addition to the heading information. The first errors have first spectral characteristics. The second errors in the second direction signal have second spectral characteristics which are different from the first spectral characteristics. The second direction signal on line 14 and the first direction signal on line 12 are connected to a first combining means 15 for combining the first direction signal and the second direction signal to generate a combined error signal on line 16. The combined error signal is the difference between the first direction signal and the second direction signal so that the heading information is cancelled from the combined error signal. The combined error signal from the first combining means 15, termed DELTA, is provided over line 16 to a filter means 17 for filtering the DELTA signal according to the second spectral characteristics. The output of the filter means 17 is a filtered error signal F DELTA on line 18 from which the second errors have been essentially filtered out, leaving the first errors. The first direction signal on line 12 and F DELTA on line 18 provided as inputs to a second combining means 19. The second combining means 19 combines the F DELTA signal and the first direction signal essentially offsetting the first errors to generate an improved estimated heading EH on line 20 estimating the heading of the land vehicle on which the apparatus 10 is mounted. In sum, the apparatus 10 shown in Fig. 1 includes at least a first sensor means 11, a second sensor means 13 and a processor means 21, responsive to the first direction signal generated by the first sensor means 11 and the second direction signal generated by the second sensor means 13, for generating data on line 20 regarding an estimated heading EH of the vehicle. The present invention is described in terms of the spectral characteristics of the errors in the direction signal. The spectral characteristics of the errors in a particular direction signal are determined in part by the type of direction sensor which generates the signal. In a preferred embodiment of the present invention as described below, the first sensor means is implemented with a relative direction sensor such as a differential odometer, which generates a relative direction signal RDS, while the second sensor means is implemented with an absolute direction sensor, such as a compass, which generates an absolute direction signal ADS. As mentioned earlier, an absolute direction sensor such as a magnetic compass is subject to magnetic anomalies, which create short term errors. More precisely, these anomalies create errors in the ADS for distances relatively close to the location of the anomaly. Thus, as the vehicle passes by the anomaly, the effect is seen for only a small distance. Because distance and time are directly related In contrast the primary errors of the RDS are relatively long term i.e., long distance and thus are confined to the relatively low end of the heading signal spectrum, that is they have relatively low frequency components. Lastly, we can think of the actual heading information itself as having, at one time or another, spectral characteristics having all frequency components in the heading signal spectrum. For example, while turning a sharp corner the actual heading changes rapidly over a relatively short distance and time giving high frequency components. When driving down a long straight road the actual heading changes only slightly, giving rise to very low frequency components. In general, the frequency components of the heading will vary over a wide spectrum, depending upon the velocity and route. Because the actual heading varies over a wide spectrum, simple frequency filtering of either the ADS signal or the RDS signal is not adequate because it will, at times, filter the actual heading signal as well as the error signal. The preferred embodiment of the present invention first subtracts one direction signal from the other, thereby eliminating the actual heading information and generating the combined error signal DELTA including the errors from both signals. Because the errors from the two sensors are independent, on average, nothing else is cancelled and the remaining signal DELTA represents all errors. We can now pass this combined error signal DELTA through a frequency selective filter which is tuned to eliminate the high frequency error components, that is errors having the spectral characteristics of the error in the ADS. This has the effect of eliminating the high frequency errors of the ADS. Ideally, the signal F DELTA remaining after filtering line 18, Fig. 1 contains only the lower frequency errors of the RDS essentially unaltered. This signal is recombined with the RDS signal to cancel these lower frequency errors, ideally leaving only the actual heading information as a more accurate heading estimate EH at the output. The present invention is further improved as described below by estimating the relative size of the errors in the ADS and RDS. At different times one or the other sensors may indicate a higher relative level of error. When this happens, the filter is adjusted to eliminate more of the errors from the sensor generating the higher level of error. In general, the estimated heading EH is not precisely equal to the vehicles actual heading because the combining and filtering processes are not ideal and the spectral properties of both sensors are not totally separated. However, the present invention provides a substantially better estimated heading EH, over more driving conditions and environments, than can be obtained from either heading sensor individually. The present invention can be further illustrated in terms of a simplified mathematical model. The first sensor means 11 generates, for example, a relative direction signal RDS which indicates the heading of the vehicle relative to a prior heading of the vehicle. Since the first sensor means 11 generates a relative direction signal RDS, a random start heading of the vehicle will be reflected in the output from the first sensor means 11 by an offset from the heading of the vehicle relative to the earth by a random value. Also, tire slip and imprecise calibration will cause additional errors. These errors are accumulated in the RDS signal, that is, every error reflected in a prior output of sensor means 11 is contained in the current output of the first sensor means 11 for the present heading. Thus, a simplified, representation of the relative direction signal RDS is given by the following equation A second sensor means 13 generates, for example, an absolute direction signal ADS which indicates the heading of the vehicle relative to the earth. In the preferred embodiment, the second sensor means 13 detects the direction of the magnetic field of the earth and calculates the heading of the vehicle relative to the direction of the magnetic field of the earth. The difference between magnetic heading and true heading, called variation, can be easily corrected by a lookup table or otherwise and has not been included here to simplify the discussion. A major source of error in the output of the second sensor means 13 resides in magnetic anomalies, such as changes in the magnetic field of the earth caused by changing conditions surrounding the second sensor means 13 as the vehicle travels across varying terrain or streets. Thus, the output of the second sensor means 13, the absolute direction signal ADS can be represented in simplified form as follows The means 21 for combining the relative direction signal RDS and the absolute direction signal ADS reduces the effects of errors A in the absolute direction signal ADS and errors D and R in the relative direction signal RDS thereby generating an improved estimate of the heading of the vehicle EH on line 20. Thus the first combining means 15 subtracts the relative direction signal RDS from the absolute direction signal ADS to generate the combined error signal, DELTA It should be mentioned that the above illustration is only an approximation of the actual process and hence the output is not exact. Errors such as measurement noise, imperfect filtering and overlap in the spectrum of A and the other error signals R, D, cause the estimate to be non exact. The embodiment of the present invention shown in Fig. 1 can be extended to a plurality of sensors as described with the aid of Figs. 1A, 1B and 1C. Fig. 1A shows the apparatus 10 of Fig. 1 redrawn according to standard linear systems notation see, for example, Equation 6 can be rewritten as equation 7 as follows Equation 7 can be represented as equation 8 as follows Thus Fig. 1A can be redrawn as shown in Fig. 1B. In this manner F₁ s is equal to a filter equation adapted to filter the errors having spectral characteristics that are likely to occur in the relative direction signal. Likewise, F₂ s corresponds to the filter equation defining filter characteristics corresponding to spectral characteristics of errors likely to occur in the absolute direction signal. Thus according to the embodiment shown in Fig. 1B, each direction signal is separately filtered and the filtered outputs are combined to obtain the estimated heading EH s , with the constraint on the filters that F₁ and F₂ when added equal 1 for the entire range of frequency s that is relevant to the heading calculation. Further expanding from the embodiment of Fig. 1B and equation 8 , Fig. 1C shows an embodiment of the invention using a plurality of sensors to generate a plurality of direction signals X₁ s , X₂ s , . . . X In the preferred embodiment, where X Fig. 2 shows a block diagram of a preferred embodiment of the invention as implemented on a vehicle for traveling over land and used in conjunction with a vehicle navigation system. The reference numbers used in Fig. 1 are used in Fig. 2 where appropriate for consistency. Figs. 3A through 3E are used to illustrate the operation of the apparatus 10 of Fig. 2 by way of example. Fig. 3A shows a sample of the absolute direction signal ADS generated, for instance, by magnetic flux gate compass mounted on the vehicle. Fig. 3B illustrates a relative direction signal RDS generated for instance by a differential odometer on the vehicle. Fig. 3C illustrates the DELTA signal generated at the output of the first combining means 15. Fig. 3D illustrates the F DELTA signal generated at the output of the filter means 17. Fig. 3E illustrates the resulting estimated heading EH of the vehicle across the course for the example superimposed on the actual course H for the example. The apparatus 10 as shown in Fig. 2 includes the first sensor means 11, the second sensor means 13, and the processor means 21 including the first combining means 15, the filter means 17, and the second combining means 19. The first sensor means 11 is implemented using a differential odometer 22. The differential odometer 22 is a means for generating a relative direction signal RDS on line 12 by comparing the difference in distance traveled by wheels on the opposite sides of an axle of the vehicle as mentioned above. The second sensor means 13 is implemented with a compass means 23 for generating an absolute direction signal ADS, such as a magnetic flux gate compass described in prior U.S. Patent Application Serial No. 675,827 entitled FLUX GATE SENSOR invented by Alan C. Phillips and owned by an assignee in common with the present application. The compass means 23 generates a signal on line 28 indicating the heading of the vehicle relative to the magnetic field of the earth. The output of the compass means 23 includes a magnitude component M indicating the magnitude of the magnetic field surrounding the compass means 23 and a directional component ϑ indicating the angle of the heading of the vehicle relative to the magnetic field. The actual compass outputs X and Y are given by equations 10 and 11 In normal operation and for the purposes of the description of the apparatus 10 as depicted in Fig. 2, it can be assumed that the selector means 24 selects the heading component ϑ from the compass means 23 as the absolute direction signal ADS for line 14. The generation of the ADS control signal on line 26 and the selection of the two inputs is described in more detail below with reference to Fig. 5. As mentioned above, the operation of the apparatus 10 of Fig. 2 can be described with reference to the signal graphs of Figs. 3A 3E. Beginning with Fig. 3E, line H shows the actual heading of the vehicle for the example. Thus, the vehicle in our example begins at a heading of about 45 north of east along the segment 101. Then as illustrated by segment 102, the vehicle makes a 45 turn toward the east. For purposes of illustration, the turns are considered as instantaneous. The vehicle then travels straight as illustrated in segment 103 until making an approximately 120 turn as illustrated in segment 104. The vehicle then proceeds straight at its resultant heading of about 30 west of north to the end of the example along segment 105. Fig. 3A shows an example of the absolute direction signal ADS as the heading component ϑ magnetic flux gate compass 23. The signal generated by the magnetic flux gate compass 23 tracks the actual heading H. It can be seen that errors 106 may occur, due to anomalies such as magnetic dip error, that are reflected in the signal generated by the magnetic flux gate compass 23. Also as the chart of Fig. 3A shows magnetic anomalies due to steel structures or the like can cause the flux gate compass to generate a spike 107 wherein the signal indicates a large deviation, shown as an approximately 360 turn in the ADS. Fig. 3B shows a simplified example of the RDS generated by the differential odometer 22. The starting heading 109 is a random value as discussed above and is not likely to be the vehicle heading. The signal illustrates sensor drift, reflected in the slope of the relative direction signal. The turns taken by the vehicle are well delineated at segments 110 and 111. However, due to an error caused by, for example, wheel slip, the turn, 111, as indicated by the relative direction signal RDS appears to be slightly less than the full 120 shown in segment 104. Also, it can be seen in Fig. 3B that the slope in the final segment 112 is slightly greater than the slope of the earlier segments of the figure, illustrating that the drift error may not accumulate at a constant rate in the relative direction signal. Fig. 3C shows the DELTA signal generated by subtracting the absolute direction signal of Fig. 3A from the relative direction signal of Fig. 3B. The magnetic anomalies, 106 and 107, are clearly reflected in the DELTA signal. Also, the drift, wheel slip and random start heading are reflected in the DELTA signal. It can be seen at the final segment, 113, shows the increased slope of the drift illustrated by segment 112 in Fig. 3B. Also a slight offset 114 due to wheel slip can be seen in the DELTA signal. By subtracting RDS from ADS we have cancelled the sometimes rapidly varying heading information. As discussed above, the higher frequency anomalies from the DELTA signal on line 16 can now be filtered by filter means 17 without affecting the heading information H to generate an F DELTA signal as illustrated in Fig. 3D. The F DELTA signal from line 18 shown in Fig. 3D is similar to the DELTA signal of Fig. 3C with a few exceptions. Most noticeable is the reduction of the spike 107. Less noticeable is the slighter reductions of the magnetic dip error anomaly 106 and the wheel slip 114. The slope of the drift is preserved although a slight slope dependent shift is introduced by the filter from points 115 to 116. The F DELTA signal is then added to the relative direction signal by the second combining means 19, and the output is the estimated heading EH, plus magnetic variation, as illustrated in Fig. 3E superimposed on the actual heading H. The estimated heading H is not subject to the majority of the anomalies which are reflected in the absolute direction signal and the relative direction signal. The characteristics of the filter means 17 determine the relative characteristics of the apparatus 10 in eliminating errors in the ADS and RDS signals. Accordingly, the setting of the characteristics of the filter means 17 directly translates into the responsiveness of the apparatus 10 to generate accurate data regarding the estimated heading of the vehicle. In the preferred embodiment, the filter means 17 operates by periodically sampling the DELTA signal from line 16 of the first combining means 15 over periods of distance traveled and filtering the DELTA signal to generate F DELTA according to the following filter equation 13 where F DELTA Thus the filter means 17 behaves according to the filter constant T In the preferred embodiment, the filter means 17 responds to a filter control signal on line 27 to vary the characteristics of the filter means 17, such as by varying the filter constant T Fig. 4 illustrates a filter control means 30 for generating the filter control signal on line 27. The filter control means 30 is responsive to multiple parameters FP1, FP2, FP3, FP4, and so on through FPN. The filter parameters are generated from the relative direction signal, the absolute direction signal, comparisons between the absolute direction signal and the relative direction signal, the map data base, the measured magnitude of the magnetic field and comparisons between magnetic field strengths and other sources of data. The filter control signal on line 27 operates to vary the filter constant T For a filter means 17 implemented according to equation 13 set out above, as the filter constant T The first filter parameter FP1, which is input to the filter control means 30, is generated by subtracting the relative direction signal RDS on line 12 from the absolute direction signal ADS from the compass means 23 on line 28 ADS RDS . Then, a standard deviation SDD of ADS RDS weighted as a function of distance is determined. If the distance weighted standard deviation SDD is large, then the differential odometer 22 and or the compass means 23 are generating erroneous signals. When the compass means 23 and or the differential odometer 22 are generating erroneous signals as indicated by the first filter parameter FP1, then the filter control means 30 determines, based upon the other filter parameters, whether to increase or decrease the filter constant T A means 31 for generating the first filter parameter FP1 is implemented in the preferred embodiment by software control of a computer not shown . By way of example, the means 31 generates the first filter parameter FP1 by sampling ADS RDS once every second for each second that the vehicle has travelled 4.57 metres fifteen feet or more. The standard deviation SDD is calculated by taking the three most recent readings R1 R3 and calculating the current standard deviation SD where T time constant for decay of SDD. In this manner, the standard deviation of ADS RDS is weighted to reflect more strongly deviations in the data collected at the closest segment of distance travelled and responds quickly to sudden increase. The second filter parameter FP2 is generated by means 32 for generating a signal indicating unusual deviations in the magnitude of the magnetic field of the earth as detected by the compass means 23. The second filter parameter FP2 is generated by comparing the measured magnitude of the magnetic field of the earth from the output of the compass means 23 against the expected magnitude of the magnetic field of the earth corrected for any significant vertical dip angle L at the location of the vehicle . When the difference between the expected magnitude and the measured magnitude is large, then the output of the compass means can be expected to be unreliable. Thus, when the means 32 generates a filter parameter FP2 indicating that the measured magnitude of the magnetic field of the earth differs from the expected magnitude and filter parameter one FP1 is set, then the filter control means 31 signals the filter means 17 to decrease the filter constant T In the preferred embodiment, the means 32 is implemented by software control of a computer. The values for the expected magnitude of the magnetic field of the earth are stored in the computer during the calibration of the compass means 23. For example, the data may be generated by orienting the compass means 23 in a number of known headings and measuring the magnitude of the earth s field for each of those known headings. That measured magnitude for the known headings is stored in the computer. When the vehicle travels across terrain which cause anomalies in the magnetic field of the earth, then the difference between the expected magnitude of the magnetic field of the earth generated during calibration of the compass means 23 and the measured magnitude will indicate the presence of many of those anomalies. The third filter parameter FP3 is generated in means 33 for indicating the accuracy of the compass means 23. For instance, the means 33 could be implemented using a map data base discussed in more detail below which sets a particular bit for areas on the map in which the output of the compass means 23 is expected to be subject to anomalies. The third filter parameter FP3 indicates that the filter constant T The fourth filter parameter FP4 is generated by means 34 for indicating the accuracy of the differential odometer 22, or the first sensor means 11, generating the relative direction signal. For instance, the means 34 as implemented with a differential odometer 22 includes means for detecting the turn radius and the centrifugal force on the vehicle. These data regarding the turn radius and centrifugal force on the vehicle around the turn correlates with inaccuracies in the differential odometer 22 which depend on the suspension geometry of the vehicle and other factors specific to the particular embodiment of the differential odometer. The coefficients used in FP4 may be derived from both data entered regarding vehicle specifications and calibrations of the relative direction sensor on a specific vehicle by measurement. Additional parameters, such as is indicated by the nth filter parameter FPN in Fig. 4, could be implemented depending on the particular embodiments of the direction sensors used. In the preferred embodiment, the filter control means responds to the multiple parameters to generate a signal on line 27 which controls the filter constant T Various interrelationships between the multiple parameters input to the filter control means 30 are determined by the particular embodiment chosen and implemented by programming the computer to recognize these inter relationships. Thus for a given plurality of sensor means, the filter means 17 is controllable to adapt to the spectral characteristics of errors reflected in the direction signals generated by those sensor means. As mentioned above, the apparatus 10 shown in Fig. 2 of the preferred embodiment is implemented on a land vehicle having a vehicle navigation system. The vehicle navigation system includes the map data base 25 having directional data regarding the heading of a vehicle known to be traveling on a particular street. The preferred embodiment of the vehicle navigation system is disclosed in detail in the prior U.S. Patent Application entitled VEHICLE NAVIGATION SYSTEM AND METHOD , Serial No. 618 041 Filing Date 06 07 84, owned by an Assignee in common with the present application, which has an equivalent EP A 0166547. The disclosure of the application Serial No. 618,041 including the drawings, specification and claims is incorporated by reference as if fully set forth herein for the purpose of disclosing one preferred embodiment of the vehicle navigation system with which the apparatus 10 is used. For an apparatus 10 according to the present invention used in conjunction with a vehicle navigation system, the invention provides the selector means 24 as discussed above for selecting between the map data base heading data and the second sensor means heading data for the ADS signal. The map data base 25 is now discussed. The vehicle navigation system provides the map storage means 25 shown in Fig. 2 including a map data base as disclosed in application Serial No. 618,041. This map data base includes data identifying 1 a set of line segments S defining the set of streets St, 2 street widths, 3 vertical slopes of the line segments S, 4 magnetic variation of the geographical area identified by the map, 5 map accuracy estimates, and 6 street names and street addresses. Fig. 6 is used to explain the street segment data stored on map storage means 25 that identify a set of line segments S defining the set of streets St. Each such street St is stored on the storage means 25 as an algebraic representation of the street St. Generally, each street St is stored as one or more arc segments, or, more particularly, as one or more straight line segments S. As shown in Fig. 6, each line segment S has two end points EP₁ and EP₂ which are defined by coordinates X₁Y₁ and X₂Y₂, respectively, and it is these XY coordinate data that are stored in the storage means 25. The course or heading of the segment S can be determined from the end points. The map data base also contains data to relate magnetic north to true north, magnetic dip angles to determine heading errors due to the vertical slope of streets St, and other data accounting for the actual magnetic variation of a given geographic area. Because these are generally continuous and slowly varying characteristics, only a few factors need be stored for the entire map data base for this purpose. As mentioned above, these factors may be input as one or more of the multiple parameters to the filter control means 30 and selector control means 50 described below. The map data base is subject to a variety of other errors including survey errors and photographic errors which may occur when surveying and photographing a given geographic area to make the map data base, errors of outdated data such as a new street St that was paved subsequent to the making of the map data base, and, a general class of errors encountered when describing a 3 dimensional earth surface as a 2 dimensional flat surface. Consequently, the map data base may contain data estimating the accuracy for the entire map, for a subarea of the map or for specific line segments S. Additionally, some streets St in the map M are known to be generalizations of the actual locations e.g., some trailer park roads . The map accuracy data may be coded in such a way as to identify these streets St. The heading of a vehicle which is recognized as being on a particular line segment S is calculated from the map data base by determining the slope of the segment S from the endpoints EP₁ and EP₂ and comparing that slope to the known orientation of the map. For a two way street, the heading of the vehicle is determined to be the direction which is closest to the most recently generated estimated heading of the vehicle. In summary, the map data base includes data identifying locations on the map having characteristics which are expected to cause the compass means to be unreliable, such as, streets with inclines causing magnetic dip errors, streets with large steel structures adjacent to them causing anomalies in the magnetic field surrounding the structure, data identifying geographic areas having natural variations in the magnetic field, and so on. This data identifying the characteristics of geographic locations is supplemented in the map data base by data indicating accuracy of the map itself. Fig. 5 shows a block diagram of a selector control means 50 for generating the ADS control signal on line 26. As mentioned above, the apparatus 10 of Fig. 2 operates normally to select the output of the compass means 23. However, when the ADS control signal indicates that the heading as calculated from the map data base is preferable, the selector means 24 will select the heading from the map data base as the absolute direction signal on line 14. The selector control means 50 for generating the ADS control signal on line 26 in the preferred embodiment is responsive to multiple selector parameters SP1 through SPN to generate the ADS control signal on line 26 causing the selector means 24 to appropriately select data from the map data base 25 or the compass means 23. The first selector parameter SP1 indicates whether the navigation control system has identified the location of the vehicle as being on a particular street. Thus, the first selector parameter SP1 is generated by means 51 for indicating that the vehicle is located on a particular street. The second selector parameter SP2 indicates whether the heading of the particular street is within a threshold of the data on line 20 regarding the estimated heading of the vehicle. Thus, the second selector parameter SP2 is generated by the means 51 for indicating whether the apparatus 10 is generating data that indicates an estimated heading of the vehicle which corresponds to the heading predicted by the particular street on the map data base 25. The third selector parameter SP3 is derived from the map data base and indicates whether the vehicle is located in a geographic area or on a particular street segment which is expected to suffer magnetic anomalies causing errors in the output of the compass means 23. Thus, the means 53 for generating the third selector parameter SP3 generates data regarding expected errors in the compass signal due to the location of the vehicle. In the preferred embodiment the selector control means 50 will cause the selector means 24 to select the map data base only when the first selector parameter SP1, the second selector parameter SP2, and the third selector parameter SP3 are set. Thus, the map data base would be used to generate the absolute direction signal on line 14 only when the navigation algorithm has decided that the vehicle is on a particular street, the map data base indicates that the compass means is expected to be subject to anomali s in the area in which the vehicle is located, and the output of the apparatus 10 indicating data regarding the estimated heading of the vehicle remains within a threshold angle of the heading indicated by the particular street on the map data base. As illustrated in Fig. 5, additional selector parameters SPN may be implemented depending on the particular type of second sensor means 13 used for generating the absolute direction signal. Various interrelationships among the selector parameters are determined by the characteristics of the vehicle navigation system, the map data base, and the sensor used for generating the absolute direction signal. In the preferred embodiment, each of the selector parameters SP1 through SPN and the selector control means 50 are implemented by software control of a computer, in conjunction with the navigation control system. In another aspect of the present invention, when implemented with the vehicle navigation system as disclosed above, the output of the filter control means 30 as shown in Fig. 4 is a parameter fed back to the navigation system. The parameter on line 27 is used by the vehicle navigation system in its algorithm for determining whether the vehicle is located on a given street. Part of that algorithm compares the output of the apparatus 10, that is the data indicating the estimated heading of the vehicle on line 20, with the known heading of the segment S on which the vehicle has been located. Fig. 7 shows the flow chart of the subroutine in the vehicle navigation system disclosed in prior application VEHICLE NAVIGATION SYSTEM AND METHOD, Serial No. 618,041, for determining if a segment S is parallel to the estimated heading EH of the vehicle within a threshold. Initially, an angle α of the line segment S is calculated block 7A in accordance with equation 15 Then, the current estimated heading EH of the vehicle is determined block 7B from line 20 of apparatus 10. Next, the system determines if the absolute value of α EH or the absolute value of α EH 180 is less than a threshold number of degrees block 7D . If this difference is greater than the threshold block 7D , then the system determines that this line segment S is not parallel to the estimated heading EH of the vehicle block 7E . If this difference is less than the threshold block 7D , then the system determines that this segment S is parallel to the estimated heading EH of the vehicle block 7F . The means for determining whether this particular segment is parallel to the estimated heading of the vehicle receives the parameter on line 27 of Fig. 4 and generates a value for the threshold of block 7D. When the parameter indicates the estimated heading means 20 is unreliable then the threshold of block 7D is increased. On the other hand, the threshold of block 7D is decreased if the reliability of the estimated heading on line 20 is good as indicated by the parameter on line 27. This parameter for setting the threshold of block 7D is one of several parameters used in the navigation system described in VEHICLE NAVIGATION SYSTEM AND METHOD application referred to above to determine the particular segment the vehicle is on, and hence determine the map heading data sometimes used as the ADS as described above. The apparatus 10 for generating an improved estimate regarding the heading of a land vehicle as disclosed above can be implemented using analog or digital components as known in the art. In the preferred embodiment the apparatus is accomplished by software control of a computer not shown . Fig. 8 and 8A through 8H provide flow charts of the software control of a computer operating according to the present invention. Fig. 8 is an over all flowchart for the calculation of the estimated heading EH according to the present invention. The first step in the flow chart for the calculation of the estimated heading EH is to calculate the heading H The next step involves calculation of the heading H The next step involves the calculation of the compass errors bounds E The next step involves the calculation of the wheel sensor error bounds E The next step in the overall flowchart of Fig. 8 is to calculate the combined error signal DELTA from H In the next step the software determines whether the vehicle has traveled over a threshold distance block 6 . The threshold distance will be determined by the type of sensors used, the average velocity of the vehicle, and other factors to optimize the calculation of the estimated heading. If the vehicle has traveled over the threshold distance, then a filter time constant factor is calculated block 8E . The filter time constant factor F is utilized in the calculation of the filter time constant T The next step involves determining whether to select the absolute direction signal from the heading H In the next step the F DELTA is calculated utilizing the filter time constant factor F to calculate the filter time constant T In the last step, the estimated heading EH is calculated from the wheels heading H Fig. 8A shows the algorithm for the calculation of the heading from the compass H Fig. 8B shows a flowchart for calculating a heading from the wheels H Fig. 8C is a flowchart showing the calculation of the compass error bounds E Fig. 8E shows the calculation of the filter time constant factor F used in calculating the filter time constant T Fig. 8E A shows the flowchart for the calculation for the time weighted standard deviation SDD. In the first step, the standard deviation of the three previous DELTA measurements SD Fig. 8F shows the algorithm for determining whether to select the ADS signal from the compass or the map data base. In the first step, the software determines where the vehicle was on the map at the last update of the navigation algorithm block 1 . If the vehicle was not located on a particular street, then the heading is selected from the compass. However, if the vehicle was updated to the map, then the software determines whether a special map data base bit is set block 2 . The special map data base bit is set when the map indicates that the vehicle is in an area where the heading signal H Fig. 8G shows the algorithm for the calculation of F DELTA. In the first step the filter constant T Fig. 8H shows the calculation of heading from the wheels and F DELTA. The estimated heading EH is set equal to H Appendix A to the present application is a printout of a source code language program for carrying out the present invention which is provided for the purposes of providing an example of one embodiment of the present invention. The software in Appendix A includes the following subroutine modules Apparatus 10 according to the present invention overcomes the problems of prior art sensors for generating accurate data regarding the heading of a land vehicle by eliminating errors in the signals generated in direction sensors. According to this apparatus and method, errors reflected in the absolute direction signal and the relative direction signal are minimized. Because the errors in the relative direction sensor are for the most part probabilistically independent and spectrally separated from magnetic anomaly induced errors reflected in the absolute direction signal, the present invention is able to combine the signals to isolate and minimize the effects of the errors in generating accurate data regarding the heading of the vehicle. The foregoing description of the preferred embodiment of the invention has been presented for the purposes of illustration and description. It is not intended to be exhaustive or to limit the invention to the precise form disclosed, and obviously many modifications and variations are possible in light of the above teaching. The embodiment was chosen and described in order to best explain the principles of the invention and its practical application to thereby enable others skilled in the art to best utilize the invention in various embodiments and with various modifications as are suited to the particular use contemplated. It is intended that the scope of the invention be defined by the claims appended hereto. Accordingly, further aspects and advantages of the present invention can be determined by a study of the specification, the appendix, the claims and the drawings.