# Method and apparatus for use in interactive dialogue.

## Abstract
A dialogue controller 15 and a speech recogniser 11 are provided for obtaining classified information from utterances spoken by a user in a dialogue. Templates to enable the recog niser to recognise utterances are grouped in logical templates comprising templates of a given utterance and utterances which are equivalent from the point of view of the dialogue con troller for a particular part of the dialogue. A logical template CONFIRM may include templates for Yes , spoken by differ ent speakers and also templates for Yeah , Confirm and other synonyms. The dialogue controller does not need to know which template has been matched the logical template CONFIRM is identified and the appropriate classified informa tion is sent to the dialogue controller. In a telephone informa tion service, the apparatus includes a speech synthesiser 13 , a telephone monitor interface 17 and a data store.

## Claims
CLA IS 1. method of obtaining classified information frorr utterances spoken by a user in a dialogue contrclled by a dialogue controller, comprising establishing teltes es each representing an utterance in Ã¢ selectee vocabulary, ana comparing said templates with signals derived from one or more user utterances to determine any close match, characterised by grouping together one or more templates of utterances having the same meaning and or having equivalent meanings for the purposes of the dialogue such that at least one group comprises templates having equivalent meanings, comparing templates from at least one of saic groups with signals derived from one or more utterances spoken in a user response to determine any close match, and sending classified information relating to the identity of the or each group comprising a matched template to the dialogue controller. 2. A method as claimed in claim 1, wherein groups are created for stages in possible dialogues controlled by the dialogue controller, wherein a group created for a particular stage or stages comprises templates of utterances having equivalent meanings at said stage. 3. A method as claimed in Claim 1 or Claim 2, wherein one or more of said groups comprises a plurality of templates of a given utterance spoken by different speakers. 4. A method as claimed in Claim 3, whereby different speakers establish a template for a given utterance, closely similar templates being discarded prior to grouping. 5. A method as claimed in any preceding claim, wherein one or more of said groups comprises a plurality of templates of a given utterance spoken witr respective different articulations by one speaker. 6. A method as claimed in any preceding claim, including dynamically adjusting the discrimination threshold for identifying a match according to earlier recognition scores during that dialogue. 7. A method as claimed in any preceding claim, including sending a direction from the dialogue controller to a speech recogniser such that one or more selected groups of templates are ready for comparison with signals derived from said utterances. 8. A method as claimed in Claim 7, wherein the direction from the dialogue controller causes groups of templates to be downloaded from a template store to the recogniser. 9. A method as claimed in Claim 7, wherein templates are stored in the speech recogniser and a direction from the dialogue controller causes selected groups of said templates to be activated for a forthcoming part of the dialogue. 10. A method as claimed in claim 7, including sending directions from the dialogue controller to the speech recogniser for respective forthcoming parts of the dialogue and sending classified information from the speech recognlser to the dialogue controller relating to the or each group of templates comprising a matched template, thereby assimilating information necessary to establish a user enquiry, consulting a data store to obtain information necessary to respona to the enquiry and transmitting the response information to the user. 11. Apparatus for obtaining classified information from utterances spoken by a user in a dIaloue comprising a dialogue controller arranged te contrcl the dialogue and te comaunicate with a speec recogniser, characteriseH in that the dialogue controller is arranges to group together one cr more templates representing utterances having the same meaning or equivalent meanings for the purposes of the dialogue where at least one group comprises templates having equivalent meanings, and the speech recogniser is adapted to compare templates within one or more of said groups with signals derived from one or more utterances spoken in a user response to identify any close match, and to send classified information relating to the identity of the or each group comprising a matched template to the dialogue controller. 12. Apparatus as claimed in claim 11, including a data store for consultation by the dialogue controller to obtain information to answer a user enquiry and transmission means for communicating with the user during the dialogue and transmitting said information. 13. Apparatus as claimed in claim 12, wherein said transmission means comprises a speech synthesiser.

## Description
METHOD AND APPARATUS FOR USE IN INTERACTIVE DIALOGUE The present invention relates to a method and apparatus used in interactive dialogue. In particular, it is concerned with obtaining classified information from utterances spoken by a user in a dialogue. Speech synthesis and automatic speech recognition potentially allow users to interact with computer systems and databases using voice alone. There is a wide variety of potential uses for speech recognisers which can successfully recognise utterances eg words, part words, or short phrases, depending on the type of recogniser made by a user. Ideally, the recogniser can be used to recognise utterances of any one of a class of users for which the recogniser has been trained.Applications include telephone information services, which could be made much more flexible than the current recorded information services, s, and office automation tasks where untrained people could use computer equipment. Speech recognisers have limited vocabularies and are suited to applications such as those mentioned above, where simple, goal orientated dialogues within limited domains of discourse take place. Currently available speech recognisers have vocabularies of around 100 to 300 words or utterances.Before a speech recogniser can be used to recognise an utterance, a representatIon of the utterance to be recognisec must be forne ane stored. Isolated word recoc1sers, for example, may extract features such as spectral or linear prediction coefficients from signals derived from a spoken word. Each wcrd iS chavacLeilsec by a feature template comprising a set of coefficIents, suc as spectral coefficients, derived fror a filter bank. Each word is assumed to be represented by a unique template pattern and recognition is performed by finding the best fit between an unknown feature template and those stored in memory.The term recognition score is given to a number which represents the closeness of fit between two speech templates this number usually has to exceed a specified figure called the recognition threshold before recognition of a word is deemed to have occurred. The term template used herein refers to reference data which can be compared with input data derived from an utterance for the purpose of establishing a match eg by exceeding a recognition threshold . Dietrich Klugmann in an article entitled Speaking with the Copute Data Report Vol Viii 1980 Sept No 3 pages 4 9 discusses speech recognition techniques. It describes classifiers for word patterns. A 1class is said to be all pronounciation variants of a single word. It is pointed out that a general problem with classifiers results from the fact that with large numbers of classes, speed decreases, whilst the number of allocation errors increases. Various methods may be chosen for selecting templates.For example Lawrence Rabiner, in IEEE Translations onAcoustics, Speech and Signal Processing, Vol ASSP 26 No 1February 1978, pages 34 42 describes the creation of templates by creating a data plot of reference tokens and generating templates by averaging reference tokens which are clustered together on the plot. Thus, a set of templates is created for a given word. The present invention is not concerned with the particular method chosen for creation of templates, but with establishing templates and subsequently using those templates in a useful and conveniert manner. Problems of complexity are encountered in using speech recognisers in applications such as database enquiry systems. The present invention provides a method and apparatus which can, for certain applications, help in simplification. According to the present invention, there is provided a method of obtaining classified information from utterances spoken by a user in a dialogue controlled by a dialogue cor,troller, comprising establishing templates each representing an utterance in a selected vocabulary, and comparing said templates with signals derived from one or more user utterances to determine any close match, characterised by grouping together one or more templates of utterances having the same meaning and or having equivalent meanings for the purpcses of the dialogue such that at least one group comprises templates having equivalent meanings, comparing templates from at least one of said groups with signals derived from one or more utterances spoken in a user response to determine any close match, and sending classified information relating to the identity of the or each group comprising a matched template to the dIalogue controller. Note that templates of utterances said to have the same meaning are templates for one particular utterance, such as the word to , which requires more than one template for the single utterance in order to cover differences of pronounciation by different speakers and or one speaker in different contexts. Utterances having equivalent meanings are those such as the words red, crimson, scarlet which are different from one another but mean the same or are tc be interpreted in the same way at a p ticul2r stage of dialogue which may take place. Grouts can be createc for stages in possible dialogues welch may occur under control of the dialogue controller, where a group created for a particular stage r stages comprises templates of tterances having equivalent meanings t that stage or those stages. Note tnie altnojch utterances may be synonymous in one part of a dialogue, they may not be in another. For example, at one stage In a dialogue a customer may be enquiring about train fares fromLondon to Ipswich.The answer will be the same whateverLondon station is named as departure point for exampleLondon, Euston ane Liverpool Street are all synonymous for this enquiry and templates for these words could be included in a single group. Later in the dialogue, the customer may be enquiring about bus fares from Euston station to Liverpool Street station, so Euston andLiverpool Street must be included in two further different groups which are loaded into the recogniser for the later part of the dialogue. The invention also provides apparatus for obtaining classified information from utterances spoken by a user in a dialogue comprising a dialogue controller arranged to control the dialogue and to communicate with a speech recogniser, in which the dialogue controller is arranged to group together one or more templates representing utterances having the same or equivalent meanings for the purposes of the dialogue where at least one group comprises templates having equivalent meanings, and the speech recogniser is adapted to compare templates within one or more of said groups with signals derived from one or more utterances spoken in a user response to identify any close match, and to send classified information relating to the identity of the or each group comprising a matched template to the dialogue controller. Thus, templates representing the same or equivalent utterances are grouped. When recognition of one of the templates in a group occurs, information identifying the group not the individual template is sent to the dialogue controller. Instead of being told that a particular one of say 30 templates has been identified, the dialogue controller is given the information that a specified one of, say, 8G groups of templates contains an identified template. This can lead to considerable simplification in the internal structure of the dialogue controller. The invention will now be described by way of example with reference to the accompanying figure, which is a block diagram showing a dialogue system incorporating apparatus according to an embodiment of this invention. The diagram illustrates a train timetable telephone information service comprising an isolated word speech recogniser 11, a speech synthesiser 13 and a dialogue controller 15. A telephone monitor interface 17 connects the speech synthesis or recognition equipment to the telephone network 19 and the caller s telephone 21.Interface 17 comprises a hybrid 23, filters 25,27 on the two arms of the hybrid and amplifiers 29 and 31. The dialogue controller 15 is connected via data links 33,35 with synthesiser 13 and recogniser 11. A data base not shown associated with the dialogue controller 15 holds the necessary information on train times for responding to user enquifles. On receipt of an incoming call, the telephone monitor interface 17 notifies the dialogue controller 15 and the call is answered. Speech generated by the speech syntheslser 13 is filtered, amplified as appropriate and fetufnen to the caller via the hybrid. Similarly, speech from the caller passes through the other arm of the hybrid, is filtered to telephone bandwidth, and is then amplified and passed to the speech recogniser 11. Recogniser 11 may be any stable recogniser capable of handling a relatively rge vocabulary, such as an Interstate VRM recogniser. Steer synthesiser 13 may be any conmercially available svnthesiser, for example Speech Plus Prose 20 . Analogue processing of the speech path is needed particularly on the recognitior path. The filterina ensures that all speech signals have a fixed bandwidth irrespective of the nature of the telephone connection and has the effect of improving the noise immunity of the system as well as reducing the variability of speech from different speakers. The amplifier is provided with automatic gain control to compensate for varying re received speech levels speech level may vary between different telephone connections and also during a dialogue if the caller raises or lowers his voice. The dialogue controller 15 is the heart of the system, and suitably comprises a number of associated modules, including a small computer. It has an associated recogniser interface comprising an applications program including low level software for controlling items of equipment, acting as an intermediary between the higher level software of the dialogue controller and the speech recogniser 11, and identifying required information. The dialogue controller 15 itself comprises high level software, which is not, in general, concerned with the details of the actual words used in the dialogue, but with the information they represent. As mentioned above, most isolated word speech recognisers are limited to a vocabulary of 200 300 words or utterances ie they can store 290 300 templates . In order to simplify the dialogue system as much as possible, the number of utterances to be distinguished is kept to the minimum necessary. This has the advantage that the smaller the number of templates used, the greater the recognition accuracy is likely to be. In practice, not all words used in a conversation need to be distinguishable frorr all others, since the dialogue controller should take account of the context of the conversation. However, the numbEr of templates available for use must be sufficiently laroe to enable a reasonably natural dialogue to take place. Clearly, for telephone information services the system must be user independent. It is therefore necessary to produce a user independent set of templates. fn order to train the Interstate VRM recogniser used by the applicants, a panel of subjects, representing a typical cross section of the general public, was selected. Each panellist spoke each word from the vocabulary three times and the signals for each word were averaged to produce a template. The templates from one panellist were supplied to the recogniser and tested against those of another panellist.If the recognition scores were high the templates were considered to be equivalent and only one was maintained for low scores, it was necessary to retain both templates.In this way, one or more templates were created for each vocablulary word. Some words such as to , for may be differently articulated by some people according to the context for example if the word occurs in the middle or at the end of a sentence. For some words in the vocabulary therefore two or more templates may be needed te train a recogniser for a particular panellist. A full set of templates for a given vocabulary may be built up using the above technique. Alternatively, one panellist s templates may be averaged with others utterances to produce an averaged template for each vocabulary item. This creates a smaller number of templates, but low recognition scores may result for some vocabulary items. Better results could be obtained by averaging similar templates and retaining less similar ones. Some words in the vocabulary cf the recoiser il will have equivalert meanings for the purposes of te dialogue, o, a particular part of the dialogue. As incicated above, the dialogue is constrained by the dialogue controller 15 so that the user is required to give specific information during consecutive stages. In a very simple system, the user may be asked to give one word answers to questions.Suppose the user is asked to confirm something his answer may be Yes , Yeah or Correct . Ali of these answers are equivalent from the point of view of the dialogue controller which simply needs to know that confirmation has been made it does not need to know which word or words have been spoken by the user in making the confirmation.The present invention takes advantage of this by grouping all templates having the same or equivalent meanings for the purposes of the dialogue, or a stage which may occur in the dialogue, in groups which will be referred to as logical templates . In this example, all of the logical templates ie. groups of templates are stored in a master store which forms part of the dialogue controller. Each logical template has an associated name classifying its meaning for the purposes of the dialogue controller. Speech recogniser 11 is loaded with appropriate logical templates for a forthcoming part of the dialogue. If the caller has indicated that he has misunderstood the previous question, the question will simply need to be repeated and no loading or unloading of templates need occur. For Interstate VRM, like most speech recognisers, numbering of templates is necessary because the recogniser is adapted to refer to templates by number accordingly, on loading, each individual template is given an identification number. The numbers given are arbitrary and are allocated only for the forthcoming sub dialogue. If particular templates are reloaded for a subsequent part of the dialogue the respective allocated numbers are likely te be different. Suppose that it has already been established that the user wishes to travel from Ipswich.The next question to be asked by the speech synthesiser, on a direction from the dialogue controller is Where do you want to go to The answer is expected to be the name of a place or station ana all logical templates representing place names must bye loaded into the recogniser. The high level software in the dialogue controller instructs loading and the applications program carries out the instruction.Logical templates for LONDON, FOLKESTONE etc are loaded, together with a logical template for REPEAT in case the user has not heard the question. The logical template LONDON includes one or more templates for London , depending on whether different members of the training panel pronounced the word in a similar way. Since a person wishing to travel from Ipswich to London will arrive in London at Liverpool Street station, the logical template LONDON also includes one or more templates for Liverpool Street . On loading, the identification numbers given arbitrarily to the individual templates, are referenced against the names of the templates by a template load map set up by a sub procedure in the applications program. Suppose, for example, that there are two templates for London numbered OC and 01, and three for Liverpool Street numbered 02, 03 and 04.The template load map for the logical template LONDON would be LONDON London DO London 2 01 Liverpool Street 1 02 Liverpool Street 2 03 Liverpool Street 3 04If the user s answer most closely matche Liverpool Street 2, the sneech recor iser would sene template number 03 to the applications program. The sub procedure would translate to template C3 and local tem ate LONDON. The sub procedure can be arranged to perform additional checks before identifying a particular logical template. For example, it might check to see whether the second best recognition score was obtained from Liverpool Street 1 or 3.If so the sub procedure could indicate to the dialogue controller a higher degree of confidence in the recognition. On the other hand, if the second best recognition score was obtained for a template in a different logical template, and the two scores were close, a very low decree of confidence could be indicated, resulting in the question to the caller being repeated. Data representing the classified information LONDON are sent to the dialogue controller in a form such that the dialogue controller can immediately make use of the information. The information is stored and appropriate further questions for subsequent steps in the dialogue prepared. The dialogue controller is arranged to make sensible assumptions and intelligently interpret responses from the caller. For example, if the system is to provide aLondon based information service, then it is reasonable to assume initially that people who use the system will want details of train services to or from London. The dialogue controller will seek to confirm such an assumption by asking a question such as Do you wish to travel fromLondon . Similarly, information derived from answers to earlier questions can be used to form subsequent questions which implicity confirm the answers to earlier questions. Another useful facility of the system is its ability to adapt to poor speech recogition. If poor recognition scores are being achieved, lower accuracy is dersnded for future recognition by making dynamic adjustments of the threshold ciscrirination for template matchinc within the recogniser. At the same time, a simpler dialogue strategy is adopted in which one word answers are to be given with very poor recognition scores, the user is asked to respond only with Yes Or No . In cases where the speech recogniser has a large enough internal store for all templates needed for a phase of dialogue, and is able to mark templates as active or passive, it is not necessary to load and unload a full set of templates for each sub dialogue. The dialogue controller provides the applications program with a list of logical templates for a forthcoming sub dialogue, and the applications program loads templates as necessary and activates the templates of required logical templates. Note that for a connected word recogniser, it would be necessary to specify that certain templates are to become active only after others have been recognised, the recognised templates and all associated templates then being deactivated . The software of dialogue controller 15 is written inISO standard PASCAL so that it can readily be transferred to other computer systems. The software itself is structured to give the dialogue controller and the applications programs reasonable independence from the type of synthesisers and recognisers being used, so that different synthesisers and recognisers could be used if desired . Advantages of grouping templates in logical templates will be apparent. Templates are stored in groups in a store in the dialogue controller and groups are down loaded as necessary to the smaller store in the speech recobr se . 411 templates grouped together are either templates of the same words or part words or phrases spoken w efferent speakers or differently articulated by one speaker, or of words which are equivalent for the purposes of the dialogue or a particular stage of dialogue. The grouping of such templates makes manipulation very much easier. The high level software in the dialogue controller need not be aware of the existence of the individual templates.It can initially instruct the applications program to download or activate certain logical templates or classes of logical template which may be needed for a sub dialogue. Once a template has been recognised the applications program identifies the logical template to which it belongs and advises the dialogue controller. In a very straight forward manner, information is supplied to the dialogue controller in a classified form suitable for interpretation. A dialogue is conducted with the caller until all information needed to answer the caller s enquiry has been obtained. This mostly takes the fonn of questions asked by the speech synthesiser 13 under the instruction of the dialogue controller 15, to elicit information from the caller to enable an answer to be given. Each answer is analysed by the speech recogniser 11 and relevant classified information sent to the dialogue controller. The information received is used for determining the subsequent course of the dialogue and or stored until all ne necessary information has been received. During the course of the dialogue the dialogue controller arranges to confirm information which it has already received. For example, if the dialogue controller has found that the caller wishes to travel from Ipswich to London and the dialogue controller has next to find when the caller wishes to travel, it can ask At what time do you want to catch a train from Ipswich to London Suppose it has been established that the caller wishes to travel from Ipswich to London on a weekday, to arrive by midday. Once the dialogue controller has all the necessary inforiration, which it has confireed as far as possible with the user, the train timetable database associated with the dialogue controller is consulted. This gives the information that there is a train from Ipswich at 10.21 arriving at Liverpool Street Station, London at 11.44.This information is spoken te the caller by the speech synthesiser 13. An advantage in setting the system up is that logical templates are chosen but the choice of alternative words synonyms need not be made until a later stage in the design. The number of alternatives can be increased if an existing speech recogniser is replaced by one capable of handling a larger number of templates. Many changes may be made te the speech racogniser and synthesiser and the low level procedures without affecting the higher level frictions of the dialogue controller which operates using classified information associated with logical templates.Thus, the system can be designed as modules dialogue controller, recogniser, template store, synthesiser, applications and interface pro procedures each of which can be enhanced and developed separately. The use of logical templates is also helpful in setting up a dialogue control system. The system can be set up and tested using templates produced by only one or two trainers. The speech recognisers can then be trained by an appropriate panel of people. The logical templates for the two trainers and the full panel will be the same, although of course the actual templates will be different, so that the operation of the dialogue controller will be unaffected.If the system is used for communicating with users of a computer there may be group of, say, ten users whc could train the recogniser. If sore users were from tine to time replaced by others, some retraining would be necessary. however, no change to the dialogue controller would be needed as the classified information associated with the logical templates would be unaltered. An added facility which would be useful for computer applications is that the applications program can be instructed to check whether all templates being recognised during a session o one or more dialogues belong to one person if so future loading could be limited to templates belonging to that person. Ncte that any convenient method for preparina templates may be used. Various methods are known and some of these are discussed in the article by Rabiner referred to earlier.