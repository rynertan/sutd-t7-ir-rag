# SYSTEM FOR CORRECTING ERROR IN DIGITAL DATA

## Claims
Gerät zur Fehlerverdeckung in digitalen Videosignalen mit einer Verzögerungsspeicherschaltung 30 mit Paaren von in Reihe geschalteten Verzögerungselementen 21, 22 24, 25 27, 28 und mit Hauptverzögerungsspeichern 23, 32 , die zwischen den Paaren von Verzögerungselementen angeordnet sind, wobei der Eingang und der Ausgang jedes Verzögerungselements zu einer Fehlerverdeckungsschaltung 29 abzweigen, die an ihrem Ausgang fehlerverdeckte Daten liefert, wobei die Verzögerungsspeicherschaltung 30 einen Kompensations Verzögerungsspeicher 31 enthält, auf den ein Multiplexer 33 folgt, und wobei der Ausgang der Fehlerverdeckungsschaltung mit einem der Eingänge des Multiplexers verbunden ist, um fehlerverdeckte Daten, die zuvor einer Fehlerverdeckung unterzogen wurden, rückzukoppeln, um Fehler in Daten, die auf die zuvor einer Fehlerverdeckung unterzogenen Daten folgen, zu verdecken.

## Description
The present invention relates to an error concealing system for digital data for use with, for example, a digital VTR. EP 0 044 963 A1 discloses a method for error concealing erroneous digital data in which the correct data which precedes and the correct data which follows the chain of erroneous PCM signals are used as a basis for calculating a first error concealed data. The result of this calculation i.e. first error concealed data then is used as a basis for the next interpolation process which provides the error concealed value of the next disturbed data. Interpolation is carried out by an interpolation circuit which comprises a summing amplifier having three input terminals of different sensivity by which the input value is weighted. The output of the A D converter is fed to the input terminals via switches which are controlled by an error concealing control circuit. The second output terminal of the switches is connected to sample and hold circuits via another switch which is controlled by a control signal. The setting of the resistor circuitry depends on the number of subsequent erroneous data. If the number of erroneous data exceeds the number of four, the last correct data is fed to the output until there is only a difference of four sampling intervals to the next correct data. While the device of D1 is useful for linear arrays of data, it is not adapted to deal with two dimensional data arrays like video pictures because erroneous pixels in video pictures cannot only be error concealed by the preceding a the subsequent pixel within the same line but also by surrounding pixels situated in the preceding and the next line of the same field or even the corresponding pixel in the preceding or the next field or frame. An example of a prior art digital VTR will hereinafter be described with reference to Figs. 1 to 3. In the first place, an arrangement relationship of rotary magnetic heads of the prior art digital VTR will be described with reference to Fig. 1. Reference letter DR designates a tape guide drum which is constituted by a rotary drum as an upper drum and a fixed drum as a lower drum. This tape guide drum DR may be formed of a fixed drum as an upper and lower drum and a rotary drum as a middle drum. Reference letters H References TG₁ and TG₂ designate tape guide poles for determining a wrapping angle ϑ with which the magnetic tape TP is wound around the tape guide drum DR. The tape wrapping angle ϑ is selected to be, for example, 240 . Then, a recording system of the prior art digital VTR will be described with reference to Fig. 2. Reference numeral 1 designates an A D converter to which component color video signals, i.e., a luminance signal Y, a blue color difference signal B Y and a red color difference signal R Y are supplied and thereby A D converted to be digital component video signals. These digitized component video signals are supplied to a multiplexer 2, in which they are multiplexed and 2 channel encoded and thereby produced as 2 channel multiplexed digital video signals. These signals are supplied to a shuffle circuit 3 provided with a memory and thereby shuffled. In this shuffle circuit 3, the 2 channel digital video signals are written in the memory by respective write clock pulses and then read out therefrom by respective read clock signals at a predetermined processing speed, whereby to shuffle the 2 channel digital video signals, thus preventing a burst error from occurring in a reproduced data due to the dropout of the tape and so on. The 2 channel digital video signals derived from the shuffle circuit 3 are supplied to an error correcting and encoding circuit 4 in which they are encoded and then fed to a time base expanding circuit FIFO memory 5 and thereby time base expanded. In the time base expanding circuit 5, the 2 channel digital video signals from the error correcting and encoding circuit 4 are written in a memory by a write clock signal corresponding to the processing speed and then read out therefrom by a read clock signal corresponding to the recording rate. The 2 channel digital video signals derived from the time base expanding circuit 5 are alternately supplied to recording amplifiers 6A, 6B and 6C, 6D at every 1 5 field or at every 1 6 field . The respective outputs from the recording amplifiers 6A, 6B and 6C, 6D are respectively supplied to the recording rotary magnetic heads H A reproducing system of the prior art digital VTR will be described with reference to Fig. 3. The digital video signals reproduced from the magnetic tape TP by the reproducing rotary magnetic heads H The outputs from the playback processors 8A to 8D are supplied to a time base corrector 9 in which they are time base compressed. In this time base corrector 9, the outputs from the playback processors 8A to 8D are written in a memory by a write clock signal corresponding to a recording rate and then read out therefrom by a read clock signal corresponding to the processing speed to thereby time base compress the same. The time base compressed 2 channel digital video signals derived from the time base corrector 9 are supplied through a synchronizing detector circuit 10 to an address reproducing circuit 11. The 2 channel digital video signals derived from the address reproducing circuit 11 are supplied to an error correcting decoder 12 in which they are error corrected and then supplied to and written in a frame memory 13. The 2 channel digital video signals read out from the memory 13 are supplied to a de shuffle circuit 14. In the de shuffle circuit 14, the 2 channel digital video signals from the memory 13 are written by a write clock signal based on the write processing speed and de shuffled and read out therefrom by a read clock signal corresponding to a read processing speed, so that even if the burst error occurs in the reproduced signal due to the dropout or the like, there is a small possibility that errors will occur together on the picture. The 2 channel digital video signals from the de shuffle circuit 14 are supplied to a de multiplexer 15 in which they are decoded to 3 channel digital component video signals. Thereafter, they are fed to an error concealing circuit 16 and thereby error concealed. The 3 channel digital component video signals from the error concealing cirucit 16 are supplied to a D A converter 17 in which they are D A converted and thereby developed as analog component video signals, that is, the luminance signal Y, the blue color difference signal B Y and the red color difference signal R Y. The method for error concealing the digital video data in the prior art digital VTR will be described with reference to Figs. 4 to 9. Fig. 4 illustrates a desired picture element When the data corresponding to the picture element A prior art error concealing apparatus will be described with reference to Fig. 5. In Fig. 5, reference numeral 20 designates an overall arrangement of a delay memory. Since 9 picture elements of square lattice extending to, for example, three scanning lines shown in Fig. 4 are to be processed, the full delay time of the delay memory 20 is set as 2H 2T At the center of the delay memory 20, or the connection point between the third and fourth unit delay memories 24 and 25 or at time point t₀ in which a data e corresponding to the central picture element Fig. 6 illustrates patterns of the recording tracks formed on the magnetic tape TP by the afore mentioned digital VTR, in which A, B, C and D respectively designate slant tracks recorded by the recording rotary magnetic heads H Reference A , B , C and D respectively designate tracing tracks in a case where the magnetic tape TP is transported at the constant and same speed as that of the recording mode and the respective tracks are traced by the corresponding reproducing rotary magnetic heads H Since as earlier noted the dig tal VTR carries out the shuffling operation upon recording, it is rare that errors will occur together on the video screen upon playback mode with constant tape speed. Accordingly, even if the error occurs in the data corresponding to the picture element However, when the magnetic tape TP similarly to Fig. 6 is transported at high speed, for example, at a tape transport speed three times the transport speed of the recording mode, the patterns of the tracks A₁ , B₁ , C₁ , D₁ , A₂ , B₂ , ... traced by the reproducing rotary magnetic heads H Although as shown in Fig. 9 it may be considered that the sampling range of the concealing data is enlarged, this urges the circuit scale to be increased considerably and is neither economical nor the realities. Fig. 9 illustrates a desired picture element In view of such aspects, an object of this invention is to provide an error concealing system for digital data by which in a reproducing system having a relatively high error rate, the concealing processing can be carried out by using an error concealing data of small scale and which is particularly useful in a digital video device. In order to achieve the above mentioned object, the present invention is to provide an apparatus for concealing errors comprising the features of claim 1. Specific embodiments are described in the subclaims. Figs. 1, 2 and 3 are respectively a locational representation of a tape guide drum and rotary magnetic heads, a block diagram of a recording system and a block diagram of a reproducing system of an example of a digital VTR to which the present invention is applied with good effect, Figs. 4, 9, 11 and 13 are diagrams useful for explaining the present invention, Fig. 5 is a block diagram showing a prior art error concealing circuit, Figs. 6 and 7 are respectively pattern diagrams showing track patterns of a magnetic tape, Fig. 8 is a waveform diagram showing an envelope of a reproduced high frequency signal, Fig. 10 is a block diagram showing an example of an error concealing apparatus to which the present invention is applied and Fig. 12 is a block diagram showing another example of the error concealing apparatus to which the present invention is applied. An embodiment of an error concealing system for digital data according to the present invention will hereinafter be described with reference to Figs. 10 and 11. Fig. 10 shows an arrangement of an example of an error concealing apparatus to which the present invention is applied. In Fig. 10, like parts corresponding to those of Fig. 5 are marked with the same references and the overlapped explanation therefor will be omitted. In Fig. 10, reference numeral 30 designates an overall arrangement of a delay memory. The total delay time of this delay memory 30 is determined as 2H 2T Since the error concealing circuit 34 has a delay time T The operation of the error concealing apparatus of Fig. 10 is as follows. In a rectangular lattice shown in Fig. 11A, let it be assumed that data corresponding to the picture elements In this case, although in the prior art error concealing apparatus shown in Fig. 5 the data corresponding to the picture elements However, in the error concealing apparatus shown in Fig. 10, since the main delay memory 32 is provided at its input side with the multiplexer 33, the erroneous data e in the illustrated state is error concealed by the error concealing circuit 34 and, the error concealed data and an error flag whose presentation is switched from erroneous to correct in response to such data concealment are supplied to the multiplexer 33. At that time, the multiplexer 33 is switched by the control signal s derived from the concealing circuit 34 such that it transmits the concealed data. As described above, the concealed data on the scanning line L As described above, in this error concealing apparatus, since the concealed data is fed back to the delay memory, the erroneous data can sequentially be concealed by using the correct data of small scale. Thus, even when the error rate is relatively high such as when the digital VTR is in the playback mode at a high speed, it is possible to carry out the error concealment with ease. While in the above the playback mode at high tape speed is described, this is also true for the playback mode at low tape speed. Another example of the error concealing apparatus to which the present invention is applied will be described with reference to Figs. 12 and 13. Fig. 12 shows an arrangement of another example of the error concealing apparatus. In Fig. 12, like parts corresponding to those of Figs. 5 and 10 are marked with the same references and overlapped explanation will be omitted. In Fig. 12, reference numerals 20A and 20B respectively designate rear field and front field line delay memories. Both the line delay memories 20A and 20B are exactly the same in arrangement as the delay memory 20 shown in Fig. 5. Reference numerals 41 and 42 designate field delay memories for the rear and main fields, respectively. The field delay memories 41 and 42 are both supplied with the outputs from the rear field and main field line delay memories 20A and 20B. The delay times of both the field delay memories 41 and 42 are selected to be both 1V 2H 2T Fig. 13 shows a relationship amongst the data of the respective fields. From this, it will be apparent that the apparatus of Fig. 12 is used in such a case that the present invention is applied to three dimensions containing the time base. Accordingly, from the explanation given on the embodiment of Fig. 10, it can easily be understood that the data, which is concealed by using the correct data of the preceding field, is fed back to the delay memory and the erroneous data at the succeeding field can be sequentially concealed. While in the apparatus of Fig. 12 the data of a certain field and the fields before and after such field, i.e., totally 3 fields are used for error concealment, instead of 3 field data, 3 frame data can be used. According to the present invention as described above in detail, since the concealed data is fed back to the delay memory and is used as the correct data for the error concealment, the erroneous data can sequentially be concealed by the correct data of small scale. Consequently, when the present invention is applied to the digital VTR, even upon playback mode at variable tape speeds, it is possible to improve the quality of the picture by using the circuit arrangement of a small scale.