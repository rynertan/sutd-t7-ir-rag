# Cache system adopting an LRU system, and magnetic disk controller incorporating it.

## Abstract
According to a magnetic disk controller incorporating a disk cache system, an arbitrary LRU value and a resident bit for inhibiting replacement of a corresponding block are added to a read write command. Each entry of a directory memory 35₁ has a disk block address field, an LRU counter for storing the arbitrary LRU value, a write command receiving bit field representing non writing of write data in the disk unit, the write data being accessed by the host system, a resident bit field for inhibiting replacement of the corresponding block, and a disk drive identifier field LUN representing the corresponding magnetic disk drive unit 10₁ through 10₄ . The LRU setting value added to the read write command is registered in the LRU counter field of the entry corresponding to the block to be replaced. If the number of data is smaller than a maximum number of blocks to be written in the disk unit, writing is performed for the corresponding block in the cache memory. The resident bit of the entry to be replaced is set reset in response to the read instruction. If a read error occurs, the cache block to be replaced is divided into subunits on the basis of a sector next to that the number of which is read, a start sector fo the disk area data which is to be transferred to the host system, and a last sector thereof. A transfer start cache address, the number of transfer sectors, and a data transfer direction control code are produced for each one of the subunits of the cache block to be replaced. The directory memory is commonly used by a plurality fo magnetic disk units.