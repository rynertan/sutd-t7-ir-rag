# IMAGE PROCESSING FOR UNSHARP MASKING OF IMAGE

## Claims
Ein Bildverarbeitungssystem, welches umfaßt

## Description
The present invention relates to image processing, and more particularly, to an image processing system for use in reproducing an image from an original image with a frequency component or components emphasized which are higher than a specific spatial frequency. An image processing system comprising the features of the preamble of claim 1 is known from US A 4 317 179. In image processing, especially in a digital data processing, a so called unsharp masking process may often be involved in which a spatial frequency component or components of a specific frequency band included in a digitalized video signal are enhanced so as to produce an image that is suitable for a specific usage. In a medical diagnosis, for example, there is a kind of radiation photography system using a stimulable phosphor sheet. In such a system, a radiation sensitive sheet, made of stimulable phosphor, is exposed to an imagewise radiation to store an original image therein, which is then read out by illumination of a stimulating ray to be recorded as a visible hard copy of image on a recording medium. A latent image of an object under inspection, such as of a living body, which is temporarily stored in a sheet of stimulable phosphor as energy distributions of radiation, is scanned with a stimulative light beam to cause secondary emission of light from the sheet in dependence upon the stored latent image. The secondary emission of light from the phosphor sheet is in turn converted into an electrical signal indicative of the image. The electrical signal is converted into a digital form, which is then processed so as to cause a specific frequency component or components to be emphasized, effecting enhancement in sharpness of edge portions of the image. In a medical diagnosis, for example, such unsharp masking may advantageously be used to produce an easily readable picture of blood vessels or foci, for example, with a fine gray scale tone emphasized. More specifically, according to Japanese Patent Laid Open Publication No. 163472 1980, for instance, a video signal S which has been processed under unsharp masking is represented by the following expression It is to be noted that the unsharp masking signal S According to Japanese Patent Laid Open No. 75139 1981, when a latent image stored in a stimulable phosphor sheet is scanned in raster fashion, the unsharp masking signal S Combining the expressions 1 with 2 , unsharp masking process depends upon the following expression Generally, β may be a function of S where γ is a nonlinear function for use in a known gradiation conversion. Specifically, in the case of the number M of sampling points in a scanning line equal to the number N of the scanning lines in the rectangular region discussed above, the expression 4 will be transformed into The operations in accordance with expressions 3 , 4 and 5 are substantially not different from an ideal masking operation with respect to improvement in medical diagnostic performance of radiation images, and in addition include an averaging by simple addition, resulting in shortening an operational period of time as well as simplifying the system configuration for image processing. As depicted in FIG. 3, for example, a square mask 500 is formed by four sides of equal length including N pixels each, with horizontal scanning made in the direction of the arrow H and vertical scanning in the direction of the arrow V. A total optical density C where the pixel at the center of mask 500 is represented by a,b in the coordinates. The total density T with respect to the entire mask 500 is then given by During the scanning of the n th line, the scanning beam reaches pixel m,n , so that the unsharp masking operation is shifted from S In a radiation photography system using stimulable phosphor sheets, or image storage panels containing stimulable phosphor, on which images have been stored at radiation exposure sites or stations are collected to an image processing station or center, in which information on the stored images are read out from the thus collected storage panels to be data processed for reproduction as easily recognizable images. It is required for the image processing systems provided in the center to deal with a huge amount of image data for a very short period of processing time. It is therefore advantageous for those image processing systems to execute operations on such unsharp masking during as short period of time as possible. It is therefore an object of the invention to provide an image processing system which is capable of processing unsharp masking on a real time basis in a shortened period of operational time with respect to a large amount of image data. In accordance with the present invention, an image processing system comprises video signal input means for receiving an original video signal S to produce a resultant signal S with respect to a rectanglar area formed by Np scanning lines each including M The object of the present invention is achieved by the image processing system as described above further comprising the features as set out in the characterising clause of claim 1. The other objects and features of the present invention will become mare apparent from a consideration of the following detailed description taken in conjunction with the accompanying drawings in which The inventors found that in the operations in accordance with formulae 3 , 4 and 5 , it takes as much time for operations of summing the original video signals with respect to the entire pixels involved in a rectangular area, namely, or as for that of the remaining portions of the formulae 3 , 4 and 5 . This can be seen from the following table I showing an example of operational periods of time during which addition operations with respect to an unsharp masking were executed by a bit slice type microprocessor in which it takes one microsecond for reading writing and addressing a storage location, .3 microsecond for addition and subtraction each, .9 microsecond for multiplication, and 3 microsecond for division. In Table II, operational periods of time for emphasis and gradiation processing with respect to β and γ are also shown. Additionally, the microprocessor used had a storage including a table which defines an emphasizing function β and a nonlinear function for gradiation conversion γ. It should be noted that the period of two microseconds required for transferring data was specific for the system in accordance with the present invention. As clear from those tables, it takes comparable periods of time for executing the additions with respect to the unsharp masking and for processing emphasis and gradiation. To the respective operations, a small period of time is inpractice added which is necessary for error control, periphery processing of a frame, and timing control between the image reader and the image recorder. In any case, however, it took 25 30 microseconds for image processing per unit pixel. Thus, taking account of those resultant values, the inventors developed an image processing system which could execute operations on such unsharp masking during as short a period of time as possible. Referring to FIG. 1, an image processing system in accordance with the present invention includes an image reader 10 for sensing an image under processing, or original image, which may be a radiation image of an object to be inspected, stored in a sheet of stimulable phosphor in the form of distributions of radiation energy, for example. Although the description will be made on an illustrative embodiment directed to radiation image processing, images which can be dealt with in accordance with the invention may be in any form of images, having gray scales such as of remotely sensed images. In an exemplary radiation photography system employing stimulable phosphor as an intermediate or temporary image storage, reader 10 senses an original image stored in a stimulable phosphor sheet under page scanning in a raster fashion with an illuminating stimulative light beam to produce time serial video signals on its output 12. Output 12 from image reader 10 is interconnected to a first processor system 100, which may be a microcomputer. Processor system 100 performs operations on the additions or included in the term of the expressions 3 4 and 5 for an unsharp masking process with respect to an unsharp mask, which is one of rectangular areas of an image under processing. First processor system 100 is interconnected to a second processor system 200 by a connecting device 300, which may include a common bus system for coupling data buses and control lines between both of processor systems 100 and 200, for example. Second processor system 200, which also may be a microcomputer, receives the results from the additions performed in first processor system 100 together with the original video signals S Second processor system 200 has an output 14 interconnected to an image recorder 16. Second processor system 200 produces operational results from output 14, in response to which image recorder 16 will reproduce a visual image on a recording medium as a hard copy of the processed image. In FIG. 2, there is shown an embodiment of an image processing system which is implemented by a couple of microprocessors. In the figure, the like components are designated by the same reference numerals as in FIG. 1. With reference to FIG. 2, first processor system 100 includes a processing unit µP 102, and a local memory unit LM 104 having a random access memory RAM and a read only memory ROM , etc. Processing unit 102 and local memory 104 are interconnected to a data bus 106, to which the aforementioned image reader 10 is interconnected together with an input output device I O 108, such as a keyboard and a display unit. Second processor system 200 may be substantially of the same system configuration as first processor system 100, and the corresponding elements are designated by reference numerals having a two handredth digit with the tenth and unit digits thereof corresponding to those of first processor system 100. It will be appreciated that to a data bus 206 of processor system 200 interconnected is image recording unit 16, instead of image reader 10 in first processor system 100. For simplicity of illustration, control connections between the elements are omitted from the figure. Data bus 106 of first processor system 100 is connected to a common bus system 304 via a bus interface BIF 302, which controls over interference and hogging which would otherwise occur between the bus systems. Similarly, data bus 206 of second processor system 200 is also connected to common bus system 304 via another bus interface 306. In the illustrative embodiment, a common memory unit CM 310 is also coupled to common bus 304 by means of a memory control MC 308, which controls over interference and hogging between the storage units. Common memory 310 is accessible by either of processor systems 100 and 200 to temporarily store therein the operational results obtained from first processor system 100, which results thus stored in locations of storage 310 can be fetched by second processor system 200. In the system shown in FIG. 2, transfer of data from first processor system 100 to second processor system 200 is made by means of common storage 310 and the associated circuits therewith. However, other techniques for transferring data between processors are of course applicable to the image processing system. For example, both processor systems 100 and 200 may be adapted to communicate directly with each other between bus interfaces 302 and 306 without using common storage 310. Processor 102 of first processor system 100 controls image reader 10 to scan and sample all pixels, for example M N pixels, involved in an unsharp masking on an image to be inspected, in a raster scanning fashion to form original video signals S as well as the original video signals S Processor 202 of second processor system 200 reads out the operational results together with the original video signals S Description has been made on an illustrative embodiment performing unsharp masking operations by an averaging by simple addition in accordance with expressions 3 4 and 5 . More generally, however, the present invention is also applicable to unsharp masking operations by means of averaging by weighted addition with respect to a plurality of masks of different sizes at a position of an original image. As shown in FIG. 4, for example, assume P similar, rectangular areas or masks 500 1, 500 2, ..., 500 P including N₁, N₂, ..., N where α In accordance with expression 8 , addition or accumulation of the original video signals S with respect to each of masks 500 1, 500 2, ..., 500 P, which will then be multiplied with a weight α In the illustrative embodiment described with reference to FIGS. 1 and 2, an unsharp masking in accordance with the expression 8 proceeds along the following process. First processor system 100 executes P times the additions defined by the term in the expression 8 . That is, the accumulation of the original video signals S More specifically, with reference to FIGS. 5A and 5B, showing examples of control flows performing the operations in accordance with equation 8 by first and second processor systems 100 and 200, respectively, first processor 102 firstly sets the first unsharp mask box 600, FIG. 5A , and also sets By the way, the second processor 202 receives the data ΣS The image processing system in accordance with the present invention thus includes a couple of processor systems which are interconnected in cascades logically to each other. The one processor system in the former stage performs additions of pixel data with respect to unsharp masks to transfer the data resultant from the additions to the other processor system in the latter stage. While the one processor system in the preceding stage performs the additions of the pixel data on the subsequent unsharp mask, the other processor system in the latter stage executes the remaining operations on the previous unsharp mask using the resultant data transferred from the one processor system. Addition or accumulation of original video signals with respect to unsharp masks performed in the one processor system is comparable in time with emphasis and gradiation control performed in the other processor system, as recalled from the previous discussion. The operational burden in the unsharp masking process will be shared by those two processing systems, giving rise to increase in the operational speed in the total system. The image processing system may therefore be adapted to process the unsharp masking on a real time basis in response to reading pixel data associated with respective unsharp masks over an image to be processed, so as to reproduce a visual copy of the thus processed image on a real time basis. In the case of the example described above, the addition on unsharp masking, and emphasis and gradiation control were executed in the period of 13 15 microseconds per unit pixel, which is approximately twice as much in operational speed as in the case of the prior art, single processor system. In the case of averaging by weighted addition for unsharp masking operation, the operational period of time per unit pixel is approximately P times as much as in the case of the averaging by simple addition, if the number P of masks is not significantly large. In comparison with the prior art system, however, the operational time is improved about half as much. In the illustrative embodiment, the two processor systems share the burden of unsharp masking processing between accumulation of pixel data and operations on the remaining operations. This share is convenient in understanding logical construction, particularly in software configuration between the two systems of processing units, resulting in facilitating program sequencies therefor to be manufactured and modified. While there has been described and shown above an illustrative embodiment of the present invention, it will be appreciated that the invention is applicable to other types of images having gray scales, such as remotely sensed images, in addition to X ray photography. Also in addition to real time image processing as described above with reference to the illustrative embodiment, it is advantageously applicable to images stored in the form of digital data in a large capacity storage medium, such as magnetic disk.