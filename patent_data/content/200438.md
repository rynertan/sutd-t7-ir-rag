# DIGITAL READING DEVICE FOR FACSIMILE APPARATUS

## Claims
Farbbildlesevorrichtung mit Kompensation von Ungleichförmigkeit des Fotosensorsystems, aufweisend eine Lichtquelle 14 zum Beleuchten eines das zu lesende Bild tragenden Dokuments, einer Richtungseinrichtung 17, 19, 21, 22 zum Richten eines Streifens des so beleuchteten Bildes auf eine Serie von Leseelementen 23 , um eine Folge von Antwortsignalen ansprechend auf eine Folge von Pixeln entlang des Streifens zu erzeugen, wobei die Richtungseinrichtung zumindest einen Spiegel 17, 19, 21 und ein Objektiv 22 umfaßt und die Serie von Leseelementen 23 eine Serie von Zellen eines Ladungsspeicherelements CCD umfaßt, einen A D Wandler 28 , der die Antwortsignale zur Lieferung entsprechender digitaler Signale bearbeitet, eine Speichereinrichtung 31 zum zeitweisen Speichern der digitalen Signale, die vom Wandler in einer vorab erfolgenden Lesung eines kalibrierten Hintergrund Probestreifens 29 gewonnen werden, eine Nur Lese Speichereinrichtung 32 , die sequentiell für jedes Bildpixel durch beide, die digitalen, vom Wandler beim Lesen eines Streifens des Dokumentenbildes gelieferten Signale und die entsprechenden in der Speichereinrichtung gespeicherten, digitalen Signale adressierbar ist, um Ausgangssignale zu liefern, die hinsichtlich Änderungen der Übertragungsfunktionen der Lichtquelle 14 , des r Spiegel 17, 19, 21 , des Objektivs 22 und des CCD s kompensierte Pixel darstellen, gekennzeichnet durch eine Anzahl Filter 24 , die zur Einfügung zwischen dem Bild und dem CCD selektierbar sind, um das CCD dazu zu veranlassen, sequentiell eine Folge von einem jeden der Filter zugeordneten digitalen Signalen in der vorab erfolgenden Lesung zur Speicherung in der Speichereinrichtung zu erzeugen, und daß die Nur Lese Speichereinrichtung 32 eine dieser Anzahl von Filtern 24 entsprechende Anzahl von Abschnitten umfaßt, wobei jeder Abschnitt für jedes Bildpixel durch die digitalen Signale, die in einem Lesen eines Streifens dieses Bildes durch das zugeordnete Filter gewonnen wurden, und die entsprechenden digitalen Signale, die in der Speichereinrichtung 31 gespeichert sind, gemeinsam adressiert wird, wobei jeder Abschnitt der Nur Lese Speichereinrichtung 32 Ausgangssignale liefert, die entsprechend den zugeordneten Filtern unterschiedlich kompensierte Pixel repräsentieren.

## Description
The present invention refers to a digital reading device for facsimile apparatus, as defined in the preamble of claim 1. In known apparatus of the aforesaid type, a given pixel of an image generates a signal whose intensity depends on the position along the image line of the original image point in the document, because of the different effect along the line of the means for directing the image on to the reading elements, the state of the illumination lamps, the variation in the time of response of the individual reading elements and the different response by one reading element to the other see for example JP A 59 153 377 . The object of the invention is to provide a reading device in which the amplitude of the reading signal is compensated, eliminating the effect of the variations in response of the said elements to a pixel of determined intensity due to decay of response through time and variation with position. The object problem is met by the device according to the invention, defined by the characterising part of claim 1. The invention will be described in more detail, by way of example, with reference to the accompanying drawings, in which Fig 1 is a section of a schematic representation of a facsimile apparatus, incorporating a digital reading device embodying the invention. Fig 2 is a plan of the apparatus along the line II II of Fig 1 and Fig 3 is a block diagram of the circuit for generating the signals of the reading device. With reference to Fig 1, a transparent support plate 10 for a document 11 Fig 2 to be read is fixed and is covered with a hinged cover 12 Fig 1 , suitable for holding the document 11 against the plate 10. Adjacent to the cover 12 is placed a keyboard 13 for control of the digital reader. This includes two fluorescent lamps 14, carried by a first carriage 16 moving transversely to explore the whole length of the document. The lamps 14 are selected in such a way as to supply collectively a substantially constant distribution of spectral energy versus wavelength in the field of vision. As an example two lamps of the company Toshiba have been selected, one lamp 14 being of blue colour and the other of white colour with cold light, designated EDCW by Toshiba. The carriage 16 carries a mirror 17 inclined at 45 , so as to reflect the image of the elementary line of the document in a plane parallel to the document itself, as indicated by the broken line in Fig 1. The reader comprises also a second carriage 18 carrying a pair of mirrors 19 and 21 inclined 45 in opposite directions, so as to reflect the optical beam 180 towards an objective 22. This focuses the beam on to a series of reading elements constituted by cells of a charge coupled device 23 CCD . In order to allow the reading of images in colour, the optical beam can be filtered by a colour filter selected from a number of filters carried by a disc 24. This can be rotated by a stepping electric motor 26 in order to select from one time to the next the required filter. In particular the disc 24 comprises position without a filter for reading in black and white and three positions with red, green and blue filters for the reading of the respective colours. The cells of the CCD 23 are so spaced that each element can receive the light reflected by a small area of the document, called a pixel. The number of pixels per mm, generally between 3 and 12, determines the horizontal resolution of the reading device. The number of lines per mm read on the document on the other hand determines the vertical resolution of the reader. As an example the device may comprises a CCD 23 with 2048 cells, by means of which a 210 mm line is read with a resolution of 10 points mm. As is known, the cells of the CCD 23 generate electrical signals corresponding to the intensity of light received, which after being serialized and then filtered and amplified by a circuit 27 Fig 3 are sent to an analogue digital converter 28 having for example a resolution of 6 bits, through which 64 levels of amplitude of reading signal can be identified. In particular the converter 28 is of the fast type, known as a flash A D converter. The digital signals can be coded, transmitted, stored and or reproduced on paper. The ideal conditions for a correct reading would require a light source 14 Fig 1 which is homogeneous along the line, an objective 22 devoid of losses at the edges, a constant reflectance of the mirrors 17, 19 and 21 and a perfect homogeneity of response of the different cells of the CCD 23. In reality the effect of the CCD 23 on a document of A4 format, with an objective 22 of 50 mm and a 2.8 f aperture, reduces by half the response signal at the edges of the line compared with the response which the same pixel would give at the centre of the line. With an aperture of 5.6 the reduction of the edges is about 30 , and in combination with the reduction due to dirty lamps about 50 . The non homogeneity of the cells of the CCD 23 can lead to a variation of the signal of 10 , while dust deposition on the mirrors 17, 19 and 21 and the ageing of the lamps 14 cause variations in time, although these variations are homogeneous along the length of the line . According to the preferred embodiment of the invention on the plate 10 Fig 2 , in a position adjacent to the upper edge of the document 11, there is fixed a sample strip 29 of white colour, which constitutes the calibrated background of the original and is suitable for being read by the CCD 23 as a sample line before every reading of the document 11. The reading device comprises a read write memory RAM 31 Fig 3 , to store the signals obtained in a preliminary reading of the sample strip 29, and means for comparison comprising a programmable read only memory EPROM 32 to compare the reading signals of the individual elementary lines of the document 11 with the signals stored in the RAM 31. Therefore the RAM 31 has a capacity of at least 2X6K bits. The reading device comprises a central processing unit CPU 33 with a microprocessor, which when it receives a command for reading the document 11, generated by the keyboard 13, executes a programme recorded in a read only memory ROM 34. The CPU 33 controls a circuit 36 for controlling the CCD 23, via a logic signal EXP corresponding to the duration of the enablement of the CCD for reading the document. In particular the circuit 36, in response to the logic signal EXP, generates an analogue signal ØX, which determines the duration of the enablement of the CCD 23, and a timing signal ØT, which determines the serialisation of the signals generated by the CCD 23, to be sent to the circuit 27. The circuit 36 also generates a logic signal LN at every elementary line read and a logic signal CK at every pixel signal sent by the CCD 23 to the circuit 27. These two signals are sent to a counter 37, whose capacity is equal to the number of cells of the CCD 23 and hence to the number of pixels of an elementary line. The counter 37 thus indicates the position of the pixel whose signal is sent to the circuit 27. The output of the counter 37 addresses the successive locations of the RAM 31 in which the signals provided by the converter 28 are to be written or from which the signals stored there are to be read. The CPU 33 also generates, at the beginning of the reading routine given by the ROM 34, a signal C for a compensation command, which controls a circuit 38 for enablement of writing in the RAM 31. This circuit is further controlled by the signals LN and CK so as to emit the write enable signal WR during the reading of the sample strip 29 Fig 2 . Thus the signals of this reading, emitted by the converter 28 Fig 3 , are recorded in the RAM 31 at the addresses given by the counter 37. On the other hand during the reading of the successive lines of the document 11, the signals emitted by the converter 28 are no longer stored by the RAM 31 and the counter 37 only addresses the cells of RAM 31 for reading from one line to the next. The CPU further provides two signals C1 and C2 indicative of the colour of the filter, according to the following table The signals C1 and C2 control a circuit 39 for selection of the filter this circuit controls the rotation of the stepping motor 26 Fig 1 in a manner known per se. The EPROM 32 Fig 3 is constituted by four modules associated with the four colours defined before. The four modules are addressed in parallel with 12 bits, six of which are supplied by the converter 28 in the direct reading of each pixel of the lines of the document 11, while the other six are supplied by the reading of the RAM 31 at the address given by the counter 37, whereby these represent the signals given by the converter 28 in the reading of the corresponding pixel of the sample line. In each module of the EPROM 32, at each address there is recorded in advance a 4 bit value proprotional to the ratio between the direct reading signal of a pixel and that recorded in the RAM 31 in the preliminary reading of the corresponding pixel of the sample strip 29. In particular the value recorded in the EPROM 32 is obtained by multiplying a number equal to the desired level number for the amplitude of the reading signal by the ratio between the value of the direct reading expressed by the six address bits supplied by the converter 28 and the value of the preliminary reading expressed by the six address bits supplied by the RAM 31. By recording this 4 bit value in the EPROM 32, it is possible to obtain directly the values of 16 levels of amplitude of the signal of the pixel read in the line of the document, basically compared with the signal of the pixel read in the sample line. In other words on each module of the EPROM 32 there is constructed a true andd proper table of compensated values of reflectance compared with an address formed by six pre stored bits in the RAM 31 and by six bits relating to the immediate reading of the pixels of the document. These values represent therefore the signals of the pixels compensated in amplitude for all the deteriorations of these occurring with time and with transverse location, through non homogeneity of the lighting of the original, through dust deposition on the mirrors, through loss at the edges of the objective and through the non homogeneity of the cells of the CCD. The four modules of the EPROM 32 permit the adoption of different compensations for the three primary colours and for black. The values thus address on the four modules of the EPROM 32 are sent to a multiplexer 41, which under the control of the two signals C1 and C2 sends to a circuit 42 for coding greys of half tones only those relating to the colour selected by these signals. The circuit 42 is also organised in four modules, one for each colour, selectable by the same signals C1 and C2. For each value given by the four bits of the multiplexer 41, the circuit 42 selects a corresponding sequence of bits indicative of the white and coloured points, to represent the corresponding value of the half tone, in a manner in itself known. The signals generated by the circuit 42 are then parallelised by a paralleliser 43 and are stored in a line buffer 44, under the control of an enablement signal DS emitted by the CPU 33 only when the scanning of the document 11 is effected. From the buffer 44 the stored signals are then taken for compression and subsequent storage in a mass or transmission memory to a distant station, or for controlling a device for reproduction of the image read. It must be noted that during the reading of the sample line the EPROM 32 also supplies the four bits recorded at the address represented by two equal groups of six bits. Since, however, the CPU 33 does not emit the signal DS, these values are not stored in the buffer 44. The programme recorded in the ROM 34 comprises a routine for reading in black and white and a routine for reading in colour. The two routines are selected by means of the keyboard 13. The routine for reading in black and white makes the device execute a single reading cycle, in which the corresponding white position of the filter 24 is selected. At the beginning the sample line 29 Fig 2 is read, which is stored in the RAM 31 Fig 3 . Immediately afterwards the lines of the document 11 are read one after the other, whose values are compensated in amplitude by the B W module in the EPROM 32. The routine for reading in colour on the other hand makes the device execute three successive cycles of reading of the document 11, making the CPU 33 generate successively the values of the signals C1 and C2 which indicate red, green and blue. For each colour the device, by means of the circuit 39, first selects the corresponding filter of the disc 24 Fig 2 . Then it reads with this filter the sample line 29, storing the signals in the RAM 31 Fig 3 . Finally it reads with the same filter the successive lines of the document 11 and, by means of the appropriate module of the EPROM 32, it suppleis the reading signals of the corresponding colour, compensated in amplitude. It is understood that the device described can have various modifications and improvements made to it within the scope of the claims. For example the EPROM 32 can be replaced by a ROM or by any circuit suitable for supplying in output numerical or analogue values, as a function of the result of the comparison between the signals obtained in the reading of the sample line and those obtained in the direct reading of the lines of the document. Furthermore, the value recorded corresponding to each address of the compensation memory EPROM or ROM can be multiplied by a factor K which takes account of the particular use of the signal, for example for a video or for a print out according to a specific technology. In that case, whenever the utilisation of the signals of the device is changed, it is necessary to replace the compensation memory. In particular the device can be fitted with a number of compensation memories, automatically selectable as a function of the use of the signal chosen from time to time.