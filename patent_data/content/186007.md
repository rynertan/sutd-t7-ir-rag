# Apparatus, method, and structure for translating a document having one structure into a document having another structure

## Claims
Dokument Zwischenstruktur 307 zur Darstellung einer ersten Dokumentstruktur 305 , die für ein zwischen Dokumentenverarbeitungssystemen 301, 303, 313 auszutauschendes Dokument repräsentativ ist, bei der die Dokument Zwischenstruktur für den Dokumentenaustausch die logischen Beziehungen zwischen den Komponenten des Dokuments darstellt und umfaßt

## Description
The present invention relates to structures used for documents in data and word processing systems and more particularly to apparatus, methods, systems, and structures used to translate a document having one structure into an equivalent document having another structure. Documents may be written and processed using many different kinds of data processing or word processing systems. Documents processed using a given system have a document structure specific to that system. Thus, if a document is to be processed first on one system and then on another, it must be translated from a document having the structure required for the first system into a document having the structure required for the second system. In the prior art, translation from one structure to another was accomplished by writing a translation program specific to the two structures. The consequences of this approach are shown in prior art Figure 1. In that Figure, there are represented four versions of a document, version 101 having structure A, version 103 having structure B, version 105 having structure C, and version 107 having structure D. Six programs, represented by the boxes labelled 109, 111, 113, 115, 117, and 119, are necessary to permit translation of a version having any one of the structures into a version having any of the other structures. As further structures are added, the number of translation programs required increases disproportionately, If all translations may be made in either direction, the number of translation programs N required for a number of structures n is expressed by N n 1 n 2 .. n n 1 . Moreover, in order to write each of the translation programs, a detailed knowledge of both document structures is required. That requirement is disadvantageous in two respects. First if translation programs are to be provided for any considerably number of structures, the programmer must spend a great deal of time studying the structures. Second, where one of the document structures is confidential and proprietary to one manufacturer and the other is confidential and proprietary to another, the knowledge required to write a translation program for the structures may be unobtainable. US A 4 156 909 describes a data driven multiprocessor computer. Characters are used to define a start and end of a particular data field. Data structures are organized into data files, and the structure and organization of a file is described by the contents of a first field of the file. However, a program or process is carried out in response to the linking up of pairs of data files, each pair having one data file containing part of the program, and the other data file containing the operands for that part of the program. The above mentioned shortcomings are not avoided. From EP A 0109614 a document transformations are known. However, the proposed approach is a state machine driven process that takes input from a source document form and transforms the input in accordance with predefined, rule based, state transition diagrams into an explicit target document form. Again, a programmer must be aware of both the source and target document structures and the target document structure might be unobtainable. The claimed invention solves the problem just described by providing an intermediate document structure for use in document translation. As shown in Figure 2, translation from a document having a first structure into a document having a second structure is accomplished by translating the document having the first structure into a document having an intermediate structure and then translating the document having the intermediate structure into a document having the second structure. Thus, Version 101 of the document is translated into Version 103 of the document by using A I translator 203 to translate Version 101 into Version 201 having the intermediate structure and then using B I translator 207 to translate Version 201 into Version 103. As may be seen from Figure 2, when translation is done via a Version 201 having the intermediate structure, only as many translation programs are required as there are document structures other than the intermediate structure. Thus, for the four structures A, B, C, and D represented in Figure 2, 4 programs, A I translator 203, C I translator 205, B I translator 207, and D l translator 209, are required instead of the 6 programs of the prior art. Since the number of programs required in the prior art increases disproportionately as the number of document structures increases, the present invention is particularly advantageous when a large number of different document structures must be dealt with. Further advantages of the present invention stem from the fact that each program translates between a single structure and the intermediate structure. Thus, a programmer writing a translation program need only understand two structures the one he is immediately concemed with and the intermediate structure. Moreover, since translation between confidential document structures can be achieved by translating from the first confidential structure to the intermediate structure and then from the intermediate structure to the second confidential structure, there is no need to disclose confidential structures as long as all programmers know and understand the intermediate structure. The present invention is particularly valuable when a number of word or data processing systems utilizing different document structures are connected by means of a network. In the absence of an intermediate structure, a variety of document structures must be transferred over the network when an intermediate structure is available, all documents may be translated into the intermediate structure before being placed on the network, and the network need only deal with the intermediate structure. The intermediate structure used in the invention has a sequential structure, i.e, one in which the logical relationships of the components of the document to one another are represented by the locations of the components relative to each other in the document structure. Because the structure is sequential, there is no need for a translation of a document into the intermediate structure to be complete before translation from the intermediate structure into the target structure begins. Thus, in a network, the intermediate structure may be transmitted over the network as it is produced and translated into the target structure as it is received. The following description of a preferred embodiment first describes implementations of the invention in a single stand alone document processing system and in a network of document processing systems. Thereupon, it describes a preferred embodiment of the intermediate document structure, and finally, it provides an example of translation between the preferred embodiment of the intermediate document structure and a prior art document structure. A block diagram of a stand alone system for document translation according to the present invention is presented in figure 3. The document translation system shown in that figure is implemented in a standard multi user document processing system such as the Wang Laboratories, Inc. ALLIANCE TM system. Such a document processing system commonly includes at least a mass storage device such as a disk drive for storing documents and document processing programs, a processor for processing documents, and local storage used by the processor to store data and programs while processing a document. In figure 3, these components are represented as document and program Storage 303, processor 301, and processor local memory 313. Under control of a program, processor 301 may fetch data and programs from document and program storage 303 to local memory 313, may execute the programs and process the data in local memory as specified by the programs, and may store processed data in storage 303. Other components of the system, not important for the present discussion and therefore not shown in figure 3, may include terminals for the users and means for reading and writing floppy disks. Translation is necessary in a document processing system of the type shown in figure 3 when a user of the system wishes to process a document having a document structure different from that used in the document processing system. Such a situation may arise when the user has a copy of the document on a floppy disk made by a different document processing system. In this case, the document must be read from the floppy into storage 303 and then translated into the proper form before further processing is possible. Translation using an intermediate structure takes place in two steps from the first document structure to the intermediate structure and from the intermediate structure to the second document structure. Figure 3 shows the document processing system while executing the first step. Storage 303 contains document with structure A 305, document with intermediate structure 1 307, and two programs A I extraction program 309 and I B composition program 311. Program 309 is termed an extraction program because it extracts information from a document having structure A and produces a document containing the same information and having intermediate structure I. Program 311 is termed a composition program because it composes a document having structure B from the information contained in the document having structure I. During the first step, processor local memory 313 contains four buffers, i.e., areas of memory in which data and programs relevant to the translation operation are stored during the translation operation. A buffer 315 contains the portion of document 305 which is currently being translated into the intermediate structure I buffer 317 contains the result of the translation of the contents of A buffer 315 into the intermediate structure state buffer 319 contains data which indicates the current state of the translation operation code buffer 321, finally, contains the code from program 309 which processor 301 is currently executing. During translation from structure A to structure I, the system operates as follows for each portion of document A 305 being translated, processor 301 moves the components of document A s structure containing the portion from storage 303 into A buffer 315. Processor 301 then begins translating the contents of A buffer 315 under control of code from program 309. If code other than what is presently in code buffer 321 is required to perform the translation, that code is copied from program 309 into code buffer 321. As processor 301 translates, it places the result in I buffer 317. When I buffer 317 is full, it is copied to document 1 307 similarly, when a portion of document 305 which is not presently contained in A buffer 315 is required, the required portion of document A 305 is copied from storage 303 to A buffer 315. Variations on the above implementation of the invention will be immediately apparent to one skilled in the art. For example, document processing systems of the kind typified by the ALLIANCE generally have relatively small memories 313 consequently, the buffers 315, 317, and 321 will not be large and transfers between storage 303 and these buffers will frequently occur. When implemented in a system such as a general purpose data processing system with large local memory, the buffers may be large enough to accept an entire document and all of code 309, and transfers between storage 303 and local memory 313 may occur only at the beginning and end of the translation operation. Large systems may also include means for permitting direct transfer of data between storage 303 and memory 313 in such systems, data would be transferred between document 305 and document 307 and buffers 315 and 317 and code from program 309 to buffer 321 without the direct intervention of processor 301. Further, in a multiprogramming system, state buffer 319 may contain state permitting interruption and resumption of a processing operation. The second step is analogous to the first. Figure 4 shows the document processing system during this step. The documents involved are the document with structure 1 307 which resulted from the first step and a document with structure B which is to be the result of the second step. The program involved is I B composition program 311. The buffers are I buffer 317, state buffer 319, code buffer 321, and B buffer 403, which contains data destined for document 401. Code buffer 321 contains code from I B composition program 311. During the translation operation, processor 301 under control of I B composition program 311 reads a portion of document 307 into I buffer 317, translates the contents of I buffer 317 into structure B, and places the result in B buffer 403. When B buffer 403 is full, its contents are written to document 401. Portions of program 311 are copied to code buffer 321 as required to perform the translation operation. If the document processing system must deal with documents having structures other than structure A, then there must be a program analogous to A I extraction program 309 for every structure which the document processing system must deal with. Of course, the number of such programs is reduced if all document processing systems adopt the convention that documents on floppy disks are in the intermediate structure. In that case, only two programs are required I B composition program 311 and a B I extraction program for translating documents having the B structure into ones having the I structure. The situation in a networked system in which all documents which are transferred via the network have the intermediate structure is similar to the one which arises when all documents on floppy disks have the intermediate structure. As shown in Figure 5, each of the systems in the network must have a composition program for translating documents from the intermediate structure into the structure used in the system and an extraction program for translating documents from the structure used in the system to the intermediate structure. Network 505 of Figure 5 connects two systems, system 501 using structure A and system 503 using structure B. Each system has storage 303, processor 301, and memory 313. System 501 further has A I extraction program 309 and I A composition program 507, while system 503 has I B composition program 311 and B I extraction program 509. Figure 5 shows systems 501 and 503 as they would be set up in the course of a transfer of a document from system 501 to system 503. System 501 first operates under control of A I extraction program 309 to translate document with structure A 305 into document with structure 1 307 in the manner previously described. When the translation is finished, document with structure 1 307 is sent via network 505 from system 501 s storage 303 to the equivalent storage in system 503. System 503 then operates under control of I B composition program 311 to translate document 307 into document with structure B 401. In a transfer of a document from system 503 to system 501, the reverse of the above occurs. System 503, operating under control of B I extraction program 509, translates a document having structure B into its equivalent having structure I. That document is then sent via network 505 to system 501 which, operating under control of I A composition program 507, translates the document with structure I into one with structure A. Since all of the documents transferred via network 505 have the intermediate structure I, a given system attached to the network need only have an extraction program for translating the system s document structure into the intermediate structure and a composition program for translating the intermediate structure into the system s document structure. Thus, regardless of the number of kinds of document structures used by systems attached to the network, a given system need only have two translation programs. In the preceding discussion, it has been presumed that each step in the translation process translated an entire document. However, in embodiments of the invention in which the intermediate document structure is sequential, it is possible to translate from the first structure to the intermediate structure to the second structure in a continuous process in which the document having the intermediate structure is translated into one having the second structure as fast as the document having the intermediate structure is produced. In the stand alone system of figures 3 and 4, the two steps in the translation can be carried out by separate processes, one executing the extraction program and the other the composition program. In such a system there is no need for a separate document with the intermediate structure instead, as A I extraction program 309 executed by the first process outputs to I buffer 317, I B composition program 311 executed by the second process reads from buffer 317 and outputs to buffer 403. When that buffer is full, program 311 outputs to document with structure B 401. In the networked system of figure 5, A I extraction program 309 executing in system 501 may output from buffer 317 directly to network 505, and I B composition program 311 executing in system 501 may place data received over network 505 directly into buffer 317. Again, there is no need for a document with the intermediate structure in storage 303 of either system 501 or system 503. Which of the possible implementations is employed in a given system depends on the characteristics of the system. For example, in a system in which speed of transfer across network 505 is not a limiting factor, or one in which the size of storage 303 is, the document with the intermediate structure may be output directly to network 505. If, on the other hand, the speed of transfer is a limiting factor or the size of storage 303 is not, the document with the intermediate structure may be output to storage 303 and from there to the network. As previously indicated, the intermediate document structure in a preferred embodiment is sequential, i.e, the logical relationships between the components of the document are represented by the locations relative to each other of the components in the document structure. The intermediate document structure of a preferred embodiment is further distinguished by the fact that components of the document which are dependent from other components are nested within the components from which they are dependent. Both of these characteristics may be seen in figure 6, which shows parts of the intermediate document structure for a simple document. Figure 6 represents a single sequence of data. Thus, the points indicated by A A in the first and second lines of the figure are the same. Wavy lines indicate that the document structure includes material between the wavy lines which has been omitted. The major component of the embodiment of the intermediate structure shown in figure 6 is the In a preferred embodiment, the beginning of each segment is represented by a segment start code and a segment type code indicating the type of the segment, and the end of each segment is represented by a segment end code and the segment type code for the segment. In Figure 6, the segment which contains all of the other components of the document has the stream type. The start of the segment is marked by start of segment SOS 605, which contains start segment code SSC 601 and segment type code STC 603 indicating the stream type. The end of the stream segment is marked by the end of segment EOS 641 in Figure 6. EOS 641 for the stream segment contains end segment code ESC 637 and a repetition of STC 603 indicating the stream type. The stream segment contains a descriptor and a segment of the text type. The descriptor contains administrative information about the document. Examples of such information include the name of the person who created the document, the name of the person who typed the document, the document s title, a description of its contents, and the document s classification, for example letter or memo. The descriptor begins with start of descriptor SOD 611 and ends with end of descriptor EOD 617. SOD 611 contains start descriptor code SDC 607 and descriptor type code DTC 609 identifying the descriptor type, and EOD 617 contains end descriptor code EDC 615 and a repetition of DTC 609. The area between SOD 611 and EOD 617 contains descriptor contents DC 613. In a preferred embodiment, all descriptors belonging to a segment must immediately follow that segment s SOS 605. Descriptors may not overlap and DC 613 may not contain a segment or another descriptor. Segments of text type contain the sequence of character or numeric codes which makes up the document and may also contain control specifiers, attributes, descriptors and other segments. SOS 605 for the text segment of figure 6 contains SSC 601 and STC 619 specifying the text type, and EOS 639 for the text segment contains ESC 637 and STC 619 for the text type. The sequence of character or numeric codes in the text segment is represented by text codes TC 621. The text segment of figure 6 also contains an attribute and a control specifier. The attribute is a revision attribute which indicates that a sequence of characters has been revised. The attribute begins with start of attribute SOA 627 and ends with end of attribute EOA 635. In a preferred embodiment, SOA 627 contains start attribute code SAC 623 and an attribute type code ATC , which indicates the type of the attribute. Here, ATC 625 indicates the revision attribute. EOA 635 contains end attribute code EAC 633 and ATC 625. The attribute applies to all of the characters represented by the character codes occurring between SOA 627 and EOA 635. The actual effect of the attribute depends on the document structure of the document which is finally produced from the intermediate document structure. For example, in some documents, a bar may appear in the margin next to the text represented by the character codes to which the attribute applies. In others, the attribute may have no meaning and will be ignored in the translation process. As will be explained in more detail later, attributes may overlap or be nested within a segment, but may not extend across segment boundaries. All descriptors applying to an attribute immediately follow SOA 627 for the attribute. Control specifier CTL 630 in the text segment of figure 6 specifies a page break at the point in the sequence of character codes at which CTL 630 occurs. CTL 630 consists of two parts control code CC 629 indicating a control specifier, and control type code CTC 631 indicating the kind of control specifier. CTC 631 in figure 6 is for a page break. Other CTC codes may specify line breaks, tabs, indentations, and similar text formatting functions. A CTL 630 may be immediately followed by one or more descriptors further describing the formatting operation specified by CTL 630. In a present embodiment, SSC 601, ESC 637, SDC 607, EDC 615, SAC 623, EAC 633, and CC 629 are distinct arbitrary 8 bit codes the type codes indicated by STC 603, DTC 609, ATC 625, and CTC 631 are distinct arbitrary 16 bit codes. In other embodiments, the codes may have different lengths. The character codes may belong to a set of character codes such as the ASCII, EBCDIC, or Wang Laboratories, Inc. s WISCII character code set or code sets such as those for Prestel terminals. The numeric codes may include codes used to represent fixed decimal values or floating point values. Other types of segments may have other kinds of codes representing the information they contain. In a present embodiment of the text segment, confusion between the codes used to define segments, descriptors, attributes, and control specifiers and the codes used to represent data is avoided by means of a unique eight bit identity code which specifies that the preceding eight bits are not to be interpreted as one of the codes which marks the beginning or end of a segment, attribute, descriptor, or control specifier, but instead as a data code. This technique is illustrated In Figure 7, where TC 621 in the third portion of the segment shown in the figure contains a character code identical with SSC 601. That character code is followed by identity code IDC 707, which prevents the code from being interpreted as the start of a segment. Variations of the technique just described may be employed in other embodiments. For example, the order of the code identifying the component and the code identifying the component type may be reversed and the identity code may indicate that a following code is not to be interpreted as a type code. An advantage of the intermediate document structure of the present invention is its adaptability. In a present embodiment, a document has five kinds of components segments, descriptors, attributes, control specifiers, and data codes. However, segments, descriptors, attributes, and control specifiers are identified by means of 8 bit codes, and consequently, new kinds of components may be added without changing the basic nature of the document structure. The same is true with regard to new types of segments, attributes, descriptors, and control specifiers. The types of these components are specified by 16 bit codes, and thus, it is possible to have up to 2 16 different types of segments and the same number of types for the attributes, the descriptors, and the control specifiers. Such adaptability of the intermediate structure is required to deal with the progress of document processing technology. For example, originally, documents were composed only of text however, as the technology of document processing has expanded, documents have come to include images and voice data, and the present invention includes segment types for voice data and images and for the the binary data representing a voice signal or an image. As other items are included in documents, corresponding segment types may be added to the intermediate structure. In a present embodiment, there are 11 segment types Of these types, the text, header, footer, note, footnote, and shelf segments in a present embodiment all represent text sequences, and consequently may contain TCs 621, attributes, and control specifiers. Figure 7, showing a detailed representation of a text segment is exemplary for all of these segment types. The text segment of figure 7 represents text which begins with a title which is centered and underlined and which has been revised. The segment begins with SSC 601 and STC 619 specifying a text segment, contains CC 629 and CTC 702 specifying that the following text is to be centered, SAC 623 and ATC 625 specifying the beginning of a revised section of text, SAC 623 and ATC 703 specifying the beginning of a section of text which is underlined, attribute descriptor 711, specifying that the underline is to be a single underline and including SDC 607, DTC 709 indicating single underline, EDC 615, and DTC 709, TC 621 representing the sequence of characters in the title, EAC 633 and ATC 703 marking the end of the portion to be underlined, two occurrences of CC 629 and CTC 705 return marking the end of the title and a blank line following the title, TC 621 containing the text following the title, EAC 633 and ATC 625 marking the end of the portion of the text which was revised, additional TC 621, and ESC 637 and STC 619 specifying the end of the segment. As previously explained, IDC 707 and SSC 601 in the third line of the figure show how the identity code is used to distinguish data codes from those which indicate the start or end of a component of the document. Figure 7 also shows how, as previously explained, attributes may overlap. In a present embodiment, the text, header, footer, note, footnote, and shelf segment types all have the general form just presented however, the header and footer segment types in a present embodiment may not contain other segments. There is no such restriction for the text, note, footnote, and shelf types. For example, a text segment may include a note or footnote segment, and if the text includes a picture, an image segment and a binary segment representing the image. A segment of the external reference type has as its contents the information required to locate the external reference. For example, if the external reference is to another document, the external reference segment will contain the information which the document processing system requires to locate the other document. In a present embodiment, a binary segment is always preceded by segment specifying how the data contained in the binary segment is to be interpreted. Presently, such interpretive segments are either voice segments or image segments. Other embodiments may of course include other kinds of interpretive segments. Figure 8 presents a detailed representation of one such combination of an interpretive segment with a binary segment. In that figure, the interpretive segment is a voice segment. The voice segment begins with SSC 601 and STC 801 for the voice type and ends with ESC 637 and STC 801 for the voice type. Its contents are the information required to properly interpret the contents of the binary segment. In a present embodiment, the contents of the voice segment include audio data type ADT 803, which specifies the type of audio data contained in the binary segment, V 805, specifying the version of that type, the digitization rate DR 807 for the audio data, and the length of time T 809 represented by the following binary data. The binary segment begins with SSC 601 and STC 811 for the binary type and ends with ESC 637 and STC 811 for the binary type. The contents of the segment include L 813, specifying the length of the data in bytes, and BC 815, containing the binary data codes. The contents of L 813 and BC 815 are interpreted solely as binary data, and consequently, a binary segment in a present embodiment cannot contain other segments, attributes, or control specifiers. The relationship between the image segment and the binary segment containing the image data is substantially the same as that between the voice segment and the binary segment containing the voice data. In a present embodiment, the information used to interpret the image data includes image type, horizontal and vertical size, horizontal and vertical resolution, the encoding scheme, the version of the encoding scheme, the encoding parameter, a code indicating the hardware which was the source of the image, the display format, and the display color. In other embodiments, the binary segment may contain codes representing video images and the image data may include the information needed to produce a video image from those codes. A present embodiment of the invention has 11 attribute types Several of the above attributes may have several variants. For example, in a present embodiment, underscore may specify one or two line underscore and script may specify a superscript or a subscript. As pointed out in the discussion of the text segment and shown in Figure 7, a given variant is specified by means of an attribute descriptor 711 in the attribute. In a present embodiment, there are thirteen types of control specifiers. They are the following As is apparent from the above descriptions, where a control specifier has a number of possible effects on the format of the document, the exact effects are specified by means of descriptors immediately following the control specifier. In some prior art document structures, document components may have character string names. The names may be used in various document processing operations to refer to the components. In a present embodiment of the intermediate document structure, a component s name is represented by a descriptor of the name type. Figure 9 shows how a descriptor of the name type may be used to represent the name of a text shelf segment. The descriptor follows immediately after STC 901 for the shelf and consists of SDC 607, DTC 903 for the name type, a character sequence 905 representing the name, EDC 615, and DTC name 903. The discussion next turns to a specific example of translation between a given document structure and the intermediate structure. There are first presented a document having a document structure of the type presently used in word processing and an equivalent document having the intermediate structure of the present invention. Thereupon, the methods by which the translations are accomplished are discussed. Figure 10 is an illustration of the document structure of the type presently used. The structure is made up of equal sized numbered blocks in a file. The blocks have three different kinds of contents administrative information about the document, indexes by means of which components of the document may be located, and the actual text of the documents. The administrative blocks are at fixed locations in the file. Blocks of other types may be anywhere in the file. Thus, except for the administrative blocks, there is no relationship between the location of a block in the file and its function in the document. Blocks are located in the file by means of pointers specifying block numbers. The pointers may be used to link blocks into chains and to form indexes by which the blocks may be located. The document illustrated in figure 10 contains two pages of text and a named text shelf. Each page has a header and footer, and a portion of the text on one of the pages is underscored. The pages of text are contained in document body chain 1025. Document body chain 1025 consists of text blocks 1002. Each text block 1002 in the chain is linked by means of a pointer to the preceding and following block in the chain. The double linking makes it possible to move easily from one part of the document body to another. The text blocks in the chain have two major components the text portion T and the attribute portion A . T contains character codes for the text of the document, codes representing tabs, indentations, page breaks, and the like, and special codes called attribute characters. The last character in T of each text block is a special etx character code indicating the end of T. In Figure 10, attribute characters appear as AC 1033 and the etx character as etx 1031. The A portion of a text block 1002 contains informational attributes and visual attributes. Each informational attribute corresponds to an attribute character and contains references by means of which other text blocks 1002 containing the information required for the informational attribute may be located. The information applies at the location in the text specified by the attribute character corresponding to the informational attribute. In Figure 10, there are three format attributes FA 1035, each one specifying a format for text and corresponding to an AC 1033 in T of text block 1002 containing FA 1035. The visual attributes specify ranges of characters in the text to which a modification such as underlining or bold face type applies. In Figure 10, there is one visual attribute, VA 1023, specifying which portion of the text is underlined. Document body chain 1025 contains two pages of text. In the document structure of Figure 10, each page must have a FA 1035. The FA 1035 specifies the page s format, any headers or footers for the page, and the fact that the AC 1033 corresponding to the FA 1035 also specifies the location of the beginning of a new page. The format, header, and footer are specified by means of references in FA 1035 to text block chains containing the information required for the format, header, and footer. Thus, FA 1035 in the first block 21 in page 1 1027 has three references, represented by FOR, HR, and FR. FOR refers to the text block 35 containing the page format, HR refers to the text block 12 containing the header, and FR refers to the text block 26 containing the footer. The first text block in page 2 1029 has the same informational attribute as the first text block in page 1 1027. In addition, text block 15 of that page contains VA 1023, the visual attribute indicating the part of the text which is underscored. The chains of text blocks containing the header, footer, and format referred to in FA 1035 are each made up of only 1 block in the present example document. Text block 26 contains footer 1017, text block 12 contains header 1019, and text block 35 contains format 1021. Header 1019 and footer 1017 both have FAs 1035 containing the reference FOR referring to format 1021. Headers, footers, and text thus all share the same format. The final component of the document of figure 10, text shelf 1015, is made up of another chain of text blocks containing 2 blocks, 20 and 30 . The remaining parts of the document structure of Figure 10 are four administrative blocks 1031 containing document info blocks 1001, document table DT 1003, and three index blocks 1033 including name index block NIB 1005, page index block PIB 1007, and reference index block RIB 1009. Document info blocks 1001 include administrative information about the document such as the document s title, creator, subject, size, and so forth. DT 1003 contains pointers to the document s indexes. P10 points to NIB 1005, P16 points to PIB 1007, and P40 points to RIB 1009. DT 1003 is always at a fixed location in the document structure, and consequently, any component of the document can be located by using DT to find the proper index and then using the index to locate the component. The three index blocks correspond to three indexes a name index by which a named component of the document may be located using the component s name, a page index by which individual pages of the document may be located, and a reference index by which chains containing information referred to by references in informational attributes may be located. In the document of figure 10, each of these indexes is contained in one index block the name index in NIB 1005, the page index in PIB 1007, and the reference index in RIB 1009. In larger documents an index may contain more than one index block. The name index is made up of name index entries NIEs 1006. Each name index entry contains a name and a pointer to the first text block of the chain containing the named component. Thus, NIE 1006 in NIB 1005 contains P20 pointing to text block 20 , the first text block in text shelf 1015. The page index in PIB 1007 is made up of page index entries PIEs 1008. Each PIE contains a page number and a pointer to the first text block for the page. The document of figure 10 has two pages, the first beginning on block 21 and the second beginning on block 9 , and accordingly, the PIE for page 1 contains P21 and that for page 2 contains P9. The reference index in RIB 1009 is made up of reference index entries RIEs 1010. Each RIE contains a reference number represented here by FOR, HR, and FR , and a pointer to the first block of the chain containing the reference, here block 35 for FOR, block 12 for HR, and block 26 for FR. The components of the document structure and those of the intermediate document structure correspond as follows The intermediate structure has no components corresponding to DT 1003 or the index blocks, since the relationship of the components to each other in the intermediate structure is determined by their positions relative to each other in the intermediate structure. Figure 11 shows the translation of the document of figure 10 into an equivalent document with the intermediate structure. That document begins with SOS for the stream type 1101 and ends with EOS for the stream type 1151. Immediately following SOS 1101 are descriptors 1103 containing the information from document information blocks 1001 of the figure 10 document. Then comes SOS 1105 for the text segment for the contents of document body chain 1025, followed by PB CTL 1107, a page break control specifier marking the beginning of page 1, a set format control specifier 1109 and text format descriptors 1111 containing information as to how the text is to be formatted. The format described in text format descriptors 1111 remains in effect until another SF CTL 1109 occurs in the text segment. The information in descriptors 1111 is obtained from format 1021 of the figure 10 document. Following descriptors 1111 is a header segment for the page 1 header. The segment includes SOS header 1113, SF CTL 1109 for the header format, header format descriptors 1115, header text 1117, and EOS header 1119. Header text 1117 is obtained from header 1019, and header format descriptor from format 1021, as specified by FA 1035 in header 1019. Next in the intermediate structure comes a footer segment for the page, containing SOS footer 1121, SF CTL 1109, footer format descriptor 1123, footer text 1125, and EOS footer 1127. Like a format, once a header or footer is established, it remains effective until a new one is established. Following the footer segment is page 1 text 1129. At the end of the text comes PB CTL 1107 for the page break at the end of the first page. Since page 2 has the same format, header, and footer as page 1, there is no need for format, header, or footer segments. Next is page 2 text 1131, from page 2 1029. Page 2 1029 contains a visual attribute indicating an underscore, and consequently, included in page 2 text 1131 is an underscore attribute, which contains SOA underscore 1133, an attribute descriptor 1135 indicating whether the underscore is single or double, the underscored portion of text 1131, and EOA underscore 1139. Thereupon come ununderscored text 1131 and EOS text 1141, marking the end of the text segment. The rest of the stream segment is occupied by the text shelf segment corresponding to text shelf 1015. That segment includes SOS shelf 1143, a descriptor 1145 containing the shelf name obtained from NIB 1005 , the shelf content 1147, from the text blocks in text shelf 1015, and EOS shelf 1149. Following the text shelf segment and terminating the intermediate document structure is EOS stream 1151. As may be seen by a comparison of figures 10 and 11, relationships which are expressed by means of attributes, indexes, and pointers in the document structure of figure 10 are expressed by means of nested segments, attributes, and descriptors in the document structure of figure 11. Thus, in the document structure of figure 10, the fact that each page has an identical header is expressed by the fact that the reference HR appears in FA 1035 for each page, while the same fact is expressed in the document structure of figure 11 by placing a header segment in the text segment ahead of the text for the first page to which it applies. In programming terms, what happens is that when AC 1033 is encountered in T of block 21 , the processing of document body chain 1025 must be interrupted, FA 1035 must be examined, and if it specifies a page break, new header, new footer, or new format, a PB CTL 1107, a header segment, a footer segment, or a SF CTL 1109 and its associated descriptors 1111 must be placed in the intermediate structure. After that has been done, the processing of document body chain 1025 must be resumed. If, as is the case here, the header or footer referred to in FA 1035 itself has in its text an AC 1033 and that AC 1033 refers to another FA 1035 containing a reference here the reference to format 1021, FOR , then the processing of the header or footer must be interrupted to process the chain of blocks referred to by that reference. The nested components of the intermediate document structure thus correspond to a processing sequence in which the processing of a given component of the document of figure 10 is begun, is interrupted when information from another component is required, and is resumed when the processing of the other component is complete. In a present embodiment, the required processing sequence is achieved by means of a stack which is part of State Buf 319 when the processing of a first component is interrupted, state including the kind of component and the current location in the component is saved on the stack. Then the new component is located and processed. When the processing of the new component is complete, the saved state is restored from the stack and processing of the first component continues. Generally speaking, in the document structure of figure 10, an interruption or resumption of processing of a component involves a shift from one chain of text blocks to another. Figure 12 shows the main translation loop of a preferred embodiment of a translation program for translating the document structure of figure 10 into the intermediate document structure. During operation of the loop in a system such as that shown in Figure 3, the portions of the document which are currently being translated are read from storage 303 into A buf 315 as the intermediate document is produced, it is written to I buf 317, and from there to storage 303. The portions of the program currently being executed are contained in code buf 321, and state buf 319 contains the stack, a position block indicating the location of the character currently being processed, a value indicating the kind of component being processed, the character currently being processed, and other values necessary for the operation of the program. The loop begins with initialization block 1201. Procedures in that portion of the program output SOS stream 1101 and then read the contents of doc info blocks 1001 and place descriptors 1103 containing the information from those blocks immediately after SOS 1101. Initialization continues by using DT 1003 to locate the first text block in document body chain 1025. Once the block is found, the program outputs SOS text 1105 and begins to process the characters in T one at a time. Processing is done in the main translation loop. On entering the main translation loop, two boolean variables, Translation then commences with the first character in T of the first text block in page 1 1027 and continues one character at a time block 1209 . As shown by block 1211, if the character being processed is any character other than etx 1031, it is processed by process char 1213. As will be explained in more detail later, if the character is a text character, processing of the current chain continues if it is an AC 1033, state is saved and the next character processed by the main loop is the first byte from the corresponding informational attribute. If one of the bytes in the informational attribute is a reference to another text chain, the program saves state, outputs a code indicating the type of the chain it is processing, outputs the characters necessary to indicate the start of the new component being processed, and processing continues with bytes from the text chain referred to in the reference. If the character is etx 1031, the end of T in a text block in the chain currently being processed has been reached. The manner in which processing continues is determined by whether the text block is the last in a page, the last in a chain, or the last in a document. If the text block is not the last in a chain, it will contain a pointer to its successor if the text block is the last on a page, the first character in the successor block will be an AC 1033 corresponding to a FA 1035 specifying a page break. When the text block is neither the last in a chain or the last on the page, processing continues with the first character of T in the successor block decision block 1215 . When the text block is the last on a page, that character will be AC 1033 corresponding to FA 1035 specifying the page break, and a PB CTL 1107 will be output in the course of processing the AC 1033. The program determines whether the text block is the last in the document by examining the stack. If it is empty, there are no other chains to be processed and no more characters in the present chain. When the text block is the last in the chain, but not the last in the document decision block 1217 , processing of the component represented by the chain has been completed, and the program writes the codes necessary to end the component to the intermediate document block 1218 and then restores the state saved when processing of the current chain began block 1219 . That state contains the location of the next character to be processed, and processing continues as described. If the text block is the last in the document, Continuing with figure 13, which presents a detail of process char block 1213, the program first determines whether the character being processed is part of a sequence of text decision block 1300 . If It is, it determines whether the character is an AC 1033 block 1301 . If it is, the program saves the current state block 1303 and resets the position block to indicate the beginning of the informational attribute associated with AC 1033 block 1305 . Thus, the next character fetched in the main loop is the first byte of the associated attribute. If the character is not an AC 1033, the program next determines whether it is a control character, i.e., whether it is a tab, indent, carriage retum, or the like block 1309 . If it is, the program writes a control specifier corresponding to the control character to the document with the intermediate structure block 1315 . If it is not, the program examines the visual attributes associated with the character to determine whether they have changed block 1311 . If they have, it does the processing required to begin or end an attribute in the intermediate document and then outputs the character to the intermediate document block 1313 . Thereupon, the next character is fetched. If the character is not part of the text, it is part of an informational attribute or some other non textual entity such as a format. In that case, further processing depends on whether the character is a reference block 1315 . If it is, the current state is again saved and the position block is set to the start of the chain referred to by the reference blocks 1323 and 1325 . Thus, the next character processed by the main loop will be the first character of that chain. If the character is not a reference and the item currently being processed is not yet finished decision block 1317 , the character is processed as required for the item block 1321 . For example, if what is being processed is an informational attribute specifying a page break, the program will output a PB CTL 1107. If the item is finished, the program will restore the state saved when the processing of the item began block 1319 . Figure 14, finally, contains a detailed representation of the visual attribute processing performed in block 1311. In a present embodiment, the translation program receives attribute information about a character from the document of figure 10 in the form of a bit array indicating which attributes are on and which are off for that character. The translation program first compares the entire bit array associated with the current character with the entire bit array associated with the last character received from the block. If there is no change, the program goes directly to block 1313 block 1401 . If there has been a change, the program compares the two bit arrays bit by bit. If a bit in the array for the current character is the same as the corresponding bit in the array for the previous character, the program simply compares the next bits block 1405 If they are not, the program determines from the comparison of the corresponding bits whether the visual attribute represented by the bits has been tumed on or off block 1409 . In the former case, the program writes the codes necessary to start the attribute to the intermediate document block 1411 in the latter, the program writes the codes necessary to end the attribute block 1413 . A concrete example of how the program works is provided by the processing of page 1 1027. During initialization, the program examines DT 1003 to determine if there is a pointer to PIB 1007. If there is, there is text in the document, and the program outputs SOS text 1105. Using PIE 1008 to page 1 of the document in PIB 1007, the program locates text block 21 , the first block in page 1 1027, and begins processing the first character in the block. That character is AC 1033 corresponding to FA 1035, so the program saves state and begins processing FA 1035. FA 1035 specifies a page break, and consequently, PB CTL 1107 is output to the document with the intermediate structure. FA 1035 also specifies a new format, the one referred to by FOR. Consequently, process char 1213 again saves state, locates block 35 containing format 1021, sets the state to specify the first character in block 35 and that the chain being processed is a format chain, and outputs SF CTL 1109. The main translation loop then forms format descriptors as required by the text of block 35. When etx 1031 in block 35 is reached, the program responds as shown in Figure 12 for an etx 1031 which is the last in a chain. In this case, a control specifier is being processed, and thus, no special end codes are required. The program then restores the state saved when processing format 1021 began and resumes processing FA 1035. The next item is reference HR for header 1019, so the program again saves the current state, outputs SOS header 1113 , and begins processing T in header 1019. The first character in T of header 1019 is, however, AC 1033 referring to FA 1035 in A of header 1019. This FA 1035 contains only the reference FOR to format 1021. Process char 1213 therefore again saves the current state, outputs SF CTL 1109 following SOS header 1113, saves state again, produces header format descriptors 1115 from the text in format 1021, and restores state as previously described. Since there are no further items in FA 1035, state is again restored and the remaining characters in header 1019 are processed, to produce header text 1117. When etx 1031 in header 1019 is reached, state is again restored and processing of FA 1035 continues. The next item in FA 1035 is FR, referring to footer 1017, which is processed in the fashion described for header 1019. When processing of footer 1017 is finished, processing of AC 1033 in block 21 is finished and the remaining text characters in the block and the remaining blocks of page 1 are processed to produce page 1 text 1129. When AC 1033 of block 9 , the first block in page 2, is reached, FA 1035 in that block is processed. Since FA 1035 of block 9 specifies the same format, header, and footer as FA 1035 of block 21 , there is no need to output a new SF CTL, header segment, or footer segment, and all that is output is PB CTL 1107 marking the end of page 1. Processing continues as described above until all of the components of the document have been translated. Translation from the intermediate structure to the document structure of figure 10 employs the same general methods as translation in the other direction. First, the document structure is initialized by setting up the administrative blocks and the first index blocks and loading doc info blocks 1001 with the information from doc info block descriptors 1103. Then the processing of the contained segments begins. Each segment corresponds to a different text chain in the document structure of figure 10, and consequently, each time the beginning of a segment is encountered, processing of the current chain must be interrupted and processing of a new chain commenced. Each time the end of a segment is encountered, processing of the chain corresponding to the segment containing the segment which ended must resume. Again, the program uses the technique of saving state on a stack each time processing is interrupted and restoring state each time processing of a segment terminates. While a document translated from a given document structure into the intermediate document structure and then back to the original document structure will contain the same information as the original document, the final document structure may not be completely identical with the original document structure. For example, many of the text blocks of figure 10 contain attributes referring to a single header block 1019. In the intermediate document structure, a header segment is produced each time the header changes. The program which translates from the intermediate document structure to the structure of figure 10 may not check whether a given header segment is identical to a header segment which appeared previously in the document. If it does not perform such a check, the program will translate each header segment it encounters into a separate text block and the resulting document structure will contain more text blocks and RIEs 1010 than the original document structure. The foregoing Description of a Preferred Embodiment has disclosed how an intermediate document structure may be used to translate a document having one structure into an equivalent document having another structure, has showed how stand alone and network systems may be constructed which use the intermediate structure to translate documents, has disclosed a preferred embodiment of the intermediate document structure, and has shown in detail how a document may be translated from a prior art document structure to the intermediate structure of the present invention and vice versa. The preferred embodiment disclosed herein is, however, only one possible embodiment of the invention. For example, the basic form of the intermediate document structure of the present invention may be maintained while employing different conventions regarding the codes which begin and end segments, attributes, descriptors, and control specifiers. Moreover, some embodiments may have a segment or other construct corresponding to each reference, rather than only to references which establish new formats, headers, or footers. Further, the document structure of the present invention is inherently expandable, and consequently new components and new types of the components disclosed herein may be added. Finally, translation using the intermediate structure may be accomplished by programs employing algorithms different from those disclosed herein but having the same result.