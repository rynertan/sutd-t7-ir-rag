# METHOD OF, AND DEMODULATOR FOR, DIGITALLY DEMODULATING AN SSB SIGNAL

## Claims
Verfahren zum Demodulieren eines Einseitenbandsignals, wobei die nachfolgenden Verfahrensschritte durchgeführt werden, analoge Durchlaßfilterung des genannten Signals, Quadraturmischung eines aus dem Ergebnis der analogen Filterung abgeleiteten Signals mit einem Ortsoszillatorsignal zum Erzeugen eines Signalpaares, digitale Filterung, mit Dezimierung, der betreffenden Signale des Paares und Kombination der von den betreffenden dezimierten Signalen abgeleiteten Signale, wobei die Analog Digital Umwandlung zwischen der analogen Filterung und der digitalen Filterung durchgeführt wird,

## Description
The present invention relates to a method of, and demodulator for, digitally demodulating a single sideband SSB signal. Digital demodulation of an SSB signal is known, for example, from an article entitled Digital HF Radio a sampling of techniques in Ham Radio magazine, April 1985, page 18 et seq., particularly Figures 14 16 on pages 31 and 33 and the corresponding description. Typically an IF signal is filtered and applied to an analogue to digital converter ADC . The ADC output signal is then processed digitally inter alia by effectively creating two quadrature relating channels by means of quadrature mixers, low pass filtering and decimating the signals in the two channels, and filtering and arithmetically combining the results. The results of the arithmetic combination may be reconverted to an analogue signal in a digital to analogue converter DAC . An advantage of processing a signal digitally is that a more flexible or general purpose demodulator can result. However the known methods are liable to require particularly stringent filtering which means that dedicated circuits may have to be made for each stage of the demodulator. An object of the present invention is to enable the filtering requirements in a digital demodulator to be relaxed whilst maintaining good selectivity. According to one aspect of the present invention there is provided a method of demodulating an SSB signal, comprising analog pass filtering said signal, quadrature mixing a signal derived from the result of the analog filtering operation with a local oscillator signal to effectively produce a pair of signals, digitally filtering, with decimation, the respective signals of the pair, and combining signals derived from the respective decimated signals, analog to digital conversion being effected between the analog filtering operation and the digital filtering operation, characterised in that the decimation uses an odd numbered integer decimation factor greater than 1 and in that the signals which are combined are derived from the respective decimated signals by a process which comprises digitally producing a relative 90 degree phase shift between the respective decimated signals. According to another aspect of the present invention there is provided an SSB signal demodulator comprising an analog pass filter having an input for an SSB signal, a local oscillator, quadrature related mixing means to inputs of which outputs of said pass filter and said local oscillator are coupled, signal combining means, first and second filtering and decimating means coupling first and second outputs of the quadrature relating mixing means to first and second inputs of the signal combining means respectively, and analog to digital converter means included in the couplings from the pass filter to the first and second filtering and decimating means, characterised in that the filtering and decimating means are each arranged to decimate by an odd numbered integer factor greater than 1 and in that digital phase shifting means are provided for producing a relative phase shift of 90 degrees between the output signals of the filtering and decimating means prior to their being fed to the combining means. It has now been recognised that selectivity in a demodulator can be improved by initially analogue filtering an input signal and then subsequently digitally filtering the filtered analogue signal. In particular digitally filtering and decimating signals using an odd numbered integer factor greater than 1 and applying the decimated signals to a digital means for producing a relative 90 degree phase shift therebetween, for example a Hilbert transform pair, and then combining the results enables a passband stopband characteristic to be obtained that is characterised in that a passband is flanked by stopbands. This means that the filtering requirements in the demodulator can be relaxed. The digital part of the demodulator may be implemented using a general purpose processor. In an embodiment of the present invention the digitised signal is mixed with quadrature components of a local oscillator signal which is mathematically related to the sampling frequency, f The SSB signal, which may comprise an RF,IF or base band signal, may be band limited to prevent aliasing and provide far out adjacent channel isolation. The band limited signal may be obtained by bandpass filtering in a roofing filter and improved selectivity can also be obtained by adjusting the nominal carrier frequency equal to f The present invention will now be described, by way of example, with reference to the accompanying drawings, wherein, Referring to Figure 1 the receiver comprises an antenna 12 connected to an r.f. front end 14 which may consist, for example, of an amplifier or a mixer, the latter possibly together with at least one IF stage. The output of the r.f. front end 14 comprises a signal based on a nominal carrier or IF frequency which in the case of SSB is suppressed. This output signal is fed to a bandpass filter 18, termed a roofing filter, which provides a band limited output to prevent aliasing and achieve adjacent channel isolation. The filtered signal is applied to an analog to digital converter ADC 20 which samples at a frequency f The digitised output from the ADC 20 is applied to quadrature related digital signal paths 22 and 24. The block shown in broken lines comprises a digital filter 21 which is optional but if present it has an input coupled to the ADC 20 and an output coupled to the paths 22 and 24. The paths 22 and 24 comprise mixers 26, 27 to which digitised versions of sin 2πf After the particular arithmetic operation the digital sum or difference signal is reconverted to an analogue signal by a digital to analogue converter DAC 36 and the output therefrom is applied to a low pass filter 38. If desired an interpolating filter 35 may be connected in the signal path to the DAC 36. An advantage of using the interpolating filter 35 is that the specification for the low pass filter 38 can then be relaxed as the periodic repeat frequency components are further away from baseband. The digitally operating section of the receiver can be implemented by a suitably programmed microcomputer such as a Texas Instruments TMS 320. By operating digitally one achieves perfect tracking between the signal paths 22, 24. In determining the operation of the demodulator of Figure 1 one selects a local oscillator frequency and decimation factor such that the Hilbert transform stage 30 gives rise to a bandpass filtering characteristic within the bandwidth of the roofing filter 18. Figures 4 to 7 are tabular summaries showing the composite performance of the LSB and USB channels for different incident SSB frequencies. Figure 4 shows the periodic filtering characteristic when there is no decimation in the decimating filters 28, 29 and Figure 5 shows the case when the decimation factor is 4. The upper tabular summary relates to the upper side band USB subtraction channel and the lower tabular summary relate to the lower side band LSB addition channel. The other legends used in the tabular summaries are RUSB rejected upper sideband, RLSB rejected lower sideband and INV inverted. Figures 6 and 7 show the periodic filtering characteristics when the decimation factors are 3 and 5, respectively. An examination of these filtering characteristics shows that the frequency length of the segments becomes shorter for higher values of the decimation factors. Also there are points in the tabular summaries where it is possible to note some advantageous operating points. For example when a particular wanted sideband is flanked between two rejection bands then this considerably eases the analogue prefiltering requirements of the demodulator. Such advantageous operating points exist in regions corresponding to the nominal carrier f There can be a disadvantage in making the passband stopband segments too small in that the periodic filtering characteristic may revert too soon back to passband within the pass bandwidth of the roofing filter 18 leading to reduced selectivity and consequent degradation of the receiver performance. Another reason for not making the passband segments too narrow is that they may become narrower than the passband of the wanted signal. Figure 8 shows the filter response 39 for a demodulator of the type shown in Figure 1 without a digital filter 21 and in which the decimating factor is five and the nominal IF frequency of f Figure 9 shows that adjusting f Figure 10 illustrates the overall characteristic when the local oscillator frequency is adjusted so that the nominal IF frequency f Figures 11 and 12 illustrate the selectivity of the demodulator to obtain USB and LSB for an arrangement in which the passband of each decimating filter has been relaxed so that it reaches its stopband when the periodic filtering characteristic enters its adjacent passband. To switch between upper and lower sidebands the nominal IF frequency is required to switch two channel widths so that the frequency of f Reducing the decimating factor from 5 to 3 may improve the overall demodulator performance because the segments are wider and in consequence the unwanted channel either is further down the slope of the characteristic 40 or lies outside the passband of the roofing filter. The alternative arrangement for obtaining an SSB signal with a satisfactory sideband rejection includes the digital preprocessing filter 21 Figure 1 . Additionally as shown in Figure 13 the passbands of the roofing filter, response curve 40, and the decimating filters, response curve 42, are different from the arrangement not having the filter 21, see Figure 8 for example. The response of the digital pre processing filter 21 is referenced 45 and as shown the passband corresponds to the width of one of the passbands of the periodic filtering characteristic and has a sharp cut off which is desirable for good selectivity with SSB. In operation the analogue output of the R.F. front end 14 is applied to the roofing filter 18. The filtered analogue signal is digitised in the ADC 20 and the digital output is filtered in the digital filter 21. In mixing the output of the filter 21 in the mixers 26, 27 the frequency f The foregoing description is concerned with demodulating an SSB signal. The circuit shown in Figure 1, omitting the digital pre processing filter 21 can be made universal to AM,FM and SSB by connecting different end stages to the points A and A in the paths 22 and 24, respectively. Figure 2 illustrates an arrangement for recovering a digitised FM signal. This arrangement comprises delays 50, 52 providing a delay τ m f Figure 3 illustrates that AM can be recovered by squaring the signals at A and A in squaring circuits 60,62, the outputs of which are added together in a summing stage 64 after which the sum signal is applied to a square root stage 66 to obtain a digital version of the demodulated AM signal. The digital signal is converted to an analogue signal and low pass filtered in the stages 36,38, respectively. The embodiment described is based on the concept of analogue filtering an input signal, effectively directing the result into a pair of quadrature related signal paths and digitising it, digitally filtering and decimating the signals in the two paths using an odd numbered integer decimation factor greater than 1, Hilbert filtering the decimated signal in one path, and arithmetically combining the result with the decimated signal in the other path to obtain the required selectivity. By this approach the specification of the roofing filter 18 can be relaxed. If the demodulator is designed for demodulating SSB signals only then the passband of the roofing filter 18 can be a gently sloping single channel one, the digital filtering being used effectively to cut out a slot having sharp or fast sloping sides. By relaxing the specification of the roofing filter then alignment and local oscillator drift problems are avoided. Alternatively if the demodulator is designed for multi mode operation then the passband of the roofing filter 18 should be made wide enough to pass full deviation FM. The digital filtering in such a case provides an effective way of obtaining further filtering especially when demodulating SSB signals. In practice there is a relationship between the bandwidth of the roofing filter 18 and the sampling rate in the ADC 20 Figure 1 which is that the bandwidth of the roofing filter must be less than 1 2 the sampling rate, that is the Nyquist frequency. The bandwidth of the roofing filter 18 is dictated by the intended application, that is single mode or multi mode, and this dictates the required sampling rate. In the illustrated multi mode case the bandwidth of the roofing filter 18 is chosen to pass full deviation FM and this corresponds to about four SSB sidebands. Figure 14 illustrates a simplified flow chart for the various digital operations implemented by a microcomputer such as a Texas TMS 320 which is running in real time. It will be assumed that the pre decimation filter 21 has been omitted and an SSB signal is being recovered. Figure 14 demonstrates the fundamental operation of the demodulator program. The diagram shows how a loop counter is used to allow decimation by five. A sample rate of 40kHz is to be used for the data input which would make the design of the Hilbert filter impracticable for any reasonable performance. However in choosing a sample rate of 40KHz then the quadrature mixing can easily be performed with 10kHz thus giving a nominal input carrier frequency of 10kHz. The bandwidth of the two channels is 3kHz. After the initial quadrature mixing decimation by five is used to reduce the sample rate down to 8kHz where it is possible to design practical Hilbert filters and make better use of the available processing time. In Figure 14 the block 70 is a programme timing block which ensures that sampled data from the A to D converter is ready every 25µSec. This data is read into the processor, step 72. Step 74 denotes operating on the input sampled data to give two quadrature channels. This is achieved by multiplying the incoming signal with a 10kHz locally generated pseudo local oscillator. One channel is derived from direct multiplication while the quadrature channel is derived from multiplication with a 90 degrees phase shifted version of the pseudo local oscillator. The next step 76 is to take the signals in the mixer outputs and store them by moving data in a data memory store and updating vacated memory locations. The step 78 denotes increasing the count in a counter by one. Step 80 denotes checking whether the count is 5, if it is not N then the cycle is repeated until the count is 5, that is Y at which time the program exits to step 82. In step 82 the counter is reset to zero and the data, which is in the correct place, is operated on by the decimation filter coefficients, step 84. Step 86 denotes the Hilbert transform operation, and the step 88 denotes the arithmetic operation to obtain the appropriate sideband. The operational steps to obtain digital versions of the FM and AM signals are self evident from a consideration of Figures 2 and 3 and accordingly separate flow charts will not be described. In the case of using the digital pre processing filter 21, this is configured as a 30 stage transversal filter which receives time samples from the analogue to digital converter 20. After a newly received time sample has been stored, each of the stored time samples is multiplied by its individual filter coefficient and the results are accumulated to provide an output to the quadrature related mixers 26, 27. The multiplication and accumulation operations are carried out again after the receipt of another time sample. Since the use of the pre processing filter 21 enables the specification for the decimation filters 28, 29 to be relaxed, then each filter comprises only eight stages. It will be appreciated that the arrangement of Figure 1 could alternatively be supplied with base band input signals. If this is the case the aerial 12 and r.f. front end will, of course, be omitted and the band pass filter 18 and 21 if present be replaced by a low pass filter or filters. It will also be appreciated that the required relationship between the signals in the paths 22 and 24 can alternatively be obtained by producing a phase difference of 90 degrees between the signals fed from the aerial 12 to the mixers 26 and 27 respectively, and feeding the other inputs of these mixers with in phase or anti phase local oscillator signals. If this is done a 90 degree phase shifter may be included in the coupling between ADC 20 and one of the mixers 26 and 27 or, for example, a 45 degree phase shifter may be included in the coupling from ADC 20 to one of these mixers and a 45 degree phase shifter in the coupling from ADC 20 to the other. Yet another possible variation of the circuit of Figure 1 is to replace ADC 20 by a pair of ADCs, one between mixer 26 and filter 28 and the other between mixer 27 and filter 29, so that the mixers 26 and 27 become analog mixers fed with non digitized local oscillator signals . Although as described component 30 of the Hilbert transform pair 30,31 produces the whole of the 90 degree, 90 degree phase shift characteristic required between the two signal paths it will be evident that the production of this characteristic may be shared between the components 30 and 31, for example by arranging that component 30 has a 45 degree, 45 degree phase shift characteristic and component 31 has a 45 degree, 45 degree phase shift characteristic at corresponding frequencies.