# ANALOG DATA STORAGE SYSTEM

## Claims
Hochgeschwindigkeits Datenerfassungssystem zum Speichern von aufeinanderfolgenden Analogsignal Abtastwerten, mit Analogsignal Eingabeeinrichtungen SIG1 und SIG2 und Analog Signalausgabeeinrichtungen OUT , einem ersten Analog Eingabebus, der an die Analogsignal Eingabeeinrichtungen SIG1 und SIG2 angeschlossen ist und einem zweiten Analog Ausgabebus, der an die Analogsignal Ausgabeeinrichtungen OUT angeschlossen ist, einer Speicheranordnung 50 mit einer Vielzahl an Zellen 52 , die in n fortlaufend numerierten Reihen, wobei die Reihen mit der Numerierung von 1 bis n 2 mit den Reihen der Numerierung n 2 1 bis n ineinander verschachtelt sind und in m fortlaufend numerierten Spalten angeordnet sind, Reihentaktgebereinrichtungen 12 , die zur wahlweisen Aktivierung von jeder Reihe in der Speicheranordnung 50 an die Speicheranordnung 50 gekoppelt sind, Spaltentaktgebereinrichtungen 28 , die zur wahlweisen Aktivierung von jeder Spalte in der Speicheranordnung 50 an die Speicheranordnung 50 gekoppelt sind, Zellen, die Reihen mit der Numerierung von 1 bis n 2 zugeordnet sind und Zellen, die Reihen mit der Numerierung n 2 1 bis n zugeordnet sind, die getriggert werden durch alternierende Spaltentaktgeber Aktivierungsimpulse, die sich zeitlich überlappen, wobei die Analogsignal Eingabeeinrichtungen SIG1 und SIG2 zur Übertragung eines analogen Signals an die Zellen der Anordnung 50 direkt an die Speicheranordnung 50 angeschlossen sind, und Einrichtungen, die auf die Reihen und Spaltentaktgebereinrichtungen 12 und 28 ansprechen, um zur Speicherung einer Analogsignal Abtastwertreihe, die Abtastungen des Analogsignals umfaßt, nacheinander jede Zelle 52 zu aktivieren, wobei jede Zelle 52 ein Gatterpaar Q1 und Q2 umfaßt, das zwischen den Analogsignal Eingabeeinrichtungen SIG1 und SIG2 und einem ersten Kondensator 20 in der Zelle angeschlossen ist, um den ersten Kondensator zur Speicherung jedes Analogsignal Abtastwerts zu veranlassen, wobei die Gatter Q1 und Q2 auf die Reihen und Spaltenaktivierungseinrichtungen 12 und 28 ansprechen und jede Zelle 52 einen Spannungs Folger 40 beinhaltet, der an den ersten Kondensator 20 gekoppelt ist, und wobei eine Multiplex Ausgabevorrichtung 42 zwischen dem Spannungs Folger und dem zweiten Analog Ausgabebus angeschlossen ist, zur Übertragung einer Proportionaldarstellung jedes gespeicherten Analogsignal Abtastwerts an den Ausgabebus.

## Description
The invention is directed generally to an analog data storage system and more particularly to such a system for very high speed sampling of analog pulse information, the pulse widths being in the range of 10s of nanoseconds. An increasingly important problem in large scale physics detectors is the sampling of and recording of analog pulse information for pulse widths in the range of a few tens of nanoseconds with accuracy of the order of one percent and with a dynamic range of the order of eleven bits one part in two thousand . The generation of high precision time and amplitude information related to the outputs from various kinds of detectors is of considerable significance in applications including high energy physics, transient digitising of signals associated with nuclear impulses, laser fusion, optic communication, and general lab measurement methods. In most known systems, the accuracy degrades significantly as the signal to be sampled approaches the low end of the dynamic range. It is therefore an object of the present invention to provide an analog pulse sampling system and method which can maintain a high level of accuracy over a wide dynamic range. A high speed acquisition system employing an analog memory matrix has been disclosed in U.S. patent no. 4271488. The cells of the matrix are scanned in sequential order by row and column shift registers to sample the input analog signal. Additionally, two independent shift register clock rates are provided to enable the input signal to be sampled at one rate and the stored data to be read out at a second slower rate. Also, an alternative embodiment discloses partioning the memory to improve the data writing performance by overlapping the column selection in the two memory sections. Another data acquisition system patent, U.S. patent 3898656, discloses using independent input and output circuitry to read write data into a memory matrix. The separate input and output circuits provide a solution to the detrimental charge sharing effect which arises if only a single input output circuit is used. An objective of the present invention is to provide an improved analog pulse storage integrated circuit. Analog pulse storage systems frequently find use in instrumenting and recording the data from large scale experiments which may have up to several hundred thousand channels of information consisting of time and amplitude measurement of the signal. An objective of the present invention is to provide an integrated detector which is of small size, low power, and low cost to be used to detect the signal values carried on each channel. Because of the very low pulse width, in the range of a few 10 s of nanoseconds, an effective sampling rate of 2 x 10⁸ samples per second is desirable, while maintaining accuracy on the order of 11 bits. Prior art attempts to monitor and record analog pulse information for very small width pulses has frequently utilized threshold detectors which could not provide detailed analysis of the pulses being studied. An objective of the present invention is to provide analog pulse sampling information comprising a plurality of sample points for a pulse on any given channel, each sample having an aperture of about 1 nanosecond with a sample time position error less than or equal to 0.1 nanosecond. The sample clock interval should be both very regular and at extremely high frequency to provide a maximum number of samples across the pulse, which may have a pulse width of no more than a few 10 s of nanoseconds. Another objective of the present invention is to provide an integrated circuit solution, in order to reduce the cost and maximize the speed of the sampling chip. It is therefore highly desirable to provide a chip having a sampling cell design which is highly regular and thus extremely reproducible on a large scale. Known methods of high speed sampling for a multiple channel environment include cascaded discrete component sample and holds in each channel. However, the use of discrete components limits the number of channels which can be instrumented due to drive problems, and component size and speed limits the number of samples which can be made per channel. A second known prior art device is the RETICON 5501 which is a bucket brigade device of a well known design. However, this device as with the device described above must be cascaded, so that it suffers from drive problems and size limitation. Also, because of the way the circuit is designed, the sampling rate cannot be controlled except by cable delay of the sampling gate which is very cumbersome. The sampling aperture time is relatively limited. The analog storage system described in IEEE Transactions on Nuclear Science, Vol NS30, February 1983 at page 339 341 suffers from the same limitations, due to the use of a delay line. Another method in some general use is to place a high speed or flash ADC analog to digital converter on each channel. Such devices work at rates of 100 x 10⁶ samples per second 100 mhz but yield accuracies no better than 5 to 6 bits, unless extended by elaborate additional circuitry. The cost of a single converter and the power consumption for each converter are both undesirably high for large systems, and probably impractical for systems for greater than 100,000 channels. According to the present invention there is provided a high speed data acquisition system for storing a succession of analog signal sample values as defined in Claim 1. The limitations of the prior art are overcome in the presently disclosed analog storage integrated circuit, in which each storage cell is defined to include two input gates between the pulse input at which the analog pulse information is received, and a storage capacitor for storing the analog signal level for the defined aperture. The cells are arrayed in rows and columns, and the input gates are controlled by separate row and column clocks. One of the clocks operates at a relatively low rate the other clock operates at the rate of sampling. Data is read and stored by each cell only on coincidence of the two clocks. Therefore, if the low speed clock is the column clock, and the high speed clock is the row clock, then the column clock need shift from column to column only after every row cell in that column has been activated by the row clock. Utilizing this arrangement, one clock may be continuously running, the other clock being initiated by detection of the pulse to be sampled, or by receipt of a known time marker or trigger synchronously with the arrival of the data pulse to be sampled. Use of a chip design having such a regular array of cells lends itself to cascading to extend the number of samples per channel before any stored cell data is read out. In a further advantage, if a sufficient number of cells are provided to separately store all the analog pulse sample information appearing on a channel, then the storage time can be extended to any length compatible with the ultimate data storage device. In the data storage array of the present invention, a separate reference cell is provided of identical design to all of the storage cells on the chip, but not receiving any of the analog pulse information. By reading out the analog storage cell in parallel with the output of the storage transistor on each cell through matched transistors incorporated in each cell, any degradation of the analog information on the cell with storage time can be taken into account. Further, reading out the information through matched transistor pairs for the reference cell output and the storage capacitor cell output on a differential basis maintains the absolute accuracy of the magnitude of the analog data stored in each cell. In a further advantageous feature of the present invention, the columns are divided vertically into two halves. Therefore, the column pulse which activates the controls for the cells in the bottom half of the column can overlap in real time with the pulse being used to activate the control gates for the other half of the column. By interleaving the numerical sequence of row activation, the speed of the actual pulse writing storage is optimized, while minimizing the complexity of the input clock timing circuitry. The foregoing and other advantages of the present invention will become more apparent from a study of the following figures wherein The basic elements of the analog storage integrated circuit are shown in figure 1. All these elements illustrated are on chip except the row gate pulse generator 12 which comprises the row clock trigger. A differential buffer not shown is also provided for reading out the stored data to a remote memory. The input signal which is an analog pulse typically of a few 10 s of nanoseconds is applied simultaneously to all of the inputs of all of the cells via inputs SIG1 and SIG2. Typically there are two hundred fifty six cells on each sampler chip arrayed in a 16 x 16 matrix 50 as shown in figure 1. Each cell 52 is designed in accordance with the schematic shown in figure 3. As shown therein, each of the cells includes a storage capacitor 20 which is capable of storing charge only during the time period that both of the input gate transistors Q1, Q2 are turned on. The other details of the cell of figure 3 are explained below. Returning to figure 1, the row gate clock pulse generator 12 runs continuously at the analog pulse sampling rate. The arrival of the analog data pulse on input lines SIG1, SIG2 is signaled by either a threshold detector which detects the actual pulse, or a pulse detector which receives a trigger pulse which is transmitted in timed relation to receipt of the analog pulse. Turning on the column counter 28 will now transmit column clock input signals to each of the memory cells 52 in turn. This signal to each cell is shown as c at gate Q2 in figure 3. Coincidence of the row and column clock signals at any gate allows storage of a brief analog sample aperture about 1 nanosecond of the data pulse on the storage capacitor. Signal storage occurs when 1s, 2s the two phase column clocks for driving the two sets of half shift registers this is necessary because of the overlapping output of the column clock pulses shown in Figure 5. The Recirculation logic, 35, shown in detail in Figure 2, responds to and generates these last three signals. Generation of the other identified signals is accomplished by techniques well known in this art. The x and y coordinate output shift registers 32, 34 are of similar design to those shown in Figure 2. The clock logic is used to simplify chip layout, as these shift registers run at the same rate typically significantly slower than the input rate. Returning to the design of the memory cell itself, as shown in Figure 3 each cell includes in addition to the input section a highly linear output stage. Specifically, each memory cell includes a nonloading readout amplifier section 40, and multiplex readout portion 42 for conveying a linear representation of the charge stored on the capacitor 20 through the multiplex readout portions 42 and 44 to the chip outputs OUT and Each of the output sections including the non loading amplifier 40 and the buffer amplifier 42 comprise matched pairs of identical transistors. The input to the transistor Q5 of amplifier 40 is connected to the capacitor C By providing a transistor Q7 to function as a current mirror, and a transistor Q9 which has the voltage at point A applied to its gate and functions as a source follower, a linear representation of the magnitude of the voltage stored on the capacitor 20 can be applied to the output bus through the multiplexor 44. In order to provide for temperature compensation and leakage from the capacitor, a reference cell 60 shown in detail in figure 4 is provided on each chip. As can be seen from figure 4, the design of the reference cell 60 is identical to the design of each of the memory cells in the array. The cell is pulsed by INHS after all data cells have received the data which they are to store thus the voltage V ref which is applied to the transistor Q6 provides a differential reference level which is coupled through transistors Q8, Q10, Q12, and Q14 to the output bus so that a reference level is always available which accounts for the temperature changes and capacitor leakage. Thus the output being read as a differential output will accurately represent the analog pulse sample. The use of differential signal readout for Vsig, together with careful use of matched transistor pairs 40 and 42 from C Two further transistors Q3 and Q4 are provided in the cell input stage to further enhance the accuracy of the stored analog value. A signal reset is provided to gate a transistor Q4 connected across the storage capacitor 20 incorporated in each memory cell. This is provided to allow for draining the storage capacitor 20 to ground after the data has been read out to remote storage. A second signal INH is provided to gate a transistor Q3 connected to a node in between the two gate transistors Q1, Q2. This is used to ground the intermediate node, so that any leakage current, gate or signal feed through from the first gate, which is the gate receiving the continuously running fast row clock pulses, does not affect the readout of the storage capacitor 20. It will be apparent to one of skill in the art who has reviewed the subject invention disclosed, that the integrated circuit design of the present invention provides a number of significant advantages in the field of physics data recording. The use of NMOS IC technology, for the analog storage cell, allows an order of magnitude improvement in density and makes practical systems of a very large scale because of the ease of reproduction of the integrated circuit and the low power consumption. The accuracy of the analog samples recorded will be significantly improved because of the identity of every cell in the memory cell array. The power consumption will be significantly reduced over known prior art methods such as Flash A D converters. Any high power circuitry required for drive purposes can be shared by many channels. The dynamic range, the sampling aperture, and the accuracy are much improved over known methods. An accuracy of 11 bits one in two thousand compared with six bits one in sixty four , is achieved. The cost per channel in large scale systems will be significantly reduced. The figure of merit speed x dynamic range divided by cost will yield an improvement ratio of at least 100 to 1 compared with current alternatives. Persons skilled in this field on reviewing this invention disclosure may make modifications to the present design. Therefore, the scope of the present invention is to be limited only by the following claims.