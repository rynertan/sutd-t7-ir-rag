# FULL DUPLEX SPEAKERPHONE FOR RADIO AND LANDLINE TELEPHONES

## Claims
Schaltung eines von einer Handbedienung unabhängigen Telefons zum Beseitigeneiner unerwünschten Signalkopplung mit einem Lautsprecher 113 , der einerstes abgeändertes Signal umwandelt, das von einem ersten aus einem Übertragungskanalempfangenen Signal erzeugt und von einem zweiten Anpassungsfilter 305 abgeändert wird, mit einem Detektor 225 zur Wahmehmung des erstenabgeänderten Signals, mit einem Mikrophon 115 , das ein zweites Signal umwandelt,um es mit einem ersten Anpassungsfilter 301 abzuändem und als zweitesabgeändertes Signal gleichzeitig mit dem ersten Signal auf einem Übertragungskanalzu übertragen, und mit einem Detektor 223 zur Wahmehmung des zweitenabgeänderten Signals,

## Description
The present application is related to U.S. Patentno. 4,378,603, Radio Telephone with Hands freeOperation by Bruce C. Eastmond issued onMarch 29, 1983 and to U.S. Patent no. 4,400,584, Speakerphone for Radio and Landline Telephones ,by Richard J. Vilmur issued on August23, 1983. These patents are assigned to the assigneeof the present invention, and, by referencethereto, the foregoing related patents are incorporatedin their entirety into the present application. The present invention relates generally tospeaker phones, and more particularly to an improvedduplex speakerphone that can advantageouslybe utilized in both radio and landline telephonesystems. In both radio and landline telephone systems, auser typically communicates by means of a handsetthat includes a speaker at one end which isplaced close to the user s ear and a microphone atthe other end which is held close to the user smouth. In operation one hand of the user must beused to hold the telephone handset in its properorientation thereby leaving the user s only freehand to accomplish tasks, such as driving a vehicle.In order to provide a greater degree of freedomfor the user, speakerphones have been developedfor use in landline telephone systems. A conventional speakerphone is typically coupledto the telephone line and, when enabled, allowsthe user to move about freely while communicatingwith another telephone user. Such speakerphonesgenerally either receive or transmit at a given instant,i.e. simplex, and a comparison of the volumeof the two parties is made. This comparison selectsthe party speaking the loudest and determines themode receive or transmit. If this selection did notoccur, a feedback, or echo, may disrupt the communicationsand, if severe enough, cause an oscillationin the telephone circuit known as singing . One type of echo commonly found intelephony is that of an electrical signal reflectiondue to imperfect impedence match at four wire totwo wire conversion points commonly called hybrids.Thus, part of a near end party s speechsignals are coupled from his speakerphone microphonecircuit to his speaker circuit. A long delayintroduced into this coupled portion of speech maycause confusion to the speaker and disruption ofcommunications. The second form of echo uniqueto speakerphones is that of acoustic coupling betweenthe speaker and the microphone. Acousticenergy produced by the speaker may reflect fromnearby objects or be coupled directly to the microphone.This feedback produces a phase delay inthe coupled audio signal making a hollow soundingecho and, with sufficient audio signal amplificationgain, singing in the telephone circuit. The conventional solution to echo and singingproblems for speakerphones is the attenuation ofthe audio signal in the path having the weakestaudio signal in favor of the path having the strongestaudio signal. Many techniques have been developedto switch or variably attenuate one path orthe other. These techniques, however, suffer from anumber of problems including inability to accommodatehigh ambient noise environments, clippingof speech syllables of the party attempting to starta conversation on the attenuated path, and pathattenuation uncertainty due to feedback from thespeaker to the microphone when the speaker amplificationhas been turned up. These problemshave been reduced by inventions U.S. Patent4,378,603 by Eastmond and U.S. Patent 4,400,584by Vilmur having unique speech detector circuitsand special control processes. For true duplex systems, self adapting echocancellers have recently been employed to mitigateechos by generating an estimate of the echoand subtracting the estimate from the signal corruptedby the echo. In this way, the acoustic couplingof a far end telephone talker can be removedfrom the signal generated by the near end speakerphonemicrophone without decreasing or switchingthe gain available to the near end speakerphoneuser. In a similar manner, electronic reflectionsfrom the hybrid may be cancelled at the near endspeakerphone. GB 2011230 A describes an echo canceller fora loudspeaking telephone having a first transversalfilter for subtraction of echo from the microphonechannel to deliver a substantially echo free signalto the transmission channel and a second transversalfilter for synthesis of an electrical echo signal todeliver a substantially echo free signal to the receptionchannel. The determination of the echo estimate, however,may not always be calculated properly. Underconditions of high ambient noise, non linear distortion,or both parties talking simultaneously, theecho sample may not be fully representative of theecho signal. Therefore, there is a need for fullduplex speakerphone which can provide optimumperformance under less than ideal situations ofnoise, echo signal distortion, and simultaneous userspeech. Accordingly, it is a general object of the presentinvention to provide a speakerphone that allows duplex hands free communications in environmentshaving high levels of ambient noise. According to the invention, there is providedhands free telephone circuitry as defined in claim 1and claim 7 and a corresponding method as definedin claim 12. The invention can provide improved echo cancellationof echo signals subject to non linear distortion,and improved duplex speakerphone operationwithout telephone circuit singing under conditionsof simultaneous user speech. A portion of the received signal is subtractedfrom the generated transmit signal, which includesan echo of the received signal, thereby resulting ina cancellation of the received signal echo. Likewisea portion of the transmit signal is subtracted fromthe received signal, which includes an echo of thetransmit signal, thereby cancelling the transmit signalecho. The portion of the received signal isderived after detection of the received signal andfollowing cancellation of the transmit signal echo.Also, the portion of the transmit signal is derivedafter detection of the transmit signal and followingcancellation of the received signal echo. Figure 1 is a block diagram of a mobile radiospeakerphone and radio system known from priorart. Figure 2 is a block diagram of a gain pathswitching hands free speakerphone employing signaldetectors to determine the active speakerphonepath. Figure 3 is a block diagram of a knownspeakerphone employing adaptive filters to removeechos caused by acoustic coupling and hybridmismatch. Figure 4 is a block diagram of a speakerphonein which the coefficients for the adaptive filter aredetermined by a second microphone positionedsuch that the acoustic output of the speaker and itsassociated distortion are transformed into an electronicsignal by the second microphone. Figure 5 is a block diagram of a speakerphoneemploying non linear matching circuitry to shapethe signal input to the adaptive filter such that thecoefficients developed therefrom include predetermineddistortion expected from the speaker. Also,non linear matching circuitry may shape the inputto the adaptive filter to account for distortion in thechannel between the speakerphone and the matchinghybrid. Figure 6 is a block diagram of the presentinvention in which a land party signal detectorenables the coefficient calculation of an adaptivefilter for cancelling the acoustic echo present fromspeaker to microphone and a mobile party signaldetector enables the coefficient calculation of thereceive signal adaptive filter for cancelling the hybridecho. Non linear matching circuitry may shapethe coefficient input signal to the adaptive filters. Figure 7 is a block diagram of an adaptive filterwhich may be used in the present invention. A basic mobile radiotelephone system whichmay advantageously utilize the hands free speakerphoneof the present invention is shown in Figure1. In conventional and cellular radiotelephone systems,a party in a vehicle 101 communicates byway of a mobile radio 103 with a radio base station105 may be connected to a land party via a radiosystem control terminal 107 and the publicswitched telephone network. Among other things,the radio system control terminal 107 includes controlcircuitry 109 which provides a communicationspath from the radio base station 105 to a four wireto two wire converter, or hybrid, 111 for conversionto the conventional two wire pair used in landtelephony. In order to provide the mobile party with thesame quality of telephone service that a land partyreceives, it is necessary that each radio channel ofthe radiotelephone system be a duplex radio channel,having separate transmit and receive radiofrequencies. Thus, the mobile radio 103 may besimultaneously transmitting on one frequency andreceiving on the other, such that both the mobileand land parties may simultaneously talk and listen.Typically a handset, similar to handsets foundin landline telephone instruments, is connected tothe mobile radio 103. It is necessary that the mobileparty hold the handset up to his ear just as aland party does. It would be much safer and convenientfor the mobile party, however, if the conversationduring a telephone call could be achievedwithout the necessity of a continuous physical involvementof the mobile party. By utilizing aspeakerphone the mobile party can converse withthe land party for the duration of the telephone callwith no required physical action, thus freeing themobile party of tasks which would interfere with thesafe operation of the vehicle. Moreover, somestates have motor vehicle regulations requiring thata mobile party stop the vehicle when dialing anotherparty s number. As a result many radiotelephonecontrol and dialing units provide for on hookautomatic dialing of telephone numbers. However,the handset must still be removed by the mobileparty for conversation. By utilizing the present invention,vehicular safety is enhanced further sincethe speakerphone allows the mobile party to conversewithout the necessity of removing one of hishands from the steering wheel. In landline applications, the speakerphone ofthe present invention can likewise be used to allowfreedom of movement during conversations andmulti party conference calls. The speaker phonecan be coupled to a telephone line via a hybridinterface which may couple a near end transmitsignal to the telephone line and couple a receivefar end signal from the telephone line to thespeakerphone. In order to provide for hands free operation invehicular applications, a separate microphone 113and separate speaker 115 can be provided forvoice communications. It is advantageous to utilizea separate microphone 113 in a vehicle in order tooptimally locate the microphone 113 for receivingthe hands free party s speech in a changing andnoisy environment. At least two sources of feedback operate in aspeakerphone. The first type of feedback is reflectionof the hands free party s signal by the four wireto two wire conversion hybrid 111. This isillustrated as the sidetone path 117 reflected fromthe impedance mismatch between the hybrid 111of the control terminal 107 and the switched telephonenetwork. An additional reflection may occurat the far end land party s hybrid not shown andbe delayed by a period of time proportional to theelectrical distance of the land party from the controlterminal 107. The second type of feedback is that of acousticcoupling between the speakerphone speaker 115and the speakerphone microphone 113. Thisacoustic coupling may be the result of reflectionsof the acoustic energy emitted by speaker 115from surfaces in the spacial regions near thespeaker 115 to the microphone 113. The acousticcoupling may also be direct coupling of acousticenergy from the speaker 115 to the microphone113. The effect of the acoustic coupling is a hollowecho presented to the land party and, if the amplificationgain of the loop from hybrid 111 totransmitter 118, mobile radio 103, speaker 115,microphone 113, mobile radio 103, receiver 119,and hybrid 111 is great enough, oscillation singing will result making any conversation impossible. Referring to Figure 2, there is illustrated ablock diagram of hands free speakerphone controlcircuitry which has been used for mobile radiotelephoneservice. Such a speakerphone has beendescribed in U.S. Patent no. 4,378,603, Radiotelephone With Hands Free Operation byBruce C. Eastmond, issued March 29, 1983 andU.S. Patent no. 4,400,584, Speakerphone For RadioAnd Landline Telephones by Richard J. Vilmurissued August 23, 1983. Both of these patents areassigned to the assignee of the present invention.The control circuitry of Figure 2 may be locatedeither in the mobile radio equipment 103 or in aseparate equipment box utilized by conventionalradiotelephones for interfacing control and otherfunctions with the mobile radio 103. The hands free control circuitry interfaces microphone113 and speaker 115 which deal with thelow frequency or baseband frequency of the radiolink to mobile radio transmitter 201 and mobileradio receiver 203, respectively. Two audio switches205 and 207 are included which open to blockor close to pass the audio signals from the microphone113 or to the speaker 115 in response to acontrol signal from control logic 209. Thus, in thisconventional speakerphone, only one path isclosed at any given time by switches 205 and 207and only one side of the conversation passesthrough the speakerphone. Each of the audio pathsalso includes gain stages 211 and 213 in the microphoneaudio path and gain stages 215 and 217in the speaker audio path. Amplifier 217 in thespeaker audio path may have a variable gain forcontrolling the volume of speaker 115. Additionally,a high pass filter 218 may be interposed betweenthe microphone 113 and switch 205 to remove lowfrequency background noise. In a preferred embodiment,a high pass filter having a cut off frequencyof approximately 300 Hz effectively removesthe low frequency background noise. The audio signals in the microphone audio pathare coupled from amplifier 213 to radio transmitter201, which in turn provides a radio signal for transmissionto the base station 105 via duplexer 219.Radio signals received from base station 105 areselectively coupled by duplexer 219 to radio receiver203, which demodulates audio signals fromthe radio signal for application to amplifier 217 andsummer 221. The hands free control circuitry in Figure 2 alsoincludes a mobile party signal detector 223 and aland party signal detector 225 for detecting thepresence of the mobile party voice signals andland party voice signals, respectively. The mobileparty and land party signal detectors 223 and 225,include substantially identical circuit blocks. Bothdetectors 223 and 225 are comprised of conventionalcircuitry including a logarithmic amplifier 227 commonly referred to as a soft limiter , an envelopedetector 229, a smoothing filter 230, a valley detector 231, a summer 233, and a comparator235. The logarithmic amplifier 227 extendsthe dynamic range of the envelope detector 229due to its amplification characteristic. The envelopedetector 229 provides an output which follows themaxima and minima, or envelope, of the audiosignals. The smoothing filter 230 provides variablebandwidth low pass filtering depending upon thebinary state of the control logic 209 output. Thevalley detector 231 operates as a rectifier which follows the minima of the envelope detector 229output. The valley detector 231 output essentiallycorresponds to the steady state background noisepresent at the microphone 113 in the case ofdetector 223 or at the receiver 203 in the case ofdetector 225. Summer 233 adds a reference voltage V Thus, the comparator 235 will only provide anoutput signal if the smoothing filter 230 outputexceeds the steady state background noise by themagnitude of the reference voltage VR. The outputsignal from comparator 235 has a binary one highlevel when the envelope detector 229 output exceedsthe valley detector 231 output by the referenceVR and otherwise provides a binary zero levelto control logic 209. The one level from comparator235 indicates that audio signals from microphone113 have been detected in the case of detector223 and that audio signals from receiver 203 havebeen detected in the case of detector 225. Summer 221 applies a signal that is the sum ofboth the audio signals from mobile radio receiver203 and the variable audio signals from audioswitch 207 to land party signal detector 225. Thus,the signal applied by summer 221 to detector 225varies as the volume of speaker 115 is varied. The control logic 209 in Figure 2 is responsiveto the output signals from the mobile and landparty signal detectors 223 and 225. The controllogic 209 provides a control signal for opening andclosing audio switch 207 and audio switch 205 viainverting gate 237. When audio switch 207 isopened, audio switch 205 is closed and vice versa. The hands free speakerphone of Figure 2,therefore, solves the echo problem by path switching,that is, determining whether the speakerphoneis to be transmitting audio signals picked up bymicrophone 113 or receiving signals from mobileradio receiver 203 by providing gain in one directionand attenuation in the other. A variable gain orpath switched technique such as that used in Figure2 is subject to a condition in which the initialspeech syllable from the path not switched isclipped before the signal detector detects and activatesthe switch. Additionally, background noise ofsufficient amplitude in either direction can causeblockage of a desired signal and cause confusionin the telephone conversation. Figure 3 shows a block diagram of a full duplexspeakerphone. A receive signal is conventionallyconverted to acoustic energy by speaker 113 andacoustic energy is converted to a transmit signalby microphone 115. Both the receive signal andthe transmit signal may be present simultaneouslyand the acoustic echoes, direct or reflected, arecancelled from the transmit signal by adaptive filter301 and associated subtraction network 303. Thehybrid echo is similarly cancelled from the receivesignal by adaptive filter 305 and associated subtractionnetwork 307. The adaptive filter 301 synthesizes the lineartransfer function of the receive signal acoustic echopath. The input signal is taken from the receivesignal input to the speaker 113. The output ofadaptive filter 301 is a representation of the receivesignal via the acoustic echo path, and is coupled tothe subtraction circuit 303 to cancel the actualreceive signal echo. An error signal from the outputof subtraction circuit 303 is coupled back to theadaptive filter 301 to produce a convergence of theweighting and filter coefficients used by adaptivefilter 301 to an optimum representation. Adaptivefilter 301 is a conventional nonstationery linearadaptive filter which will be described later. The adaptive filter 305 synthesizes the transferfunction of the electrical echo path. Its input isconnected to the transmit signal following subtractioncircuit 303. Based on the transmit signal input,adaptive filter 305 supplies a signal representativeof the echoed transmit signal to subtraction circuitry307. Subtraction circuit 307 essentially cancelsany transmit signal which is coupled to thereceived signal by a mismatched hybrid. An errorsignal is coupled from the output of subtractioncircuit 307 to adaptive filter 305 to produce convergenceof the weighting and filter coefficients usedby adaptive filter 305. Thus, the adaptive filter 301 linearly synthesizesthe acoustic echo signal which is correlatedto the receive signal and the adaptive filter 305linearly synthesizes the electric echo signal whichis correlated to the transmit signal. A problemarises if the transfer function of the echo signal isother than a linear function. For example, electricalto acoustical transducers such as speaker 113,typically have transfer functions that are non linear.The sound produced by a speaker contains distortion.If this distortion is not accounted for in thecoefficients of adaptive filter 301, the distortion isnot cancelled from the transmit signal and an echoconsisting of the distortion is returned to the far endparty. To aid in cancelling the non linear productsgenerated in the electrical to acoustic transducer,the configuration of Figure 4 has been developed.In this improvement of a speakerphone, a secondmicrophone 401 is added to sample the acousticenergy generated by speaker 113. This microphone401 may be optimally positioned between1 8 and 6 from the speaker. The microphone 401 sample includes the transduction non linearitiesand is input to adaptive filter 301. Because thesignal input to filter 301 more accurately simulatesthe echo signal input to microphone 115, a betterecho cancellation is achieved at subtraction circuit303. Some non linearities may be predicted and aphysical implementation of the predicted non linearitymay be created. A non linearity matchingcircuitry equivalent to the speaker 113 transferfunction non linearity may be used to sample theincoming received signal as shown in Figure 5. Thephysical implementation of the non linearity matchingcircuitry may vary depending upon the type ofdistortion encountered. The simplest implementationused in a preferred embodiment is a seriesimpedance followed by a voltage variable resistoror varistor. As the actual implementation may be adesigner s choice, the invention should not be limitedto a particular selection of components. Thenon linear matching circuitry 501 is coupled to theadaptive filter 301 such that the signal used tocreate the adaptive filter coefficients is processedto include the predicted non linearities of speaker113. Thus, if the non linearities can be predictedand an implementation realized, the sampling microphone401 can be replaced by circuitry 501. Similarly, non linearities introduced into theelectronic echo of the transmit signal may be simulatedby a non linear matching circuitry 503. Thusnon linearities such as those introduced in the radiosystem by signal compression, amplitude limiting,and expansion may be factored from the receivesignal by adaptive filter 305 and subtraction circuit307. It has been shown by others that allowing theadaptive filter to update the echo coefficients duringintervals when the desired signal is corruptedby noise or when the signal energy is concentratedin frequency or skewed, such as when single ormulti frequency tones are present, the adaptive filterassumes a transfer function which representsthe energy skewed signal. These coefficients maynot be optimum for the remaining frequency componentsof the signal to be cancelled. Consequently,a poor return loss path may be established atfrequencies which are not cancelled by the adaptivefilter. This poor return loss can lead to undesirableoscillations in the circuit. To resolve this problem, the signal detectorsdescribed in conjunction with Figure 2 may beemployed to gate the determination of coefficientsby the adaptive filter. One such arrangement isshown in Figure 6. In this embodiment, the analogsignal is converted to a digital representation of theanalog signal so that processing and cancellation ofechoes may be simplified. A receive signal from amobile receiver or the receive terminals of a four wireto two wire hybrid are digitized by conventionalanalog to digital converter 601. The digitizedreceive signal is then coupled to subtraction circuit307 which removes the near party echo from thereceived signal. Thence it is coupled to conventionaldigital to analog converter 603 and passed tospeaker 113 via attenuator 604 and any necessarypower amplification not shown . Analog to digitalconverter 601 and digital to analog converter 603may be realized with an integrated circuit,MC14402 available from Motorola, Inc. and includingboth functions. The land party signal detector225 determines that the received signal is a signalwhich may be used to develop appropriate coefficientsfor the adaptive filter 301. The output of thesignal detector 225 is a binary detection signaldeveloped by comparing the instantaneous energylevel to the background energy level plus a thresholdvalue. The background energy level is developedby filtering the instantaneous energy level.The filter in the preferred signal detector embodimentis a valley detector comprising an asymmetricalFIR filter with a slow rise time, which maybe on the order of 2 seconds, and a fast fall time,which may be approximately 50 msec. The valleydetector tracks the background energy by slowlyrising while speech or other information is presentand then quickly falling back to the ambient noiselevel when the information ends. By comparing thevalley detector output to the instantaneous engergy,an indication is presented to the associatedadaptive filter 301 to be used to enable and disablethe updating and modification of the adaptive filtercoefficients. Although the land party signal detector225 is shown and described as an analog detector,this detector may be digitally implemented andwould sample the received signal prior to digital toanalog convertor 603. The digitized receive signal is input to adaptivefilter 301 via optional non linear matching circuitry501. This portion of the receive signal is used bythe adaptive filter 301 to calculate filter coefficientsrepresentative of the received signal so that thereceived signal echo may be subtracted from thetransmit signal. The process used by the adaptivefilter 301 will be described later. The transmit signal may be generated by voiceor other signal generating means and, in a speakerphone,contains elements of the received signalacoustically coupled from speaker 113 to microphone115. This composite transmit signal is convertedto a digital transmit signal by conventionalanalog to digital converter 605 which may be anMC14402 before being passed to the subtractioncircuit 303. The coefficients computed for the receivesignal determine what fraction of the compositetransmit signal will be cancelled. Thus, theoutput from subtraction circuit 303 consists of the near end generated signal and portions of thereceive signal echo not removed by the subtractioncircuitry 303. Part of this transmit signal is fed backto the adaptive filter 301 to modify weighting factorsapplied to the receive signal coefficients sothat the amount of echoed received signal removedis optimized. Thus the feedback signal provides adynamic correction to the amount and frequency ofthe signal to be subtracted from the transmit signal. A portion of the transmit signal is passed toadaptive filter 305 through optional non linearmatching circuitry 503 so that a similar cancellationprocess of the echoed transmit signal may beremoved from the received signal. A mobile partysignal detector 223 is employed to detect thetransmit signal in the presence of noise and activatethe coefficient determination of adaptive filter305. The input to mobile party signal detector 223may follow a transmit signal digital to analog converter607 which may be an MC14402 or, if themobile party signal detector 223 is implemented indigital form, may precede the conventional digitalto analog converter 607. It will be recognized by those skilled in the artthat if the duplex speakerphone is realized bydigital signal processing, all of the digital functionsof Figure 6 may be implemented as part of a signalprocessing microcomputer and appropriate processingmethods. Furthermore, it is possible tocombine functions shown as discrete functions inFigure 6 into a single time shared function. Oneexample of such sharing might be the time shareduse of a single signal detector to accomplish thefunctions of both land party signal detector 225 andmobile party signal detector 223. Additionally, thenon linear matching circuitry 501 may be gain determiningentries in a look up table, chosen tomatch the speaker 113 distortion. Likewise the non linearmatching circuitry 503 may be entries tomatch the radio system distortion. An attenuator 609 follows the digital to analogconverter 607. This attentuator 609 and receivepath attenuator 604 are small value switched attenuatorsand may, in the preferred embodiment,provide as little as 0db attenuation to the respectivesignal. In the preferred embodiment these attenuatorsare variable gain amplifiers but may alsobe multiplication constants in a digital implementationand the invention need not be so limited. Theprimary function of the attenuators is to keep thesystem unconditionally stable since the adaptivefilters eliminate most of the system echoes. Typically,when one path alone has a signal, the attenuatorin that path is switched out and the attenuatorin the opposite path is switched in. Thisselection of attenuators is maintained when speechceases. This process is known as switch and stay.When both paths carry a signal, both attenuatorsare switched in. These low value switchable attenuatorsin cooperation with the signal detectorspermit simultaneous speech signals to occur withoutdetrimental effects. Figure 7 is a block diagram of adaptive filter301 which may be used to cancel the receivesignal echo from the transmit signal. A virtuallyidentical adaptive filter 305 is used to cancel thetransmit signal echo from the receive signal. Thereceive signal may be input to the adaptive filter301 via non linear matching circuitry 501 if suchcircuitry is desirable. The receive signal is presentedto a series of delay elements shown assignal delay blocks 701, 703 and 705. Each delayelement of the filter imparts a 125 microseconddelay to the receive signal in the preferred embodimentso that time delayed replicas of the originaldigitized receive signal are available at the outputof each delay element. The signals produced at theoutputs of each of the delay elements are adjustedby multiplying the delayed receive signals by afeedback signal in multipliers 707, 709 and711 factored by a predetermined weighting factorat 713, 715, and 717 and combined in summingnetwork 719. This signal, which is the algebraicnegative of the receive signal echo, is supplied tothe subtraction network 303 to cancel the receivesignal echo present on the transmit signal. Sincethe receive signal may be speech characterized byerratic signal levels and silent intervals, means foradjusting the adaptive filter is present via the feedbacksignal and amplifier 721. The gain of amplifier721 proportionally establishes the speed of correctionby providing a signal to be multiplied with thereceive signal at its delay components to producea signal whose polarity and magnitude indicate theappropriate correction for each delayed element ofthe received signal. Thus, if the error signal feedbackto the adaptive filter 301 indicates a substantialremnant of the echo in the outgoing transmitsignal, the amount of each delayed received signalis individually adjusted to allow a greater portion ofthe received signal to be passed to the subtractionnetwork 303. Inhibition of the calculation of coefficientsmay be accomplished by causing amplifier721 to cease passing error corrections to theweighting factors. Thus for a radiotelephone it is desirable to beable to communicate without having to use a handheld telephone handset. This is a basic safetyimprovement on simultaneously operating a vehicleand communicating by radio. It is also desirable tobe able to communicate in a full duplex mode thusavoiding audio path switching which can, at times,cause confusion and blocking by attempted simultaneoustalking. The present invention providesthe means to carry on a normal conversation and aradio communication system by the use of adaptive digital filters to cancel both the speaker tomicrophone coupling in the vehicle and whateverecho comes from the hybrid and the remainder ofthe communications system.