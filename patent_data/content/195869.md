# IMPROVED FILTER FOR DATA PROCESSING

## Claims
Abbildungsverfahren, aufweisend die Schritte Gewinnen von Daten von einem Gegenstandsquerschnitt von Interesse Modifizieren dieser Daten entsprechend eines Rekonstruktionsalgorithmus zur Konvertierung der Daten aus einem Orts in einen Ortsfrequenzbereich Filtern der modifizierten Daten mit einem Ortsfrequenzbereichsfilter und Zurückkonvertieren der gefilterten Daten in einen Ortsbereich und Rückprojizieren der Daten über einen Gegenstandsbereich von Interesse, um eine Strukturabbildung bereitzustellen

## Description
The present invention relates to cross sectional image reconstruction and particularly to a method for processing data in a computed tomography scanner. Reconstruction techniques for cross sectional imaging are known for deriving information concerning the internal structure of a subject. These reconstruction techniques are derived from mathematical reconstruction algorithms utilizing the fact that sensed data corresponds to a line integral of a function taken through a cross section of interest. These reconstruction algorithms allocate this function across the cross section in a process known as convolution back projection. In computed tomography, a patient or subject cross section of interest is successively scanned from different directions by an x radiation source to direct X rays through the cross section of interest. One or more detectors positioned on an opposite side of the patient from the source obtain intensity readings of the x radiation after it has passed through the patient. If enough intensity measurements from different directions are obtained, these intensity readings can be utilized to reconstruct an attenuation image of the patient cross section. In nuclear magnetic imaging, a structure is placed within a strong magnetic field to align the magnetic dipoles of atoms within the structure. A gradient field is superimposed at different orientations and the field is pulsed to perturb the magnetic moment of the atoms. As the atoms decay from the perturbed to their aligned state they generate fields characteristic of the structure of the atoms. The gradient field causes the atoms within the structure to decay with different characteristics which can be sorted out by a reconstruction process. Other uses for reconstruction processing are in geology and astronomy. In geology, for example, the internal structure of the earth can be discerned without actually excavating and physically analyzing the exposed structure. Various procedures have been tried to improve the accuracy of the information obtained using these reconstruction processes. One calibration technique used to enhance image quality in computed tomography involves the scanning and reconstruction of phantoms. Since the structure of the phantom is known the reconstructed image can be compared with the known structure to establish and determine the cause of discrepancies between the reconstructed image and the known structure. One problem experienced with computed tomography scanners is an inaccuracy in the CT numbers obtained, i.e. the numbers which designate radiation attenuation in each pixel of a computed tomography CT image. Reconstruction of water phantoms of varying sizes results in the CT numbers of water being off by as much as 90 CT numbers. The CT numbers of the entire image are shifted up or down by this amount. This inaccuracy seems to be dependent upon the size of the object under examination. One mathematical equation that solves the computed tomography reconstruction problem takes the form of a spatial domain convolution integral followed by an integration known in the art as back projection. The convolution is carried out directly in a spatial domain by taking the projection data from the X ray detectors and convolving this data with an appropriate convolution kernel. This spatial domain convolution, in theory, is carried out over the limits of plus and minus infinity. In the past, however, since it is known that the patient occupies a finite region in space this integration was limited to the specific region of interest occupied by the patient. Commercial third and fourth generation computed tomography scanners often use fourier transform techniques rather than spatial domain convolution. According to these more recent procedures a fourier transform of the data is performed, this transformed data is multiplied by a filter function, and then the inverse fourier transform is taken. This solution is documented in the literature. See, for example, Convolution Reconstruction Techniques for Divergent Beams , Herman et al, Comp Biol Med, Permagon Press 1976, Vol 6, pgs. 259 271. The Herman et al paper is incorporated herein by reference. The filter function used in scaling the fourier transformed data is the fourier transform of the convolution filter used in spatial calculations. The fourier transform of the convolution filter yields a ramp function which begins at zero and increases linearly with frequency to a maximum value. Since the ramp filter function is based upon a fourier transform of a spatial domain convolution filter used with earlier reconstruction techniques, this filter was not considered as a source for the CT number inaccuracies sometimes experienced in CT imaging. The present invention reduces the mathematical inaccuracies observed in performing image reconstruction in the prior art by use of a new filter function for reconstruction imaging. According to the present invention there is provided a method of imaging comprising the steps of obtaining data from a subject cross section of interest modifying said data in accordance with a reconstruction algorithm to convert said data from a spatial to a spatial frequency domain filtering said modified data with a spatial frequency domain filter and converting said filtered data back to a spatial domain and back projecting said data over a subject region of interest to provide a structure mapping characterised in that said spatial frequency domain filter has a function such that amplitude increases non linearly with frequency so as to deviate above and below a linear ramp filter function with deviations from the linear ramp filter function that diminish with increasing frequency. In a particular method according to the invention said spatial frequency domain filter function is derived from a spatial domain convolution filter by fourier transforming discrete points of said convolution filter. The present invention also provides an apparatus for imaging a cross sectional slice of a subject comprising means for obtaining data corresponding to the structure within said slice means for fourier transforming said data from a spatial domain to a spatial frequency domain means for filtering said transformed data means for performing an inverse fourier transform on the filtered data and means for back projecting said transformed filtered data to produce an image characterised in that said means for filtering has a function of linear ramp form with deviations therefrom which diminish with increasing frequency. One method and apparatus in accordance with the invention will now be described with reference to the accompanying drawings in which Figure 1 is a schematic perspective of a CT imaging system Figure 2 is a flow chart summarizing the steps of a CT image reconstruction Figure 3 is a schematic depiction of a prior art linear ramp filter function and a contrasting wavy ramp filter function conforming to the invention and Figure 4 is a flow chart of the steps in generating a new and improved CT filter function. Turning now to the drawings, Figure 1 illustrates a computed tomography scanning system 10 used in imaging cross sectional slices of interest in a patient. The computed tomography system 10 comprises a scanner 12 coupled to a viewing console 14, a computer 16, and specialized electronics 17 needed by the scanner 12 for control and data handling. The scanner 12 is a fourth generation computed tomography scanner where a fixed array of detectors 31 surrounds a patient aperture 18. During imaging a patient is positioned on a couch 20 and then moved into and through the patient aperture 18 until a cross sectional slice to be imaged is appropriately positioned. A scanner front panel 22 is hinged to the scanner housing and swings away from the housing to allow the interior of the scanner 12 to be accessed. The scanner housing is supported by a pair of supports 26, 28 and can be tilted about an axis extending through the supports parallel to the floor. In this way, patient cross sections other than a vertical cross section can be obtained without repositioning the patient. A series of electronic subsystems 30 shown to the side of the computed tomography scanner 12 provide voltages suitable for creating x radiation. In an X ray tube, highly accelerated electrons are directed to a tube anode from a cathode and in particular electrons having nearly 150,000 electron volts of energy strike the anode to produce x radiation. In computed tomography scanning, special electronics 17 analyze intensity values detected by the scanner 12. This specialized electronics 17 counts output pulses from a circular array 31 of scanner detectors as well as controls movement of an X ray tube and coordinates this movement with the analysis of the output signals. A service module 34 coupled to the electronics 17 allows the scanner 12 to be tested without the aid of the computer 16 or the viewing console 14. High speed computed tomography scanning is possible only through use of a high speed data processing computer 16. The illustrated and presently preferred computer 16 is a 32 bit Perkin Elmer mini computer with a disc storage capacity of 320 million bytes. This computer 16 performs the data processing for reconstructing a grid like image of attenuation variations inside the patient slice from intensity readings taken from the plurality of detectors surrounding the patient aperture. The particular computer chosen is responsible for not only analyzing and reconstructing cross sectional image densities but also for displaying this information on the console 14. The console 14 depicted in Figure 1 includes a first work station 36 for a technician operating the computed tomography apparatus and a second work station 38 for a person responsible for diagnosing the images produced. Although not shown in Figure 1, a remote viewing station is optionally provided so that the person diagnosing the patient need not be in the same location as the operator. Each detector in the array comprises a scintillation crystal coupled to a photodiode. In operation, the x radiation from the X ray tube impinges upon the scintillation crystal which converts the x radiation to visible light which in turn affects the current flow in the photodiode. Changes in current produced by the x radiation are converted from an analog current signal into a sequence of pulses which are counted. Electronics for generating these pulses in response to current changes in the photodiode are known in the art. The pulses are then counted and divided by the time period in which they are counted to obtain an indication of the intensity of the x radiation impinging upon the detector at a given time. Circuitry for performing this counting function is disclosed in U.S. Patent No. 4,052,620 to Brunnett which is assigned to the assignee of the present invention. That prior patent is incorporated herein by reference. Additional details concerning the scanner are disclosed in pending patent application Serial No. 441,903 to Zupanic et al entitled Computed Tomography Detection Method and Apparatus which is assigned to the assignee of the present invention. The disclosure of the Zupancic et al is also incorporated herein by reference. The steps of detecting the radiation 50 and generating the pulses 51 as well as determining the intensity 52 are depicted in a flow chart Figure 2 schematically describing the computed tomography process. These three steps 50, 51, 52 are followed by taking the logarithm of the data and a storing 54 of that data in the computer 16. The logarithm of the intensity data yields data proportional to the attenuation the radiation experiences. The remaining steps in the computed tomography process are performed by the computer 16. The computer first performs a series of calibration and correction calculations 56 on the data. These calculations are based upon data obtained during a CT set up phase. These calculations take into account variations in detector sensitivity, gain, and offsets in the electronics. Once these calibration steps have been completed, a digital filtering step 58 is performed where all data from each detector is filtered in accordance with a filter defined in accordance with the invention. The filtering process consists of performing a forward fast fourier transform of the data, multiplying the transformed data by a spatial frequency domain filter Figure 3 and then performing an inverse fast fourier transform to produce the filtered data. At a next stage of the computed tomography process, filtered data for those detectors which are not functioning is assigned data 64 based upon the filtered data from those detectors which are supplying valid data. Finally, all data, both from those detectors that are functioning and those which are not, are back projected 66 into a memory to produce an image of a particular patient slice under examination. Once this back projection process has been completed, this data is again stored and utilized in imaging 68 a picture of this slice on the console 14. Referring now to Figure 4, a flow chart summarizing the steps in computer generating a filter function are summarized. This filter function is stored and accessed as needed to multiply the transformed data at step 60 in the Figure 2 flow chart. The first six steps 110, 112, 114, 115, 116, 117 in the Figure 4 flow chart are initialization steps. A first step 110 sets a variable labeled PTS equal to the sample size of the data set to be filtered. In one embodiment this sample size is either 512 or 1024 points corresponding to a number of detector intensity readings per view in a fourth generation scanner. At step 112 a variable labeled FIELD is set equal to the field size which is the diameter of the region of interest within the patient aperture which is to be reconstructed. At a next step 114, a variable ANGLE is determined based upon the variables PTS and FIELD. This ANGLE is equal to the angular increment between consecutive samples of the data set, and is equal to the angle α defined with reference to the curved detector strip geometry illustrated at page 261 of the Herman et al paper. ANGLE is determined according to the following equations and D is the distance from the center of FIELD to the vertex of the data set as defined with reference to the curved detector strip geometry illustrated on page 261 of the Herman et al paper. To obtain data in a format such as the curved detector strip described in the paper, the data sets from detectors in a fourth generation computed tomography scanner such as the Synerview 1200 must be interpolated to form sets of divergent rays with constant angular separation between consecutive rays. In preparation for generation of the filter function, an array of variables named FILTER I is initialized 115 to zero. The next six steps 116, 117, 118, 120, 122, 124 are steps in generating a truncated convolution kernel. Only a symmetric half of this kernel is generated and it should be noted that all values of FILTER I after the first are zero for even values of I. At steps 126 and 128 two variables DPTS, QPTS are initialized and the next four steps 130, 132, 134, 136 produce a symmetric half of the convolution kernel by wrapping the data generated in steps 118, 120, 122 and 124 around a symmetric center point of the FILTER array. The next four steps 138, 140, 142, 144 truncate the convolution kernel and limit its extent to the geometrical extent of the region of interest within the patient aperture. At the conclusion of step 144 a truncated spatial domain convolution kernel of discrete points has been generated from the equation at step 120. These points are either zero outside the region of interest or defined by the equation in step 120. These are discrete points rather than the continuous convolution kernel utilized in generating a filter function in accordance with the prior art. At a next step 146 a fast fourier transform of the points defined in the earlier steps is taken to produce a spatial frequency domain filter utilized at the step 60 at Figure 2. In the remaining steps 150, 152, 154, 156, 158 of the Figure 4 flow chart the FILTER array is constructed from a real component of this fourier transformed data. A graphical representation of this filter is disclosed in Figure 3. This representation contrasts the prior art filter function which is a ramp function starting at zero and increasing linearly with constant slope. Figure 3 also illustrates the new and improved filter function which is seen to have low spatial frequency ripple with a finite value at zero frequency. Differences between the ramp filter with ripple of the invention and the prior art ramp filter diminish with frequency. This is illustrated in Table I where normalized filter values are tabulated. For low frequencies the ramp filter with ripple of column two oscillates above and below the linear ramp filter. At high frequencies the two filters coincide so that only a representative few of these filter values have been disclosed in Table I. In practice, these values are attenuated at high frequency to remove the effects of high frequency noise. This high frequency rolloff is known in the computed tomography art. Utilizing this new filter function to scale or multiply transformed data from the detectors produces computed tomography images in close agreement with phantom images. Images produced using the new filter function do not exhibit the object size dependent CT number inaccuracies of the prior art. The present invention has been described with a decree of particularity. The number of points comprising the convolution filter and the variables limiting the extent of that convolution filter can be varied to optimize CT image quality. In a preferred mode the filter values are stored in computer memory and the actual filtering performed by a dedicated array processor within the computer 16.