# DEVICE FOR PROTECTING COMPUTER SOFTWARE

## Claims
Vorrichtung 10 zum Überprüfen der Verwendung einer Software in einem Computersystem bezüglich wenigstens einem ausgewählten Verwendungsaspekt, wobei das Computersystem einen Zentralprozessor 16 mit der Software aufweist sowie mindestens eine mit dem Zentralprozessor verbundene Bedienungs Datenstation 14 , die zugriff auf den Zentralprozessor hat, und wobei die Vorrichtung 10 ein mit dem Zentralprozessor 16 verbundenes Empfangsmittel 72 hat, ein Speichermittel 82 , das Daten, die die Software Verwendungsgrenze für den ausgewählten Aspekt begründen, enthält sowie ein Mikroprozessor Steuermittel 60 und ein Unterbrechungsmittel 58, 70 , dadurch gekennzeichnet, daß die Software in dem Zentralprozessor 16 Verwendungsdaten erzeugt, die für die überprüfte Software Verwendung für den ausgewählten Aspekt des Computersystems bezeichnend sind, wobei die Vorrichtung, wenn die Verwendung der Software überprüft wird, wenigstens ein voreingestelltes Niveau von Vorkommen von Bedingungen benutzt, die die Verwendungsgrenze für den ausgewählten Aspekt verletzen daß das Empfangsmittel 72 mit dem Zentralprozessor 16 verbunden ist zum Empfang der überprüften Software Verwendungsdaten von der Software in den Zentralprozessor daß das Speichermittel 82 Daten enthält, die das voreingestellte Niveau von Vorkommen von verletzenden Bedingungen etablieren, und das Speichermittel die verletzenden Bedingungsvorkommen Daten, die mit dem Betrieb des Computersystems entstehen, speichert sowie die Daten abspeichert, die für die bestehende Verwendung der überprüften Software bezeichnend sind daß das Mikroprozessor Steuermittel 60 mit dem Empfangsmittel 72 und dem Speichermittel 82 verbunden ist, um in Reaktion auf die Verwendungsdaten die Bedingungen zu bestimmen, die die Verwendungsgrenze verletzen, und zur Bestimmung, ob das Vorkommen der verletzenden Bedingungen einen Bezug hat auf eine vorbestimmte Beziehung zu dem aufgestellten Niveau von Vorkommen von verletzenden Bedingungen und daß das Unterbrechungsmittel 58, 70 mit dem Computersystem und dem Steuermittel 60 verbunden ist und von dem Steuermittel gesteuert wird, um eine Ausgabe an das Computersystem zu schaffen, wenn die Vorkommen der verletzenden Bedingungen einen Bezug haben auf die vorbestimmte Beziehung zu dem aufgestellten Niveau der Vorkommen von verletzenden Bedingungen, wobei die Ausgabe so arbeitet, daß gemäß der so bestimmten Beziehung die Verwendung der Software in dem Computersystem in einer vorbestimmten Weise gesteuert wird.

## Description
This invention relates to an apparatus for monitoring the use of software in a computer system with respect to at least one selected aspect of such use, the computer system having a central processor containing the software, and the central processor being accessed by at least one operator terminal connected to it. More particularly, the invention relates to a combination software and hardware device for use with computer systems having one or more consoles or terminals connected to a central processing unit. Computer software, programs, or packages of programs are often licensed by the developer or other supplier to the user or customer. The software licence may provide that, for a prescribed payment, the program may be used a given number of times, or for a given number of hours, or on a particular computer system, or on a given number of terminals. Licensing of software on a per terminal basis would be highly desirable as a convenient way to distinguish small users from large users and adjusting payments accordingly. However, once the software is provided to the customer by the supplier, it is currently very difficult for the supplier thereafter to control the access, use, or transfer of the software. It is correspondingly difficult for the supplier to police the software licence. As a result, suppliers are often reluctant to enter into limited licences. The advantages of such licences, for example lower cost to small users or flexible pricing, are lost. Techniques for the control or protection of computer programs currently use either a software approach or a hardware approach. A hardware approach to preventing unauthorised use of computer programs typically employs a physical key, such as a specially coded card which must be inserted in a lock in the computer system before access can be had to the program. The key provides data, such as an electronic serial number or authorisation number. The correctness of the data must be properly verified before a program can be run. Alternatively, a programmable read only memory PROM may be inserted in the computer system. The program then detects an authorisation number in the PROM to permit the program to operate. Another approach is to put authorisation data, such as a serial number, physically in the circuitry of the computer system. When the program is initially run, the authorisation data of the computer system are entered in a blank in the program. Thereafter, the program will only run if the authorisation data are present. While the security provided to the program is high with the hardware approach, there are factors which limit its use. A major drawback is cost, both in the key and in the modification to the computer system. This has tended to limit the hardware approach to protection of large, expensive software programs. Many manufacturers do not put a serial number in the circuitry of the computer. Also, if the computer circuitry must be changed, there is a problem of getting the new authorisation data into the program. Further, the hardware approach is not particularly well suited for situations where use of the program is to be permitted, but under limited conditions. In the software approach to program protection, the program is altered by encryption techniques so that it is not accessible without a software key placed on the medium containing the program, such as a computer disc. The software approach is less expensive than the hardware approach but less secure. Furthermore, there are several problems in the software approach. One is that it prevents legitimate copying as where an authorised user wishes to make a back up copy of the program. A second drawback is that devices known as nibble copiers can duplicate all the software on the disc, including the software key, so that the security is greatly compromised. Nor does the software approach protect against an unauthorised taking of the program from one computer system to another, since the security data are transferred along with the program. Because of the shortcomings of the hardware only and software only approaches, combined software and hardware techniques are becoming available. One such approach to the prevention of copying places a unique pattern or fingerprint on blank media, such as floppy discs, for storing the program. The program is placed on the disc by the manufacturer through software that encrypts the program source code several times to link the encrypted program to the unique pattern. The program can then be accessed only if the pattern is present, thus preventing copying of the program. However, this, and similar approaches, are limited to the media element of the computer system. None of the foregoing techniques permit authorised use, whilst preventing use of the program or software outside limits authorised or established in a software licence. US A 3806882 describes a system that controls access to information stored in a computer by means of a portable electronic key device which either prevents or allows access to the computer. JP A 57 97162 relates to preventing access to a central data file. A terminal discriminating and processing part determines whether a requesting end user is an authorised user or not. Only authorised users are permitted access to the files, but once in have unlimited use. JP A 58 82355 prevents improper use of portable terminal equipment by registering information for preventing improper use, and its permitted frequency of error. When an error count of input data exceeds the previously registered permitted error frequency, the equipment is made ineffective. The present invention is directed to a software hardware device for controlling access to a main or host computer, and the programming contained therein, from one or more computer terminals or consoles. The access may be controlled in accordance within limits established in a software licence. According to the invention there is provided apparatus for monitoring the use of software in a computer system with respect to at least one selected aspect of such use, the computer system having a central processor containing the software, the central processor being accessed by at least one operator terminal connected to the central processor the apparatus comprising receiving means coupled to the central processor, memory means for containing data establishing the software usage limit for the selected aspect, microprocessor control means, and interrupt means characterised in that the software in the central processor generates usage data indicative of monitored software usage for the selected aspect of the computer system, the apparatus employing at least one pre established level of occurrences of conditions violating the usage limit for the selected aspect when monitoring use of the software in that the receiving means is coupled to the central processor for receiving the monitored software usage data from software in the central processor in that the memory means contains data establishing the pre established level of occurrences of violating conditions, and stores violating condition occurrence data arising from operation of the computer system, and records data indicative of existing usage of the monitored software in that the microprocessor control means is coupled to the receiving means and to the memory means for determining, in response to the usage data, the conditions violating said usage limit and for determining whether the occurrence of the violating conditions bears a predetermined relationship to the established level of occurrences of violating conditions and in that the interrupt means is coupled to the computer system and to the control means, and is controlled by the control means to provide an output to the computer system when occurrences of violating conditions bear the predetermined relationship to the established level of occurrences of violating conditions, said output operating to control, in accordance with the relationship thus determined, the use of the software in the computer system in a predetermined manner. In a typical application of the device, data not significant to security, for example data occurring during the ordinary operation of the computer system, pass unimpeded between the central processing unit and the terminal. When data having significance from the security standpoint are sent from a terminal to the central processing unit, the computer system will interrogate the security device of the present invention. Such data might typically be a request to run a particular program. The device has the use limits permitted by the software licence programmed into it. If the request is proper and within the limits established by the software licence, operation of the program is permitted. If the request is not proper, the security device produces a variety of consequences. For infrequent improper requests, operation of the program may be permitted, depending on the applications program, but with an appropriate warning displayed on the computer terminal. For frequent improper requests, operation of the program is blocked by the security device until released by the software owner or supervisory personnel. The device of the present invention, which is independent of the central processing unit, thus monitors program access requests so as to properly control access to the programs in the central processing unit. By contrast to other approaches to program security, the device of the present invention is an intelligent device having interactive capabilities. For this purpose, the device may employ a micro processor. The device is readily auditable to ascertain which programs are authorised and the limits of that authorisation. The device may also store commercial data relating to the programs, such as the name of the software licensee. The authorisation can easily be changed in the field through a local terminal or through a remote terminal connected by a modem. Warning messages and the like provided by the device can be similarly changed. The device may use units, such as cartridges, which can be inserted into the device to permit control of the authorisation of software application packages or supplier designated software products, such as word processing or graphics programs. This provides increased authorisation control, maintainability, and field reliability. For instance, multiple software suppliers can control and maintain use of their products without coordination with other software suppliers in a single computer system. This is in contrast to past approaches in which a single knowledgeable source of the authorised configuration must be reached to restore operation of the computer system following the field failure. Embodiments of the invention will now be described, by way of example, with reference to the accompanying drawings, in which Referring to Fig. 1, a software protection device 10 of the present invention may be interposed in a data signal link or line 12a and 12b between a computer terminal 14 and a central processing unit 16 of a computer system. Other terminals 14a, 14b may be connected to the central processing unit 16. For some types of central processing units, a second connection between the device 10 and the computer 16 may be made by a link or line 18 for security purposes because of the particular operating system used. The line 18 is connected to an additional peripheral port of the central processing unit 16. Alternatively, the device 10 may be connected to the central processing unit 16 only via the line 18, as shown in Fig. 2. The internal configuration of the device 10 is shown in Fig. 3. The device 10 shown in Fig. 3 is suitable for the connection shown in Fig. 1. The data signal line 12a from the terminal 14 is coupled to a port 50 of the device 10. The data signal line 12b, connected to the data port of the central processing unit 16, is coupled to a data port 52 of the device 10. Internal lines 12 and 12 interconnect the ports 50 and 52 to maintain the data signal path between the terminal 14 and the central processing unit 16. The arrows shown in Fig. 3 symbolically show the flow of data to and from the central processing unit 16 and the terminal 14. The line 12 contains signal level shifters 54 and 56 which alter the signals in the line 12 to levels appropriate for the operation of device 10, central processing unit 16, and terminal 14. Level shifters 54 and 56 may comprise integrated circuit RS 232 level shifters, such as that made and sold by National Semiconductor Corp., under the model no. 1488 or 1489. Line 12 also includes an interrupt means 58, shown diagrammatically as a switch operable by controller 60. Interrupt means 58 may be operated by controller 60 to cause the display of warning messages on terminal 14 in certain operating modes of the device and to disable data signal lines 12a, 12b under certain conditions of attempted unauthorized use, as described below, from the standpoint of passing normal data traffic. A second pair of internal data lines 18 and 18 are provided in device 10. Lines 18 and 18 are connected to port 62 and to security data line 18 leading to the additional peripheral port of central processing unit 16. The other ends of lines 18 and 18 may be connected to port 64 that permits additional security devices to be connected in series with the device shown in Fig. 3, as shown in Fig. 7. Data line 18 includes signal level shifters 66 and 68 similar to level shifters 54 and 56. Data line 18 also includes an interrupt means 70 operable by controller 60 to supply information and commands to the software program in central processing unit 16. Universal asynchronous receiver transmitter 72 has the receiver port connected through level shifter 74 to data line 18 . The transmit port is connected to interrupt means 58 and 70. Receiver transmitter 72 may comprise an integrated circuit, such as that made and sold by Signetics, as model no. SCN2651. Controller 60 may be a microprocessor, such as that made and sold by the Motorola Corporation, of Phoenix, Arizona, under the designation MC6809. Watchdog 76 may comprise a monostable multivibrator that clocks and resynchronizes controller 60 to insure proper operation of controller 60. Data bus 78 connects controller 60 to memory 80. Memory 80 may comprise an electronically erasable programmable read only memory EEPROM . Universal asynchronous receiver transmitter 72 is connected to data bus 78. Memory 80 contains data relating to the operating system for central processing unit 16. It may also contain the data maintenance and operating programs for device 10, as well as a map of the data contained in cartridges 82 hereinafter described. Data relating to the programs authorized to run on the computer system 14 16 is contained in plug in cartridges 82a, 82b, and 82c. These plug in cartridges may each comprise an electronically erasable programmable read only memory EEPROM containing data specific to a particular vendor. The EEPROM contains the limits of authorization for the various programs and packages contained in central processing unit 16. A map of the data in the cartridge is also included in the EEPROM. The cartridges are connected to controller 60 by data bus 84. Device 10 operates as follows, as shown in flow chart form in Fig. 4. Device 10 monitors line 18 from the security port of central processing unit 16 as at step 100 in Fig. 4 to ascertain the presence of information significant to program security. Thus, when a request from terminal 14 to central processing unit 16, via the applications software program in central processing unit 16, requests authorization to run a particular program, the application software in central processing unit 16 will, in turn, issue a request in security lines 18 to device 10 as at step 102 to inquire whether running of the program is authorized. The request will be received by universal asynchronous receiver transmitter 72 and provided to controller 60. Controller 60 through data bus 84 will interrogate the applicable cartridge 82 to obtain the authorization data relating to the requested program, as at step 104. If the request is within the authorization provided in the software license, controller 60 will provide a response through receiver transmitter 72 in data bus 18 , 18 to the associated port of central processing unit 16 indicating to the computer system that operation of the program is authorized. The program is then permitted to run. This is shown in Fig. 4 as step 106. If the analysis of the request for program authorization at step 104 indicates that the request is not within authorized limits, the following operation will occur. The applicable cartridge 82 contains data relating to the number of unauthorized requests for the program the time of the last unauthorized request and a moving average of the frequency of unauthorized requests. This data is interrogated by controller 60 via data bus 84 at steps 107, 108, and 110 of Fig. 3. At the same time the stored data is updated at steps 112, 114, and 116. Computation of the moving average may employ an exponential smoothing function in which latter entries may be related to earlier entries in a desired manner to reflect the number of incidents of significance in the average. Based on the frequency at which unauthorized requests are occurring, one of four events will occur in protective device 10. The frequency levels at which the various events will occur are programmed into cartridges 82 by the software supplier. A very low frequency of unauthorized requests indicates that the unauthorized requests are probably occurring through inadvertency or genuine error. For example, a terminal operator may inadvertently request the wrong program. Or, the correct program may be requested but at the wrong time. If the frequency of unauthorized request is less than some predetermined number A programmed into the applicable cartridge 82, as determined in step 118 of Fig. 4, an error message is sent to central processing unit 16 from protective device 10 at step 119 for whatever further action may be undertaken by the applications software. The message will be provided from receiver transmitter 72, as controlled by controller 60, and interrupt device 70. The message indicates that a violation has occurred but that it is a low level violation. This may be termed a Level I violation. The applications software will typically provide a warning on the operator s terminal screen 14. Other typical action that could be taken by the application software might include entry in a master log in central processing unit 16 or the provision of a warning signal to a supervisory terminal connected to central processing unit 16. Normally the application software would be permitted to run after the appropriate warning signal has been recorded and or given, as shown in Fig. 4. For infrequent violations, it will be appreciated that the operation of device 10 is basically open loop. Messages are sent to central processing unit 16 but no other action is taken by device 10. If the unauthorized requests are occurring at a greater frequency, this may be taken as evidence that some deliberate attempt is being made to obtain unauthorized access to the programs in central processing unit 16. Step 120 in the flow chart of Fig. 4 ascertains that the frequency of unauthorized requests is greater than the threshold A of step 118 but less than some greater frequency B also programmed into the applicable cartridge 82. This may be termed a Level II violation. Under this circumstance, an error message is sent to the application software in central processing unit 16, as at step 121, similar to the action 119 taken for low frequency violations. However, additionally, a timer provided in controller 60 is set in operation as at step 123. If security device 10 does not receive an appropriate response from the software in central processing unit 16, within the time period of the timer as at step 125 receiver transmitter 72 provides a signal in line 18 from interrupt device 70 to disable that particular piece of software from running in central processing unit 16 as at step 127. The computer system can run other software for which authorization is not required or for which authorization is properly obtained. If the software in central processing unit does provide the appropriate response to protection device 10 within the time period of the timer, the software is permitted to run in the same manner as described in connection with step 118. The additional action discussed above would ordinarily be taken, such as a warning on terminal screens, entry in master logs, and the like. The operation of device 10 just described is closed loop in that a response, or lack thereof, from central processing unit 16 back to device 10 is involved in the operation. If the violation frequency is greater than the threshold provided in step 120 but less than some higher threshold C, as determined in step 122 shown in the flow chart of Fig. 4, receiver transmitter 72 and controller 60 operate interrupt device 70 that acts directly on central processing unit 16 to disable the program, as at step 124. Receiver transmitter 72 and controller 60 also operates interrupt device 58 to send a disable message directly from device 10 to terminal 14, as at step 129. This is a Level III violation. For Level III violations, operation of the computer system can only be restored or released by the insertion of a key sequence from computer terminal 14 to controller 60 or cartridge 82 as at step 126. This could be done by the user s supervisory personnel. Or it could be done by a field service representative of the program supplier, either locally through user s terminal 14 or remote from terminal of the supplier connected by a modem. It should be noted that, at violation Level III, the operation of protection device 10 does not depend on the application software in central processing unit 16. Rather, protection device 10 operates independently on central processing unit 16 to disable operation of the protected software. For very, very frequent violations greater than frequency C, that can only indicate deliberate attempts to secure unauthorized access to the program, protection device 10 again disables the program in the same manner as described in the preceding paragraph as at step 128. However, protection device 10 will only restore operation of the protected software by a key sequence inputted to controller 60 from the program supplier s factory, as through a modem connected either to central processing unit 16 or protective device 10 or from terminal 14, as at step 130. This is termed a Level IV violation. Data relating to the number of unauthorized requests and the time they are occurring indicated at steps 114 and 116 in Fig. 4 may be used to assist in detecting the source of the unauthorized requests. In a usual embodiment of software protection device 10, the typical data shown in the following data table would be provided in each cartridge 82. It is anticipated that each cartridge 82 could typically be of sufficient storage capacity for the data relating up to approximately one hundred software packages. The data table is as follows. The foregoing data table provides the data necessary for operation of the protective system, as well as the necessary control information to the software supplier. As will be noted from the data table, cartridges 82 may be reprogrammed from terminal 14 to alter the limits of authorization. For example, in return for increased payments, the limits of authorization can be expanded. Any such changes require proper validation and modification access data or passwords. The application software may be transferred to another central processing unit by transferring both the software and protection device 10 or, at least the appropriate cartridge 82. However, if transfer of the software is attempted without the cartridge 82, the software cannot be made to run. Fig. 5 shows a device 10A of the present invention suitable for use with a computer system having only a single data line 12 for both data and security information. The configuration of device 10A generally resembles that of device 10 as shown in Fig. 2. Interrupt means 58 is connected in data signal line 12 to disable operation of the software and provide messages from receiver transmitter 72 to the screen of terminal 14. Fig. 6 shows a device 10B of the present invention suitable for operating solely through the associated additional peripheral port of central processing unit 16. All warning and interrupt messages are transmitted through this port of the central processing unit via the line 18. Fig. 7 schematically shows use of a plurality of software protection devices 10 1, 10 2 and the associated interrupt devices 58 and 70 between terminal 14 and central processing unit 16. Protection devices 10 1 and 10 2 are connected in series on security line 18 and or, if applicable, on data signal line 12. The use of additional protection devices 10 increases the number of software packages that can be protected.