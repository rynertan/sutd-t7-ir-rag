# Method of providing security of data on a communication path.

## Abstract
Privacy and security of a dial up data communications network are provided by means of a user terminal identifi cation code I.D. together with a user terminal primary cipher key. A list of valid I.D. and primary cipher key code pairs is maintained at the host location. I.D. and cipher key pairs, sent to the host via an anciphered line, are com pared with the stored code pairs. Match up comparison of the code pairs is made by the host before host acquisition by the terminal user is allowed. All data put on the com munications line at either end is totally encrypted to pre vent unauthorized access.

## Claims
CLAIMS 1. A method for providing security of data on a communications path between a host and a remote terminal, comprising the steps of providing a valid list of user identification code and primary key pairs to the host assigning a specific user identification code and associated primary key pair to a user, said code pair being one of said valid list of pairs, communicating said specific user code to the host by means of the communications path searching said valid list of pairs by said specific user code to find said specific primary key of said specific user code and said associated primary key pair generating and encrypting a new session key using said found primary key for said encrypting sending said encrypted session key and information to the remote terminal by means of the communications path said information being encrypted with said found primary key decrypting said encrypted session key and said information at the remote terminal using said specific primary key and communicating further information between the host and the remote terminal by means of the communications path said further information being encrypted and decrypted by said session key. 2. The method according to Claim 1 further comprising the steps of destroying said user code and said primary key in the remote terminal upon completion of the communications session. 3. The method according to Claim 1 further comprising the step of installing said specific user identification code and said associated primary key in the remote terminal for automatic acquisition thereto upon request from the host. 4. A method for providing security of data on a communications path between a host and a remote terminal, comprising the steps of providing a valid list of user identification codes and primary key code pairs to the host assigning a specific user identification code and associated primary key code pair to a specific user requiring the entry by said user of said specific user code and primary key pair at the remote terminal communicating said specific user code to the host via the communication path searching said valid code pair list by said specific user code to find said specific primary key of the specific user code and specific primary key pair generating and encrypting a new session key using said found specific primary key for said encryption sending said encrypted session key and some information to the remote terminal via the communication path from the host decrypting said encrypted session key at the remote terminal by means of said specific primary key transmitting further information between the remote terminal and the host, said further information being encrypted by said session key and destroying said specific user code and said specific primary key at the remote terminal upon completion of the communications session.

## Description
The invention relates to a method for protecting the security and privacy of a data transmission system by use of identification and key words at an otherwise unprotected terminal. The dial up network for time sharing and data base management applications can be viewed as a special case of a dedicated line network. Use of a dial up configured network requires special treatment when consideration of security and related operations are made. The remote site equipment is typically a teleprinted or CRT terminal with either an integral or separate telephone coupler modem. The equipment operates using asynchronous line discipline. Operation is based on the interactive nature of the dialogue between the computer and the terminal.No error checking is generally available so full duplex operation is used so that the operator can verify that he has entered the desired character into the computer. Basically, this is accomplished by entering data at the keyboard and transmitting it directly to the computer. The data is not printed until the computer sends back, or echos, the characters that it has received. Thus, the printer prints what the computer receives and sends back. The operator knows what was typed so may judge if the computer is receiving the proper information. Host site equipment or dial up concentrator site equipment consists of a dial up modem connected to a communications line adapter which in turn is connected to a computer. When a remote terminal calls, the modem answers the ring and selects a vacant line to the computer then notifies, via a connect signal, that the terminal is connected.The computer usually asks the terminal user for identification and, if correct, aids the terminal user by means of prompts, etc. to follow desired tasks. Operating a remote terminal is a rudimentary task, consisting of simple sequential steps. The operator turns on the terminal, dials the special telephone numbers supplied, places the telephone in the coupler and waits for computer response.Typically, the computer asks for an account number and a password. The operator enters these numbers committed to memory or recorded and waits for the computer to accept his log on requests some systems may not require log on steps . If accepted, a prompt character is printed indicating that the computer is ready to begin an interactive dialogue. Problems relating to the security of systems accessible by dial up lines abound. The main threat is that anyone who can, call up the computer may be able to use confidential data or programs stored in the computer data base for their own unauthorized use. Prevention of these problems has been attempted in nearly every major system in use. Two general solutions form a basis for discussion of security problems. One solution to the security problem is that of terminal authentication. In the dial up network scenario, any terminal may be connected to the host given the phone number of the dial up modem at the host site. Terminal authentication is the means by which the host is assured that the terminal connected is one which is allowed and not that of an intruder. Terminal authentication is important where many legitimate computer users share a single terminal. It is assumed that anyone using the terminal is authorized. When the users of a computer system are dispersed and or mobile it has been considered desirable to control access to the host by controlling the user rather than the terminal. Each user then has special passwords and or account numbers which allow individual authentication to the host. The subject of privacy is closely related to the effect of many of the threats discussed below. Privacy is the safeguarding of all data passing from the terminal to the destination and back from accidental or premeditated examination while en route. Some schemes for authentication and authorization may not include facilities for privacy, but privacy techniques almost always provide these as side benefits. In the dial up network, the phone line which connects the terminal coupler to the host consists of several segments. The first segment local loop connects the coupler to the local phone switching centre. The centre may be in the basement of the same building or in a separate building some distance away. The local loop typically passes through several connection blocks on its way to the switching centre. The host is similarly connected. Thus, even a dial up line which may use many different paths from the switching centre used by the terminal to the switching centre used by the host uses a single vulnerable path at each end of the line. The wire tap is the major threat to these lines. A passive wire tap can be connected which allows all authentication and authorization data to be recorded for later use in accessing the host. An active wiretap may be connected to the line allowing access to the host by the piggyback method. This operation by the wire tapper allows the legitimate user slog on information to pass through the tap to the host. When the user enters the sign off command, however, the active tap intercepts this message and simulates the sign off message to the user. The actual sign off is not passed to the host. Instead the wire tapper takes control of the user s files with no record of this illegitimate modification or readout being made. These and other shortcomings and problems of the prior art are solved by the present invention by maintaining passwords or key words in an encrypted form while in the dial up network domain. It is therefore an object of the invention to provide a system operating method wherein at least some of the account numbers, passwords or key words are never present in the dial up network portion of the data system except in encrypted form. It is another object of the invention to provide data system security without necessary for locked hardware enclosures. It is yet another object of the invention to provide security and privacy in a data transmission system used on a dial up network by means of encrypted key words. These and other objects of the invention will become more readily understood upon study of the detailed description of the invention together with the drawings in which Figure 1 is a block diagram of first embodiment of the invention in which identification and keywords are contained or stored within a remote terminal, Figure 2 illustrates in a flow chart form step by step procedure for enabling secure data transmission in the system of Figure 1, Figure 3 is a block diagram of a second embodiment of the invention in which identification and kay words are entered by the user, and Figure 4 illustrates in flow chart form a step by step procedure for enabling secure data transmission in the system of Figure 3. There are two scenarios in which key word security may be subject to operational problems.The first situation exists where a remote data terminal is relatively secure i.e. the users access to the terminal is well controlled and the main security threat is from a wire tap. The second situation exists where user access to the terminal is not well controlled and an additional threat is posed by an unauthorized user. A first embodiment of the invention is illustrated in Figure 1. Figure 1 embodiment is intended to solve the first threat case, above, that of the wire tap. Terminal 10 is connected by means of terminal encryption module TEM 12 to telephone coupler 14. TEM 12 contains an identification code, in the illustrated case,ID2. TEM 12 also contains primary key K2.Coupler 14 is connected by means of dial up telephone system 16 to dial up modem 18. Dial up modem 18 is connected to terminal access module tax 20 whenDial Connect Signal CTS 22 is present. TAM 20 is connected to host computer 24 when OTS 26 is present. TAM 20 contains table look up pairs 28 of IDn and K. IDn and Kn pairs are related to n terminals, each having an IDn Kn code keyword pair and each pair is unique to its terminal. In operation, the system of the invention follows procedural flow chart of Figure 2. Referring thereto, it will be seen that in the first step of the method of the invention, the user dials the computer 40 and places the handset of his telephone in an audio coupler if this connection is not already made electronically. In the second step, the terminal access module TAM 20 of Figure 1 intercepts a dial connect signal CTS 41, and sends a request for identification to terminal encryption module gEM 12 of Figure 1 . The TEM responds by sending ID2 in this illustration 43 which may be a two character identification code ID2 which has been stored in the TEM at installation or subsequently.The DAM does a table 28 of Figure 1 look up to find and call up E2, the primary key word which is associated with ID2. The next step 44 is to send to TEM 12 of Figure 1 a session key, K5 and randomly generated information, INFO both of which are encrypted by K2 according to the algorithm described by a standard data encryption system such as that described in Federal InformationProcessing Standard Publication 46 and available through the National Technical Information Service.This encrypted data is decrypted by use of primary key K2, locally stored at TEM 12 of Figure 1 and decrypted K5 is then used to encrypt the decryptedINFO for transmission back to DAM 20 of Figure 1 .If information received and decrypted by the AM agrees 46 with that encrypted and sent by the AM 44, the system sends a dial connect signal CTS to host computer 24 of Figure 1 . If the information does not agree 46, no OTS is sent and an alarm may be made to occur at the TAM. Assuming OTS is sent to the host computer 48, all messages to the TSE 49 and to the DAM 50 are encrypted using K5 as the encryption key. When a disconnect signal is received by the TAM 51, encryption and decryption cease and, of course, the telephone line is disconnected by the hang up which caused the disconnect. Upon review of the operating procedure described above, it will be seen that K2 is never actually present on the telephone wires. It is not, therefore, subject to the wire tap threat. The only time E2 is used on the wire at all is in step 44 of Figure 2 where session key K5 and information are encrypted by E2 and sent to the TEM. K2 is not present in this transmission and the only way in which a wire tap could reveal K2 is if there were prior knowledge of K5 and or the associated information encrypted by K2. But K5 and the information are randomly generated for each contact with the user.Therefore since K2 is used to encrypt Ks, Ks remains secure and may be used for encryption and decryption of all messages 49, 50 for the rest of the session for which K is generated. In another embodiment of the invention see Figure 3 , which is similar to that described above and in Figures 1 and 2, IDn and primary key, Kn are not contained in the remote terminal TEM 72.This slightly different embodiment of the invention may be utilized where the remote terminal is not secure and where the onus of security is placed upon the human users of the system. This might be the case, for example, where the remote terminal is a portable unit or where,bynecessity, it must be located in a relatively public or insecure location. In operation, the procedure is similar to that described for the embodiment of Figure 1 except for differences required by the fact that IDn and do do not reside in TEM 72. It is therefore a requirement for the user to supply his ID code and primary key to the TERM. The code and key become peculiar to the user rather than the terminal. In this preferred embodiment of the invention, the user puts terminal 70 in a local operational mode and inserts a wake up character by means of the keyboard 100, Terminal 70 responds with TENTER ID 101 or the equivalent. The user enters his ID which may be ID2, for example. Terminal 70, under control of TEM 72, prints ID2.If the user verifies that the printed ID is correct he strikes CR carriage return and terminal 70 overstrikes the ID 102 to maintain security of the code. Terminal 70 then prints 11ENTER KE 103 or the equivalent. The user then enters his primary key, K2 in this example , terminal 70 responds by printing E2 and when the user is satisfied that his key has been correctly printed he strikes CR . Terminal 70 responds by overstriking the printed K2 104 to maintain security of the key. The users ID2 and K2 now are resident in TEM 72 and the system, temporarily, appears to be the same as the system of Figure 1. The operational procedure of Figure 2 is followed 105 from this point on with one exception when step 52 of Figure 2 is reached, stop encryption, ID2 and K2 information which has been temporarily resident in TEM 70 is destroyed 106. Since ID2 andE2 are now removed from TEN 70, an unauthorized user is not able to access the computer through terminal 70 subsequent to the authorized user s access. As in the first embodiment of the invention, above, E2, the primary key, is never present on the dial up network and is not subject to a wire tap threat. Es, the session key, is only used as encrypted by K2 or as a data encrypting key so it is also not subject to the wire tap threat. The encryption decryption algorithm is publicly known, but the keys used are protected and so the data sent over the dial up network are protected so long as the ID Key pairs are not available to one who would breach security. Control of authorized users is accomplished at the host end at AM 20 by adding or deleting ID Key pairs. A previously authorized user may be locked out by removal of the ID Key pair previously assigned. A new user can become authorized when an ID Key pair is entered into the TAM 20 and the same ID Key pair issued to the user. Anyone without the proper ID Key pair cannot gain access to the computer. While the invention has been particularly shown and described with reference to two preferred embodiments thereof, it will be understood by those skilled in the art that varIous other modifications and changes may be made to the present invention from the principles of the invention described above without departing from the spirit and scope thereof, as encompassed in the accompanying claims. Therefore, it is intended in the appended claims to cover all such equivalent variations as come within the scope of the invention as described.