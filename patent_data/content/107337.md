# Improvements in or relating to sample and hold circuits and methods.

## Abstract
A feedback sample and hold circuit has an amplifier A whose output is connected through a sampling switch S

## Claims
CLAIMS 1. A sample and hold circuit including an amplifier A , a primary sampling switch Ss connected in a circuit path between an input for a signal source and an input 15 of a buffer B , a primary holding capacitor CH connected between the input of the buffer and a reference potential point, and feedback means SF responsive to output of the buffer for providing a feedback signal to an input of the amplifier, and characterized by correction sample and hold means sic CcH connected to the output of the amplifier and responsive to switching feedthrough error generated by the sampling switch for substantially correcting such error. 2. A circuit as claimed in claim 1 wherein the correction means includes a correction sampling switch and anda correction holding capacitor CcH connected serially respectively, between the output of the amplifier and a reference potential point, and coupling means Ccc connected to a node 22 between the correction sampling switch and the correction holding capacitor and serving to provide a correction signal. 3. A circuit as claimed in claim 2 wherein the coupling means includes a correction coupling capacitor connected between the input of the buffer and the said node and having a capacitance substantially less than that of the primary holding capacitor. 4. A circuit as claimed in claim 2 or 3 including a correction zeroing switch so2 connected between a reference potential point and the said node. 5. A method of sampling and holding a signal in a feedback sample and hold circuit wherein an amplifier output 14 is sampled and held by means of a primary feedback sample and hold circuit Ss,CH to generate a primary held signal, and characterised in that the amplifier output is sampled and held by means of a secondary feedback sample and hold circuit Scl,CcH to generate a correction held signal, and an attenuated form of the correction held signal is combined with the primary held signal. 6. A sample and hold circuit characterised by first cm , second cog , and third CCH capacitors connected serially between two reference voltage points, the common node 15 of the first and second capacitors forming a signal node and the common node 22 of the second and third capacitors forming a correction node, primary sampling switch means sus connected at one side to the signal node for selectively connecting the signal node to an input for a signal voltage source, secondary sampling switch means Sc for selectively connecting the correction node to an input for a signal voltage source, and correction feedback means, including an operational amplifier A having an input coupled to the signal node and an output coupled to the correction node, adapted to correct the voltage at the correction node in response to a change in the voltage at the signal node, upon disconnection of the signal node from the signal voltage source input by the primary sampling switch means. 7. A circuit as claimed in claim 6 wherein the correction feedback means includes a buffer B having an output 16 connected to an input of the operational amplifier.

## Description
IMPROVEMENTS IN OR RELATING TO SAMPLE AND HOLD CIRCUITS AND METHODS. The invention relates to feedback sample and hold circuits and methods. Sample and hold circuits are used, for example, in electronic integrated circuits for delay functions and find application alone and in banks of stages for time domain filtering, such as in a transversal filter0 The invention will be described by way of example with reference to the accompanying drawings, in which FIG. 1 is a schematic circuit diagram of a portion of a known feedback sample and hold circuit stage bank FIG. 2 is a schematic circuit diagram of a portion of a feedback sample and hold circuit stage bank embodying the invention and FIG. 3 is a schematic circuit diagram of the circuit stage of FIG. 2 modified to include an additional correction zeroing switch. Referring now to FIG. 1, in a known arrangement of N sample and hold circuit stages interconnected as a bank to work in conjunction with a common operational amplifier A each of the stages, shown enclosed by a broken line, includes a basic sample and hold circuit section and a switched feedback path connecting the output of the sample and hold circuit to the inverting input of the amplifier A. The sample and hold circuit sections each include a sampling switch Ss, a holding capacitor CH, and a buffer B.The sampling switches are operated successively by pulses of a set of individually associated primary sampling switching pulse trains Ts. The feedback sections include feedback enabling switches SF, which are operated successively by pulses of a second set of switching pulse trains so that the feedback for any particular stage is enabled during the entire sample and hold process of that stage. The details of the switching pulse electrical connections to tlie sampling switches SS and the feedback enabling switches S F are readily apparent to those skilled in the art and are not shown in the figure for the sake of clarity. For understanding the general mode of operation of one of the stages, it is useful first to assume that its sampling switch Ss is in the conducting, closed condition, so that the signal output tracks the signal input. When the sampling switch Ss is opened, the output is held at a fixed hold value. If the switch is a perfect switch and the amplifier A and the buffer B are ideal, then the hold output will be precisely the same magnitude as the input which was present when the sampling switch S5 was opened. The feedback loop in conjunction with the amplifier A reduces the effect of a voltage offset in the buffer B and in the sampling switch Ss on the signal output.The sampling switch is generally an electronic switching device and is particularly well implemented by the use of one or moreFET field effect transistor devices such as MOS metal oxide semiconductor transistors. While MOS devices are particularly suitable for use as electronic switching devices, they are nevertheless not perfect. Because of coupling between the gate, source, and drain of the MOS device, unwanted error charge in the form of switching charge feedthrough is fed onto the holding capacitor CH after the MOS sampling switch is isopened.At this time, since the sampling switch Ss no longer conducts from source to drain, the operational amplifier A can no longer act to preserve the correct charge on the holding capacitor C. As a result, there arises a hold voltage offset, the magnitude of which is determined by the amount of charge feed through from the sampling switch SS to the holding capacitor C divided by the capacitance value of the holding capacitor CEI. Since the capacitance magnitude of the holding capacitor CH limits the speed with which it can be charged, it is not possible to decrease the holding voltage offset by increasing at will the capacitance magnitude of the holding capacitor CH. One known way of decreasing the hold voltage offset has been to provide a charge feedthrough compensation switch across the sampling switch Ss. This is described, for example, in U.S. Patent 4,308,468. Such an approach significantly reduces the gross effects of the feedthrough charge for a particular switching device, but it does not deal with the effects of variations in feedthrough charge characteristics from one switching device to the next. Since in actual practice no two switches are identical, the feedthrough charge effect of each sampling switch SS is reduced by its associated compensation switch only to the extent that the feedthrough charge effects of both are identical.Thus, for a bank of feedback sample and hold circuits, the variations in the net charge feedthrough of the sampling switches S5 and any compensating switches which may be connected across these still results in variations among the holding capacitor voltages, even when all the stages are sampling an identical signal.This produces a fixed pattern noise in a configuration in which the outputs of the sample and hold circuits are repeatedly sequentially sampled. This problem is discussed in relation to transversal filtering in, for example, A Programmable Transversal Filter for VoiceFrequency Applications by Sunter et al. in IXEE Journal of Solid State Circuits, Vol. YI 16, No. 4, Aug. 1981, According to one aspect of this invention a sampleand hold circuit includes an amplifier, a primary sampling switch connected in a circuit path between an input for a signal source and an input of a buffer, primary holding capacitor connected between the input of the buffer and a reference potential point, feedback means responsive to output of the buffer for providing a feedback signal to an input of the amplifier, and correction sample and hold means connected to the output of the amplifier and responsive to switching feedthrough error generated by the sampling switch for substantially correcting such error. According to another aspect of this invention there is provided a method of sampling and holding a signal in a feedback sample and hold circuit wherein an amplifier output is sampled and held by means of a primary feedback sample and hold circuit to generate a primary held signal, the amplifier output is sampled and held by means of a secondary feedback sample and hold circuit to generate a correction held signal, and an attenuated form of the correction held signal is combined with the primary held signal. According to a further aspect of this invention a sampleand hold circuit includes first, second and third capacitors connected serially between two reference voltage points, the common node of the first and second capacitors forming a signal node and the common node of the second and third capacitors forming a correction node, primary sampling switch means connected at one side to the signal node for selectively connecting the signal node to an input for a signal voltage source, secondary sampling switch means for selectively connecting the correction node to an input for a signal voltage source, and correction feedback means, including an operational amplifier having an input coupled to the signal node and an output coupled to the correction node, adapted to correct the voltage at the correction node in response to a change in the voltage at the signal node, upon disconnection of the signal node from the signal voltage source input by the primary sampling switch means In one embodiment of the invention, a correction sampling switch and correction holding capacitor are connected serially, respectively, between the output of the amplifier and a reference potential point, normally ground potential, to provide the correction sample and hold circuit. A correction coupling capacitor is connected to the common node of the correction sampling switch and the correction holding capacitor on one side and to the common node of the primary sampling switch and the primary holding capacitor on its other side, thereby coupling an attenuated correction circuit output to the primary signal path. For a brief time after the primary circuit has switched to its hold condition, the correction circuit provides an attenuated, secondary path for a feedback correction of the signal held in the primary circuit.The attenuating coupling correspondingly reduces the effect of any switching charge feedthrough error which would be likewise introduced by the switching of the secondary, correction circuit to its hold condition. In another embodiment of the invention, there is provided a correction zeroing switch connected between a reference potential and the common node of the correction holding capacitor and the correction sampling switch for periodically zeroing that node, so that large signal amplitudes can be better corrected. Referring now to FIG. 2, the first stage portion of a bank 10 of a plurality of MOS device feedback sample and hold circuit stages 12, in which all capacitors and transistor switches are MOS devices, includes a high perfoimance, high gain operational amplifier A. The amplifier A has inverting and noninverting input ports and an output port 14.While only the first of the stages 12 is shown, it is to be understood that there are additional stages connected as a bank, with the amplifier A being common to them. Each stage 12 includes a buffer B having an input port 15 and an output port 16. The output port 14 of the amplifier A is connected through an MOS transistor primary sampling switch Sg to the input port 15 of the buffer B. The output port 16 of the buffer is connected to the inverting input port of the amplifier A by a feedback path 18 in which there is a feedback enabling switch S. A primary holding capacitor CII is connected between the input port 15 of the buffer B and ground potential. A correction coupling capacitor CCC with a capacitance substantially less than that of the holding capacitor C11 and a correction holding capacitor CII of about the same capacitance as tlie primary holding capacitor C11 are connected in series, respectively, between the buffer B input port 15 and ground potential.A secondary, correction sampling switch Sc couples the output port 1 of the amplifier A to the common node 22 of the correction holding capacitor Ccii and the correction coupling capacitor Ccc. The switches Ss, 5c are similar to each other. Each switch consists of an N channel and aP channel MOS transistor connected in parallel with their gates driven by appropriate switching control pulses.This known arrangement minimizes the charge feedthrough of the switch, since the complementary characteristics of the transistors leads to a substantial mutual cancellation of their individual charge feedthroughs. Signal input to the circuit 10 is to the noninverting input port of the amplifier A. Signal output from the stage 12 is from the output port 16 of the buffer B. The circuit configuration of the stage 12 provides a means by which the feedback loop 18 can be used to correct the hold voltage offset resulting from the opening of the sampling switch Ss. To accomplish this, the amplifier A stores a correction voltage Vc on the correction holding capacitor Ccii. The charging of the correction holding capacitor Ccii transfers charge through the correction coupling capacitor Ccc to the holding capacitor CH, thereby correcting the hold voltage offset contributed from the sampling switch S5 charge feedthrough. The switches Ss, Sc, SF are operated at the appropriate times as discussed below by respective switching pulse trains Ts, TC, TF from connection to appropriate sources, not shown in the drawings, as would be readily apparent to one skilled in the art. The mode of operation is as follows with the feedback path 18 enabled and both the sampling switch and the correction switch Sc closed during a signal tracking phase, the output is equal to the input. The sampling switch SS alone is then opened by the first pulse train Ts, leaving the holding capacitor C11 charged to nearly the correct hold voltage value VII, but with an error voltage Terror resulting from the charge feedthrough from the sampling switch Ss. The correction switch will then provide a secondary path to permit the amplifierA to correct the hold voltage value VII by charging the correction holding capacitor CH until the output is again equal to the input.At this time, the correction switch SC isopened by the second switching pulse train TC.Because the correction coupling capacitor Ccc is of much smaller magnitude than the primary holding capacitor Cu, the offset voltage on the correction holding capacitor CcH caused by opening the correction switch Sc will be attenuated with respect to the output voltage V out by approximately the factor CCC CH . A modification of the circuit 10 is the circuit 19 of FIG. 3, which is similar to the circuit 10 except that its stage 20 is provided additionally with a correction zeroing switch Scz. This additional switch is connected between the common node 22 of the correction coupling and holding capacitors Ccc, CcH and ground potential and is also operated by the first pulse train Ts. This feature facilitates correction for large signal amplitudes by bringing the common node 22 to zero before each hold. In the operation of the stage 20, the primary sampling switch S5 and the correction zeroing switch are first closed during tracking of the signal, with the correction switch Sc being open. Then the sampling switch S5 and the correction zeroing switch SCZ are opened simultaneously by the primary sampling pulse train Ts, while the correction switch Sc is simultaneously closed by the correction pulse train Tc. Since the voltage on the correction holding capacitor Ccii is initially zero, or ground potential, the amplifier A can swing the correction voltage Vc from zero to full scale in either direction, thereby providing the maximum correction voltage for large signal amplitudes.A disadvantage of this arrangement, however, is that the amplifier A will have to slew back to zero, or near zero, when a large input signal is present. This takes extra time, and thereby somewhat lengthens the time required for the holding function. The obJective of circuit embodying the invention is to store a correction voltage which will substantially reduce the effect of the charge feedthrough from the primary sampling switch Ss. Since the correction voltage is also stored, a configuration must be used in which the effect of switch feedthrough when storing the correction voltage is less than the feedthrough of the primary sample and hold circuit. Since the error voltage caused by opening the primary sampling switch Ss is of the order of ten millivolts, whereas the signal being stored is on the order of several volts, the stored correction voltage can be attenuated in its effect on the signal output, and there will still be sufficient range in the correction voltage to perform the necessary correction.Assuming that the correction voltage is stored using a switching means and a holding capacitor similar to the primary holding capacitor CH, a bank of such circuits will exhibit the same variation in the correction voltage that the primary sample and hold circuits of the bank of stages exhibit in the output voltage. If, then, the correction voltages are attenuated in their effect on the respective signal outputs, the variation in the correction voltages produced by random differences in the correction switches SC will also be correspondingly reduced.From the viewpoint of obtaining the minimum fixed pattern noise, the attenuation of the correction signal should be as large as it can be, while ensuring that the attenuated error voltage is large enough to correct for the worst error produced by feedthrough from the sampling switches SS llowever, since tile attenuation of the correction voltage is an elemeiit in the feedback path loop associated with the amplifier A, it affects the settling time of the loop.Thus, constrairlts on tije time allowed for the entire sample and hold operation may impose a more severe restriction on tlte aliloullt of Rttenuatioii that can be used. For typical practical application of tulle sample and hold circuit 10, e.g. where the input signal to the amplifier is audio frequency or higher, it is advisable to provide a sample and hold of the incoming signal before the input port of the amplifier. This prevents the signal level at the output port t f the amplifier from undergoing significant change during the time that the correction sample and hold capacitor is being charged and thereby interfering with the accuracy of the correction. Although the above discussioli involves a bank 10 of sample and hold stages 12 which are coupled to each other, it should be understood that a single stage 12 could also be used alone with the amplifier A to perform a useful sample and hold function. The buffer B prevents the circuitry connected to the signal output from altering the charge on the holding capacitor CH. While in the stage 12 of the bank 10 it is a transistor, it could also be a nominal unity gain amplifier of another sort. The sample and hold means can be any suitable sample and hold ciretlit configuration, and need not be the particular arrangement of a single sampling switch and holding capacitor as described for the stage 12 of the bank 10. While in the circuits 10 and 19 as described above the correction coupling means is a capacitor, other coupling means could also be used, provided that they result in an attenuated form of the correction signal being contributed to the signal output. The reference potentials at various nodes of the sample and hold circuit need not necessarily be the sameIn fact, in some instances it my be advantageous that they have different levels.