# CONTROL APPARATUS

## Claims
Betriebssteuergerät zum Steuern der Maschinenausrüstung, umfassend eine Vielzahl von Maschinen, welche derart angeordnet sind, daß sie nacheinander auf Material einwirken, das von der Ausrüstung bearbeitet wird, wobei die Maschinenausrüstung im manuellen Arbeitsmodus betrieben wird, und wobei der Betrieb der Maschinenausrüstung schrittweise durchgeführt wird sowie auf automatische Weise, wobei der Betrieb der Maschinenausrüstung gemäß einem Steuerprogramm für die Maschinenausrüstung gesteuert wird, umfassend

## Description
The present invention relates to a control apparatus such as a control board for controlling various manufacturing machine equipments. Recently, manufacturing machine equipments have been becoming more and more complicated and diversified. At the same time, a high level of sequential processing or data processing has been demanded for the control boards which control such machine equipments, and an external control means such as a programmable sequential controller has come to be used for sequential processing. Generally, a control board is provided with an operating panel and a sequential controller which controls a machine equipment in a sequential manner according to predetermined operations on the basis of operating data input from the operating panel and detection signals provided from the machine equipment and which causes the operating panel to display the status of operation of the machine equipment. In such conventional control board, however, a dedicated operating panel has been fabricated for each machine equipment to be sequential controlled, and therefore the whole or a part of the operating panel must be replaced at every change of the object or contents of sequential control. The present invention has been made for overcoming the described inconvenience involved in the prior art. It is an object of the present invention to provide an operation control apparatus having general applicability, that is, the controller may be readily converted to a new operation control apparatus by simply replacing a graphic sheet releasably mounted on the operating panel when the machine equipment is to be controlled by a new control program or new machine equipment is to be controlled. The graphic sheet has a layout of symbols, indicative of machine and operation conditions thereof and laid out to form a process diagram of the machine equipment, which may be different depending on the control program. Thus the present invention allows efficient design work of the control apparatus at low cost without having to replace entire or a large portion of the control apparatus. A control apparatus according to the invention is characterized by the features according to claim 1. Fig. 1 is a perspective view of a control apparatus according to an embodiment of the present invention Fig. 2 is a view showing the entire construction of the apparatus Fig. 3 is an exploded perspective view of an illuminable switch Figs. 4 and 5 are circuit diagrams each showing a circuit configuration of an illuminable switch Fig. 6 is an electric wiring diagram of a part of an operating panel Fig. 7 is a detail view of a part of Fig. 6 Fig. 8 is a configuration diagram of the operating panel Fig. 9 is an explanatory view showing signal allocation in the operating panel Fig. 10 is a block diagram showing a circuit configuration of an operating panel means Fig. 11 is a side view showing a substrate configuration in the operating panel means Fig. 12 is an explanatory view showing an example of input output cards of a sequential controller Fig. 13 is a flow chart showing operations of a control circuit of the operating panel means and Fig. 14 is a plan view showing an example of a graphic sheet. An embodiment of the present invention will be described in detail hereinunder with reference to the drawings. Fig. 1 is a view showing an external appearance of a disc type control board constructed according to the present invention. On a control board surface 1a are provided an operating panel device 10, a data display unit 11, a data input switch 12, an emergency stop push button 13, a board stop push button 14, an operating panel enable disable switch 15, an operation sound buzzer 16 and a fault alarm buzzer 17. On both front and rear sides of the control board are provided double leaf doors 1b only a front door shown , and in the interior of the control board are mounted sequential controller, no fuse circuit breaker, electromagnetic contactor, electromagnetic switch, transformer, DC regulated power supply, relay, etc. In Fig. 2, which is a schematic view showing the construction of the control board, the reference numeral 30 denotes a sequential controller, which receives at its input 30a detection signals from various detectors 21 attached to a machine equipment such as a limit switch, a proximity contactless switch and a photoelectric switch, switch signals from the foregoing switches 12 15 and operation data from the operating panel device 10, then performs a sequential processing for these signals and thereafter produces at its output 30b control signals to various loads attached to the machine equipment such as solenoid 22, electromagnetic valve 23 and electromagnetic switch 24, operation signals to the display unit 11, buzzer 16 and contact 17 of the buzzer 17 which are disposed on the control board surface and illumination data to the operating panel device 10. The operating panel device 10 is connected to inputs 30a and 30b of the sequence controller 30 through connectors 31 and 32, and it is composed of a control circuit 100 which inputs and outputs the above operation data and illumination data through the connectors 31 and 32, an operation panel 200 which comprises illuminable switches 201 arranged in a matrix form on a printed circuit board, and a graphic sheet 300 superposed on the operating panel 200 and graphically showing the correlation between various portions of the machine equipment and the illuminable switches 201. As the illuminable switch 201 there is used a switch of such a unit structure as shown in Fig. 3 exploded perspective view capable of being mounted to a printed circuit board so that the packing density can be enhanced. In Fig. 3, a unit case 201a is integrally formed of resin and is provided at its bottom 201a with such a normally opened momentary switch 201b as shown in Fig. 4 which turns on when its upper surface is pressed and turns off upon release of the pressing force. An illumination unit 201c, which is removably attached to the unit case 201a, comprises a lens 201d which is integrally formed of a transparent resin, a filter 201e, a name plate 201f and an LED light emitting diode unit 201g. These are unitized by engaging lugs 201g of a reflector 201g of the LED unit 201g with recesses 201d of the lens 201d so as to hold therebetween the filter 201e and name plate 201f. In this state, legs 201d having hooks at the respective fore ends and extending from the four corners of the lens 201d are aligned with the unit case 201a and brought into engagement with key slots 201a so as to be slidable within a predetermined range, whereby the LED illuminating type switch 201 is constituted. In the bottom of the reflector 201g of the LED unit 201g are formed four apertures 201g , and four LED s 201i, which are series parallel connected on a printed substrate 201h as shown in Fig. 5, face on the apertures 201g in a one to one relation, respectively, thereby ensuring a uniform planar illumination. At opposed edges of the printed substrate 201h are provided terminals 201j, which are in contact with electrodes 201k formed in the unit case 201a. Projecting from the unit case 201a are lead terminals 201ℓ, which are connected to both ends of the switch 201b and the electrodes 201k. By soldering the lead terminals 201ℓ to a pattern of a printed circuit substrate, the switches 201 are arranged in a matrix form. Fig. 6 shows a connection of a total of 128 8 vertically x 16 laterally in the figure LED illuminating switches 201 arranged in a matrix form on a printed circuit substrate, in which the circle and black dot marks represent in a simplified form the state of connection between the switch and LED shown in Figs. 7a and 7b. By arranging four such printed circuit substrates each with 128 LED illuminating switches 201 arranged thereon, in such a form as shown in Fig. 8, there is obtained an operating panel 200 with a total of 512 16 vertically x 32 laterally illuminable switches 201 arranged in such a matrix form as shown in Fig. 9. The switches 201b and the LED s, which constitute each illuminable switch on each printed circuit substrate, are connected to the control circuit 100 through connectors 203a, 203b and 203c. Further, as shown in Fig. 9, the LED of each illuminable switch 201 on the operating panel 200 is specified by LED data comprising hexadecimal digits of 0 to 1F and binary digits of 0000 to 1111, while the switch is specified by switch data comprising 0 to 7 digits, address data comprising binary digits of 0000 to 1111 and switch data select comprising binary digits of 00 to 11. Fig. 10 is a block diagram showing a concrete example of the control circuit 100, in which the numerals 101 and 102 denote an output isolator and an input isolator, respectively. In each isolator, input and output are separated through a photo coupler to provide a circuit strong against noise. The numerals 103 and 104 denote an output interface and an input interface, respectively, each of which performs a signal voltage transformation. The numerals 105, 106 and 107 denote an arithmetic and logical unit ALU , a read only memory ROM and a clock generator, respectively. The ALU 105 controls input and output of data, namely, receipt and delivery of data between it and the sequential controller 30 in accordance with a program stored in the ROM 106 as will be described later. The data transmitted through the isolator 101 to the sequential controller 30 comprise a total of 16 bits which are 8 bits of switch data, 2 bits of data select signal, 4 bits of switch address data and one bit each of data valid signal and data invalid signal. On the other hand, the data fed from the sequential controller 30 to the control circuit through the isolator 102 are LED illumination data comprising a total of 40 bits which are 32 bits of LED data, 4 bits of address data and one bit each of Strobo, Clear, All On and Test signals. The numeral 108 dentoes a keyboard display controller incorporating a random access memory RAM . The keyboard display controller 108 has an operation data storage area which stores operation data on the operated switch among the illuminable switches 201 on the operating panel 200, and an illumination data storage area which stores illumination data on the illuminable switch 201 to be illuminated on the operating panel 200 provided from the sequential controller 30. Write to and read from each of these storage areas are performed under control of the ALU 105. The reference mark ℓc denotes a control signal line for applying control signals from the ALU 105 to the interfaces 103 and 104 and RAM 108. The numeral 109 denotes an address bus driver for applying to a decoder 110 an address fed from ALU 105 through an address bus. The decoder 110 decodes the thus applied address and performs addressing for the keyboard display controller 108. The numeral 111 denotes a data bus driver for input and output of various data between the interfaces 103, 104, ALU 105 and the keyboard display controller 108. The numeral 112 denotes a plus command driver for driving, with LED data in the illumination data, anode rays in an LED matrix 200a which is constituted of the LED s of the illuminable switch 201 on the operating panel 200. The numeral 113 denotes a decoder which decodes address data in the illumination data to obtain specific data for illuminating LED. The numeral denotes a minus command driver for driving cathode rays in the LED matrix 200a in accordance with the specific data obtained by the decoder 113. The decoder 113 also outputs scan data used at the time of writing operation data from a switch matrix 200b to the keyboard display controller 108, the switch matrix 200b being composed of the switches of the illuminable switches 201 on the operating panel 200. The operating panel device, as shown in Fig. 11, is of a three layer structure comprising successively from the upper side four switch substrates PC₁ which constitute the operating panel 200, an isolator substrate PC₂ which constitute the isolators 101 and 102, and a CPU substrate PC₃ which constitutes a central processing unit CPU by combination of ALU 105, ROM 106, keyboard display controller 108, etc. The panel device, which is thus constructed and supported by a frame F, is removably fitted in an opening 1a formed centrally in the control board surface 1a. In this case, a graphic sheet 300 is held between a style strip K which masks unnecessary portion and the operating panel 200. The sequential controller 30 has a large number of input output cards, of which those for input and output of signals between the controller 30 and the control circuit 100 are shown in Figs. 12a to 12d. The card a is an input card for receiving DC inputs from the control circuit 100. Its input Nos. 1 to 8 take charge of switch data 0 to 7, Nos. 9 to 12 take charge of switch addresses 0 to 3, Nos. 13 and 14 take charge of switch select signals 0 and 1, and Nos. 15 and 16 take charge of date valid and data invalid signals respectively. The cards b to d are output cards for providing DC outputs from the sequential controller 30 to the control circuit 100. Output Nos. 1 to 16 of the card b are in charge of LED data 0 to F, output Nos. 1 to 16 of the card c are in charge of LED data 10 to 1F, output Nos. 1 to 4 of the card d are in charge of LED addresses 0 to 3, and Nos. 5, 6, 7 and 8 are in charge of Strobo, Clear, All On and Test signals, respectively. These cards are connected to the control circuit 100 through connectors. In addition to the above cards, the sequential controller 30 has other cards taking charge of DC inputs from the digital switch 12, DC inputs from the detectors 21 attached to various points of the machine equipment such as limit switch, photoelectric detector, proximity switch, electrostatic switch and reed switch, DC inputs such as Board Stop, No fuse Circuit Breaker OFF and Operation Circuit Stop, DC outputs to the data display unit 11, and AC outputs to loads such as motor and electromagnetic valve. The ALU 105 in the control circuit 100 performs operations in accordance with the program stored in the ROM 106. These operations will be explained below with reference to the flow chart of Fig. 13. Operation is started by turning on the power supply of the apparatus, and first initialization is performed in step S1 for the interfaces 103 and 104 and the keyboard display controller 108. Next, in step S2, judgement is made as to whether All ON signal from the sequential controller 30 is present or not. The All ON signal is for lighting the LED s of all illuminable switches 201 on the operating panel 200 and inspecting their illumination. If the result of the judgement is YES, the LED s of all illuminable switches 201 are turned on in step S3. On the other hand, if the judgement result is NO, program advances to step S4, skipping over step S3. In step S4, judgment is made as to whether Clear signal from the sequential controller 30 is present or not. The Clear signal is for turning off the lighting LED s. If the judgment result is YES, all the LED s are turned off in the next step S5, while if the judgment result in step S4 is NO, program advances to step S6, skipping over step S5. In step S6, judgment is made as to whether Strobo signal from the sequential controller 30 is present or not. The Strobo signal is for showing that LED data to be output are ready on the side of the sequential controller 30. If the judgment result is YES, a stand by is made for 2 milliseconds for the stabilization of data in step S7, thereafter read of LED address data is performed in step S8, and read of LED data performed in step S9. In the next step S 10, the thus read LED data are each written in a predetermined storage position of the illumination data storage area in the keyboard display controller 108 designated by the LED address, under control of ALU 106. In the subsequent step S11, judgment is made as to whether write of all data has been completed or not, and if the judgment result is NO, the above steps S8 to S10 are repeated until all data are written, while if the judgment result is YES, program advances to the next step S12. In connection with step S6, if the judgment result therein is NO, that is, if Strobo signal from the sequential controller 30 is not present, the processings of steps S7 to S11 are not executed, and program advances directly from step S6 to step S12. In step S12, the switch data stored in the operation storage area of the keyboard display controller 108 are read to the ALU 105, and then in step S13 judgment is made as to whether Test signal from the sequential controller 30 is present or not. The Test signal is for conducting a test as to whether the LED of a pushed illuminable switch 201 on the operating panel device 10 goes on or not. If the judgment result is YES, then in step S14, LED data is written to the position corresponding to the operated switch in the illumination data storage area of the keyboard display controller 108. On the other hand, if Clear signal is not present, program advances to step S15, skipping over step S14. In step S15, judgment is made as to whether read of all switch data has been completed or not. If the judgment result is YES, program advances to the next step S16, while in the case of NO, the steps S12 to S14 are repeated until all switch data are read. In step S16, judgment is made as to whether the number of pushed switch in different addresses is one or not, and if the judgment result is YES, program advances to step S17. In step S17, judgment is made as to whether the number of pushed switch in the same address is one or not, and if the judgment result is YES, program advances to step S18. In step S18, judgment is made as to whether Two Push flag is off or not, and if the judgment result is YES, process advances to step S19, while in the case of No, program returns to step S2. In step S19, switch data to be output is read, and switch address data to be output is read in the next step S20. Then, in step S21, judgment is made as to whether the address data read in step S20 is coincident with the preceding address value, and if the judgment result is NO, that address is temporarily stored in a register in the ALU 105 in step S22, then N value is set in another register in the next step S23. On the other hand, if the judgment result in step S21 is YES, program advances to step S24, in which judgment is made as to whether the coincidence continued N times or not. If the result of this judgment is NO, program returns to step S2. This N time collating is performed to detect that the switch is held ON during time t necessary for the execution of steps S2 to S21 multiplied by N, and thereby prevent an erroneous input caused by chattering or noise. If the judgment result in step S24 is YES, the address stored in step S22 is cleared in step S25, then Two Push flag is turned on in the subsequent step S26, and Data Valid output is turned on in the next step S27. Thereafter, program returns to step S2 and the subsequent steps are executed up to step S18, and if the judgment result in step S18 is NO, program again returns to step S2. If the judgment result in step S16 is NO, that is, if the number of pushed switch in different addresses is not one, program advances to step S29, in which judgment is made as to whether the number of pushed switches is two or more. If the result of this judgment is YES, Data Invalid output is turned on in the next step S30, and Data Valid output is turned off in the subsequent step S31. Further, in the next step S32, Two Push flag is turned on and program returns to step S2. Where the judgment result in step S17 is NO, the steps S30 to S32 are executed and then program returns to step S2. Further, where the judgment result in step S29 is NO, it is assumed that there is no switch pushed, and program advances to step S33, in which Data Valid output is turned off. Then, in step S34, Two Push flag is turned off and then program returns to step S2. The above processings will now be summarized. Upon application of power, initialization is performed. And according to the program, All ON signal is checked from the output of the sequential controller 30, and if it is present, all the LED s are turned on so as to permit a lamp check. On the other hand, if it is not present, this processing is jumped over, and Clear signal is checked. If Clear signal is present, all LED s are turned off, while if it is not present, this processing is jumped over and Strobo signal from the sequential controller 30 indicating that LED data are ready, is checked. If a change is recognized in the Strobo signal, a stand by is made for 2 milliseconds for the stabilization of data, and then LED address data and LED data are read and written to the illumination data storage area of the keyboard display controller 108. This processing is performed for all LED s. Unless there is a change in the Strobo signal, this processing is jumped over. Next, switch data are read from the keyboard display controller 108, and whether Test signal from the sequential controller 30 is present or not is checked. The Test signal is produced during interruption of operation of the sequential controller 30, and the data are written to the keyboard display controller 108 so that the LED of the pushed switch can be turned on. Consequently, the operation of the operating panel device 10 can be confirmed even without the sequential controller, and this is advantageous for the improvement of maintainability. If Test signal is not present, this processing is jumped over. Upon completion of write of all switch data, whether the number of pushed switch is one or not is checked. If it is only one, whether the Two Push flag is off or not is checked, and if it is off, switch data and switch address data are read and collating is performed N times in order to enhance the reliability of data. If coincidence of collating is confirmed N times, Two Push flag is turned on, Data Valid signal is produced and program returns to the beginning. Where Two Push flag is on, program returns to the beginning directly. Where the number of pushed switch is not one, Data Invalid signal is produced, Two Push flag is turned on and program returns to the beginning. When Two Push flag is again checked, it is on, so program returns to the beginning. As this state is repeated, the sequential controller 30 drops Strobo signal, so that the result of checking Strobo signal becomes NO, the result of checking whether the number of pushed switch in different addresses is one or not also becomes NO, and check is made as to whether the number of pushed switch is two or more. At this time, the swtich is open, so Data Valid output is turned off, Two Push flag is also turned off and program returns to the beginning. The above operations are performed cyclically, and turning on and off of LED s of the LED illuminating switches as well as input and output of switch data are performed between the control circuit and the sequential controller 30. Fig. 14 shows an example of pattern described on the graphic sheet 300 with respect to the case where the control apparatus is used for controlling a part of a tobacco manufacturing equipment. In the illustrated pattern, switches and indications for automatic operation are arranged at the rightmost portion, and manufacturing steps are described in the central portion. Further, at the leftmost portion are arranged operating sections for clock processing and data processing to be performed by the sequential controller. The switches not inked in are in use as illuminable switches. Switches AUT and MAN on the right indicate manual or automatic operation for designating operation mode of the entire process, and manual and automatic switches M and A arranged in the central portion are switched over by said mode designation. In operation indication OPN shows that the process is in automatic operation. Ready indication RDY shows that the process is in an initial state. Sequential start swatch SRT is a switch for commanding an automatic operation of the process. Sequential stop switch STP is a switch for slopping the automatic operation. Restart switch RST is a switch for starting operation from a post step so as not to cause clogging of raw material, the restart being performed upon completion of fault processing after fault stop of the process. Fault indication FLT is an indication showing the presence of fault in automatic operation. Fault store indication FSR is an indication showing that fault is stored until reset switch RST is depressed. Said reset switch RST is a switch for restart after the processing for the stored fault of the process. Buzzer stop switch BZS is a switch for stopping a fault indicating buzzer. Switch caution indication SWC is an indication showing that switches inside and outside the board are not switched yet to automatic operation mode. The central portion shows the flow of the process, in which each square frame with oblique lines indicates an individual machine in the equipment. If this portion is depressed during the manual mode, the whole of the individual machine is operated, or one cycle operation is performed. The circular mark represents a motor for the individual machine, indicating the state of operation in rotation mode or being used as a manual operation switch during the manual mode, and it indicates an alternate function when used as the switch. The white arrow portion indicates a damper switch over direction for an electromagnetic valve, a cylinder with motor, etc. and is used also as a driving switch in manual mode. The X mark indicates a fault portion of an individual machine in the process, and the key mark indicates that the safety switch of an individual machine is turned on, calling attention before start. In the right lower portion are arranged illuminable switches for the selection of process route. The leaf mark indicates that raw material is present in that position, and Ms and As in an individual machine indicate switches used for switching to manual mode in that portion alone at the time of clogging of raw material. RUN at the leftmost top is a flicker indication showing that the control operation of the sequential controller is being performed. LC means a Lamp Check switch for lighting all LED s. CDLY is a Clock Display which is a command switch for the sequential controller to effect read and write of clock data TS means. Timer Start which is a command switch for starting from 0 second of the time set the data input switch. M S and H M are Minute Second and Hour Minute switches for specifying the indication form in displaying time on the external data display unit. Read switch is for commanding from the data input switch the timer counter number in the sequential controller. The data to be displayed on the data display unit is specified by selecting the present value or preset value. The change of data is performed by specifying the timer counter number with Read , then specifying data for change by the data input switch and thereafter pushing Write . All Reset is a command switch for resetting the internal storage data of the sequential controller and setting to initial value. Although in the above embodiment the graphic sheet is used to represent the correlation between the illuminable switches on the operating panel and various portions of the machine equipment, the name plate of each illuminable switch may be used for the same purpose in place of such graphic sheet. According to the present invention, as set forth hereinabove, a specific illuminable switch on the operating panel composed of matrix like arranged illuminable switches are operated to produce specific operation data, and thus a specific operation state is displayed by illumination of a specific illuminable switch. Therefore, even a change in the object of control or the contents of operation could be coped with by merely altering the function of each illuminable switch, thus eliminating the need of redesigning the entire apparatus. Consequently, various effects are obtained, for example, not only a more efficient design work but also the reduction of cost based on generalization can be attained.