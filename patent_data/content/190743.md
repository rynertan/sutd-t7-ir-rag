# CONTROL SIGNAL GENERATION CIRCUIT FOR WIRELESS REMOTE CONTROL SIGNAL TRANSMITTER

## Claims
Signalgenerator mit einer Anzahl von Tastenabfrage Ausgangsanschlüssen KO₁ KO₇ , die mit einer Tastenmatrix 15 verbunden sind, einer Anzahl von Tasteneingangs Anschlüssen KI₀ KI₃ , die mit der Tastenmatrix verbunden sind, einer Einrichtung 7 zum Ausgeben zyklischer Abfragesignale an die Tastenabfrage Ausgangsanschlüsse, einer Einrichtung 6, 9, 11 , die mit der Ausgabeeinrichtung 7 und den Tasteneingabeanschlüssen KI₀ KI₃ verbunden ist, zur Erzeugung von Tastencode Daten entsprechend einer betätigten Taste KS in der Tastenmatrix 15 , gekennzeichnet durch ferner einer Einrichtung 16 18, 40 43, 52 54, 64 zum Koppeln von zumindeste einem aus ausgewählten der Tastenabfrage Ausgangsanschlüsse KO₀ KO₇ mit einer Potentialquelle V

## Description
The present invention relates to a control signal generation circuit used in a wireless remote control signal transmitter for controlling the circuit operation of an instrument such as a television receiver, a video tape recorder, a toy, an air condisioner, etc., and more particularly to a custom code generation circuit employed in such a signal transmitter, which generates a custom code used for selecting and designating the instrument to be controlled among various ones. A remote control signal transmitter generates a data code for controlling the operation of a controlled instrument in response to actuated or operated key or keys, wherein a semiconductor integrated circuit device called hereinafter as an IC is widely used to form the data code responsive to the operated key and modulate the data code to transmit it by means of infrared rays, electromagnetic waves or supersonic waves. The remote control signal transmitter also generates a custom code in addition to the generation of the data code, the custom code being alloted to the instrument to be controlled in order that only that instrument responds to the code data. By the custom code, undesired instruments are prevented from responding to the data code. Due to the increase in the remote controlled instruments, a large number of custom codes should be formed. If a private remote control IC is manufactured with its peculiar custom code, its cost would be increased considerably. In order to solve this problem, it is required to generate a large number of custom codes by use of one kind remote control IC. For this purpose, in prior art, a custom code setting terminal called hereinafter as a CCS terminal is provided to the remote control IC and key scan signals outputted from key scan output terminals are supplied selectively to the CCS terminal to obtain a custom code, as disclosed in United Stated Patent US A 4,412,218 which shows a signal generator according to the preamble of Claim 1. More specifically, the scan signals are outputted cyclically from the key scan output terminals to detect the operated key. Therefore, by coupling the selected key scan output terminal or terminals to the CCS terminal and detecting the level at the CCS terminal in synchronism with the generation timing of the scan signals, a pulse train having the combination of the data 1 and 0 is obtained. The custom code is derived from the pulse train. When the key scan output terminal or terminals coupled to the CCS terminal are changed and or their numbers are increased or decreased, the combination of the data 1 and 0 is varied. The custom code is thus changed. Assuming that the remote control IC has eight key scan output terminals, 2⁸ 256 kinds of the custom codes are obtained. Thus, according to the art disclosed in the above document, various kinds of custom codes are produced by one type remote control IC which is manufactured at a low cost. However, such a remote control IC requires a CCS terminal. An IC having a smaller number of external terminals is manufactured more cheaply, resulting in decreasing the cost of a signal transmitter. Even if a remote control IC has a large number of external terminals sufficiently to provide a CCS terminal, by replacing the CCS terminal with a key scan output terminal or a key input terminal, the number of key switches is increased, so that the remote control having various functions is carried out. Therefore, an object of the present invention is to provide a control signal generation circuit generating a plurality of custom codes without increase in number of terminals. Another object of the present invention is to provide a control signal generation circuit which can generate a larger number of custom codes without any increase in number of a custom code setting terminal of prior art. These objects are achieved by a signal generator having the features of Claim 1 the dependent Claims are related to further developments of the invention. A control signal generation circuit according to the present invention comprises a plurality of key output terminals coupled with a key matrix, means for generating scan signals from the key output terminals, impedance means for connecting selected one or ones of the key output terminals to a potential source, means coupled to the key output terminals for detecting a potential at each key output terminal during a period other than the scan signal generation period of the scan signal generation means, and means for producing a custom code in response to an output of the detecting means. Thus, in the present invention, the key output terminals are also used as custom code selection terminals. The detecting means detects the potential at each key output terminal during a period other than the scan signal generation period. The selected key output terminal or terminals are coupled to the potential source. Assuming that the detection level at the terminal connected to the potential source is a logic 1 and that at the terminal non connected to the source is a logic 0 , the combination of the logics 1 and 0 is thus obtained. This combination is varied by the selection and or the number of the key output terminal or terminals coupled to the potential source. As a result, a plurality of custom codes are derived without a custom code selection terminal which was required in the prior art. It should be noted that the present invention does not exclude the custom code producing means utilizing the CCS terminal, but the present invention can be applied to the remote control IC with the CCS terminal. In this case, an extremely large kinds of custom codes are produced by using a remote control IC having the same terminal number as the prior art. The above and other objects, advantages and features of the present invention will be more apparent from the following description taken in conjunction with the accompanying drawings in which Referring to Fig. 1, a remote control signal transmitter according to a first embodiment of the present invention generates a custom code and a key data code representative of information of an operated key and outputs them as infrared rays by means of an infrared ray diode 14. The custom code and key data code are produced by a remote control IC 1 from its output terminal OUT and then supplied to a driver circuit 13 to drive the diode 14. There is provided a key matrix 15 which is used to command the change in operation of an instrument to be remote controlled. The key matrix 15 includes four row lines In a standby condition, all the key output terminals KO₀ to KO₇ of the IC 1 assume a high level. When one of the key switches KS is operated or depressed to change the circuit operation of the remote controlled instrument, any one of the key input terminals KI₀ to KI₃ is thereby supplied with the high level. This high level is detected by a key input circuit 6, and the circuit 6 then supplies an oscillation enable signal to an oscillator 3. The oscillator 3 thus oscillates at a frequency determined by a resonant element 2 such as a crystal or a ceramic resonator connected between terminals OSC₁ and OSC₂. The oscillation signal of the oscillator 3 is frequency divided by a divider 4 to a predetermined frequency signal, and in response to this predetermined frequency signal a timing generator 5 supplies timing signals to the key input circuit 6, a key output circuit 7 and a controller 11. The key output circuit 7 responds to the timing signal from the timing generator 5 and a control signal from the controller 11 and outputs cyclically to the key output terminals KO₀ to KO₇ key scan signals used for detecting the operated key switch, but before this scan signal output operation, a custom code read operation is attained for reading out the custom code alotted to the instrument to be controlled by this signal transmitter. For this custom code read operation, a level detection circuit 8 is provided to detect the level at each key output terminal KO. The input stage of the level detection circuit 8 as shown in Fig. 2, includes an N channel MOS transistor Q₃ connected between each key output terminal and the ground and supplied at its gate with a clock signal ₃ and P channel and N channel MOS transistors Q₄ and Q₅ constituting an inverter 30 which receives the level at each key output terminal KO. An output stage of the key output circuit 7 is also shown in Fig. 2 and includes a P channel MOS transistor Q₁ connected between the power terminal V In Fig. 3, input stage of the key input circuit 6 is shown. Each of the key input terminals KO₀ to KI₃ is connected to the ground via a pull down resistor 19 and an N channel MOS transistor Q₈ receiving at its gate a clock signal ₄, and further connected to the gates of P channel and N channel MOS transistors Q₆ and Q₇. These transistors Q₆ and Q₇ are connected in series between the power terminals to constitute an inverter 31. The custom code read operation will be described below with reference to a timing chart shown in Fig. 4. In the standby condition, both of the clock signals ₁ and ₂ assume a low level, and hence all the key output terminals KO₀ to KO₇ take the high level. The oscillator 3 starts to oscillate by the operation of one of the key switches KS, and in response to this, the clock signals ₁ and ₂ rise to the high level. As a result, the transistors Q₁ and Q₂ are turned OFF and ON, respectively. Since the conducting resistance of the transistor Q₂ is selected to be sufficiently smaller than the resistors 16 to 18, all the key output terminals KO₀ to KO₇ drops to the low level. In this state, the clock signal ₂ supplied to the transistor Q₂ which is provided for the first key output terminal KO₀, is inverted into the low level as shown in Fig. 4. The gates of transistors Q₂ provided for the remaining key output terminals KO₁ to KO₇ are maintained at the high level. The clock signal ₃ is inverted into the low level in synchronism with the invertion of the clock ₂. The inversion of the clock signal ₃ occurs only for the first key output terminal KO₀ and does not occur for the remaining key output terminals KO₁ to KO₇. The transistor Q₃ connected to the first key output terminal KO₀ is thus turned ON, so that the resistance divided voltage appears at the first key output terminal KO₀, which is represented by a reference numeral 20 in Fig. 4 and determined by the conducting resistance of the transistor Q₃ and the resistor 16. At this time, if the operated key KS is disposed on the first column line The conducting resistance of the transistor Q₃ is designed such that the resistance divided voltage becomes larger than the logical threshold voltage of the inverter 30. Accordingly, the output voltage V₃₀ of the inverter 30 takes the low level as shown in Fig. 4. As a result, the level detection circuit detects that the first key output terminal KO₀ is connected to the power terminal V The clock signals ₂, ₃ and ₄ thereafter invert to the high level, the low level and the high level, respectively, so that the first key output terminal KO₀ and the output voltage V₃₀ of the inverter 30 takes the low level and the high level, respectively. Next, the clock signal ₂ supplied to the transistor Q₂ provided for the second key output terminal KO₁ is inverted to the low level. In synchronism with this, the clock signals ₃ and ₄ are changed to the high level and the low level, respectively. There is no resistor between the second key output terminal KO₁ and the power terminal V The above mention operation is continued for the remaining key output terminals KO₂ to KO₇. As a result, the voltage exceeding the threshold voltage of the inverter 30 appears at the first, fourth and eighth key output terminals KO₀, KO₃ and KO₇ due to the resistors 16 to 18, as represented as a custom code read cycle in Fig. 6. The level detection circuit 8 detects the level at each key output terminal and supplies to the register 10 the data corresponding to the detected level. The registor 10 thus stores data 10010001 therein at a time when the custom code read cycle is completed. The data stored in the register 10 is used as a custom code. Various custom codes can be set by changing the key output terminal KO connected to the power terminal V When the custom code read cycle ends, the IC 1 is brought into an operated key switch detection cycle, i.e. a key scan signal output cycle. In this cycle, the clock signals ₁ and ₂ both takes the low level to turn the transistors Q₁ and Q₂ ON and OFF, respectively, as shown in Fig. 5. The first key output terminal KO₀ is thereby raised to the high level. The remaining key output terminals KO₁ to KO₇ are held at the low level. In the operated key detection cycle, the clock signal ₃ assumes the low level to maintain the transistor Q₃ in the nonconducting state. The clock signals ₄ is inverted into the low level in synchronism with the clock signals ₁ and ₂ to disconnect the pull down resistor 19 in the key input circuit 6 from the ground. The clock signal ₄ may be held at the high level, but in that case the conducting resistance of the transistor Q₁ is required to be sufficiently smaller than the resistor 19. If the operated key switch is one of the key switches KS disposed on the first column line The clock signals ₁ and ₂ thereafter return to the high level, so that the first key output terminal KO is inverted to the low level. Similar operation is carried out with respect to the remaining key output terminals KO₁ to KO₇. As a result, pulse signals are outputted from the key output terminals KO₀ to KO₇ in that order, as shown as an operated key detection cycle in Fig. 6. That is, the scan signals are outputted. The operated key is thereby detected. The key output circuit 7 includes a counter not shown therein, and the content thereof changes by the fact that which key output terminal KO outputs the key scan signal. Although not shown, the key input circuit 6 also includes a counter therein, and its count value varies by the fact that which key input terminal is supplied with the high level signal. The contents of these counters in the key input and output circuits 6 and 7 are employed as a key data code corresponding to the operated key switch and supplied to a key data register 9 to be stored therein. In the scan signal output circuit, the level detection circuit 8 is in the non activated state, and therefore the circuit 8 does not produce any its output signal. Although not shown, it is general that the custom code read operation and the operated key detection the scan signal output operation are carried out twice and the custom codes and key data codes obtained in the respective cycles are then compared with each other in order to prevent an error custom code and an error key data code. Moreover, it is also general to provide a multi push cancellation circuit in order to prevent the simultaneous pushing of two or more key switches, but such a construction is not related directly to the present invention and thus is omitted. The custom code and key data code stored respectively in the register 9 and 10 are read out in serial and in that order by the controller 11. The controller 11 performs the well known Pulse Position Modulation PPM with respect to the read out codes, and further produces the inverted codes of the custom and key data codes. The inverted codes are also subjected to the PPM. The modulated non inverted custom code, inverted custom code, non inverted key data code and inverted key data code are supplied in that order to an output control circuit 12. The circuit 12 is also supplied with a signal of 38 KHz which is derived from the divider 4, and this signal is superposed on the respective codes as a carrier wave. The output of the output control circuit 12 is supplied to the output terminal OUT of the IC 1 and further introduced into the drive circuit 13. The circuit 13 controls the ON and OFF states of the infrared ray diode 14 in response to the signal from the output terminal OUT. As a result, the custom code and the key data code are transmitted by means of infrared rays. The instrument to be remote controlled receives the command signal transmitted via the infrared rays and detects at first the custom code. The custom code thus detected is then compared with that allotted to the instrument. When coinciding with each other, the instrument introduces the key data code and then performs the corresponding operation. As described above, the custom code for designing the instrument to be controlled is set without providing the custom code setting terminal, and further its kinds are changeable. Moreover, the resistors 16 to 18 are used for setting the custom code, and diodes which are relatively expensive, are not recessary. In the followings, other embodiments of the present invention will be described, and in the respective embodiments, the sane constituents as those shown in Fig. 1 are indicated the same numerals to omit their further explanation. In addition, the circuit operations except for the custom code read operation are the same as the first embodiment unless particular description is made, and therefore their explanations are omitted. Fig. 7 shows a second embodiment of the present invention. In this embodiment, a custom code ROM Read Only Memory 43 memorizing eight kinds of custom codes is provided in a remote control IC 100, and one of them is selected by connecting either one of eight key output terminals KO₀ to KO₇ to the power terminal V The address varies by changing the key output terminal KO coupled to the power terminal V Fig. 8 shows the third embodiment of the present invention. In this embodiment, as indicating a remote control IC by 200, a custom code setting terminal CCS terminal is provided on the IC 200. A selected first group of the key output terminals KO₀, KO₄ and KO₇ in this embodiment is coupled to the power terminal V For the purposes of both custom code setting functions, the output stage of the key output circuit 7 and the input stage of the key detection circuit 8 have the same circuit constructions as those of Fig. 2, but the clock signals ₁ to ₃ supplied to the respective transistors are different from those of Fig. 4, as shown in Fig. 9. More particularly, when the oscillator 3 starts to oscillate, all the key output terminals KO₀ to KO₇ take the low level, followed by the inversions of the clock signal ₁ and ₂ supplied to the transistors Q₁ and Q₂ provided for the first key output terminals KO₀. The transistors Q₁ and Q₂ are thereby turned ON and OFF, respectively, the first key output terminal KO₀ is changed to the high level. At this time, the clock signal ₃ is in the low level. In this embodiment, since the first key output terminal KO₀ is connected to the CCS terminal via the diode 44, the terminal CCS is supplied with the high level. The key input circuit 6 is coupled to the CCS terminal and detects the high level at that terminal to produce data 1 , for example. This data is supplied to a first custom code register 10 1. If the diode 44 is not provided, the CCS terminal is in the low level, and therefore the register 10 1 receives data 0 . The inverter 30 connected to the first key output terminal KO₀ produces the low level as its output voltage V₃₀, but the level detection circuit 8 rejects the output voltage V₃₀ by a control signal from the controller 11. As a result, it is detected whether or not the first key output terminal KO₀ is connected to the CCS terminal via a diode. In other words, the diode read operation is carried out when all of the clock signals ₁, ₂ and ₃ are in the low level, as shown in Fig. 9. In order to detect whether or not the first key output terminal KO₀ is connected to the power terminal V The diode read out operation and the resistor read out operation are then attained with respect to the second key output terminal KO₁. This terminal KO₁ is connected to the CCS terminal via the diode 45, but no resistor is inserted between the terminals KO₁ and V Thereafter, the above mentioned operations are carried out to the eighth key output terminal KO₇, so that a timing charts represented as a custom code read operation in Fig. 10 is obtained. Since the diodes 44, 45, 46 and 47 is provided between the CCS terminal and the first, second, third and sixth key output terminals KO₀, KO₁, KO₂ and KO₅, respectively, the CCS terminal is supplied with the high level in sycnhronism the signal output from the those key output terminals. Since the resistors 41, 42 and 43 are present between the power terminal V The operated key detection operation is thereafter carried out in a similar manner to that described with reference to the first embodiment, followed by the output of the custom and key data codes. With respect to the custom code output, the following three methods can be employed. In the first method, the data stored in the first and second custom code register 10 1 and 10 2 are outputted without any modification. That is, as shown in Fig. 11A, in the custom code composed of sixteen bits, a custom code 1 composed of C₁ bit to C₈ bit is constructed by the data 11100100 of the first register 10 1, and a custom code 2 composed of C₁ bit to C₈ bit is constructed by the data 10001001 of the second register 10 2. After the output of the custom code, a key code data composed of K₁ bit to K₈ bit and its inverted key code data The second custom code output method is shown in Fig. 11B. The data 11100100 stored in the first register 10 1 is used as the custom code 1 composed of C₁ bit to C₈ bit. On the other hand, not only the data stored in the second register 10 2 but also that in the first register 10 1 are utilized as the customer code 2 composed of C₁ bit to C₈ bit. The custom code 2 is obtained by inverting the data stored in the bits in the first register 10 1 except for the bits corresponding to those in the second register 10 2 storing the data 1 . Since the bits C₁ , C₅ and C₈ stores the data 1 in the second register 10 2, the data stored in the bits C₁, C₅ and C₈ in the first register 10 1 are not inverted and the data stored in the remaining bits are inverted. As a result, the custom code 2 takes data 10010010 . The third custom code output method is such that a custom code ROM 48 represented by a dotted line in Fig. 8 is provided in IC 200 and the data stored in the ROM 48 is utilized along with the data stored in the registers 10 1 and 10 2. The custom code ROM 48 is a sixteen bits construction and stores data 0001000101100000 . The controller 11 reads out the data stored in the registers 10 1 and 10 2 as well as the data stored in the ROM 48, and obtains a first logical ORed data of the first half eight bits data of the ROM 48 and the data of the register 10 1 and a second logical ORed data of the second half eight bits data of the ROM 48 and the data of the register 10 2. The first and second logical ORed data are 11110101 and 11101001 , respectively, in consequence. The controller 11 outputs the first logical ORed data as the custom code 1 . On the other hand, the custom code 2 is obtained by inverting the data stored in the bits in the first logical ORed data except for the bits corresponding to those in the second logical ORed data storing the data 1 . Accordingly, the custom codes 1 and 2 assume the data 11110101 and 11100011 , respectively. Thus, various methods can be employed to output the custom code, and in every custom code output method, the number of a presettable custom codes is 2¹⁶ 65536. In other words, the signal transmitter according to this embodiment provides an extremely large kinds of custom codes by employing a remote control IC haying the same terminal number as the prior art. The data stored in the second register 10 2 may be used as a custom code 1 . Fig. 12 shows a fourth embodiment of the present invention. Also in this embodiment, the custom code setting function using the CCS terminal and that using the level detection circuit 8 are provided similarly to the third embodiment, but the custom code setting function using the CCS terminal is different in its construction from that of the third embodiment. The CCS terminal is connected to only one of the first to eighth key output terminals KO₀ to KO₇ in this embodiment, the fourth key output terminal KO₃ . The custom code read operation is carried out similarly to the third embodiment. The second, fifth and sixth key output terminals KO₁, KO₄ and KO₅ are connected to the power terminal V As described above, one of eight kinds of custom codes is selected by connecting only one of the key output terminals KO to the CCS terminal, and a greater number of custom codes are further produced by the resistors 52 to 54. A fifth embodiment of the present invention is shown in Fig. 13. In this embodiment, the detection circuit 8 detects the level at the seventh and eighth key output terminals KO₆ and KO₇. The output of the circuit 8 is supplied to an address generator 61, and one address of a custom code ROM 62 is thereby selected. The ROM 62 stores four kinds of custom codes therein. Each of custom codes is a five bits construction. Although a resistor 64 is inserted between the eighth key output terminal KO₇ and the power terminal V The data read out from the ROM 62 is supplied to a custom code register 63 and stored in its latter five bits. On the other hand, the CCS terminal is connected either one of the first to eighth key output terminals KO₀ to KO₇, and in response to the connecting location, a code generation circuit 60 generates data composed of three bits and represented by the following Table 2 The three bits data generated by the generator 60 is supplied to the register 63 and stored in its former three bits. As a result, the custom code register 63 storing a custom code of an eight bits construction. The controller 11 thereafter processes the signal, as has been already mentioned. The present invention is not limited to the aforementioned embodiments. For example, the selected key output terminal or terminals may be connected to the ground potential, and in that case all the logic level mentioned above are inverted. It is also possible to connect the selected key output terminal directly to the potential source. In this case, the conducting resistance of the transistor Q₃ is preferrably made large in order to reduce a power consumption.