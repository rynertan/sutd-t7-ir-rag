# READER AND WRITER FOR AN IC CARD

## Claims
Kartenlese und schreibvorrichtung 12 zum Ãœbertragen von Daten zwischen einem Hauptcomputer 11 und einer an einer Kartenlese und schreibvorrichtung angebrachten IC Karte 13 , wobei die IC Karte 13 IC Speichereinrichtungen 5 zum Speichern von Daten bei einer vorbestimmten Einschreibenergieversorgungsbedingung aufweist,

## Description
The present invention relates to a reading and writing device for use in reading and writing information from and into an IC card. There have been used vending machines which sell goods by a card without money. As the commercially available cards, there are various kinds of cards such as magnetic cards in which a magnetic sheet is installed or IC cards having a data processing unit in the form of an integrated circuit. However, the memory capacity of the magnetic card is not so large. Also the memory capacity of the conventional IC card using RAM random access memory is not so large because the memory capacity is limited by a power supply used in the IC card. In order to increase the memory capacity of an IC card a PROM programmable read only memory is used as memory means. Such an IC card is known for example from US A 4 105 156. For maintaining the data stored in the PROM no battery is necessary in the IC card whereby the capacity of the memory can be increased. However, as a PROM, which is a non volatile memory, EPROM, EEPROM and fuse ROM are used. These PROMs are respectively different in the drive condition write in power supply condition . On the other hand usually the conventional card reader and writer can be operable under only one type of the drive conditions, therefore, conventional card reader and writer can not be used for IC cards with various types of PROMs. For example, the card reader and writer designed for card using the EPROM requires a power source for supplying 21 volt as write in voltage. The card reader and writer for the card using EEPROM requires a power supply for generating 5 volt as write in voltage. In case the IC card of which the write in voltage is not compatible is inserted in one card reader and writer, wrong data may be written in the memory and in the worst case, PROM 5 may be damaged. However, in order to make the IC cards practical use, it is essential necessary to provide a card reader and writer which is compatible to IC cards having different drive conditions. It is the object of the present invention to provide a card reader and writer which is compatible with the various kinds of IC cards having different drive conditions. According to the present invention there is provided a card reader and writer according to the preamble of claim 1 further including means for reading information indicating the write in power supply condition, the information being contained in means carried by the IC card, and means for changing the write in power supply condition of the card reader and writer corresponding to the result of the reading. These and other features of the present invention will be come a parent from the following description taken in conjunction with a preferred embodiment thereof with reference to the accompanying drawings, throughout which like parts are designated by like reference numerals, and in which Fig. 1 shows one example of an IC card, wherein 1 denotes a card body, 2 denotes a circuit board, 3 1 to 3 8 denote external connecting terminal for the application of a power supply, data input and output, clock input and ground. 4 denotes a data processor, 5 denotes a PROM for storing data. As shown in Fig. 1, in the IC card, there is defined a recess in which the circuit board having the data processor 4 and IC PROM is embeded. The external terminals 3 1 to 3 8 are formed on the circuit board 2 so that the external terminals are respectively exposed from the card body 1 for connection with the external circuit arrangement. When the proposed IC card is inserted in a card reader and writer not shown , the circuits in the IC card and the card reader and writer are coupled through the external terminals 3 1 to 3 8 so as to communicate between the data processor 4 and a host computor connected to the card reader and writer. The PROM 5 is used for storing the data and the data processor 4 processes the data from the card reader and writer or the PROM 5 based on the program stored in the data processor 4. The circuit arrangement in the IC card is shown in Fig. 2 in which 6 denotes a program memory, 7 denotes CPU, 8 denotes an address decoder, 9 denotes a data bus and 10 denotes an address bus. The program memory 6 stores a processing program and CPU 7 operates to write in and read out of the data stored in PROM 5 upon taking in the process program from the program memory 6 by accessing sequentially the addresses of the program memory 6 through the address bus 10 and the address decoder 8. In writing the data in the IC card, the data supplied from the card reader and writer through the data bus 9 can be written in a predetermined address of PROM 5 designated by the address signal fed from the CPU 7 through the address bus 10 and the address decoder 8. In reading the data, a predetermined address of PROM 5 designated by CPU 7 through the address bus 10 and address decoder 8 and the data read out from the designated address of PROM 5 are sent to the host computor through the data bus 9. Referring to Fig. 3 showing an example of a card reader and writer according to the present invention, 11 denotes a host computor, 12 denotes a card reader and writer, 13 denotes an IC card. The host computor 11 sends a command signal to the card reader and writer 12 and the IC card 13, on the other hand, the host computor 11 processes the data upon receipt from the IC card 13. In the card reader and writer 12, there are provided a microprocessor 14 for judging the kinds of the IC cards and producing a control signal representing the kinds of the IC card by reading the data stored in the memory 5 of the IC card 13, a clock signal generator 15 and a power voltage supply for supplying a suitable voltage for write in the data in the IC card 13. The voltage supply 16 is provided with a power supply 17 arranged to supply a write in voltage V In operation, upon insertion of the IC card 13 in the card reader and writer 12, the insertion of the IC card is detected by the card reader and writer 12 and the clock signal generator 15 starts, the microprocessor 14 and the IC card 13 are driven. The microprocessor 14 sends a command signal for requesting the write in voltage i.e., the access condition of the IC card to the CPU 7 installed in the IC card 13 through the I O line 19 in the step S1. The CPU 7 decodes the command in the step S3 and returns the access information of the data memory 5 preliminarily written in the specific area of the data memory 5 to the microprocessor 14 through the I O signal line 19. Then the microprocessor 14 decodes the returned information in the step S3 and the program flow goes to the step S4 wherein the kinds of the access information or the write in voltage is detected. When the information returned from the IC card 13 is access information of EPROM, the microprocessor 14 decodes returned information on the basis of the program preliminarily stored in the microprocessor 14 and produces a control signal of 2 bits such as 01 in the step S51. By this operation, the selector 18 is changed over to supply the write in voltage V After setting the write in voltage from the power supply 16 of the card reader and writer 12 as mentioned above, the microprocessor 14 sends a signal representing that the initial condition is completely set to the host computor 11 in the step S6. Thus the data communication between the host computor 11 and the IC card 13 is started to write in the data in the IC card 13 in the steps S7 to S10. In the above embodiment, the card reader and writer 12 is provided with the processor for judging the kinds of the data memory mounted on the IC card and the power supply for supplying the most suitable write in voltage on the basis of the result of the judgement in the processor, the card reader and writer may be compatible with the IC cards using any one of the memories such as EPROM, EEPROM and fuse ROM. As the processor 14 is provided in the card reader and writer 12 so as to set the write in power supply condition without using the host computor, the period of time between insertion of the IC card in the card reader and writer and the setting of the drive condition is made short. Also it is an advantage that there is no need to load the burden of the condition setting for the host computor. Although in the preferred embodiment mentioned above, there is used a microprocessor 14 so arranged as to read the write in power supply condition information of the data memory which stores the data as a parameter showing the write in condition, the scope of the present invention is not limited to the embodiment described above, for example, mechanical means, electrical means or optical means may be used as the device for judging the write in power supply condition by mechanical means, electrical means or optical means. Referring to Figs. 6 and 7, there is provided any one of light reflecting members 21, 22 and 23 on one side edge portion of the IC card 13 corresponding to the write in condition for example the EPROM, EEPROM and fuse ROM. The card reader and writer 12 is provided with light emitting and receiving devices only one device 24 corresponding to the light reflecting member 21 is depicted in Fig. 7 juxtaposed corresponding to the position of the light reflecting members 21, 22 and 23. When the IC card 13 with the light reflecting member 21 is inserted into the card reader and writer 12, the light receiving device 24 detects the light reflecting member 21 so that one of the write in voltage is selected. Said light reflecting members 21 to 23 may be formed by an aluminium vaporing in the form of a circular shape. Also, in place of using light reflecting members and light emitting and receiving device, mechanical contacts may be used as the device for judging the write in power supply condition. It is an advantage of the present invention that the card reader and writer according to the present invention can act to automatically select the write in power supply condition depending on the kinds of the IC card, the card reader and writer can be made compatible with the various kinds of the IC card, so that the practice usefulness of the card reader and writer can be increased. It is another advantage that since the processor for judging the kinds of the IC card is provided in the card reader and writer, the processing speed becomes short whereby no additional load is burdened to the host computor.