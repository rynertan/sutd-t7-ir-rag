# METHOD AND APPARATUS FOR PROCESSING AN ERROR FLAG OF A PCM SIGNAL

## Claims
Verfahren zur Verarbeitung eines PCM Signals, das aus einer Vielzahl von Datengebilden besteht, wobei jedes Datengebilde eine Vielzahl von Datenblöcken 0 51,76 127 und Paritätsblöcken 52 75 enthält, wobei jeder Datenblock eine Vielzahl von Wörtern enthält, wobei jedes Wort W₀ ein aus höherwertigen Bits bestehendes Hochzeichen W

## Description
The present invention relates to a technique to reproduce a PCM signal, and more particularly to method and apparatus for processing an error flag suitable for reproducing a digital audio PCM signal such as rotary head type PCM signal reproduction. In a PCM signal reproduction apparatus such as a digital audio system, an error of a PCM signal generated in a transmission system including a signal source is detected and corrected. If an incorrectable error is detected in the PCM signal, an audio signal is reproduced by error concealment such as means value interpolation. As disclosed in US A 4577319 JP A 58056208, JP A 58056207 assigned to the present assignee, an error flag to be added to an incorrectable data is generated by an error correction circuit and written into an error detection correction code area of a data memory. In this method, the data memory can be effectively utilized but the circuit for generating the error flag is of large scale and the number of times of access to the data memory for writing the error flag increases. The document Electronic Components and Applications vol.4, No.3, May 1982, pp. 131 141, relates to ICs for compact disc decoders. It uses a CIRC code system. The frames consist of a plurality of 16 bit words each divided in a lower and upper symbol. Error flags are generated in response to error detection correction. In effecting a judgement whether an error in a word is correctable or not, this system uses three flags. It is an object of the present invention to provide method and apparatus for reproducing a PCM signal, which are easy to generate an error flag and reduce the number of times of access to a data memory. It is another object of the present invention to provide method and apparatus for processing an error flag, which can reduce a capacity of a memory for processing PCM signal reproduction. In accordance with the teaching of the present invention, in error detection and correction in the reproduction of the PCM signal supplied from a signal source, an error flag is added for each unit of an error detection correction code, one error flag which shows a maximum significant value is selected from upper symbol error flags for word signals comprising upper symbols and lower symbols, and the selected error flag is written into the data memory. As a result, the number of components of the error flag processor is reduced and the circuit is simplified, the number of times of access to the data memory is reduced, and the capacity of the memory is reduced. In the present invention, the error flag for each word is saved based on the fact that a data interleave matrix which uses the error detection correction code for the row includes upper symbols and lower symbols which form words, respectively in the same respective rows. The object of the invention is reached with the method of claim 1 and the apparatus as defined in claim 3. Referring to Fig. 1, one embodiment of the present invention is explained. Fig. 1 shows formats of data and flag. Numeral 1 denotes one block of data. 128 blocks form one frame. Numeral 2 denotes a PCM signal, numeral 3 denotes a first error detection correction signal, and numeral 4 denotes a second error detection correction signal. In the present embodiment, the PCM signal is double encoded to enhance an error detection capability and an error correction capability. Numeral 5 denotes an error flag F Fig. 2 shows a detail of the format of the block 1 shown in Fig. 1. Numeral 7 denotes a synchronization signal and numeral 8 denotes an ID signal which includes a block address or information on the PCM signal. The synchronization signal 7 and the ID signal 8 are omitted in Fig. 1. One block of PCM signal 2 comprises 14 words 1 word 16 bits . Each PCM signal word is divided into upper 8 bits and lower 8 bits as shown in Fig. 3. The 8 bit data is called a symbol. By processing the data by 8 bit unit, the circuit scale of the signal processor can be reduced. Such a PCM signal format is used in a digital audio apparatus which uses a compact disc or digital audio tape. The first error detection correction codes 3 each having four symbols P₀ P₃ are added to the PCM signal 2 having 28 symbols to form error detection correction code sequences called C₁. The first error detection and correction code may be a Reed Solomon code having a code length of 32 symbols, the number of information words of 28 symbols and a minimum distance of 5. As seen from Fig. 1, portions of the PCM signal 2 in the 52nd to 75th blocks are second error detection correction codes. The second error detection correction codes Q₀ Q₅ 4 are added to the lateral PCM signal of Fig. 1. For example, Q₀, Q₁, Q₅ at the tops of the 52nd, 56th, 72nd blocks are added to 32 4 block interleaved symbols W The second error detection correction code may be a Reed solomon code having a code length of 32 symbols, the number of information words of 26 symbols and a minimum distance of 7. The PCM signal to be reproduced is encoded by this code. In order to detect and correct errors in reproducing the coded PCM signal, the first error detection correction is done for the first error detection correction code P₀ P₈ , and then the second error detection correction is done for the second error detection correction code Q₀ Q₅ . When the Reed Solomon code having the minimum distance 5 is used as the first error detection correction code P₀ P₃ , an error up of the two symbols can be corrected. Accordingly, in the first error detection correction, the error of up to two symbols is corrected for the first error detection correction code, and the first error flag F In the second error detection correction, an erasure is corrected by using the first error flag F In the above error correction method, two types of error flags F In this manner, the error flags are added in the first and second error detection correction, and the errors are corrected and concealed by utilizing the error flags so that the error detection capability and the error correction capability are improved. In the above error correction method, the error detection capability is 7 x 10¹⁶ P The algorithm for the above error correction is disclosed in U.S. Patent Application Serial No. 665,378 by the present inventors, entilled Decoding method and System for Doubly Encoded Reed Solomon Codes filed on October 26, 1984, based on Japanese Patent Application No. 58 202602 filed in Japan on October 31, 1983, and assigned to the present assignee, whose disclosure is incorporated herein by reference. In Fig. 1, numerals 5 and 6 denote error flags for P and Q sequences, respectively. As described above, the error flags F Fig. 4 shows an embodiment of a PCM signal reproduction apparatus which reproduces a PCM signal in accordance with the present invention. Numeral 11 denotes an input terminal to which an input signal to be reproduced is applied and which is connected to a signal source or an input signal transmission line, numeral 12 denotes an output terminal of the reproduction apparatus, numeral 13 denotes a bus, numeral 14 denotes an amplifier, numeral 15 denotes a demodulator, numeral 16 denotes a memory, numeral 17 denotes an error detection correction circuit, numeral 18 denotes a concealment circuit, numeral 19 denotes a D A converter, numeral 20 denotes a control circuit, and numeral 21 denotes an error flag processor. Referring to a timing chart of Fig. 5, the operation of the present apparatus is explained. In a time slot step 1 , the reproduced data is stored in the memory RAM 16. More specifically, the PCM signal to be reproduced applied to the input terminal 11 is amplified to a predetermined level by the amplifier 14. The data is demodulated by the demodulator 15 and the synchronization signal is detected. The data thus reproduced is stored in the memory 16 through the bus line 13. In the step 2 , the first error detection correction is carried out. The data is supplied from the memory 16 to the error detection correction circuit 17 to carry out the first error detection correction, and the data stored in the memory 16 is corrected if it is correctable. The first error flag F In the step 3 , the second error detection correction is carried out. The data is supplied from the memory 16 to the error detection correction circuit 17 to carry out the second error detection correction, and the data stored in the memory 16 is corrected if the data is correctable. The second error flag F The error flag processor 21 is shown in Fig. 6. Numerals 24 and 25 denote latch circuits for latching the upper symbol flag and the lower symbol flag, respectively, and numeral 26 denotes an F The error flag F In the step 4 , the error corrected PCM signal is outputted. The error corrected data stored in the memory 16 is supplied to the error concealment circuit 18. When one word of PCM signal is to be outputted, the upper and lower symbol error flags F The error concealment circuit 18 is shown in Fig. 9. Numerals 31 34 denote latch circuits, numeral 35 denotes an interpolation circuit and numeral 36 denotes an error discrimination circuit. The upper symbol W The error concealed PCM signal from the error concealment circuit 18 is converted to an analog signal by the D A converter 19 and the analog signal is supplied to the output terminal 12. In accordance with the present embodiment, the error flag is processed by the simple error flag processor, and the memory capacity of the memory is reduced and the number of times of access to the memory is reduced. As an alternative of the data format shown in Fig. 1, a block which consists of only data blocks and a block which consists of data blocks and parity blocks P₀ P₃ may be used. This format is disclosed in U.S. Patent Application Serial No. 712,094 by the present inventors filed on March 15, 1985, entitled Rotary Head Type PCM Recording and Reproducing Method and System , based on Japanese Patent Application No. 59 50915 filed on March 19, 1984 and assigned to the present assignee, which disclosure is incorporated herein by reference, and particularly in Fig. 14 thereof. In the above embodiment, the error detection correction data format which uses the doubly encoded Reed Solomon codes is shown although the present invention is not limited thereto but the present invention is equally applicable to an error detection correction code data format of only Q sequence for the PCM signal in which one word comprises two symbols.