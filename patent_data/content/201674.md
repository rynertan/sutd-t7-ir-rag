# A method for reproducing multi level digital images on a bi level printer of fixed dot size

## Claims
Verfahren zum Erzeugen eines Grauwertbildes aus einem Halbton Eingangsbild 2 , wobei das Grauwertbild in Blöcken angeordnet ist, die zwei Eingangs Bildelementen entsprechen, die als Grauskalenwerte digitalisiert wurden, unter Benutzung eines Druckers 4 , der einen vordefinierten Satz von Ausgangs Bildelementmustern Fig. 2 drucken kann und einen entsprechenden Satz von diskreten Grauskalenwerten erzeugt, bei dem jedes Ausgangsmuster eine Anzahl von Bildelementen umfaßt, bestehend aus den Schritten

## Description
The present invention is concerned with digital halftone generation techniques for the printing of digitized continuous tone images using printers which have fixed print positions and a limited range of discrete print intensities, the most common case being bi level printers. In particular, the invention is directed to the utilization of error propagation to compensate for the absence of continuous printing of gray values. In the conventional printing process, continuous tone images are prepared for printing by exposure through a halftone screen. The resultant image will have dots of various sizes, one for each opening in the screen. These dots are larger where more light penetrates the screen and smaller where less light is present. Thus the exposure through the screen converts the gray value of the original image at the opening in the screen into a dot of appropriate diameter. In the digital analog of the above process, the original image is scanned with a scanner and the data are captured in a digital computer. These data consist of binary representations of the scanned gray values each such value typically ranging from 0 to 255 corresponds to one scanned area or pixel of the input image. To reproduce this image on a printer capable of only printing black dots or pels in fixed output positions, it is necessary to create a sensation of gray by suitable choice of the pels to be printed. A summary of various techniques that have been used in the past is contained in the IBM Journal of Research and Development, Vol.26, No.6, pps.687 697. The scanned image may be scaled in the computer, but in any event, it may be assumed, without loss of generality, that there is one pixel of the input image for each dot to be represented in the output. The dots are represented in the output of a digital printer as patterns of pels, and the pel patterns may be considered to be arranged in blocks. Each pel in a block is either printed or not by the digital printer. Each such block represents the digital analog of the halftone dot used in conventional printing. Such a block may be of any shape which contains an integral number of pel positions and which, when replicated, fills the area to be printed without overlap. Square or rectangular block shapes are convenient. An extreme case is that where the block contains only one pel. Different levels of gray are obtained by printing or reproducing different pel patterns within a block. If the block contains only one pel, only two values of gray are available. Additional pels within a block will permit the printing of additional discrete gray values. Larger blocks will give more discrete gray values or levels, but also tend to reduce the resolution of the output image. An error occurs in the gray values of the output image when the gray levels available for printing within a block differ from the gray level determined for the respective block, which level is based on the brightness of the corresponding analogous halftone dot. Hence, the limited number of gray values available from the blocks limits the quality of the printed image due to the absence of correct grays in some areas and also to the creation of contours as the reproduction process goes from one block pattern to another in a region of slowly varying gray value. These problems may be alleviated by intermixing the levels in different blocks in such a manner as to obtain the desired gray value as an average over many neighboring blocks. In error techniques of this type, known as error propagation , the gray value desired at a given block position in an output image is determined from the input gray level at that position added to the error propagated from previous positions. More particularly, to begin with, an output pel pattern for a given block is selected from among the available patterns, which pattern typically represents an approximation to the gray value desired for that block. The error is determined as the difference between the desired gray and the gray now associated with the given block. The determined error is then distributed or assigned to one or more adjacent block positions on the same or subsequent lines of the image. This selection and error distribution method is then continued throughout the lines of the image taking into account the assigned error when selecting the appropriate pel pattern for each block. A variety of methods have been previously used for allocating the distribution of the error. However, all divide the error into fixed proportions and thus have suffered to a greater or lesser extent from the problem of producing worms , that is, output pattern artifacts consisting of apparent curved or straight lines. In addition to the worms , these methods tend to give fuzzy edges between dark and light regions of the image. The present invention concerns itself with the elimination of the worms . It is accordingly an object of the present invention to provide a system for achieving improved error propagation. In the prior art, as noted above, error diffusion is usually carried out by propagating the error at a particular block in fixed proportions to two or more adjacent block positions. For example, the propagation of an error e to each of two blocks a and b might be accomplished using a relationship such as Other random distributions of the error to be propagated may also be used as will be found appropriate. According to the invention there is provided a method for producing a halftone image from a continuous tone input image as set forth in Claim 1 and apparatus as set forth in claim 4. In order that the invention may be fully understood, a preferred embodiment thereof will now be described with reference to the accompanying drawings in which Figure 1 is a block diagram of a basic system for carrying out the present invention. Figure 2 illustrates block pattems used in printing, as prepared for a particular printer, in keeping with the present invention. The first column under the heading PATTERN shows individual blocks of 3 6 pels containing 17 different pel patterns, and the the second column shows corresponding areas containing nine identical blocks as they are arranged in printing. The REFLECTIVITY column shows measured values of reflectivity for a large area filled with replicas of the corresponding block. The GRAY VALUE column is derived from the reflectivities by a linear transformation and contains the gray values associated with the respective blocks. Figure 3 illustrates the various blocks and half blocks of an output image. The direction of propagation of error is indicated, for one block, by diagonal arrows. A basic system for carrying out the present invention is shown in FIG.1 and generally is composed of a means 1, e.g., an image scanner, for digitizing an original continuous tone image, such as a photograph 2, and providing it to a general purpose computer 3 wherein it is processed for printout as a halftone image on a digital printer 4. An input image of the type to be acted upon by the present invention may be represented by a series of gray values arranged in an array of L lines, each line containing I gray values. The gray values are typically expressed as integers in the range from 0 to 255. The output image is considered to consist of blocks of pels, each pel corresponding to an output dot or element that is printed by a digital printer or that otherwise makes up a tangible representation of the image. As seen in FIGS.2 and 3, the blocks to be described are composed of 3 6 pels for each pair of input gray values, so that there will by 9 times as many output pels as there are input gray values. Referring to FIG. 2, 17 available block patterns are shown along with their associated reflectivities and gray values for a particular printer. The output image will consist of lines of suitably chosen blocks from among the 17 to approximate the desired gray values in the various image areas. It will be seen that in alternate lines of the image, the output blocks are shifted by three pels when printed, corresponding to the conventional 45 degree halftone grid used in analog printing. Referring next to FIG.3, the steps of the method or algorithm for carrying out error diffusion in accordance with the present invention will be described. The positions on the input image are represented by a pair of numbers I,i where I is the line number and i is the number of the gray value in that line. The gray value for a , the I,i pixel, in the input image is denoted gv l,i . The gray value associated with a pattern number b will be designated g b . A temporary array is used to store the errors, e l,i . The steps of the algorithm are as follows Repeat the following sequence for all lines in the image. For odd lines, the calculation is carried out for i 1, 3,..., I for even lines for i 2, 4,..., I. Initialize the error at the extreme left of the next line Calculate the desired gray value d as the average of the gray values corresponding to the block Find the trial block number b such that d is equal to or greater than the gray value of block b and less than the gray value of block b 1. Select b such that Place block b in the appropriate location on the output image, ready for printing. Calculate and propagate the error x. First calculate the error Distribute the error in accordance with the arrows in FIG.3. Following distribution of the errors throughout the image in this manner, the output image will print out without worming or pebbling. Upon the application of the technique described above an halftone output image may be obtained from a continous tone input image without artifacts such as worming or pebbling in the other areas. The system herein described will produce printed images the same size as the scanned images on printers having three times the linear resolution of the scanner. For example, a scanned image of 200 pels inch may be printed out on a 600 pels inch printer. A preferred printer for implementing the invention is the IBM 4250 which has been found to produce excellent electroerosion reproductions suitable for use in the preparation of long life lithographic plates. Various image scanners and other conventional means may be used in the process of capturing the images in a general purpose computer such as an IBM System 370 and the described algorithms may be run by the computer. When it is necessary to change the output image size, the input image may be modified in size by any of a variety of algorithms suitable for handling digital multi level images that are known in the art.