# ELECTRICAL CIRCUIT ARRANGEMENT AND ELECTRICAL CIRCUIT UNIT INCLUDING AN ADDRESS GENERATOR FOR USE IN SUCH AN ARRANGEMENT

## Claims
Elektrische Schaltungsanordnung mit einer Anzahl von Schaltungseinheiten 1 1...1 n mit Verbindungen nach einem gemeinsamen Weg, wobei jede Schaltungseinheit einen Eingang zum Empfangen eines Steuersignals Ai enthält, und mit einer Steuerschaltung 104, 105 mit einem ersten Eingang 101 zum Empfangen eines Taktsignals, mit einem zweiten Eingang 100 in Verbindung mit dem Steuersignaleingang und mit einem Ausgang in Verbindung mit einem Eingang eines Adreßgenerators 107 , der zum Erzeugen von Adressen in Beantwortung des daran zugeführten Taktsignals unter der Steuerung des Steuersignals vorgesehen ist,

## Description
The invention relates to an electrical circuit arrangement comprising a plurality of circuit units connected to a common path, each of the circuit units having an input for receiving a control signal and including a control circuit having a first input for receiving a clock signal, a second input connected to the control signal input and an output connected to an input of an address generator, said address generator being provided for generating addresses in response to said clock signal applied thereto under control of said control signal. The invention further relates to an electrical circuit unit suitable for use in a electrical circuit arrangement as set forth in the opening paragraph. One problem in designing and constructing electronic systems which include a plurality of circuit units is the assignment to each circuit unit of a unique identity or address. Such circuit units may be RAMs, ROMs, Codecs, etc. which may be, for example, in the form of integrated circuits, hybrid circuits or printed circuit boards carrying a plurality of discrete and or integrated circuits. One possibility is to assign an address to each circuit unit at the manufacturing stage, but this leads both to more expensive circuit units and to a greater possibility of inserting the circuit units into the wrong position within the system. Another possibility is to provide each circuit unit with a number of programming pins which are connected to internal decoding circuitry and to external potentials either directly or through switches. These two possibilities may be combined so that part of the address is fixed at the manufacturing stage and part is programmable. The fixed portion of the address normally indicates the type of circuit, i.e. RAM, Codec, etc., while the programmable part identifies the particular circuit of that type. This reduces the number of external pins required which is particularly important when the circuit unit is formed as an integrated circuit since the cost of an integrated circuit increases significantly with each additional pin provided. However the number of circuit units which can be addressed is limited if the number of programming pins is not to become excessive. A further possibility is to provide an external address decoding circuit feeding an enable pin on the integrated circuit This reduces the number of addressing pins required to one but has the disadvantage that additional circuit elements have to be provided to enable addressing to be effected thus increasing the cost and complexity of the system. When the circuit units are formed as printed circuit boards PCBs which are plugged into either a mother board or a wiring frame it is usual to provide programming switches on the PCB which are appropriately set to give the PCB address. This arrangement has a number of disadvantages amongst which are the difficulties involved with mounting and soldering the switches to the PCB, the possibility of incorrectly setting the switches, and the area of the PCB occupied by the switches which reduces the available board area for the functional parts of the circuit unit. U.K. Patent Specification No. 1295332 discloses an electrical circuit arrangement and an electrical circuit unit as set forth in the first and second paragraphs. The description with reference to Figures 6 and 7 of that specification shows a circuit arrangement comprising a plurality of terminals arranged along a transmission line at approximately 10 metre intervals. Each terminal includes an address generator which is incremented by a clock signal applied thereto It is an object of the invention to enable the provision of a simple means of assigning addresses to each of a plurality of circuit units in a circuit arrangement. The invention provides an electrical circuit arrangement as set forth in the opening paragraph characterised in that, the circuit arrangement comprises a control arrangement for generating successive control signals synchronously with the clock signal and applying the successive control signals to the second input of the control circuit of successive circuit units of said plurality of circuit units. By generating the successive control signals synchronously with the clock signals it is possible to make the application of the control signal to each circuit unit independent of its distance from the source of the control signal. Thus the frequency of the clock signal is not constrained by the distance between the circuit units. The successive control signals applied to the successive circuit units control the address generators in the successive circuit units, thus providing a dedicated address to each circuit unit. Each circuit unit may have a control signal output connected to the control signal input of at least one succeeding circuit unit when present. Thus daisy chaining of the circuit units is provided. The control arrangement may comprise a sub arrangement in each circuit unit, a first input of each sub arrangement being connected to the control signal input of its respective circuit unit, said clock signal being applied to a second input of each sub arrangement and an output of each sub arrangement being connected to the control signal output of its respective circuit unit, each sub arrangement being provided for generating one of said successive control signal subsequent to a received control signal on its first input. This enables standardisation of the circuit units and a practical realisation of the control arrangement. This also enables the number of circuit units to be extended at any time. For each circuit unit the sub arrangement may generate its control signal one period of the clock signal subsequent to the receipt of the control signal at its input. This permits a fast realisation of the address generation and enables the allocation of successive addresses to successive circuit units in a simple manner. The application of the clock signal to the address generator of a circuit unit may be inhibited in response to the control signal applied to the control signal input of that circuit unit. Each sub arrangement may comprise a clocked bistable circuit having an input connected to the control signal input of its associated circuit unit, an output connected to the control signal output of its associated circuit unit, and a clock input for receiving the clock signal. Thus offering a simple realisation of the sub arrangement. The control signal input of the first unit nay be connected to a reference potential source. In this arrangement the circuit units nay be connected in a chain with the signal on the control signal input of the first unit in the chain being applied to each succeeding link in the chain at clock pulse intervals thus enabling each unit to count one more clock pulse than the preceding unit in the chain and automatically allocating consecutive addresses to each unit along the chain. It should be noted that since the links between the units will normally be conductive tracks on a printed circuit board or wire links between printed circuit boards successive units along the chain need not be physically adjacent to each other. The links between the units can be arranged to give any of the units an arbitary place along the chain. This may be important when the circuit arrangement is formed from integrated circuits connected to an I²C bus where the priority of a particular circuit unit depends on its address. The I²C bus is described in, for example Electronic Components and Applications, Volume 5, No. 1, November 1982, pages 19 and 20 and European Patent Application No.0051332A. Means may be provided for monitoring the state of the control signal output of the last unit in the sequence. This enables detection of the successful generation of addresses by all the circuit units or of a fault in one of the units or in the connection between two or more of the units which prevents the address generation control signal from propagating along the chain. At least one circuit unit may comprise means for enabling the control input and or the control signal output to be used for other circuit functions once the address generator has generated the address. The means for enabling the control signal input and or output to be used for other purposes may be operable in response to a signal produced by said monitoring means. At least one circuit unit may comprise means for changing the address generated by the address generator in response to appropriate signals applied to the circuit unit. The control arrangement may have a plurality of outputs an individual output being connected to the control signal input of a respective circuit unit. With this arrangement a control signal output pin may be saved on each circuit unit. The control arrangement may comprise a shift register. Thus the control arrangement may be substantially separate from the circuit units and this embodiment does not require the circuit units to be provided with a control signal output. The invention further provides an electrical circuit unit suitable for use in a electrical circuit arrangement as set forth hereinbefore, the circuit unit including means for recognising an address signal applied thereto, an address generator, an input for receiving a control signal, and a control circuit having a first input for receiving a clock signal, a second input connected to the control signal input and an output connected to an input of the address generator, the address generator being provided for generating addresses in response to said clock signal applied thereto under the control of said control signal. The inclusion of an address generator within the circuit unit enables each circuit unit of a given type to be manufactured in identical form without requiring additional pins for setting the address apart from the control signal input and possibly one for the clock signal if the circuit unit does not require a system clock for other purposes. This is particularly advantageous when the circuit units comprise integrated or hybrid circuits because of the significantly increased manufacturing cost of each additional pin but is also advantageous when the circuit unit comprises one or more printed circuit boards since the number of edge connector terminals is frequently a limiting factor in the complexity of circuits which can be accommodated on a single printed circuit board. Further in a given system all the printed circuit board terminals may be allocated to system functions by a standard bus specification, for example the VME Bus. Details of the VME Bus have been published by Mostek Corporation in the VME Bus Technical Specification, to which reference should be made to determine the signals required and available for systems using the VME Bus for interconnection between circuit units. Each circuit unit may include a sub arrangement of the control arrangement, a first input of the sub arrangement being connected to the control signal input of the circuit unit, said clock signal being applied to a second input of the sub arrangement and an output of the sub arrangement being connected to a control signal output of the circuit unit, each sub arrangement being provided for generating a control signal at the control signal output subsequent to the receipt of control signal on its first input. The sub arrangement may generate its control signal one period of the clock signal subsequent to the receipt of the control signal at its input. The application of the clock signal to the address generator nay be inhibited in response to the control signal applied to the control signal input. Each sub arrangement may comprise a clocked bistable circuit having an input connected to the control signal input, an output connected to the control signal output, and a clock input for receiving the clock signal. The address generator may comprise a counting circuit driven by said clock signal. The address generator may be incremented by one in response to each clock pulse. The circuit unit may comprise means for enabling the control signal input and or control signal output to be used for other circuit functions once the address has been generated. The means for enabling the control signal input and or output to be used for other purposes may be operable in response to a signal produced by the monitoring means. This further reduces the number of external terminals required by the circuit unit. Examples of other system functions where daisy chained lines are already used are the interrupt priority lines IACKIN and IACKOUT in the VHE Bus and IEI and IEO in the Z80 microcomputer system of Zilog Inc. The circuit unit may include means for changing the address generated by the address generator in response to appropriate signals applied to the circuit unit. Thus having set up an initial addressing scheme this may subsequently be altered. This may be advantageous in systems such as I²C Bus where the priority given to a given circuit unit depends on its address. By arranging for the address to be alterable the priority given to a particular circuit unit can be changed at will and need not depend on its physical position within the system. Embodiments of the invention will now be described, by way of example, with reference to the accompanying drawings, in which Figure 1 shows a circuit arrangement comprising a plurality of circuit units 1 1 to 1 n each having an input AI and an output A0, the units being arranged in sequence such that the A0 output of each is connected to the AI input of the succeeding unit. The circuit unit may take many forms, for example individual integrated circuits, complete printed circuit boards, or computer terminals. The AI input of the first unit 1 1 is connected to an input terminal 10 while the A0 output of the last unit 1 n is connected to an output terminal 11. A terminal 12 to which, in operation, a clock signal is connected is connected to a clock input of each of the units 1 1 to 1 n. Each unit 1 1 to 1 n includes an address generator the state of which is modified in response to the clock signal until the signal at its AI input is at a logical 1 and each unit is arranged to generate a logical 1 at its output A0 on the clock pulse after a logical 1 appears at its AI input. A simple way to modify the state of the address generator in response to the clock signal is to form the address generator as a counting circuit and cause it to count applied clock pulses. Thus in this case the address will be incremented by each applied clock pulse. However the state of the address generator may be modified in any arbitary manner on the occurence of each clock pulse. For example, the address generator could be formed as a read only memory with the clock pulses counting through memory addresses so that the contents of any memory location can be used as the circuit unit address. Thus, in the case where the address generators comprise counting circuits to generate addresses for each of the units 1 1 to 1 n a logical 1 is applied to terminal 10. On the next clock pulse this logical 1 appears at the output A0 of unit 1 1. The address generators of units 1 2 to 1 n are incremented but that of unit 1 1 is not since it has a logical 1 on its AI input. On the following clock pulse a logical 1 appears at the output A0 of unit 1 2 and the address generators of units 1 3 to 1 n are again incremented but those of units 1 1 and 1 2 are not since both units have a logical 1 on their A1 inputs. This process is repeated until all the units 1 1 to 1 n have a logical 1 on their AI inputs and consequently the units 1 1 to 1 n are set to have incrementally increasing addresses along the length of the chain the actual address depending only on the position of the unit along the chain. In order to detect that all the addresses have been set up the state of the terminal 11, which is connected to the A0 output of unit 1 n, may be monitored to determine when it changes to a logical 1 by means of a monitoring unit 13. The unit 13 may include an audible or visible warning device, such as a lamp, which may indicate when the state of terminal 11 is at a logical 0 or which may be operated when the state of terminal 11 goes to a logical 1 to indicate that the address setting up procedure has been completed. The unit 13 may also or alternatively produce an output signal which may be fed to a system controller to indicate that the address generation phase has been completed and which may be applied directly or via a system controller to the circuit units. This signal may be effective to cause the AI and A0 terminals of the circuit units to be disconnected from the address generator and be connected to other functional ciruits within the circuit units, for example interrupt requesters controllers. Alternatively the number of clock pulses applied may be counted to ensure that sufficient time has elapsed to enable all the addresses to be generated. If the alternative method is used however faulty units would not be detected and if the chain is broken some units will not generate their own addresses. Figure 2 shows a circuit arrangement in which circuit units 20 1 to 20 3, 30 1 to 30 4, 40 1 and 40 2 are arranged in three branches. The circuit arrangement has an input 110 to which in order to generate addresses for the circuit units a signal is applied and an input 112 via which a clock signal is appied to each of the circuit units. In a similar manner to that described with respect to Figure 1 when a logical 1 is applied to the AI input of circuit unit 30 1 the clock signal is inhibited from incrementing the address generator in circuit unit 30 1 but the address generators in all the other circuit units are incremented and at the same time the logical 1 on the AI input of unit 30 1 is transferred to its A0 output. On the next clock pulse the address generators of circuit units 20 1, 30 2 and 40 1 are also inhibited and a logical 1 is transferred to their A0 outputs while the address generators of the other circuit units are once again incremented. This process is continued until all the units have set up their addresses i.e. a logical 1 appears on output terminals 113, 114 and 115. A construction similar to that shown in Figure 2 may be useful when each unit has an address comprising a fixed part which is related to the unit type and is built into the unit during manufacture and a variable part which defines the unit number within the unit type. Thus, for example the units 20 1 to 20 3 may be RAMs, the units 30 1 to 30 4 ROMs and the units 40 1 and 40 2 display drivers. Figure 3 shows an alternative embodiment in which the circuit units 50 1 to 50 n are not connected in a daisy chain but have their AI inputs connected to the outputs of a control arrangement 51. The control arrangement may be, for example, a shift register or a read only memory ROM or may be a microprocessor controlled circuit. A clock signal is applied to terminal 52 and the address generators within the circuit units 50 1 to 50 n are incremented so long as their AI inputs remain at a logical 0 . The clock pulses also cycle the control arrangement 51 so that the state of the AI inputs of the individual circuit units can be appropriately set in synchronism with the clock pulses. Since in this embodiment the address generator control signal is not passed from unit to unit the A0 output is not required. In some circumstances it may be desired to modify the addresses of the circuit units and the arrangement of Figure 3 may be used for this purpose if the address generators are modified so that they can be reset other than by switching off the power. This could be achieved by providing a further input on the circuit units to which a signal may be applied to reset the address geneator. Alternatively the power may be switched off when address re allocation is to be made. Figure 4 shows a circuit diagram of a circuit unit 1 n according to the invention which is suitable for inclusion in the arrangements of Figures 1, 2 or 3. The circuit unit has a first terminal 100 which corresponds to the AI input of the units of Figures 1, 2 and 3, a second terminal 101 which corresponds to the clock input of the circuit units and a third terminal 102 which corresponds to the A0 output of the units of Figures 1 and 2. The terminal 101 is connected to the D input of a D type bistable circuit 103 and via an inverter 104 to a first input of an AND gate 105. The terminal 101 is connected to the clock input of the D type bistable circuit 103 and to a second input of the AND gate 105. A switch on reset circuit 106, which generates a reset signal of a desired duration when power is first applied, is connected to reset inputs of the D type bistable 103 and counting circuit 107. The output of AND gate 105 is connected to a clock input of the counting circuit 107 and the Q output of the D type bistable 103 is connected to terminal 102. When power is applied to the arrangement the circuit 106 generates a pulse which resets the D type bistable 103 so that its Q output is at a logical 0 and resets the counting circuit to an initial state which may be, but is not necessarily, all zeros. If the signal at terminal 100 is at a logical 0 and clock pulses are applied to terminal 101 the counting circuit 107 will be incremented by each clock pulse and the D type bistable 103 will remain reset and therefore a logical 0 will remain on terminal 102. When the signal on terminal 100 goes to a logical 1 the AND gate 105 will be blocked and no clock pulses will be applied to the counting circuit 107 and thus it will no longer be incremented. Further the type bistable 103 will change state on the occurrence of the first clock pulse after the logical 1 appears on input 100 thus causing a logical 1 to appear on output 102. Consequently by connecting the address generators in a chain they can be made to produce incrementally increasing addresses along the length of the chain. The counting circuit 107 which may take the form of for example a binary counter or a shift register determines the address of its circuit unit by the state of its outputs. The circuit unit is further provided with an address decoder for decoding incoming addresses. The incoming address may be in serial or parallel form depending on the system design and the circuit unit will contain appropriate address decoding circuitry. As shown in Figure 4 the circuit unit 1 n is arranged to receive and decode addresses present in parallel form on inputs 120 1 to 120 n. These inputs are connected via an n bit highway 123 to a comparator 122. The outputs of the counting circuit 107 are applied via a further Various other arrangements for receiving and decoding addresses are possible and would be readily apparent to one skilled in the art, for example the addresses may be received serially over a single line and applied to a serial parallel converter such as a series in parallel out shift register. Such an arrangement reduces the number of addressing pins required but increases the time necessary to receive and recognise an address. The clock input 101 may serve a dual purpose in that a system clock may be necessary for the operation of the functional part 125 of the circuit unit and in that case will not require an increase in the number of input terminals needed by the circuit unit. Further the circuit unit may include its own internal clock generator and an output of this clock generator may be used to increment the address generator provided that the clock generators of all the circuit units are synchronised. The counting circuit 107 may be any circuit which is capable of stepping through a number of states in response to a clock signal and could for example, be a read only memory whose memory locations are addressed in turn by means of the clock pulses. Thus non sequential addresses could be generated in a simple manner. The A1 input 100 and A0 output 102 could be dual purpose inputs outputs. Thus, if the circuit units form part of a computer system micro, mini, or main frame interrupt lines and or bus priority lines could be daisy chained in order to initially generate the circuit unit addresses and then returned to their other function by incorporating appropriate logic circuitry within the circuit units and central processor. It is, of course, necessary in that case to ensure that the address, once set up, is retained by the circuit unit until any possible instruction to alter the address is generated within the arrangement. The D type bistable 103 forms a sub arrangement of the control arrangement for the circuit arrangements as shown in Figures 1 and 2. In these embodiments the control arrangement is, at least partly, distributed in the circuit units. This allows the control arrangement to be automatically extended to accommodate additional circuit units merely by adding the circuit unit. The circuit unit 200 shown in Figure 5 includes means for enabling dual use of the AI and A0 pins and for changing the address of the circuit unit after the initial address has been set. A terminal 201 forms the AI input and a terminal 202 forms the A0 output. The terminal 201 is connected to the pole of a changeover switch 203 while the terminal 202 is connected to the pole of a changeover switch 204. A terminal 205 is connected to a control input of both changeover switches 203 and 204. A first contact of the changeover switch 203 is connected to the D input of a D type bistable circuit 206 and to the input of an inverter 207 while a second contact of the changeover switch 203 is connected to an input of an interrupt control circuit 208. The output of the interrupt control circuit 208 is connected to a second contact of the changeover switch 204 while the Q output of the D type bistable ciruit 206 is connected to a first contact of the changeover switch 204 and is connected to a first contact of the changeover switch 204 and to a first input of an AND gate 209 via an inverter 219. A terminal 210 is connected to a second input of the AND gate 209 while the output of the AND gate 209 is connected to a first input of an AND gate 211 and the clock input of the D type bistable circuit 206. The output of the inverter 207 is connected to a second input of the AND gate 211 while the output of AND gate 211 is conected to a clock input of a counting circuit 212. A terminal 213 is connected to reset inputs of the D type bistable circuit 206 and the counting circuit 212. The counting circuit 212 also has inputs to which a data highway 214 is connected, the data highway 214 also being connected to the functional portion 215 of the circuit unit 200. A control line 216 is also connected between the counting circuit 212 and the functional portion 215. The outputs of the counting circuit 212 are connected to a first set of inputs of a comparator 217 while terminals 220 1 to 220 n are connected to a second set of inputs of the comparator 217. The comparator output is fed via a line 218 to the functional portion 215. Further input terminals 221 1 to 221 n and output terminals 222 1 to 222 n are connected to the functional portion 215. In operation an initialisation signal is applied to terminal 213 to set bistable ciruit 206 to the state where its Q output is at a logical 0 and to set the counting ciruit to a desired initial state. This signal may also be applied to the switching circuits 203 and 204 to cause them to adopt the state shown in the drawing instead of or as well as the terminal 205. Alternatively the initialisation signal may be generated within the circuit unit when power is first supplied. A system clock signal is fed When the address of all the circuit units have been set up a signal on terminal 205, which may, for example, be generated by the monitoring unit 13 of Figure 1, causes the switches 203 and 204 to change state so that terminals 201 and 202 may be used for other purposes, for example an interrupt daisy chain. When this occurs the logical 1 may be removed from the D input of the bistable circuit 206 but the bistable circuit 206 is prevented from changing state since the logical 1 on the Q output which is fed via the inverter 219 to the AND gate 209 prevents clock pulses from being fed to its clock input. The state of outputs of the counting circuit 212 is compared with that of addressing signals on terminals 220 1 to 220 n and if correspondence is detected an output is applied on line 218 to the functional portion 215. This then enables the functional portion to receive information from or transmit information to the rest of the system via the terminals 221 n to 221 n and 222 1 to 222 n. These terminals may be devoted exclusively to input or output functions or may be bi directional. The construction of the functional portion is not relevant to the invention apart from the possibility of subsequent address modification. Address modification may be achieved as follows. If the counting circuit is formed by presettable binary or decade counters, such as the 74196 or 74197 TTL integrated circuits, the initial address may be allocated as described and subsequently modified by applying signals to the presetting inputs. Thus the functional portion 215 may receive an instruction from a system controller and in response thereto put data onto the highway 214 which is fed to the presetting inputs of the counters under the control of a signal on line 216 which is applied to the parallel load pin of the counters. Various modifications to the circuit unit shown in Figure 5 would be readily apparent to one skilled in the art. For example, the changeover switches 203 and 204 may be set to the state shown by the initialisation signal and changed over after a given number of clock pulses determined by a counter. The addresses may be applied to the circuit unit serially over a single line in which case the comparator may compare the incoming address with that stored on a bit by bit basis as the address arrives or it may be fed into a series to parallel converter. Any or all of the possibilities discussed with reference to Figure 4 are equally applicable to the embodiment of Figure 5 and vice versa and both embodiments may be used in the arrangements of Figures 1 and 2 and with appropriate modifications in that of Figure 3.