# Image processing apparatus.

## Abstract
There is disclosed an apparatus for processing image signals. This apparatus transduces the image signals from the image sensors in accordance with the non linear input output characteristics and outputs the signals thus transduced. In this apparatus, the various tone wedge transducing characteristics can be performed in addition to the tone wedge correction such as the ordi nary gamma correction. RAMs and a microcomputer are provided to perform these processings. This apparatus has the functions as the chroma key signal generator and the special effect producing apparatus. Thus, the grada tion and the color in the designated area in the screen can be made different from those in the other area. The two dimensional information such as characteristics and figures, or the like can be mixed or superimposed on the picture in the screen.

## Claims
CLAIMS 1. An apparatus for processing image signals by the non linear transduction of input image signals to output image signals, said apparatus comprising a an analogue to digital converter for converting said image signals into digital image signals b address selecting means to which said digital image signals from said analogue to digital converter and address data from a microprocessor are supplied and c a memory addressable by the output of said address selecting means and in which the data in a data conversion table from said microprocessor is, in use, written according to said address data, and from which the output data corresponding to said digital image signals is read out in accordance with said data conversion table. 2. An apparatus for processing image signals as claimed in claim 1, wherein a plurality of data conversion tables having different transducing characteristics are written in said semiconductor memory, and wherein a control circuit is provided for selecting which of said data conversion tables is used for transduction. 3. Apparatus as claimed in claim 2, wherein the control circuit is arranged to select a particular data conversion table in accordance with the image area being displayed. 4. An apparatus for processing image signals by the non linear transduction of input image signals to output image signals, said apparatus comprising a an analogue to digital converter for converting said image signals into digital image signals b address selecting means to which said digital image signals from said analogue converter and the address data and data having a given level from a microprocessor are supplied c a memory to which the output of said address selecting means is supplied, and in which the data in a data conversion table from said microprocessor is, in use, written acording 10 said address data, and from which the output data corresponding to said digital image signals is rea out in accordance with said data conversion table and d co mean for selecting the data having a given level .l said microprocessor in accordance with a display pat Cn by said address selecting means. 5 paratus as claimed in claim 4, further including a ester in which, in use, a plurality of said data hav . given levels from said microprocessor are stored, and wherein a pluralit5 of said data in said register are selected by said control means. 6. Apparatus as claimed in any one of the preceding claims further including means for designating the data conversion table which is written in said semiconductor memory. 7. Apparatus as claimed in any one of the preceding claims, wherein said memory is used as a memory for said microprocessor. 8. Apparatus according to any one of the preceding claims wherein the memory is a solid state memory.

## Description
DESCRIPTION IMAGE PROCESSING APPARATUS The present invention relates to an apparatus for processing image signals in which image signals from the image sensors are transduced in accordance with a non linear input output characteristic. Generally, the image processing circuitry of the conventional color video camera has a means for performing gamma correction. This gamma correction is used to correct the image signals so that the overall characteristic of the system from the image pickup tube to the image receiving tube satisfies the expression y 1 . However, it is sometimes necessary to perform non lineartransductionother than the standard gamma correction dependent upon the shooting conditions in use of the video camera. For example, it is preferable to utilize non linear transduction for obtaining clearer contrast under back lit conditions. It is convenient if the transduction characteristic can be suitably changed in response to shooting conditions for indoor shooting or outdoor shooting. However, in the conventional analog type processing circuitry it is impossible to change the transduction characteristic to the desired one. This invention contemplates the provision of a solution to this problem by providing an apparatus for processing image signals in which the image signals from the video camera can be transduced in compliance with a desired input output characteristic According to the present invention there is provided an apparatus for processing image signals by the non linear trars, tivr, of input adage signals to output image signals, said apparatus co sing a an analogue to digital converter for converting said image signals into digital image signals b address selecting means to which said digital image signals from said analogue converter and address data from a microprocessor are supplied and c a memory addressable by the output of said address selecting means and in which the data in a data conversion table from said microprocessor is, in use. written according to said address data, and from which the output data corresponding to said digital image signals is read out in accordance with said data conversion table. The invention further provides an apparatus for processing image signals by the non linear transduction of input image signals to output image signals, said apparatus comprising a an analogue to digital converter for converting said image signals into digital image signals b address selecting means to which said digital image signals from said analogue converter and the address data and data having a given level from a microprocessor are supplied c a memory to which the output of said address selecting means is supplied, and in which the data in a data conversion table from said microprocessor is, in use, written according to said address data, and from which the output data corresponding to said digital image signals is read out in accordance with said data conversion table and d control means for selecting the data having a given level from said microprocessor in accordance with a display pattern by said address selecting means. Other features are defined in the sub claims appended thereto. As will become apparent from the following description, the invention can provide an apparatus for processing image signals in which ordinary tone wedge correction such as gamma correction or the like can be performed, and in which the tone wedge transducing characteristics can be three dimensionally changed by using RAMs and a microcomputer. In other words, the gradation and the color in a designated area in the screen can be made different from those in the other area. Two dimensional information such as characters and figures, or the like can be mixed or superimposed on the picture in the screen. These and other objects, features and advantages of this invention will be more apparent from the following description of preferred embodiments, taken in conjunction with the accompanying drawings, in which FIG. 1 is a block diagram of an embodiment of the present invention FIG. 2 is a block diagram of an embodiment of the video processor in which the invention is employed FIGS. 3A C are schematics for describing the tone wedge characteristics FIG. 4 is a schematic diagram of an example of the pattern mixing according to the illustrated embodiment of the invention, on which numerals are superimposed FIGS. 5A D are schematic diagrams for describing an example of the pattern mixing in the illustrated embodiment of the invention FIGS. 6A D are schematic diagrams for describing another example of the mixing pattern and FIG. 7 is a block diagram showing the construction of a part of another embodiment of the invention, An embodiment of this invention will be described hereinbelow with reference to the drawings. FIG. 1 shows the overall construction of a digital camera system.Reference numerals 1, 2 and 3 resp ctively indicate image sensors, for example, CCDs Change Coupled Devices which generate three primary color signals such as red, green and blue. Each output of these CCDs 1, 2 and 3 is sampled by sample holding circuits 4, 5 and 6 and supplied to A D analogue to digital converters 7, 8 and 9 to obtain digital color signals DR, DG and Dg. The following processes are possible point sequential color signals are generated using one or two CCDs oneCCD is disposed apart from other two CCDs by staggering 1 2 picture element the transmitting route of the digital color signals is changed by performing interpolation, or the like. The above mentioned digital color signals DR, DG and DB are supplied to a video processor 10. This video processor 10 has a memory and a microcomputer as will be desribed later. Look up tables are stored in this memory to perform ordinary tone wedge transduction, so that it is possible to vary the tone wedge transducing characteristics three dimensionally. The digital color signals Dri Dq and Db to be output from this video processor 10 are supplied to a color encoder 11. This color encoder 11 includes a matrix circuit for generating a luminance signal and two color difference signals, a modulator for digitally modulating the color difference signals, a VC mixer, a synchronizing circuit, and a burst adding circuit. The color encoder 11 outputs from its output terminal 12 composite color video signals of, for example, the NTSC system. It may be possible to obtain the analog composite color video signals by providing a D A Digital to analogue converter. FIG. 2 shows the construction of the video processor 10 only the processing of color signal DR will be described the other two color signals DG and DB are also similarly processed, but detailed description of these is omitted for simplicity. One sample of the digital color signal DR is converted into, for example, 8 bits and the signal DR becomes the address input to an RAM 14 through an address selector 13. The RAM 14 includes two RAMs 15A and 15B.The predetermined look up tables are written in thisRAM 14 from a data bus 16 through a data selector 17.The color signal Dr to be read from the RAM 14 is output through th.e data selector 17. The look up tables to be written in the RAM 14 are used to output the 8 bit data Dr by utilizing the input signal DR as a key and to perform, e.g. standard gamma correction to a gamma of one. The above mentioned look up tables for this tone wedge transduction are produced by a CPU 18 and an RON 19. The look up table for the ordinary gamma correction and the necessary data are stored in the ROM 19. In case of performing other tone wedge processing, the data stored in this ROM 19 is read out and calculated in the CPU 18 to produce different look up tables.An RAM 20 is used for the purpose of this calculation and for temporary storage. Reference numeral 21 designates an address bus. The CPU 18 serves to control the write in readout of the RAM 14. The n word data from a latch 22 is supplied to the address selector 13. This n word data is produced by the CPU 18 on the basis of user input from a keyboard or similar device and supplied to the data bus 16. The address selector 13 further receives, as the third input t the address data from the address bus 21. This address data is used to update the content of theRAM 14. An RAM controller 23 forms the following three signals, i.e. the selection signal for the abovementioned address selector 13 and the data selector 17 the control signal to designate the data which is captured in the latch 22 and the chip selection signal for two RAMs 15A and 15B in the RAM 14. The data and the addresses from the data bus 16 and the address bus 21 are supplied to this RAM controller 23. The timing pulses and the clock pulses such as horizontal sync signals, vertical sync signals, blanking pulses for the system are also supplied to the RAM controller 23. This RAM controller 23 includes a picture address counter 24 and a pattern signal signal generating circuit 25. Thus, a pattern signal with a timing corresponding to a given pattern in the screen can be formed. With respect to other color signals DG and DB the address selector 13, RAM 14, data selector 17, and latch 22 are respectively provided in the same way as described in the color signal DR. The microcomputer such as the RAM controller 23 and the CPU 18 is used in common for the three color signals. As already known, the relation between the signal voltage V of the image receiving tube and the light emitting output L is expressed by L IVY, wherein K is a proportional constant and, in general, 7 2.2 as indicate.d by a reference numeral 26 in FIG. 3A.1As shown at 27A in FIG. 3B, a gamma correction of y xy is initially performed on the signal voltage in order to obtain a linear relationship between the signal voltageV and the light emitting output L as indicated by an alternate long and short dash line 28 in FIG. 3A.In FIGS. 3B and 3C, the x axis represents the relative levels of the input digital color signals DR, DG and Dg, and the y axis represents the relative levels of the color signals Drw Dg and Db after correction, respectively.The look up tables to be stored in the RAM 14 in the abovementioned video processor 10 approximate the tone wedge transducing characteristic as shown in FIG. 3B. As shown in alternate long and short dash lines 27B and 27C in FIG. 3B, gain control, i.e. picture control, can be realized by performing different tone wedge transducing characteristics. The white balance can be also adjusted by independent gain control of each color signal. Reference numeral 29A in FIG. 3C indicates the ordinary tone wedge transducing characteristic O .45 An alternate long and short dash line 29B designates a specific example of the tone wedge transducing characteristic of y x0.45 alpha . This specific transduction enables the correction of image signals in the case where a subject is shot under backlit condition.In other words, the output level near the white is compressed and that near the black is expanded, so that many kinds of gradations on the black side are made possible, thereby preventing the subject which receives the counterlight becoming dark. As described above, two transducing characteristics f x and g x are used to make the lookup tables of the various tone wedge transducing characteristics. That is to say, y f x and Ly ig x f x p are initially stored in the ROM 19 in the microcomputer, and the intermediate data is generated according to the following expression. i 1 a. f x ai f x ai g x f x a. a. Qy. it is possible to produce a look up table having an arbitrary tone wedge transducing characteristic between f x and g x by properly selecting the value of this coefficient ai. Assuming that a. mti O, 1, 2, we obtain yi f x y yi 1 wherein Yi 1 is the value of one step before yi thus for example m kinds of intermediate characteristics can be derived between f x and g x . It is assumed that EMI8.1 tb SEP 1 2 i, SEP where, SEP i 0,1, SEP ..... SEP m 1 tb 1 SEP where SEP i SEP SEP m tb in order to obtain m kinds of intermediate characteristics which shift from f x to g x according to an exponential change. The operation of an embodiment of this invention will be described again. The color signals DR, DG andDB are selected by the address selector 13 and supplied to the RAM 14 when performing the ordinary tone wedge transduction such as the gamma correction. The color signals Dr, Dg and Db which are read from the RAM 14 are selected by the data selector 17 and fetched. Either of the two RAMs 15A and 15B in the RAM 14 is selectively enabled by a chip selection signal. In case of rewriting the look up tables, the address from the address bus 21 is selected by the address selector 13, the data from the data bus 16 is selected by the data selector 17, and either of the RAMs 15A and 15B is set into the write enabled state, The look up tables can be rewritten by sequentially changing the addresses. The correspondence between the pattern signal which is formed by the RAM controller 23 and the selection signal of the address selector 13 can cause a plurality of patterns to be mixed in the display screen. In this case, the data n words are enabled corresponding to a given color is stored preliminarily in the latch 22 under the control of the CPU 18. The selection signals corresponding to the characters and the figures or the like are generated from the horizontal and vertical sync signals by means of the RAM controller 23. Hence, as shown in FIG. 4, characters showing the date, for instant, can be superimposed in the reproduced picture. FIGS. 5A D show the case where color bars are added in the lower half of the reproduced picture. The color signals consisting of a plurality of words which correspond to each color are stored in the latch 22.It is now assumed that the color pattern is mixed into the reproduced picture as shown in FIG. SA. The eight words W1 W8 are stored in the latch 22 corresponding to each color signal. The signal for red uses the eight words R1 R8. The signal for green uses the eight words G1 G8. The signal for blue uses the eight wordsB1 B. Each color of the color bars is expressed by those data namely, each color is produced by the combination of the components of each of the abovementioned words W1 W8. For instance, white and yellow are produced as follows. R1 G1 B1 W white R2 G2 B2 Y1 yellow Other colors such as cyano, green, Magenta, red, blue and black are also produced by the same method. As shown n FIG. 5B, the three bit selection signals S2, S3, S4 are supplied from the RAM controller 23 to the latch 22.Any one word among W1 W8 is selected. The two bit election signals S0, S1 are used for the address selector 13. when they are 0,0 , the content in the latch 22 is selected, and when they are 1,1 , the color signals DR, DG ana DB are selected. These selection signals S0 S4 change in response o the location on the screen. As shown in FIG. 5C, the selection sigrras S0, S1 become 1,1 in the upper half of the screen, and the color signals DR, DG and DB are selected. Then selection signals S0,S1 become 0,0 in the lower half of the screen and the content in the latch 22 is selected. The lower half of the screen is divided into eight vertical stripe like forms. The selection signals S2, S3, 54 in each stripe are 1,1,1 , 1,1,0 , ... 0,0,0 , respectively, as shown in FIG. SC. The predetermined color signals are selected in accordance with the relationships defined in FIG. 5B. As described above, the selection signals corresponding to the location on the screen are supplied to the address selector 13 and the latch 22. Thus, it is possible to produce the video image in which the original picture and the color bar pattern are mixed as shown inFIG. 5D. In the illustrated embodiment of the invention, twoRAMs 15A and 15B are provided as the RAM 14 for each color signal. Therefore, it is possible to perform the same pattern mixing or the like as described above. For example, as indicated at 29A in FIG. 6A, the look up table of the tone wedge transducing characteristic for ordinary gamma correction is stored in the RAM 15A with respect to each color signal. The look up table of a tone wedge transducing characteristic such as is shown at 29C in FIG. 6A may be stored in the other RAM 15B for each color signal. The color signals, DG and DB are supplied as the addresses for the RAMs 15A and 15B. The chip selection signals to be formed by the RAM controller 23 are made to correspond to the location of the screen.In the interior of a rectangular frame 30 indicated by an alternate long and short dash line in FIG. 6B, the RAM 15A is used for table look up while outside that area, the other RAM 15B is used. The color signals are subject to the tone wedge transduction in accordance with the look up table which is stored in the RAM 15A. Thus, the original picture is reproduced in the same manner as the ordinary one inside the frame 30. On the other hand, the RAM 15B operates outside the frame 30 therefore, a look up table having a tone wedge transducing characteristic such as shown at 29C in FIG. 6A is used. Hence, as shown in broken lines in FIG. 6B, outside frame 30 the image is shifted towards white and has low contrast. Such a processing is a kind of keying by an external signal. As shown in FIG 6C, it is possible with respect to, for example, the red color signal to store a look up table having the transducing characteristic that y always equals 1, whatever the value of x in the RAM 15B.As shown in FIG. 6D, it is also possible with respect to the other green and blue color signals to store in the respective RAMs 153 a look up table of the transducing characteristic in which y always eq als zero, whatever the value of x. In this state, when chip selection signals corresponding to the desired pattern formation are supplied to the RAMs .1SA and 5B in the same manner as described above a high level red signal is generated in response to the color signal DR in the area where the RAM 15B operates, , and the other color signals of green and blue are sero. FIG. 7 shows a part of another embodiment of this invention which in other respects may be the same as the previously described one. The input color signal is supplied as the address to the RAM 15A and the red signals R1, R2 ... which are necessary for generation of, for example, the color bar pattern are initially written in the other RAM 153. A plurality of address signals which are formed by the microcomputer are initially written in the latch 22 Although the are not shown, the other careen and blue color signals a e similarly processed. By the same method as already described before with respect to FIG. 5C, the chip selection signal corresponding to the area of the screen and the control signal for designating the address which is stored in the latch 22 are formed by the RAM controller 23. Thus, it is possible to perform the same pattern mixing as in FIG. 5D. For performing the pattern mixing, the color, the display pattern, characters, etc. may be designated by utilizing magnetic cards or the like in addition to the afore described keyboard. The present invention has similar advantages in the application to the processing of monotone color video signals as well as to the color video signals. In case of processing the monotone color signals, the tone wedge correction such as white clipping or black level control which may also be performed for the color video signals may be carried out. A ROM or PROM, etc. may be used as the solid state semiconductor memory.