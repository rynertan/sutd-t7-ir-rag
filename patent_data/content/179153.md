# A PROGRAMMABLE LOGIC ARRAY DEVICE USING EPROM TECHNOLOGY

## Claims
Programmierbare logische Netz Vorrichtung Fig. 8A , mit

## Description
The present invention relates generally to programmable logic array devices and more particularly to an erasable, electrically programmable logic device made using CMOS EPROM Floating Gate technology. The integrated circuit technology used in the fabrication of the present invention is CMOS Floating Gate CMOS EPROM . Floating gate technology allows programming of certain transistors such that when normal operating voltages are applied to 5 volts the programmed transistor acts like an open circuit. In their unprogrammed state, these same transistors will conduct when 5 volts is applied to the gate terminal and will appear as an open circuit when volts is applied to the gate terminal. In the past, the normal application of the technology was to manufacture electrically programmable read only memories EPROM . The programmable element in EPROM technology is a two layer polysilicon MOS transistor. By changing the circuits which access the array of programmable elements, programmable logic arrays PLA can be realized. Prior art U.S. patents include Kahng, 3,5 ,142 Frohman Bentchkowsky, 3,66 ,819 Frohman Bentchkowsky, 3,728,695 Frohman Bentchkowsky, 3,744, 36 Frohman Bentchkowsky, 3,755,721 Frohman Bentchkowsky, 3,825,946 Simko et al, 3,984,822 and Lohstroh et al, 4, 19,197. Programmable logic arrays and similar circuit elements such as programmable array logic PAL have been in existence for many years. See for example, the U.S. Patent to Crawford et al, 3,541,543 Spenser, Jr., 3,566,153 Proebsting, 3,702,985 Greer, 3,816,725 Greer, 3,818,452 Greer, 3,849,638. The first realizations were mask programmed. An example is a P channel MOS device manufactured by Texas Instruments during 1968 1970. More recently, the technology of choice has been fuse programmable bipolar technology made by manufacturers such as Signetics, Monolithic Memories, Inc., Advanced Micro Devices, Harris Semiconductor and others. The complexity of PLAs and PALs is given in terms of The article entitled Programmable logic chip rivals gate arrays in flexibility in Electronic Design, Vol. 31, No. 25, December 1983, pages 95 98,100 and 102, discloses a fuse programmable logic array device comprising a programmable AND array having a plurality of memory cells which can be individually programmed to contain logic data, input circuit means for receiving an input signal and applying said input signal to said programmable AND array, sensing means for sensing the signals output by the AND array and for developing a corresponding data signal which is the logical OR of the signals output by said AND array, signal storage means for receiving and temporarily storing said data signal, output terminal means and switching means responsive to a control signal and operative to couple either said data signal or a data signal temporarily stored in said signal storage means to said output terminal means, or to couple either said data signal temporarily stored in said signal storage means or the data signal appearing at said output terminals back to said AND array. U.S. Patent No. 4313106 discloses an electrically programmable logic array comprising a programmable AND array having individually programmable memory cells arranged in addressable rows and columns, and row driver means responsive to a buffered signal from input circuit means and operative to interrogate a particular row of said memory cells and to cause said AND array to output signals corresponding to the data contained therein. The device described in the Electronics Designs article employs fuse programming throughout and it is an object of the present invention to enable a more flexible selection of the output data. Accordingly, the present invention provides a programmable logic array device as defined in claim 1. The preferred embodiment of the present invention relates to an electrically programmable integrated circuit with a logic complexity of approximately 300 2 input NAND gates. The preferred embodiment is designated The Altera EP300 and can generally be classed as a programmable logic array PLA with substantial additional circuitry such that many combinations of inputs, outputs and feedback can be accommodated. The EP300 has the following characteristics In addition to the above there are several other features of the EP3 . These are listed below The EP3 is intended to be used as a replacement part for standard family logic components such as the 74LSxx series and the more recent 74HC and 74HCT CMOS series. As a logic replacement device, a single EP3 will typically replace from 4 to 1 standard family logic components. The reasons for making such substitutions are The ultimate objective of the present invention is to produce a more powerful system for lower overall systems cost. Typical applications for the EP3 are for random logic replacements such as decoders, comparators and multiplexers and for state machines. Logic replacement applications use the combinatorial features of the EP3 while the state machines use the registered feedback features. These and other features and advantage of the present invention will become apparent to those skilled in the art after having read the following detailed description of the preferred embodiment shown in the several figures of the drawing. In order to understand the EP3 , it is necessary to understand MOS floating gate technology. The diagram shown in Figs. 1 and 2 illustrate a 2 layer polysilicon transistor. An N channel transistor is representationally shown but the basic mechanism applies to a P channel transistor as well. If it is assumed that the floating gate in the structure shown above is initially unprogrammed, then the transistor works as follows. Whenever a positive voltage greater than a certain threshold voltage VT is applied to the control gate, a channel is induced under the gate region which allows current to flow between the drain region and the source region. In a typical N channel floating gate device, VT is approximately 1.5 volts. The signals which are applied to the control gate are typically between volts and 5 volts. The effective threshold of the transistor can be changed by causing charges to be trapped on the floating gate. Electrons are caused to flow to the floating gate when high voltage typically 21 volts is applied to the control gate and the drain. When the high voltage is removed, charges remain trapped on the floating gate and cause the effective threshold to be increased to a value greater than the voltage which would be applied to the control gate during Normal Operation. The application of the high voltages and the subsequent charge trapping on the floating gate is called programming. After the transistor shown above has been programmed, if a 5 volt signal is applied to the control gate, no channel will be created between the source and drain and no current will flow therebetween. This two layer transistor can be thought of as a programmable switch. In the unprogrammed state, the switch opens and closes in response to the application of volts or 5 volts to the control gate. In the programmed state, the switch is always open regardless of whether or 5 volts is applied to the control gate. Under normal environmental conditions, charges will stay trapped on the floating gate for very long periods of time greater than 1 years . The typical application for this type of structure has heretofore been in the making of EPROMs electrically programmable read only memories . In the present invention, the EPROM transistor has been applied in a new way making the resultant structure suitable for implementing digital logic. The general structures will be described next. In the diagrams shown in Fig. 3, an inverter is shown in part a using a standard N channel transistor 1 as the switching device and, in part b a floating gate transistor 12 is shown as the switching element. Below each schematic diagram, a logic gate representation and the corresponding truth table is shown. The truth table for the EPROM inverter in the unprogrammed state, gives the same result as the normal N channel inverter. However, when the floating gate is programmed, the output is always pulled high, independent of the input. Thus, logic functions can be programmed out of a circuit by programming the floating gate. In part a of Fig. 4 a NOR gate using EPROM elements 14, 16,...18 is illustrated. In this device, the output is only a function of the inputs corresponding to floating gates left unprogrammed. In part b , the corresponding logic diagram is shown, and in part c the truth table for the circuit is set forth. This circuit is a one dimensional array of EPROM elements which forms a NOR gate, the elements of which are selectively programmable. By extending this concept to a two dimensional array and then collecting the programmable NOR outputs in another set of NOR gates, electrically programmable logic arrays such as illustrated in Fig. 5 can be formed. There are three major component parts of the circuit shown in Fig. 5 the Array Input circuits 2 , the programmable NOR AND array 22, and the NOR Gating circuits 24. The Array Input section consists of a set of subcircuits each including a conductive path 26 formed between an input node 25 and a first output node 27, and a second path including an inverter 28 coupled between node 25 and a second output node 29. Each input to circuit 2 and its complement thus become inputs to the Programmable NOR Array 22. As illustrated in Fig. 5, the programmable NOR array 22 is comprised of a plurality of gates 3 , 31 arranged in a two dimensional array of columns 32 38 and rows 4 45. The control gate electrodes of alternating rows 4 , 42,...44 of gates 3 are connected to an output node 27, while the corresponding gate electrodes of alternating rows 41, 43,...45 of complement gates 31 are connected to an inverted output node 29 of the input circuit array 2 . The drain regions of the transistors 3 , 31 in each column of columns 32 38 are commonly coupled to a corresponding array output node of the nodes 5 , 52, 54,...56, and the source regions of the transistors of each column are coupled to circuit ground. The outputs of the EPROM NOR gates feed into the gate electrodes of another NOR gate array 24 consisting of gates 58 64 which are connected in parallel and produce the desired output at an output node 66. This circuit can generate any logical function of the input variables by generating a so called sum of products expression. The example shown in Fig. 6 will be used to illustrate the case of a 3 input exclusive or gate. The function of this circuit can be written in logic equation form as The groupings of variables on the right side of the equation are called product terms e.g. A.B.C , and the product terms are SUMed together to produce the expression for OUT. By designating certain of the inputs I1, I2,... of Fig. 5 as the variables A, B, C of Fig. 6 and by appropriately programming the array 22 of Fig. 5, the desired exclusive or function of Fig. 6 can be realized. All logic equations can be expressed in this sum of products form. See for example The schematic diagram shown in Fig. 5 is an implementation of a sum of products generator in which the product generator is an array of EPROM NOR gates columns 32 38 whose outputs feed another NOR gate 24. In the illustrated example, the PRODUCT array 22 is progammable and the SUM array 24 is a fixed NOR gate. The fixed NOR gate 24 could alternatively be replaced by an EPROM NOR gate or an EPROM NOR array such that both the SUM array and the PRODUCT array are programmable. This would then be a realization of an EPROM Programmable Logic Array EPLA in accordance with the present invention. Although other programmable elements such as fuse link and EEPROM devices exist which are suitable for implementing Programmable Arrays, they each have certain disadvantages. In general, the fuse link elements are less desirable than EPROM elements because The EEPROM element has two drawbacks However it does have the advantage of being electrically eraseable and reprogrammable, thus allowing for logic functions to be changed in the system in which it is being used. This means that a logic system could modify itself based upon some set of conditions. This also means that real time alterable logic system or adaptive logic systems are possible. Furthermore, by replacing EPROM elements with EEPROM cells such as shown in Fig. 6a, an EÂ² logic array can be realized. In this diagram, N channel transistors are assumed, but P channel transistors could also be used with appropriate changes in signal voltages. Fig. 7 is an overall diagram showing the major functional components of the EP3 electrically programmable logic array. The various circuit components will be described within the context of the several Modes of Operation of the EP3 . These modes are Read Mode also referred to as normal operation , Program Mode, Verify mode, Preload Mode, Test Mode 1, and Test Mode 2. As illustrated in the simplified block diagram of Fig. 8A, the Read Mode circuits consist of the Input Circuit 8 , the Read Row Driver 82, the AND Array 84, the OR NOR Gates and sense amplifier 86, the D Flip Flop 88, the Architecture Control 9 , and the I O Driver 92. Fig. 8B is a further illustration of the EP3 showing the major functional blocks and their interconnection when operating in the Read Mode. Each input designated as I drives an Input Circuit Fig. 9 which drives a Row Driver Fig. 1 which drives all AND Arrays Fig. 11 . In the EP3 , groups of Product Terms are ORed together by individual OR NOR Sense Amp circuits Fig. 12 . We will, in this document, interchangably refer to each collection of Product Terms as an AND Array and also refer to all the Product Terms in the EP3 as the AND Array. As illustrated in Fig. 8B, all inputs go to all of the AND Arrays. The AND Array drives the OR NOR Sense Amp Fig. 12 . The output of the OR NOR Sense Amp is a Sum of Products of all signals which feed the AND Array. Each Sum term drives a D Flip Flop Fig. 13 , a OMUX Fig. 14 and an FMUX Fig. 15 . The output of the D FLip Flop drives the OMUX and the FMUX. The OMUX drives the Output Driver Fig. 16 which in turn drives the I O pin. Each Output Driver is enabled by a Product Term from the AND Array. The FMUX can receive inputs from the OR NOR Sense Amp or the D Flip Flop or the Input Circuit connected to the Associated I O pin. The FMUX drives a ROW driver circuit which in turn drives the AND Array. Input Circuit The input circuit 8 accepts a standard TTL level input signal, level shifts the signal and provides an output to the Read Row Driver 82. A simplified schematic of the input circuit 8 is shown in Fig. 9. As shown therein, an input signal comes in through a bonding pad 94 and passes through an input protection circuit consisting of resistors R1 and R2, and a so called gate aided breakdown N channel transistor T1 which protects the gate of transistors T2 and T3 from static discharge. Transistors T2 and T3, and resistor R3 and capacitor C1 form a level shifter. TTL input levels are defined as VIL .8 volts and VIH 2. volts. T2 is a P channel transistor and T3 is an N channel transistor. The sizes of these transistors are chosen such that when the input is at VIL the voltage at Node 1 will be VCC 5 volts and when the input is VIH, Node 1 will be at less than the threshold voltage of T5. When the input is at 2. volts minimum VIH , both T2 and T3 are conducting. It is desirable to minimize the current flow from VCC though T2 and T3 during this condition. R3 helps by causing a voltage drop between VCC and the source node of T2. This helps to turn T2 off because the source to gate voltage is reduced by the amount of the IR drop. The addition of resistor R3 increases the speed through the level shifter, reduces power dissipation and allows better sensing of TTL levels. Capacitor C1 is added to speed up the positive transition of Node 1 by helping to hold the source voltage of T2 constant when the input is switched from VIH to VIL. Transistors T4 and T5 form a normal CMOS inverter pair. However T5 is chosen to be larger than T4 to move the switching point lower. Thus as soon as Node 1 gets slightly higher than the turn on voltage VT of T5, Node 2 will go low. Inverter pair T6 and T7 act as a buffer for Node 2 and are capable of driving the Read Row Driver circuit shown in Fig. 1 . Read Row Driver Referring to Fig. 1 , the signal from the Input Circuit drives logic gates G11 and G12 of the Read Row Driver. G11 is a standard CMOS inverter and G12 is a standard CMOS two input NOR gate. Control signals NORMOP and NORMOPN disable the Read Row Driver circuit during Program Mode. The Read Row Driver circuit is active when NORMOP is a logic 1 and NORMOPN is a logic . Also VPC Well is at VCC. A logic 1 level from the Input Circuit 8 causes the outputs of G11 and G12 to go low turning T15 OFF and turning T14 ON pulling the output TO AND ARRAY to VCC and turning T13 off. A logic from the Input Circuit 8 causes the output of G11 and G12 to go high turning T15 ON pulling the output toward VSS. At the same time, G11 pulls the gate of T14 high turning it OFF. As the output goes low, T13 is turned ON helping to turn T14 OFF. For each input, both true and complement signals must drive the AND array 84. Thus, there are two Read Row Drivers per Input. The second driver not shown has an extra inverter disposed between the Input Circuit and the Read Row Driver. AND Matrix The AND matrix is an array of EPROM NOR gates as discussed above. A single EPROM NOR gate is shown in Fig. 11 to illustrate the actual Pull up cuircuit used. The gate of the N channel pull up circuit 96 is driven by the signal ENBLTOSA Enable Bit Line To Sense Amp . This signal can be turned off during program mode to isolate the bit lines BL1, BL2,...BLn from VCC. Each bit line BLn is also connected through a column select transistor 98 to the column driver. These column select transistors are turned OFF during Normal Operation. The gates of the EPROM transistors 3 and 31 are driven by signals RRD and The collection of bit lines will be referred to as the programmable AND matrix. In the EP3 , bit lines are collected together in groups of 9. Eight of the nine bit lines go into the OR NOR gating circuit 86 which will be discussed next, while the 9th bit line goes to control the tri state of the associated output driver. OR NOR Gate, Sense Amplifier As shown in Fig. 12, a grouping of eight bit lines are ORed together in the NOR Sense Amplifier. Transistors T1 through T13 are a sense amp NOR gate. T1 through T8 receive their inputs from their respective bit lines. T9 acts as a pull up. The trip point of the NOR gate is set by the threshold voltage of T1 through T8 plus the offset voltage created by current flowing through T12 and T13. This current flow is adjusted by T1 and T11. When the Voltage of any of the bit lines exceeds the Variable Reference voltage, the output OUT will go low. Inverters G1 and G2 amplify the signal producing Sense Amp Output which goes to the D flip flop 88 and the variable reference circuitry 87. The Sense Amp Output is fed back to the variable reference circuit through inverters G3 and G4. The feed back mechanism is such that if any bit line goes high, the Sense Amp Output will go low. After a slight delay caused by gates G3 and G4 and transistors T17 and T18, the output of G3 will also go low, causing the Variable Reference Signal to increase and in turn raise the trip point of the NOR gate Sense Amp. Thus, the strip point is adjusted according to the present state of the Product Term inputs. By adjusting the reference in this way allows the EP3 to sense a smaller signal swing and hence operate faster. D Flip Flop As illustrated in Fig. 13, the Sense Amp Output from Fig. 12 is input to a D Flip Flop 88 after passing through the 2 input NAND gate 1 , the other input of which is The Flip Flop circuit is a conventional master slave configuration using N and P channel pass transistors. As explained above, the Flip Flop has a synchronous set and also has a synchronous reset. The Architecture Control The Architecture Control circuit consists of two pass gate multiplexers which are designated the Output Multiplexer OMUX and the Feedback Multiplexer FMUX . As depicted in Fig. 14, the OMUX has four data inputs. These are Q and OMUX Circuit The OMUX controls are QOUT, QBOUT, COMOUT and COMBOUT. The state of the OMUX control signals are determined by a set of EPROM bits which will be described below as part of the Architecture Feature Select Circuitry in Fig. 24. Because pass gates are used, only one OMUX control should ever be asserted active high or else a signal conflict at MI could exist. For example, if both QUOT and QBOUT are asserted, the Q and The OMUX allows the EP3 outputs to be configured as registered or combinatorial and be either active high or active low. The data which is passed to node MI is amplified by the inverter whose output labeled ODI becomes the input to the Output Driver. The ODI signal also feeds back to drive the gate of a P channel transistor T19 whose source is tied to VCC and whose drain is tied to node MI. This transistor pulls node MI to a full VCC level. Without it, MI would be one VT voltage lower than the OMUX control signal approximately 3.5 volts . This then helps to speed up the MI signal transition to a logic one and insure a good logic level at the inverter. FMUX Circuit The FMUX shown in Fig. 15 is of similar construction to the OMUX. It is a 3 input pass gate multiplexer. The data inputs are Q from the Q output of the D Flip Flop 88 , COM conbinatorial data from tee AND OR arrays , and IOI from the IO pad input . The corresponding controls are QFB, COMFB and IOFB. As with the OMUX, the states of these controls are determined by EPROM bits in the Architecture Feature Select block. There is an OMUX and an FMUX associated with each of the AND OR blocks of the EP3 . I O Driver The signal ODI from the Output Multiplexer becomes the input to the Output Driver as shown in Fig. 16. ODN is the active low output disable signal which comes from a single product term from the AND Array. The output circuit works as follows The Output Driver is active whenever ODN is high. Both the N and the P channel transistors N2, P2 between node 7 and node 8 are conducting as are the N and P channel transistors N1, P1, between ODI and node 6. Data from the OMUX ODI drives transistors N3 and P3 which in turn drive the output driver transistors N5 and P4. When ODI is a logic 1, the I O Pad is driven to VCC through P4 and when ODI is a logic , the I O pad is driven to VSS through N5. If signal ODN is driven low, transistors N1 and P1, and N2 and P2 are turned OFF. Node 8 is driven to VSS through N4, and node 6 is driven to VSS through N6. Node 7 is driven to VCC through P3. Under these conditions, both P4 and N5 are turned OFF. This is the tri state condition for the output driver. The I O pins on the EP3 may be used as either inputs or outputs. When used as inputs, the Output Driver is disabled by means of the ODN signal described above. An input signal applied to the I O pin goes to an Input Circuit as was shown in Fig. 9. The signal I I in Fig. 16, is the amplified and level shifted verson of the input signal applied to the I O PAD and is passed to the FMUX. Prior to using thee EP3 in an application, it is necessary to program the EPROM Transistors in the AND array 84 and in the Architecture Feature Select block 9 . Fig. 17 is a block diagram showing the functional components utilized when the EP3 is operated in the Program Mode and Verify Mode. Programming of an EPROM transistor is accomplished by applying high voltage to the gate and the drain. The high electric field from drain to source creates so called hot electrons . These hot electrons are attracted to the floating gate because of the high gate voltage. For 3 micron technology, a gate voltage of 21 volts and a drain voltage of approximately 16 volts will program the floating gate. Electrons with enough energy to jump from the drain to the floating gate remain trapped on the floating gate after the high voltages are removed. The presence of electrons on the floating gate cause the threshold voltage, as seen from the control gate, to be substantially increased such at that under normal gate voltages 5V it never will turn ON. Thus, an unprogrammed EPROM transistor will conduct with 5 volts on the gate and will not conduct with volts on the gate, while a programmed EPROM transistor will not conduct in either state. In order to program a single transistor in the AND array, a row and column selection must be made and appropriate high voltages applied. Some of the read circuitry described above must also be disabled so as to not cause damage. The circuits to be disabled are the Read Row Driver 82 and the pull ups to the AND ARRAY 84. The Read Row Driver is disabled by causing NORMOP to go low. The AND ARRAY pull ups are disabled by causing ENBLTOSA to go low. The Output Drivers must also be tri stated because the I O pins will be used as program data inputs. After a particular row and column are selected, the program data determines if the selected location is to be programmed or not. Since all pins are used during normal operation, they must be redefined for programming. The program mode is entered whenever pin 11 is raised to a VHH level. VHH is a voltage greater than 1 volts and may be as high as 21 volts which is the VPP programming voltage. Several pins have VHH detection circuits which invoke various program, verify, and test modes. The following table lists the conditions required to enter various modes. An EP3 is programmed in a manner similar to an EPROM memory. Taking Pin 11 to a VHH level causes the function of the pins to be redefined such that pins 2 through 9 become addresses which select a matrix row and column, and pins 12 through 19 become data inputs. The state of the data input lines determine whether a location will be programmed or left in its erased state. Eight bits can be programmed at a time. Eight pins 2 thru 9 are defined as addresses. If each has only two values VIL, VIH then only 256 locations can be selected. Actually, 324 array locations, 7 architectural locations and 1 security bit location must be accessible. In order to extend the address capability of the eight input lines, two pins 4 and 9 have three allowed values VIL, VIH, VHH . This permits the addressing of all locations. The HH Detect Circuit is shown in Fig. 18. The allowable input values are VIL VSS VIL .8 , VIH 2. VIH VCC , and VHH 1 VHH VPP . For any input value between VSS and VCC VTP, the P channel transistor P1 is not conducting. Since the N channel transistor is always conducting, the voltage at HHDET is pulled to VSS through N1. Inverters HHN and HH are simply buffers for node HHDET. Thus, the signal at HH is zero whenever the input signal is a normal logic level VIL or VIH . If the input signal is raised above VCC VTP, transistor P1 begins to conduct. Current flows from the input pad thru P1 and N1 to VSS causing a voltage drop across N1. The transistor sizes are adjusted such that when the input signal is greater than 1 volts, the node HHDET is above the switching threshhold of the inverter HHN. Thus, with an input level greater than 1 volts, the output from the second inverter HH, is at a logic 1. The table below shows the situation. As is illustated in Fig. 19, input signals applied to pins which have HH detectors are connected to a normal Input Buffer Fig. 9 and an HH detector circuit Fig. 18 . Signals from the Input Buffer can be logically gated with signals from the HH detector to create a third state. The three states are shown in the diagram of Fig. 19. Row and Column Decoding Internal Signals from input buffers or HH detectors are passed onto either a row decoder or a column decoder. These decoders are NOR decorders consisting of N channel pull down transistors with P channel pull ups to VCC. Except for the Architectural Decoder, these P channel pull ups are gated by a signal called NORMOP. By doing this, the NOR decoders only dissipate power during programming. A typical NOR Decoder is shown in Fig. 2 . Column Driver Outputs from the Column Decoder drive the Column Pass Gate Driver Fig. 22A which, in turn drives the gates of the Column Pass Transistors 98 shown in Fig. 11. Referring to Fig. 11, one can see that one side of the Column Pass transistor is tied to a bit line while the other side is joined in common with other Column Pass Transistors. The common node 99 is driven by the Column Driver for programming. Fig. 21 shows a group of Column Pass Transistors typically 9 being driven by one Column Driver. The Column Driver works as follows. When the Programming Mode is invoked, VPPOE which comes directly from Pin 11 is at a VPP level 21 volts . ENCLVRF is at a logic and ENCLVRFN is at a logic 1. NOR1 then reacts only to DATA. Assume DATA is at a logic 1, then DN is zero. This turns OFF transistor N4 and turns ON transistor N3 which pulls node 9 low which in turn pulls node 5 high. This causes transistor P1 to turn OFF and P2 to turn ON. With node 9 low, transistor N1 is OFF thus blocking any current flow from VPPOE to the COLUMNS. Thus with DATA at logic 1, the selected EPROM bit as selected by the Column Pass Transistor and the ROW DRIVER will stay in the erased state. Next, assume DATA is at a logic . Then DN will be 1 causing N4 to turn ON, pulling node 5 low. This in turn causes P1 to turn ON pulling node 9 high which causes N1 to turn ON and provides a current path from VPPOE through the Column Pass Transistor to the selected EPROM bit. Thus, with DATA at logic , the selected EPROM bit will be programmed. In the VERIFY MODE, which will be discussed later, ENCLVRF is at a logic 1 thus overriding DATA by forcing DN and Node 9 to be low which turns transistor N1 OFF. This effectively disables the Column Driver during the VERIFY MODE. Row Driver The Row Driver is a tri stateable driver whose inputs are zero to 5 volt levels from the ROW DECODER and whose outputs are zero to VPP. The ROW DRIVER outputs drive the gate terminals of the EPROM transistors in the AND ARRAY. A schematic diagram of the ROW DRIVER is shown in Fig. 22B. The Row Driver works as follows Assume the signal NORMOP is a logic 1 and NORMOPN is logic , which is the situation in the READ MODE described above. The signal RDIN from the ROW DECODER is at logic because the decoder pull up is OFF see Fig. 19 VPCROW is a local power line which can be switched between VCC and VPP. During the READ MODE, VPCROW is equal to VCC. The signal RDIN is passed through transistor N1 pulling the gates of N2 and P2 low causing node 1 to go high and turning OFF P1 and P3. The pass transistor N3 is turned OFF by NORMOPN, isolating node 1 from node 11. Transistor N4 is turned ON by NORMOP causing node 11 to go low and turning OFF transistor N5. Thus both P3 and N5 are OFF and the output line ROW is left free to be driven by the READ ROW DRIVER described above. Next, asume NORMOP is at logic and NORMOPN is at logic 1. This is the case during programming. The Row Decoder Fig. 2 is activated and RDIN can be either logic decoded or logic 1 not decoded . Transistor N3 is turned ON and N4 is turned OFF, thus, connecting node 1 to node 11. VPCROW is switched to the VPP level. Now, if RDIN is low, node 1 is pulled high turning P3 OFF and turning N5 ON, thus pulling ROW to Vss. If RDIN is at logic 1, N2 is turned ON pulling node 1 low. This turns P1 ON ,thus pulling node 9 to VPP. Pass transistor N1 blocks the VPP level from the ROW DECODER. With node 9 at VPP, P2 is turned OFF, and N2 is turned ON pulling nodes 1 and 11 low. This turns P3 ON and N5 OFF and drives ROW to VPP. Since ROW drives the gates of the EPROM transistors, programming can now take place. Row and Column decoding and driving is done simultaneously. A particular EPROM transistor is determined by the intersection of a row and a column. Data Input For Programming An EPROM transistor is selected at the intersection of the decoded row address and the decoded column. Whether the selected EPROM transistor is actually programmed, or left in its erased state, is determined by the DATA supplied to the Column Driver as explained above. The DATA line is driven by circuitry as shown in Fig. 23. When the PROGRAM MODE is invoked, the output driver is tri stated. The signal PADBUS is at logic 1 and PADBUSN is at logic causing the pass transistors P1 and N1 in Fig. 23 to turn ON. The logical sense of DATA is inverted from that presented at the I O Pad. From the previous discussion, this means that if a logic is presented at the I O pad, the selected EPROM transistor will remain in the erased state, while a logic 1 presented at the I O Pad will cause the EPROM transistor to be programmed. The purpose of transistor P2 in Fig. 23 is to insure that DATA will be forced to a logic 1 whenever the pass transistors driven by PADBUS and PADBUSN are turned OFF. Architecture Feature Programming The architecture of the EP3 is determined by which paths are selected in the Output and Feedback Multiplexers of Figs. 14 and 15. These multiplexers are in turn controlled by the Architecture Control Circuits there is one for each multiplexer control shown in Fig. 24. The Architecture Control Circuit output consists of an EPROM transistor 2 whose state is read by a Schimdt trigger circuit 2 2. The output of the Schmidt trigger feeds a control gate 2 4 and the output of the control gate drives the particular multiplexer. There are seven control signals 4 output multiplexer controls and 3 feedback multiplexer controls per output macro cell requiring 7 Architectural Control Circuits per macro cell. There are eight macro cells thus requiring 56 Architecture control Circuits in the EP3 . The EPROM bits for Architecture Control are programmed as follows. Refer to Fig. 24 . In the Program Mode, NORMOP is at logic turning OFF transistor N2 thus isolating the EPROM bit from FMUX. EPROM transistor 2 is programmed by raising ARDTCNTL at the gate of N1 to VPP. Also, the gate of 2 PADFEED is raised to VPP by the Architectural Program Decoder Fig. 2 and a VPP level shifting circuit similar to the Pass Gate Driver Fig. 22A . At the same time, line 14H1 is raised to a VPP VT level by a column driver circuit similar to that shown in Fig. 21. Referring now again to Fig. 24, to verify that the EPROM bit has been programmed, PADFEED and ARDTCNTL are taken to Vcc levels. The Architecture Control Program Driver is then disabled and a sense amplifier is connected to 14H1 . The sense amplifier senses the state of the EPROM bit and passes the information to the associated Output Driver. During the READ Mode, the following conditions apply. ARDTCNTL is taken to Vss thus disconnecting node 7 from line 14H1 . PADFEED and NORMOP are taken to Vcc. The state of the EPROM bit can then be determined as follows first, assume that the EPROM transistor 2 has been programmed. Transistor P1 will then pull node 7 and node 8 to Vcc. This will cause transistors N1 and N2 to turn ON pulling node 12 to Vss. During READ, PRELDBAR is at a logic 1. Thus, with node 12 at logic , IOFB will be at logic 1 which selects the I O Pad as the signal to be passed through FMUX to the Feedback Row Driver. If the EPROM transistor had been in its erased state, nodes 7 and 8 would have been pulled high. This would force IOFB to a logic . Thus, in The Architecture Feature Select, a programmed EPROM bit selects a feature and an unprogrammed bit de selects a feature. Initially, in the erased state, all features are de selected. Referring now again to Fig. 17 which is a block diagram of the EP3 for either the Program or the Verify Mode and also referring to the EP3 Mode Select Table for the conditions which select the Verify Mode, it will be seen that the Verify Mode provides a means of interrogating the AND matrix and the Architecture Feature Select Matrix to determine which EPROM transistors have been programmed. Verify Mode is invoked by taking pin 1 to Vhh. All other inputs are then directed through the INPUT CIRCUITS and approximate control circuits to the ROW DECODER, the COLUMN SELECT DECODER and the ARCHITECTURE CONTROL PROGRAM DECODER. Depending upon the state of the inputs, either eight locations in the AND ARRAY or one of the ARCHITECTURE FEATURES associated with each ARCHITECTURE CONTROL block will be directed through the I O DRIVERS. Verify is essentially the reverse process from Programming. The location to be interrogated during Verify is determined by the Input Signal exactly as it would be during Programming. The COLUMN DRIVERS and the ARCHITECTURE CONTROL PROGRAM DRIVERS are disabled and corresponding SENSE AMPLIFIERS are enabled. The data which is read by the SENSE AMPLIFIERS is directed to the output pins through the I O DRIVERS. There are 2 special modes on the EP3 . The following Table shows the control voltages necessary to enter the modes. Pin 2 at the HH level signifies the special modes. Pin 1 must be at Vil for the modes to operate properly. Testmode 1 is a reliability test to ensure the integrity of the EPROM elements. During this MODE, all EPROM elements except the VERIFY PROTECT EPROM bit will be stressed. Charge gain charge loss, and oxide integrity problems may be detected when the mode is exercised in relation to TESTMODE 2 and or VERIFY mode. In TESTMODE 1, the gates of all EPROM elements will correspond to the voltage supplied on the VPP OE pin pin 11 . One can stress all the gates from approximately 4 to 21 volts depending on the reliability test requirements. The supplies to drains of the matrix 2664 bits and those in the architecture control section 56 bits are all turned OFF. The voltages on the output pads will be either 1 or depending on the programmed states of the matrix EPROM cells and the voltage supplied on pin 11. TESTMODE 2 is used to detect the VTs of programmed bits in the matrix. In the TESTMODE 2 circuit implementation of the EP3 , only the highest VT of the 8 bits in a macrocell group may be detected. VTs of OE, SET and RESET bits cannot be read out using TESTMODE 2. During TESTMODE 2, all the column pass transistors are turned OFF and an individual row of the matrix is selected by the inputs through the row decoder. The row line voltage is the voltage on the VPP OE pin pin 11 . One of the multiplexers is turned ON to allow the data from the matrix sense amp to be read out. Assuming all EPROM bits on the row are programmed, and if the gate voltage on the row is less than the programmed VT on the row of 8 cells, the output on the pad will be a logic 1. When the voltage on pin 11 is raised above the highest VT on that row, the output will trip to a logic . The VT of an individual bit can be read out if only one bit per row is programmed. However, to test the VTs of all bits, the programming, TESTMODE 1 stressing or other reliability testing must be repeated 8 times. Charge gain tests can also be made by monitoring the VT increases after extended high temperature bakes and or stresses on unprogrammed cells. Note that the VERIFY mode can also be used to detect more dramatic VT changes i.e. charges in VT that will cause a complete change in the output logic state in the VERIFY mode . The Preload Mode is entered by raising Pin 9 to Vhh. This causes the output driver to be tri stated and forces the feedback multiplexer to get data from the I O pad indepenent of Architecture Selection . Thus, the normal feedback path from the D Flip Flop in this case is disabled and Pad feedback is enabled. The inputs to the AND array are now all directly controlled by Input and I O pads. The Preload condition is latched on a high to low transition of the Clock Pin 1 . This frees up Pin 9 to be an input to the AND array. The inputs to the AND Array act essentially like the present state of a state machine. The output from the AND OR array is the next state . When the Clock makes its transition from low to high, the next stare is captured by the D Flip Flop. Simultaneously, the output is enabled allowing the next state to propagate to the Output. The Preload mode allows the testing of an EP3 configured as a synchronous state machine by allowing external inputs to completely determine the present state . This allows fast and complete testing of all state transitions.