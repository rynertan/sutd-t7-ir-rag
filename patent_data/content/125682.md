# DIGITAL CONTROL SYSTEM WITH ERROR MONITOR OPERATIVE UPON STARTING SYSTEM OPERATION

## Claims
Digitales Steuersystem mit einem Mikroprozessor 10 , der neben anderen Funktionen eine von dem System gesteuerte Betätigungseinrichtung 24 prüft, und einem Betriebsmonitor 26 , das aufweist

## Description
The invention relates to a digital control system as indicated in the precharacterizing part of claim 1. Such a prior art digital control system FR A 2 512 978 comprises a microprocessor with reset means which can be actuated either at the time of applying the power or at the time an error is detected by a watch dog timer providing the third means. In recent years, digital processor systems for controlling various automotive vehicle components, such as engines, brake systems, air conditioner systems, height regulators and so forth have become widely available. Many such systems are provided with self check functions and initial reset functions upon starting system operations. Such functions are essential for preventing the system from malfunctioning. The control systems are further provided with watch dog timers or equivalent components which monitor for program errors in the equivalent components which monitor generally checks output signals periodically produced by the control systems and produces an error signal when the interval between system output signals becomes longer than a predetermined period. When an error signal is issued by the watch dog timer, the control system is re initialized in order to fail safe the system. Such a fail safe system has been disclosed in US A 4 363 092. This prior art malfunction preventing system for a microcomputer system detects an abnormal condition in the program execution to produce an alarm or reset signal to automatically restart the computer. Program run signal is detected in checking the microcomputer operation by measuring intervals of the program run signal. Since the program run signals are to be derived at predetermined time intervals when the microcomputer is running under normal condition, judgement can be made that the microcomputer is in failure when the interval of the program run signals is longer than a given period of time. Further, the digital control system may be provided with a self monitor system for checking actuators to be controlled, monitor indicator or display and so forth upon the system is reset and initialized. This self monitor system generally applies dummy loads to the actuators and indicator to testingly operate them. In case of the digital control systems applied to the vehicle, problem is arisen that, if initialization is taken place due to failure of program run signal in a given period of time during the vehicle running, self monitor operation is taken place to actuate the actuators. When the digital control system is applied for engine control, the engine will be driven irrespective of driving condition to degrade drive feeling. In the worst case, the engine will stall while the vehicle is running. On the other hand, when the digital control system is applied for an anti skid brake control system, a pressure control valve in a hydraulic brake circuit may be placed at release position to disable application of brake while the dummy load is applied to the actuator. Further, by turning ON the monitor indicator or indicators, the driver must fear if the digital control system per se or actuator thereof is indeed damaged. The object of the invention is to provide an error monitor system for a digital control system which initializes the system not only when the system is first powered up but also when errors in operation are detected, which error monitor system distinguishes between initialization due to system power up, i.e. cold start and that due to errors in operation, i.e. warm start, and performs error monitor operations only when initialization takes place in response to a cold start. In order to accomplish the above mentioned object, a digital control system as claimed in the characterizing part of claim 1 is provided with an error monitor system which applies dummy loads to the control system to check control system components including display indicators and control actuators, and so checking the control system at the initial stage of control operation. The error monitor system is associated with a timer which outputs a HIGH level signal for a predetermined period of time after the onset of the power supply to the digital control system. The error monitor system performs the above checking operations only in the presence of the HIGH level signal from the timer. The present invention Will be understood more fully from the detailed description given herebelow and from the accompanying drawings of the preferred embodiment of the invention, which, however, should not be taken to limit the invention to the specific embodiment but are to aid explanation and understanding only. In the drawings Referring now to the drawings, particularly to Fig. 1, a digital control system includes a microprocessor 10 which is adapted to perform automotive engine control, anti skid automotive brake control or the like. The microprocessor 10 has a power terminal Vc connected to a vehicle battery 12 serving as a power source, via an ignition switch 14, serving as a power switch. The microprocessor 10 also has a reset terminal RES connected to a reset signal generator 16 via an OR gate 18. The reset signal generator 16 is connected to a power supply line 20 connecting the ignition switch 14 to the power terminal Vc of the microprocessor 10. The reset signal generator 16 responds to the act of closing the ignition switch 14 and therefore to the onset of power supply, to output a LOW level reset signal to the reset terminal RES of the microprocessor 10 via the OR gate 18 for a given period of time. The microprocessor 10 is programmed to initialize the control system by setting initial values in various counters and so forth and to access the first step of a control program, in response to termination of the LOW level reset signal after the given period of time after the onset of the power supply. The OR gate 18 is also connected for input to an error detector 22 connected to an error monitor terminal PR of the microprocessor 10 through which a program run signal is periodically output. The error detector 22 comprises a The microprocessor 10 also has dummy load outputting terminals P₁ and P₂. The dummy load outputting terminal P₁ is connected to a magnetic coil 24 of an actuator to be checked via a power transistor Q₁. On the other hand, the dummy load outputting terminal P₂ is connected to an indicator lamp 26 via a power transistor Q₂. The microprocessor 10 is adapted to output dummy loads from the terminals P₁ and P₂ when the control system first starts to operate and during the initial stage of control operation. By means of these dummy loads, the microprocessor 10 checks the magnetic coil and the indicator lamp. The microprocessor, according to the preferred embodiment of the present invention, also has an input terminal P₃ connected to a timer 28. The timer 28 is in turn connected to the power supply line 20 to receive electric power. The timer 28 is adapted to output a HIGH level timer signal in response to the onset of power supply to the microprocessor 10 through the power supply line 20 and holds its output signal level HIGH for a given period of time. The HIGH pulsewidth of the timer signal is selected to be longer than the period of time during which the reset signal generator 18 outputs the LOW level reset signal. The microprocessor 10 is adapted to output the dummy load through the terminals P₁ and P₂ only when the input to the terminal P₃ is HIGH. Fig. 2 shows the detailed circuitry of the timer circuit 28 in the digital control system of Fig. 1. The timer 28 includes a comparator 280 comprising a differential amplifier. The positive input terminal of the comparator 280 is connected to a voltage divider 282 including resistors R₂ and R₃. The voltage divider 282 is adapted to deliver a constant voltage reference signal to the comparator. On the other hand, the negative input terminal of the comparator is connected to the power supply line 20 via a time constant circuit 284 which comprises a resistor R₁ and a capacitor C₁. The capacitor C₁ is adapted to be charged at a given charge rate by the electrical power from the vehicle battery as long as the ignition switch 14 remains closed so as to define a time constant. The charge characteristics of the capacitor C₁ are so selected that the capacitor is charged to a voltage exceeding the reference voltage applied through the voltage divider 282 after a period of time longer than the period of time for which the LOW level reset signal of the reset signal generator 18 is maintained. While the charge voltage of the capacitor C₁ is lower than the reference voltage from the voltage divider 282, the comparator 280 outputs a HIGH level comparator signal. After the given time constant expires, the capacitor voltage become higher than the reference voltage and so turns the comparator output LOW. Therefore, the input at the terminal P₃ remains HIGH for the given period of time after the onset of power supply to the control system and, then, turns LOW after expiration of the given period of time. Fig. 3 is a flowchart of a system checking program executed in response to a LOW level input at the reset terminal RES of the microprocessor 10. In the system checking program, input level at the terminal P₃ is checked at a step 100. If the input level at the terminal P₃ is LOW, the outputs at the terminals P₁ and P₂ are held LOW so as not to apply a dummy load to the magnetic coil 24 of the actuator or to the indicator lamp 26, at a step 102. On the other hand, when the input level at the terminal P₃ is HIGH when checked at the step 100, then the output level at the terminals P₁ and P₂ goes HIGH so as to apply the dummy load to the magnetic coil to test actuate the latter and to the indicator lamp to turn the latter ON, at a step 104. Since the output of the timer 28 remains LOW as long as power is continuously supplied after the capacitor C₁ of the timer has been charged to a voltage exceeding the reference voltage, the input level at the terminal P₃ remains LOW. Therefore, even if the input level at the reset terminal RES drops to the LOW level due to a LOW level error signal, the output levels at the terminal P₁ and P₂ will be held LOW so as not to perform the checking operations on the magnetic coil 24 and the indicator lamp 26. After the steps 102 and 104, the input level at the reset terminal RES is checked repeatedly at a step 106 for as long as the input level at the reset terminal RES remains LOW. That is, the checking of the input level at the step 106 continues until the input level at RES goes HIGH. After the input level at the terminal RES goes HIGH when checked at the step 106, initialization of the system is carried out at a step 108. Figs. 4 and 5 illustrate the timing of operation of the microprocessor as the system checking program of Fig. 3 is executed. Fig. 4 shows the operation in response to closing of the ignition switch. In this case, assuming the ignition switch is closed at a time t₁, the input level at the terminal P₃ jumps to the HIGH level at the time t₁. At the same time, the reset signal generator 16 starts to output a LOW level signal to the reset terminal RES through the OR gate 18. Assuming the duration of the LOW level reset signal is T₁ and the duration of the HIGH level timer output is T₂, the input level at the reset terminal RES goes HIGH at a time t₂ after the duration T₁ has elapsed. Thereafter, the timer stabilizes at the LOW level at a time t₃, thus dropping the input level at the terminal P₃ LOW. Therefore, the system checking program of Fig. 3 starts to execute at the time t₁ in response to the drop in the input level at the terminal RES. At this time, since the input level at the terminal P₃ is HIGH, the dummy loads are applied to the magnetic coil 24 of the actuator via the terminal P₁ and to the indicator lamp 26 via the terminal P₂ in order to check the operation of the magnetic coil and the indicator lamp. Since the input level at the terminal RES goes HIGH at the time t₂, initialization of the system is performed at the time t₂. Fig. 5 shows the operation in response to the error signal from the error signal generator 22. Assuming that the absence of program run signal has lasted longer than the reference value by a time t₄, the input level at the terminal RES drops LOW at the time t₄. Further assuming the period of the program run signal returns to its normal level and an interval shorter than the reference value is detected at a time t₅, the input level at the terminal RES goes HIGH at the time t₅. In response to return of the input level at the terminal to the HIGH level, the system is initialized. However, since the input level at the terminal P₃ remained LOW throughout this period, the dummy loads are not applied to the magnetic coil and the indicator lamp. Therefore, according to the present invention, testing or checking of the actuator or actuators and indicator or monitor is performed only when the power supply to the microprocessor is first established. This satisfactorily prevents the control system from erroneously performing checking operation and so actuating the actuator and turning ON the indicator in response to initialization of the system due to errors in the system. Thus, the invention fulfills all of the objects and advantages sought therefor.