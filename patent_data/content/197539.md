# A train operation control apparatus.

## Abstract
For supplying data concerning the track condition such as a grade, a curve and so on for an automatic train control apparatus 10 , there is used a magnetic card 9 which is combined with a timetable for a train operator. A card reader 8 reads out the data recorded on the card 9 necessary for traveling between a station A and the next station B when a train departs from the station A. The automatic train operation apparatus ATO 10 produces a notch command to a driving motor control apparatus in view of the read data. The present invention can realize the ATO flexible to the internal and external variable factors.

## Claims
CLAIMS 1. A train operation control apparatus having an automatic train control means 2 which generates a speed limit signal with respect to the location of a train, a point reference receiving means 4 for srlec eiving a point reference signal which is emitted from a predetermined point on the ground, a tachogenerator 6 which generates pulses in proportion to the traveling distance of the train, and an automatic train control means 10 in which a target speed signal is provided on the basis of the speed limit signal from the automatic train control means 2 , a distance dependent speed pattern is generated in response to an output signal from the point reference receiving means 4 and a notch command is issued to a control means of driving motors of the train so that the speed of the train follows the target speed or the distance dependent speed pattern, c h a r a c t e r i z e d by an external storage medium 9 which stores data concerning at least a track conditions of a railway line through which the train travels, and a data reading means 8 which reads out the necessary data and supplies the read data for the automatic train control means 10 , whereby the notch command is determined taking the supplied data into consideration. 2. train operation control apparatus as defined in claim 1, whereon said external storage medium 9 is a magnetic card which is combined with a timetable for e train operator. A A train operation control apparatus as defined in claim 2, wherein said data reading means 8 is combined with a stand for the timetable provided in a train operator s platform, and the read of the data recorded on the magnetic card is ready to be conducted when the train operator sets the timetable in the stand. 4. A train operation control apparatus as defined in claim 1, wherein said data reading means 8 reads the data necessary for traveling from a station to the next station when the train departs from the station. 5. A train operation control apparatus as defined in claim 4, wherein every data recorded on said external storage medium 9 have respective between stations codes and, when the train departs from the station, said data reading means 8 reads the data having the betweenstations codes corresponding to the track section between the two stations. 6. A train operation control apparatus as defined in claim 1, wherein the data recorded on said external storage medium 9 is a distance dependent information concerning the track condition and such information is read out to decide the notch command before the train actually reaches the position corresponding to the information to be read.

## Description
TITLE OF THE INVENTION A train operation control apparatusBACKGROUND OF THE INVENTIONField of the Invention The present invention relates to an improvement of a train operation control apparatus, and particularly to an automatic train operation control apparatus called ATO hereinafter in which a microcomputer is utilized and which has the high flexibility or adaptability against variation of factors affecting the train operation control.Description of the Related Art Nowadays, a so called microcomputer is widely used for an ATO, and one of the features of such an ATO lies in that various control parameters are stored in a memory of the microcomputer as numerical data, whereby the control parameters can be changed easily and dynamically depending on various conditions such as the purpose of use and the environmental conditions. As one of the control parameters for the ATO, there is the track condition such as the grade or the curve.In a conventional ATO system, the track condition is not used as the parameter, and this has been causing the problems such as the waste of the powering and the braking force. Besides, in the case of the conventional system, unnecessarily large allowance is taken for the control system, since the speed reduction rate for the stop of the train has to be set so that the train will not overrun the stop point even when such point is located within the section of a line having the steepest descent throughout the whole railway line. These things are disadvantageous for the ATO system in terms of the reduction of the traveling time and the saving of the energy. As one of the solution to such problem, the system in which each train is provided with the memory to store the track conditions of all the sections of the line has been proposed, but this system is disadvantageous in that the quantity of the memory required increases in proportion to the length of the line to be covered.Another problem with this system is that the memory has to be changed when the train has to be operated on the different line of the different traveling route. In order to overcome such problems, as disclosed in a Japanese Patent Laid open No.54 93508, for example, there has been proposed the system using a data transmission device between a train and the ground so that the necessary track condition data can be given to the train from a memory of a computer provided on the ground. Such a memory can have the sufficient storage capacity. In this case, however, the possibility of the transmission error due to the external noise has to be taken into account, and the equipment cost of such system is considerably high. Further, in a Japanese Patent Laid open No.55 13670, there is shown a system in which the information necessary for controlling a train is given to an operation control apparatus provided on the train by a data cassette which stores in advance the data of distance speed and time speed obtained by the calculation based on the track conditions of the line or the operational model by a skilled operator. The train is controlled by a follow up control and or a variable value control in accordance with the data given through the cassette. However, such a system has not the sufficient flexibility to the variable internal and external factors.SUMMARY OF THE INVENTION An object of the present invention is to provide a train operation control apparatus capable of adapting itself flexibly to the internal and external variable factors. A feature of the present invention is in that an external storage medium stores data concerning at least a track condition of a railway line through which a train travels and a data reading means reads out the necessary data and supplies the read data for an automatic train control means, whereby a notch command is determined taking the supplied data into consideration.BRIEF DESCRIPTION OF THE DRAWINGS Fig.l is a block diagram schematically showing a structure of a train operation control apparatus according to an embodiment of the present invention Fig.2 shows an example of a card as an external storage medium used in the embodiment of Fig.l Fig.3 is an explanatory diagram for the train operation control status according to the embodiment ofFig.l, compared with that of the conventional system and Figs.4 A to 4 D are diagrams for explaining the operation of the embodiment of Fig.l, in which Figs.4 A and B are flow charts showing the operation thereof andFigs.4 C and D indicate evaluation functions utilized in the operation shown by the flow charts of Figs.4 A and B .DESCRIPTION OF THE PREFERRED EMBODIMENTS Referring to Fig.l, the description will be made of a train operation control apparatus according to an embodiment of the present invention. In the figure, a reference numeral 2 denotes a known automatic train control device called ATC hereinafter , which furnishes a speed limit signal or an allowed maximum speed signal with respect to the location of a train and takes charge of control for securing the minimum security of the train. A reference numeral 4 denotes a point reference receiver, which receives a signal indicating a specific point of the railway line.Such a signal is emitted from a point reference transmitter not shown provided at predetermined locations on the ground. For example, there is provided such a transmitter at a point from which the train should start to decrease its speed or at a point where the train has to stop. A reference numeral 6 represents a tachogenerator coupled to a wheel axle of the train which generates a pulse every unit traveling distance. A reference numeral 8 denotes a card reader as an external data reading means for reading data recorded on a card 9 which is set in the reader 8 by a train operator. The card 9 and the data recorded thereon will be further described later. A reference numeral 10 represents an ATO, which controls the operation of the train under the rule of theATC 2, that is, by which the train is operated within such a limit that the ATC 2 is not operated. In the ATO 10, a target speed setting device 102 is included which receives the signal from the ATC 2, i.e. the speed limit signal or the allowed maximum speed signal, and provides a target speed signal which the train should follow. The target speed is usually set by several kilometers per hour lower than the limit speed or the allowed maximum speed. A point discriminator 104 is also included which receives the signal from the point reference receiver 4 to produces a point discriminating signal. There is further provided a speed calculator 106 which obtains an actual speed of the train on the basis of the pulses outputted from the tachogenerator 6. A constant speed controller called CSC hereinafter 108 is one of main components of the ATO 10, which receives the signals from the target speed setting device 102 and the speed calculator 106 and executes the control for making the actual speed of the train follow the target speed. This controller 108 receives another input signal from the card reader 8 so as to achieve the control according to the present invention as described later. Another main component of the ATO 10 is a train automatic stop controller calledTASC hereinafter 110, which controls the speed of the train in accordance with such a speed pattern as the target speed decreases from an initial speed at a certain point a deceleration starting point to zero at a point where the train is to stop at a predetermined deceleration.The speed pattern begins to be generated in response to the point discriminating signal which is produced when the train passes through the point which emits the signal indicating the deceleration starting point. The TASC 110 receives the signal from the speed calculator 106 and controls the speed of the train in accordance with the speed pattern until the train stops at the scheduled stop point. Both the controllers 108 and 110 furnishes notch commands to a known driving motor control apparatus not shown as their output signal, which are led to a notch selector 112. The notch selector 112 selects either one of the notch commands applied thereto which is of the lower notch position. The selected notch command is not given to the driving motor control apparatus at once, but, as is described in detail later, it is evaluated whether or not the selected notch is adaptive in view of the operational state at that time. The finally decided notch command is outputted to the driving motor control apparatus. Further, such evaluation is conducted with respect to all notches every time when the requirements and or conditions of the train operation are varied and hence the present notch becomes necessary to be changed. A reference numeral 114 denotes an acceleration detector, which detects the acceleration or deceleration on the basis of the signal supplied from the speed calculator 106. At that time, the signal from the card reader 8, which includes the information about the track conditions such as a grade, a curve and so on, is taken into consideration so that the true acceleration generated by a driving motor or the true deceleration caused by a braking device can be detected. Namely, the thus detected acceleration or deceleration does not include the component affected by the external factors such as a grade. Such an acceleration or deceleration is used as one of factors for the evaluation mentioned above. In this embodiment, as another factor for the evaluation, the variation in the riding quality is taken into account which is caused by changing the notch. To this end there is provided a riding quality evaluation device 116. Although described in detail later, this device 116 evaluates the riding quality on the basis of the time lapse from the last time of the notch change. Next, the further description will be made of the card and the data recorded thereon with reference to Figs.2 and 3. The card is used as an external data storage medium in this embodiment. However, it can be of course substituted by any other type of known storage medium such as a magnetic tape or disk. Although a punched tape may be used for example, an erasable storage medium is much more preferred. Also, a so called IC card which is combined with integrated circuit elements can be employed. In this embodiment, a magnetic card is utilized which is combined with a railway timetable for the train operator which will never fail to be taken with him when he runs a train. The operator usually sets the timetable on a timetable stand provided in an operator s platform.Therefore, the card reader 8 shown in Fig.l is desirable to be combined with such timetable stand. Now, as shown in Fig.2 A , the timetable according to this embodiment consists of a timetable area and a data recording area.On the timetable area, there are visually recorded names of stations of a line and times at which the train departs from or passes through the corresponding stations. Checking the actual state of the train operation with the record on the timetable area, the operator makes an effort to run the train on time. On the data recording area of the timetable, the track conditions are recorded magnetically. An example of the content of the record is shown in Fig.2 B , in which the track conditions between stations A and B are illustrated. Items of the record in this example are a between stations code, a distance km measured from a station toward a next station, an information code of the track conditions and a numerical value indicative of amount or degree of the track conditions. In a column of VALUE in Fig.2 B , the numerical value and its sign indicated corresponding to the information code GRADE mean the degree of the grade and whether the grade is an ascent or a descent , respectively.In the same column, the numerical value corresponding to the information code CURVE indicates the radius of the curve, but 99999 is a code value indicating the straight t ack. Further in the same column, the numerical value corresponding to the information code SPEED LIM is the value of speed limited. Referring next to Fig.3, let us explain the situation of the track conditions as shown in Fig.2 B . The whole distance between the stations A and B is 1 cm. From the station A, the track has an ascent of 5 per mill and is straight. At 0.100 km from the station A, the track changes from the ascent to a descent of 20 per mill. i rom 0.350 km after the departure, there is a speed limit section of 45 km h. From 0.400 km after the departure to 0.500 km, the track is curved. The radius of the curve is 600 m. The descent of 200 per mill starting from 0.100 km after the departure continues till the point of 0.700 km from the stat on A. At that point, the track changes from the descent o an ascent of 20 per will, and further from the ascent to a descent of 5 per mill at the point of 0.100 km before the station B. Abovementioned is the situation of the track conditions between the stations A and B. According to Fig.2 B , the descent of 5 per mill further continues until the point of 0.100 km after the station B. The operation mode upon departure from the station B is made slow for some reason. Referring further to Fig.3, the description is made of the outline of the operation control according to the train operation control apparatus shown in Fig.1, compared with that of the conventional system. In Fig.3, a solid line a represents the allowed maximum speed generated by the ATC 2 with respect to the distance.Receiving the signal of the above maximum speed, the target speed setting device 102 produces the target speed signal as shown by a chain line b. In the conventional system, after departure of the train, the speed thereof increases so as to follow the target speed by a full notch operation, as shown by a broken line c. In this embodiment, by means of the information externally given from the card, the fact that the track has the descent when the train runs 0.100 km after departure is taken into consideration. Namely, although the train is once accelerated by the full notch operation, the notch position is soon shifted down to the position of a half notch operation, for example.However, the train continues to be accelerated by the descent in addition to the torque produced by the driving motor, so that the speed of the train increases toward the target speed, as shown by a solid curve d. Accordingly, the energy can be remarkably saved. When the train approaches the speed limit section, according to this embodiment, the train begins to be dece1erate ln advance, and its speed becomes lcwer than the limstes speed wren the train reaches the speed limit section a shown by the curve d.In contrast in the conventional system, the braking operation ,c first initiated when the actual speed of the train exceeds the target speed Therefore, the rather large braking force is suAcenly effected, compared with this embodiment, and the oechootin may occur according to circumstances, as shown by the broken line c. Not only the unnecessarily large braking force is required, but also the comfortableness of riding is injured. The operation when the speed limit section ends is the same in both the conventional system and this embodiment. If the speed limit is released as shown by the line a, the target speed is hightened accordingly, as shown by the line b, and the speed of the train increases automatically following the hightened target speed, as shown by the lines c and d. In the deceleration of the train, according to the conventional system, when the train receives the point reference signal at the point of 0.700 km from the station A, a speed pattern changing from the target speed to zero smoothly is generated, as shown by the broken line c and the train is controlled following the speed pattern and stopped at the scheduled position of the station B. However, the track has an ascent of 20 per mill from the point of 0.700 km. In this embodiment, therefore, it is judged that the train can be stopped at the scheduled position even if the time point of initiating the braking is delayed.The traih continues to travel with the target speed as long as possible and, after that, is decelerated with the higher deceleration, as shown by the line d, whereby it becomes possible to shorten the necessary time for traveling between the stations A and B. When the train leaves from the station B, the between stations code is counted up or down by one, and the similar operation control is executed between the station B and the next station with the aid of the information given by the card. Next, the operation of this embodiment shown inFig.l is explained in detail below. Although in the figure the ATO according to the present invention is illustrated as constructed by descrete means or devices respectively having specific functions, it is to be noted that this illustration is for the purpose of facilitating the good understanding. Of course, the ATO according to the present invention can be assembled by the descrete means or devices as shown in Fig.l, however in recent years there is mostly used a microcomputer which is so programed as to achive the function of the ATO as mentioned heretofore. Therefore1 the following explanation is done with reference to flow charts ofFig.4. First of all, the description relates to the constant speed control operation which has been already described in connection with the CSC 108 in Fig.l. When a departure command is given to the train which stops at the station A, the card reader 8 reads data concerning the information of the track conditions between the stations A and B. The data read at this time is those accompanied with the between stations code A. The read data is led to a memory not shown of a microcomputer system and stored therein in the form of a table, for example. The table is referred to with the progress of the control operation and the necessary data is read out therefrom. After that, a program the flow of which is shown inFigs.4 A and 4 B is initiated and executed repeatedly at a predetermined interval, e.g. a few milliseconds. In the flow chart, steps 20 and 22 form the table retrieval process. At the step 20, an actual traveling distance after departure is obtained by counting the pulses furnished from the tachogenerator 6. At the step 22, it is retrieved by using the value related to the obtained actual distance as a searching key whether or not there is any corresponding distance data in the table within the memory. If not, the flow of the operation returns back to the step 20 and the operation mentioned above is repeated until the corresponding distance data is found.At the step 22, if any distance data is found, the flow of the operation goes to a step 24, where the data concerning the information code and its value corresponding to the distance data are read out. Here it is to be noted that the above mentioned read of the information codes and their values must be done before the train actually reaches respective points specified in the table as the distance data. To this end, the value added by an additional distance to the actual traveling distance obtained at the step 20 can be used as the searching key at the step 22. As a substitute thereof, the card can be recorded in advance with the smaller distance data than actual, and, te actual distance, as it is, is used as the searching key. When the read of data at the step 24 is finished, the flow of the operation advances to a step 26 Fig.4 B , where a given notch Ni is selected provisionally. There follows a step 28, at which a speedVp after a predetermined time T under the selected notchNi is predicted. Namely, there is predicted the speed Vp which the train will reach after the predetermined time T if the provisionally selected notch Ni is made the notch command to the driving motor control apparatus.This prediction is conducted in accordance with the following relation, for example Vp Vg OC Ni G O C x T wherein V0 actual speed of the train at the present time, dNi ae celeration caused by the notch Ni, which is determined by the characteristic of a driving system including the driving motor, O G acceleration caused by the grade of the track ascent or descent , the magnitude of which depends on the degree of the grade and the load of the train, and O C acceleration negatively affected to the train by the curve running resistance when the train travels the curved track, the magnitude of which mainly depends on the radius of the curve. At a step 30, a difference j V between the target speed and the speed Vp predicted at the stp 28 is calculated. On the basis of the speed differencenV, the selected notch Ni is evaluated at a step 32. This evaluation is carried out in accordance with the relation as shown in Fig.4 C , for example. In the figure, an abscissa represents the speed difference dV and an ordinate an evaluation value Es. As is apparent from the figure, the maximum evaluation value E5 l is given if the ifference z V is within a certain small value, and the evaluation value ES is decreased as the difference AV increases.This is in order to suppress the generation of shock caused by the variation in the speed of the train when the notch is changed. Further, the evaluation is severer in the side of the positive speed difference than in the side of the negative one. Next, at a step 34, the time lapse t from the last notch change is calculated, and further a difference AN of the notch steps between the selected notch Ni and a notch changed last, i.e. the present notch, is calculated at a step 36. At a step 38, the evaluation value ENC concerning the riding quality is obtained on the basis of the time lapse t and the notch difference 6 N calculated at the steps 34 and 36 in accordance with the relation as shown in Fig.4 D . In the figure, an abscissa represents the time lapse t from the last notch change and an ordinate indicates the evaluation value ENC, the maximum value of which is 1 similarly to that of ES. The parameter is the notch difference AN. As is understood from the figure, if the notch difference AN is 1 and the time lapse t from the time point of the last notch change to the time point when the notch should be changed to the selected notch Ni exceeds the time tl, the maximum evaluation value ENC 1 is given. If the time lapse t is shorter than the time tl, the lower evaluation value ENC is given accordingly. In the case of the notch difference A N 2, the maximum evaluation value ENC l is not given unless the time lapse t exceeds the time t2.The similar is applied to the case of the notch difference AN 3. Thereby the interval t of the notch change can become as long as possible and the notch of the smallest possible difference AN is selected, so that the riding quality is not injured. On the basis of the thus obtained evaluation values ES and ENC, the synthetic evaluation value Er is obtained at a step 40. For example, the smaller one of the evaluation values E5 and ENC can be selected as the synthetic evaluation value. ET. After the thus obtained synthetic evaluation value ET is made the evaluation vale of the notch Ni selected at the step 26, the flow of the operation goes to a step 42, where it is checked whether or not the evaluation as described above has been executed with respect to every notches. If not, the flow of the operation returns back to the step 26 and the next notch is newly selected and evaluated in the same manner.This notch evaluating operation is repeated until the evaluation of all the notches has been completed. When all the notches have been evaluated, the flow of the operation shifts to a step 44, in which the notch having the largest evaluation value ET is selected finally as the notch command under the constant speed control operation. Next, the train automatic stop control operation which has been already mentioned in connection with theTASC 110 in Fig.l will be described hereinafter. Since, however, this operation is almost the same as the the constant speed control operation mentioned above in detail, except some differences, only the different points are described in the following explanation, with reference to Fig.4. Usually, the train automatic stop control operation is required when the train approaches the station at which it is to be stopped. Therefore, the operation of reading the data from the card, as shown in Fig.4 A , is completed and the operation for the train automatic stop control is started from the step 26 of Fig.4 B when the train receives the point reference signal indicating the deceleration starting point. Similarly to the case of the constant speed control operation, a given notch Ni is provisionally selected at the step 26. The prediction step 28 follows, in which a stop. position Pp when the deceleratIon is continued with the selected notch Ni is predicted. At the step 3U, difference b P in the cistance between a scheduled stop position and the predicted one Pp is calculated.On the basis of the differenceOP, the notcn Ni is evaluated at the step 32.For this evaluation, there must be prepared the relation between the evaluation value and the differenceAP which is similar to that as shown in Fig.4 C . After that, the flow of the operation is the same as that in the constant speed control operation mentioned before. Also in this case, the notch with the largest synthetic evaluation value is finally selected as the notch command under the train automatic stop control operation. The operation as mentioned above is repeated at a predetermined interval and the adaptive notches are selected successively. Under the control by means of the thus selected notches, the tr in is controlled and stopped at the scheduled position. By the way, usually in the steady state, the train peration is dominated tX either one of the constant Feed control operation and the train automatic stop control operation Especially1 before the point reference signal indicating the deceleration start point is received, the train is controlled by the constant speed control operation only. However, just after receipt of such point reference signal, both the control operations may run simultaneously so that the notch commands dependent on both of them are possibly issued.In such a case, the notch commarid of the lower notch position is finally selected as the command to the driving motor control apparatus, as described before in connection with the notch selector 12 in Fig.l . As has been already menticned above, the problems, which cannot be solved with the conventional control system such as the waste of power as is represented by the broken line c in Fig.3 and the exessive allowance for the speed reduction rate for the stop of the train, can be solved with the automatic train cperation system according to the present embodiment, whereby the saving of the energy and the reduction of the running time for the train can also be realized. Further, in the case of the above embodiment, the track conditio is stored in the magnetic card as the external storace medium, so that the ATO control system can be made uniform regardless of the difference of the railway lines through which the train runs, and this makes the ATO control system economically advantageous over the conventional control system.Furthermore, theATO control system will not read all the data concerning the track condition at a time but separately by the track section between the stations, and the data for the track section between stations can be identified by the number of the times of the read of the data, so that the quantity of the memory needed by the ATO control system can be made smaller than that required by the conventional system, and the adaptation of the control system to the case where the length of the railway line to be covered is extended can be made readily. Also, in the case of this embodiment, the function for enabling the specification of the running mode depending on the time zone for example can be added to the control system, by integrating the magnetic card and the timetable. The present invention can provide the automatic operation system not only capable of adapting itself flexibly to the variable internal and external conditions but also permitting the use of the momory of the smaller capacity than that required by the conventional control system.