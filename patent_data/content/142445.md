# SIGNALS PATH CONTROL CIRCUITRY FOR A DATA TERMINAL

## Claims
In einem Datenendgerät System, welches eine Datenausgabe Anzeigeeinrichtung aufweist einschließlich eines Ausgangsspeichers 49 und einer Tastatur 17 , und welches so angeschlossen ist, daß es Datensignale von einem Haupt Datenprozessor 11 empfängt und zu diesem sendet, welcher Haupt Datenprozessor codierte Ein und Aus Signale an das genannte Datenendgerät System überführt, um eine Steuerung zu bewirken gemäß der das Datenendgerät System Signale zum genannten Hauptprozessor überträgt oder nicht, sowie eine Anordnung zum alternativen Freigeben und Blockieren des Verbindungsweges zwischen dem genannten Datenendgerät System und dem genannten Haupt Datenprozessor, wobei diese Anordnung in Kombination eine bidirektionale Signal Umwandlungseinrichtung 15 aufweist, die so ausgebildet ist, daß sie parallele Signale in serielle Signale in einer Richtung und serielle Signale in prallele Signale in der anderen Richtung umwandelt, wobei die genannte bidirektionale Signal Umwandlungseinrichtung 15 so angeschlossen ist, daß sie Signale vom genannten Haupt Datenprozessor 11 empfängt und zu diesem sendet wobei eine erste Puffereinrichtung 43 in Ansprache auf ein Freigabe Signal rückgesetzt wird und mit dem genannten Speicher 49 verbunden ist, um diesem Signale zwecks Anzeige zuzuführen Signalbeobachtungseinrichtungen 31 mit der genannten bidirektionalen Signal Umwandlungseinrichtung 15 verbunden sind sowie mit der genannten ersten Puffereinrichtung 43 , um Signale zur genannten ersten Puffereinrichtung durchzulassen und diese Signale zu beobachten, um das Vorhandensein der genannten Ein und Aus Signale zu ermitteln eine zweite Puffereinrichtung 23 vorgesehen ist, welche entsprechend einem Freigabe Signal rückgesetzt wird und angeschlossen ist, um Signale zu empfangen, die von der genannten Tastatur 17 stammen und diese Signale speichert für eine weitere Übertragung zu der genannten bidirektionalen Signal Umwandlungseinrichtung eine Decodiereinrichtung 79 die genannte Tastatur 17 mit den genannten ersten und zweiten Puffern 23, 43 verbindet und eine erste Logikschaltung 39 mit der genannten Signal Beobachtungseinrichtung verbunden ist und erste und zweite Zustände einnimmt, die einem ermittelten Ein bzw. Aus Signal entsprechen, dadurch gekennzeichnet, daß eine zweite Logikschaltung 25 vorgesehen ist, welche die genannte erste Logikschaltung 39 mit dem genannten zweiten Puffer 23 synchron mit einem Taktsignal verbindet, daß die genannte zweite Puffereinrichtung gehindert wird Datensignale durchzulassen in Ansprache auf das Vorliegen eines genannten zweiten Zustandes der genannten ersten Logikschaltung daß die genannte Decodiereinrichtung 79 mit der genannten ersten Logikschaltung 39 verbunden ist, wodurch in Ansprache auf ein Freigabe Kommunikation Signal von der genannten Tastatur die genannte Decodiereinrichtung 79 ein Signal überträgt, welches die genannten ersten und zweiten Puffer freigibt und welches die genannte erste Logikschaltung in den genannten ersten Zustand rücksetzt, wodurch der genannte zweite Puffer in die Lage versetzt wird, die Datensignale durchzulassen.

## Description
In data processing systems, in particular those which employ data terminals, there is a great deal of data signal traffic flowing to and from a main data processor, often referred to as the host computer. Value safeguards and monitoring systems are included in such prior art systems so that the amount of data signal traffic does not exceed the capabilities of the system, either in time constraints or in data storage constraints or the like. One such safeguard resides in the ability of the main data processor to send either an on or an off signal. The off signal causes the data terminal to be effectively disconnected, while the on signal effectively connects the data terminal to the UART. However with such safeguards there have been problems, for instance, if through some system irregularity such as voltage drop, incorrect programming, sporadic failure of components, signal line noise or the like , an off condition can be effected in the terminal circuitry. If an off condition is spuriously created, then the terminal circuitry would be incapable of use until the problem is corrected, even though, in fact, there is no real basis for the off condition. In the prior art when an irregular condition is suspected, the terminal is turned off, i.e. the power is turned off and thereafter restarted. While such a technique often causes the off condition to disappear, it also means reloading information, going through an initialization series of steps, etc. The present system enables the user to clear a data transmission path and if an off condition is a local problem, no restarting procedure is necessary. The present system also permits data transmission to be blocked if the flow of data traffic is approaching the point of exceeding the capacity of the system. The present system involves having a UART connected to the main data processor to handle the parallel to serial and serial to parallel conversions. A data transmission path from the keyboard is connected to the UART and this path includes a buffer controlled by a gate circuit and two multiplexers. Data signals are transmitted from the keyboard, through one multiplexer to the buffer, from the buffer, under control of the gate circuit, through the other multiplexer to the UART. Also connected to the UART is a second data transmission path which includes an on off comparator, with a flip flop connected thereto to provide a means for remembering the on off condition. In the second data transmission path, a second buffer is connected to the comparator. The second buffer is also connected to a screen memory which further, in turn, is connected to a display device. Data signals are transmitted along the second data transmission path from the UART to the display device. When an off signal is transmitted from the main data processor, it is detected at the comparator, which causes the flip flop to produce an off signal. The off side of the flip flop is connected to the gate circuit which controls the readout of the first buffer and this off signal acts to block that gate. In such a situation the terminal user may suspect that the off signal is spurious, or that the on off flip flop has been erroneously set, or for some other reason the user must be able to transmit. The user, in one embodiment, under such circumstances can depress a clear communications key on the terminal keyboard. In response to pressing the clear communications key, the keyboard sends signals to a decoder which provides a clear signal to both buffers and a reset signal to the on off flip flop. The buffers are cleared of the data that may be stored therein and the flip flop is reset to the on side. At the same time the keyboard sends a request for an on signal to the main data processor. If the main data processor chooses to respond positively, it will send an on signal which will be detected by the The document US A 4 031 518 discloses a data terminal system which has a data output means including an output memory means and a keyboard means, which data terminal system being connected to receive data signals from and send data signals to a main data processor. The main data processor transmits coded on and off signals to said data terminal system to control whether or not said data terminal system transmits signals to said main data processor. An arrangement is provided to alternatively clear and block the communication path between the data terminal system and the main data processor, said arrangement comprising in combination bidirectionnal signal conversion means formed to convert parallel signals to serial signals in one direction and to convert serial signals to parallel signals in the other direction, the bidirectionnal signal conversion means being coupled to receive signals from and send signals to said main data processor. A first buffer means is formed to be cleared in response to a clear signal and is connected to said output memory means to transmit signals thereto for display. Signal monitoring means are connected to the bidirectionnal signal conversion means and to the first buffer means to pass signals to the first buffer means and monitor the signals to detect the presence of said on or off signal. A second buffer means is formed to be cleared in response to a clear signal and is connected to receive signals originated by the keyboard and store the signals for further transmission to the bidirectionnal signal conversion means. A decoding means is provided for connecting the keyboard to the first and second buffer means. A first logic circuitry is connected to said signal monitoring means and has first and second states respectively corresponding to a detected on or a detected off signal. The present system is of that type and is characterized in that a second logic circuitry is connecting said first logic circuitry to said second buffer means in synchronisation with a clock signal, said second buffer means being disabled from passing data signals in response to said first logic circuitry being in said second state said decoding means is connected to said first logic circuitry whereby in response to a clear communication signal from said keyboard, said decoding means transmits a signal which clears said first and second buffer means and which resets said first logic circuitry to said first state, thereby enabling said second buffer means to pass data signals. comparator and hence the on off flip flop will remain in the on position. While the gate is unblocked, i.e. in the on condition, the keyboard can transmit data to the main data processor. In addition, the system has upper and lower threshold circuits, as part of the second buffer, so that in the event the second buffer is being loaded and is approaching its capacity, the second buffer will send a signal to the main data processor requesting an off signal. Alternatively, if the second buffer is loaded with data below the lower threshold, the second buffer will transmit a signal to the main data processor requesting an on signal. The features and objects of the present invention will become better understood in view of the following discussion taken in conjunction with the drawing which is a schematic block diagram of the present invention. The drawing shows a main computer 11 which is connected through a bidirectional channel 13 to a UART 15. There is one main data path into the UART and one main data path out of the UART. The main data path into the UART commences with the keyboard 17, which has two channels connected to a multiplexer MUX l9. The first of the channels 21 is connected from MUX 19 to buffer 23. In a preferred embodiment, the keyboard 17 is a LK 201 manufactured by Digital Equipment Corporation, while MUX 19 is made up of a number of LS 157 s manufactured by Signetics Corporation and buffer 23 is made up of a plurality of TDC 1030 s manufactured by TRW Corporation. It should be understood that the buffer operation could be implemented by firmware which is activated by the keyboard. The buffer 23 temporarily stores data information transmitted from the keyboard 17 and ultimately transmits that data information to MUX 29 in response to a clock signal from AND gate 25. The gate 25 is conditioned or not conditioned to pass a clock signal in accordance with the presence or absence of a signal on line 27, which will be discussed hereinafter. The output from buffer 23 is sent to MUX 29 and therethrough to the UART 15 and on to the main computer 11. The second transmission line commences at the UART 15 and the signals are transmitted therefrom to the comparator 31 The comparator 31 in a preferred embodiment is a plurality of LS 85 s manufactured by Signetics Corporation The signals being transmitted from the UART 15 on line 33 are coded signals and the comparator 31 monitors those coded signals. If those coded signals represent either an off or on condition, then the comparator 31 will send signals on lines 35 and 37 respectively to transfer the flip flop 39 into either its off or on condition. When the flip flop 39 is in its off condition, it transmits the blocking signal on line 27 to block AND gate 25 as mentioned earlier. If we return to considering the data flow from the UART 15, we find that information is transmitted through the comparator 3l, along line 41 to the buffer 43. The buffer 43 temporarily holds the information passed thereto and transmits it therefrom, on line 45, in conjunction with output clock signal received on line 47. In a preferred embodiment the buffer 43 is made up of a number of TDC 1030 s manufactured by TRW Corporation. There are no clock generators shown in Figure 1. The provision of clock signals is well understood in the data processing art and need not be further discussed. The output signals on channel 45 are transmitted to the screen memory 49 which may be a bit map memory and those signals are located in the screen memory in accordance with address signals transmitted on line 51. The provision of address signals to a screen memory is well understood and no further discussion thereof is required here. Also, as is well understood, the screen memory provides pixel information on channel 53 to the display device 55. Buffer 43 is designed to have upper and lower threshold circuits therein. The upper threshold circuit provides an output signal on line 57 when the buffer 43 is loaded to a point where it exceeds a predetermined threshold. The output signal on line 57 is transmitted to the encoder 59. The encoder 59 provides a group of signals from the off side on a line 61, to MUX 29 to be transmitted to the main computer. The group of signals thus described acts as a request to the main computer, which request asks the main computer to cease transmitting to the terminal, i.e. cease transmitting over line 33. If the data in the buffer goes below the low threshold value, the buffer 43 will transmit a signal on line 58 to the request on side of the encoder 59. It should be noted that there is a one shot monostable multivibrator 63 connected to MUX 29, and the input signal to the monostable multivibrator 63 is from an OR gate 65. The inputs to OR gate 65 are from line 57 and line 67. When the upper threshold signal is applied on line 57 it is also transmitted to the OR gate 65, and it passes therethrough to transfer the monostable multivibrator to its unstable side. The output from the unstable side of the monostable multivibrator 63 is transmitted on line 69, to render MUX 29 receptive to the signal on line 61. If the monostable multivibrator 63 has not so conditioned MUX 29, then signals on channel 71, from buffer 23, are permitted to pass through MUX 29. In the event that the system is in an off condition, thereby blocking AND gate 25 and rendering the data transmission line from the keyboard 17 through the UART 15 impassable, the user may suspect that the off signal, or the off condition, is spurious which can be created by a number of conditions . For instance, a low voltage condition or signal line noise might place flip flop 39 in the off condition. In another instance, the UART 15 may mishandle signals because of component failure and cause flip flop 39 to be in the off condition. In another instance, the threshold circuitry may have requested an off condition from the main computer 11 when in fact none was necessary, and for a host of other reasons the user may suspect that the off condition is not a proper condition. In such a situation the user can depress the clear communication key 73, which is found on the keyboard 17, or effect a clear communication function through a series of key strokes of particular keys which cause firmware to transmit coded signals to accomplish the clear communications function. In response to depressing the key 73 a group of signals are transmitted on channel 75, through MUX 19, along channel 77 to decoder 79. The decoder 79 in fact is used to decode many signals coming from the keyboard but for the purpose of the present discussion will only be decoding one set of signals. In a preferred embodiment the decoder 79 is a 2716 EPROM manufactured by Intel Corporation. The output from the decoder 79 is a signal transmitted along channel 67 and therefrom along channel 81 to the clear terminals on buffers 23 and 43. The clear signal being received by buffers 23 and 43 clears those buffers of any data that might be present therein. At the same time the clear signal on line 81 acts as a reset signal for the flip flop 39. When the clear signal is present on line 81, flip flop 39 is transferred to its on side. When flip flop 39 is transferred to its on side, the blocking signal on line 27 is removed and hence AND gate 25 is open to transmit data flow therethrough from keyboard 17. At the same time the signal on line 67 is transmitted to OR gate 65, whose output transfers the monostable multivibrator 63 to its unstable side. When the monostable multivibrator 63 is in its unstable side it provides a signal on line 69 to open MUX 29 to signals either on line 61 or on line 83. In the present example, the signal on line 67 will be transmitted to the request on side of the encoder 59 and hence a group of signals on line 83 will be transmitted through MUX 29 and through the UART 15, to the main computer 11. This last mentioned group of signals will be decoded in the main computer to indicate that an on signal is requested by the terminal. If the main computer chooses to respond positively, an on signal will be transmitted through the UART 15 on line 33. The system in addition to resetting the buffers 23 and 43 and the flip flop 39, requests the on signals so that in the event the spurious signal was somehow being generated and might be regenerated, the on signal from the main computer would eliminate that condition. In view of the above discussion, it is apparent that the present system provides for detecting either an on or an off signal from the main computer provides for remembering what condition the main computer requests provides for blocking the transmission path from the keyboard in the event the main computer has requested an off condition provides for requesting an off condition if the buffer in the transmission path to the display device becomes overloaded provides for requesting an on signal condition if the buffer in the transmission path to the display device goes below a lower threshold provides for a clear communication operation from the keyboard, which operation provides signals to reset the buffers of each transmission path and to reset the flip flop and thus unblock the transmission path from the keyboard to the main computer and in addition to request that the main computer provide an on signal. It should be further understood that the system clears the buffers 23 and 43, so that in the event that the transmission path is open there will be no problem in transmitting data therethrough insofar as buffer 23 is concerned nor would there be any problem in receiving information therethrough insofar as buffer 43 is concerned. It should also be understood that the user may suspect that the contents of buffer 43 has caused the spurious condition to begin with. While the above description and drawing refer to a clear communications key, it should be understood that a clear communications function, as described herein, can be accomplished by storing the correct instruction data in firmware and fetching the same therefrom, e.g., by a series of key strokes. Such an arrangement is within the concept of this invention.