# VIDEO DISPLAY CONTROLLER

## Claims
Videoanzeigesteuergerät zur Verwendung mit einer Videoanzeigeeinheit 4 , einer zentralen Rechnereinheit 2 und Speichermitteln 5 zur Speicherung einer Vielzahl von Bilddaten, um auf einem Schirm der Videoanzeigeeinheit ein sich aus einer Vielzahl von Anzeigeelementen zusammensetzendes Bild gemäß einer Vielzahl von Bilddaten anzuzeigen, welches Videoanzeigesteuergerät durch folgende Merkmale gekennzeichnet ist

## Description
The present invention relates to a video display controller for use in terminal equipment for a computer, a game machine or the like. There have been proposed various kinds of display control systems which comprise a video display processor and display animation and still images on a screen of a CRT cathode ray tube display unit under the control of a CPU central processing unit . Such a display control system is e.g. described in EP A 0071 745. Fig. 1 shows one example of such conventional systems which comprises a video display controller hereinafter referred to as VDP 101 and a central processing unit CPU 102. The system further comprises a memory 103 which includes a ROM read only memory storing a variety of programs to be executed by the CPU 102 and a RAM random access memory for storing other necessary data. The CPU 102 outputs data representative of still and animation images to be displayed on a screen of a CRT display unit 104 to the VDP 101 which in turn stores the still and animation data into a video RAM hereinafter referred to as VRAM 105. Upon receipt of a display command from the CPU 102, the VDP 101 sequentially reads the still and animation data from the VRAM 105 in accordance with scanning synchronization signals of the CRT display unit 104, and supplies the read data to the CRT display unit 104 thereby to display the still and animation images on the screen of the CRT display unit 104. Such a kind of video display controller described above is generally provided with a kind of code converter called a color palette circuit. The color palette circuit converts each of color codes codes for designating colors of display elements which constitute still and animation images on the screen read from the VRAM into three color data RD red , GD green and BD blue each composed of about two or three bits to thereby form digital RGB signal. On the other hand, when it is desired to output a composite video signal, the color data RD, GD and BD are multiplied respectively by predetermined coefficients in a matrix circuit, and then the multiplication results are added together. The signal thus obtained is outputted as the composite video signal. The case where a black and white display is performed in the conventional display controller will now be briefly described. As is well known, to obtain a gray scale or achromatic colors such as white, gray and black, the respective color data RD, GD and BD, which correspond to three primary colors, have to be made equal in value to each other. Therefore, in the case where each of the color data RD, GD and BD consists of two bits, four gradation display can be realized by data 00 , 01 , 10 and 11 . And in the case where each color data consists of three bits, eight gradation display can be realized by data 000 , 001 , 010 , ..., 111 . However, an image displayed using achromatic colors of about eight gradations is poor in quality somewhat unnatural as compared with an image displayed by an ordinary black and white television set. Therefore, to obtain a black and white display image of high quality, the image must be displayed using achromatic colors of at least sixteen gradations. As described above, the conventional display controller is disadvantageous in that a high quality image can not be reproduced in the black and white display mode because of the insufficiency of gradation. This disadvantage can be overcome by increasing the number of bits of each primary color data. However, the increase of the number of bits of the color data causes a problem that the number of component elements of the relevant color palette circuit and matrix circuit also increase. It is therefore an object of the present invention to provide a video display controller which can increase the number of gradations of a black and white image without increasing the number of bits of the primary color data. It is another object of the present invention to provide a video display controller which can cause an image to be displayed in any desired color. According to one aspect of the present invention, there is provided a video display controller for use with a video display unit, a central processing unit and memory means for storing a plurality of image data, to display on a screen of the video display unit an image composed of a plurality of display elements in accordance with the plurality of image data, the video display controller comprising a clock signal generating means for generating a clock signal which is synchronized with display timing of the display elements on the screen b reading means responsive to the clock signal for reading the plurality of image data from the memory means c phase angle generating means for generating a plurality of phase angle signals synchronized with the clock signal and d encoder means for multiplying the read image data by a plurality of first predetermined coefficients provided therein in response to the plurality of phase angle signals, respectively, to output data representative of a chrominance of a color which is designated by the read image data, the encoder means multiplying the read image data by a second predetermined coefficient provided therein to output data proportional in value to the second coefficient when the phase angle signal is not supplied thereto e the output of the encoder means being supplied to the video display unit. The image data may comprises a color code representative of a color of the corresponding display element. In this case, the video display controller may further comprise code converting means for converting the color code into three data representative respectively of three primary colors of the color and data combining means, the encoder means comprising first to third encoders for being supplied with the three data, respectively, each of the first to third encoders being provided with a plurality of first predetermined coefficients and multiplying a corresponding one of the three data by the plurality of first predetermined coefficients in response to the plurality of phase clock signals, respectively, to output data representative of a chrominance of a corresponding one of the three primary colors, the data combining means combining the data outputted from the first to third encoders together to form a digital color video signal. The image data may also comprise data representative of an amplitude of a video signal corresponding to the image. In this case, the code converter means converts the amplitude data into data representative of gradation of image of the corresponding display element, the number of bits of the gradation data being less than the total number of bits of the three primary color data, the gradation data being supplied to the first to third encoders in parallel in unit of bits equal in number to those of the each primary color data from the MSB thereof, each of the first to third encoders being provided with a second coefficient and multiplying a specific portion of the unit of bits by the second coefficient when the plurality of phase angle signals are not supplied thereto, each of the second coefficients is of such a value that the gradation data appears at the output of the combining means. The video display controller may further comprise color burst generating means for generating a color burst in synchronization with the plurality of phase angle signals, and addition means for adding the generated color burst to the output of the encoder means. In this case, the color burst generating means may further comprise control means for selectively stopping the generation of the color burst, and may also comprise phase control means for controlling phase of the color burst with respect to those of the plurality of phase angle signals. One way of carrying out the present invention is described in detail below with reference to drawings which illustrate only one specific embodiment, in which Shown in Fig. 2 is a video display control system which includes a video display controller 1 hereinafter referred to as VDP provided in accordance with the present invention. The VDP 1 causes an animation and a still image to be displayed on a screen of a CRT display unit 4 in accordance with image data stored in a VRAM video RAM 5. Also, the VDP 1 allows the contents of the VRAM 5 to be changed and causes a part of the contents of the VRAM 5 to be transferred to the outside in accordance with various kinds of commands or image data supplied from a CPU central processing unit 2. A memory 3 stores programs to be executed by the CPU 2 and various kinds of image data. The VDP 1 will now be more fully described. A timing signal generator 6 generates reference clock pulses by means of a X tal oscillator provided therein, and also generates, in accordance with the reference clock pulse, a dot clock pulse DCP and a synchronization signal SYNC. The dot clock pulse DCP is outputted to a clock terminal CK of a horizontal counter 7, while the synchronization signal SYNC is outputted to the CRT display unit 4. The dot clock pulse DCP corresponds to each display element on the CRT display screen, in other words, the dot clock pulse DCP is synchronized with a display timing of each of display elements which are sequentially displayed on the screen in accordance with the horizontal scanning of the screen. The timing signal generator 6 also generates various kinds of timing signals necessary for processing the image data and outputs them to an image data processing circuit 10. The horizontal counter 7 is reset when each horizontal scanning of the screen is started, and each time a predetermined number of dot clock pulses DCP are counted, the horizontal counter 7 outputs a signal HP to a clock terminal CK of a vertical counter 8. An output of the horizontal counter 7 represents the sequential number of the display elements on a horizontal scanning line which is currently scanned, the display elements being counted from the leftmost one on the horizontal scanning line. For example, when the output of the horizontal counter 7 is 0 an electron beam of the CRT display unit 4 is directed to the leftmost display element on a horizontal scanning line, and when the output of the horizontal counter 7 is 100 the electron beam is directed to the 101st display element on a horizontal scanning line. The vertical counter 8 is reset each time the vertical scanning of the screen is started, so that the content of the vertical counter 8 represents the sequential number of the horizontal scanning line which is currently scanned by an electron beam. In this embodiment, the horizontal scanning lines are counted from the uppermost one on the screen and the number of the horizontal scanning lines on the display screen is set to 192 . The VDP 1 also comprises a video digitizer 9 which samples an analog video signal, supplied from an external video device, at a predetermined rate, and converts signal levels or amplitudes of the sampled signals into digital data each composed of two or four bits. The amplitude data thus outputted from the video digitizer 9 represent a still image and are supplied to the image data processing circuit 10. The image data processing circuit 10 selectively stores into the VRAM 5 the amplitude data supplied from the video digitizer 9 and color codes supplied from the CPU 2 through the interface circuit 7. Each of the color codes supplied from the CPU 2 represents a color of a respective one of the display elements constituting a still image on the screen and is composed of two or four bits. In this case, which of the color codes and the amplitude data should be written into the VRAM 5 is determined by the CPU 2, and the selected data the color codes or the amplitude data are written into the same storage area of the VRAM 5. The sampling rate of the video digitizer 9 is set to either 5 MHz or 10 MHz actually, 10.74 MHz which is three times as high as the color subcarrier frequency of 3.58 MHz in the NTSC system . In the following description, both of the color code and the amplitude data are collectively referred to as dot data . When a display command is supplied from the CPU 2, the image data processing circuit 10 sequentially reads from the VRAM 5 the dot data in synchronization with the scanning position of the electron beam indicated by the contents of the horizontal and vertical counters 7 and 8, and outputs the read dot data from its output terminal TG to a color palette circuit 13 through a switching register 12. At the same time, the image data processing circuit 10 calculates and reads data necessary for displaying the animation image from the VRAM 5, and then supplies color codes obtained as the result of the above operation to the color palette circuit 13. In the case where the animation image and the still image are located at the same display position on the screen, the animation image is preferentially displayed. The switching register 12 comprises, as shown in Fig. 3, an eight bit register 12a for storing each dot data read from the VRAM 5, a switching circuit 12b which outputs the upper four bit data D4 to D7 contained in the register 12a selectively onto the upper four bit lines CB4 to CB7 and the lower four bit lines CB0 to CB3 of a color bus. The lower four bit data contained in the register 12a is always outputted onto the lower four bit lines CB0 to CB3 of the color bus, and the bit lines CB0 to CB7 are connected to input terminals of the color palette circuit 13 Fig. 4 . The operation of the switching circuit 12b will be more fully described later. The color palette circuit 13 is a kind of code converter and converts each color code fed from the switching register 12 into three color data RD red , GD green and BD blue each composed of three bits. These color data RD, GD and BD are supplied to a digital to analog converter DAC 14. When the data fed from the switching register 12 is the amplitude data, the color palette circuit 13 outputs gradation data five bits in this embodiment which corresponds to the fed amplitude data. The DAC 14 converts the color data RD, GD and BD into analog color signals R, G and B, respectively, and then outputs these color signals R, G and B to the CRT display unit 4. Fig. 4 shows the construction of the color palette circuit 13. Shown at A bit shift circuit 22 in Fig. 4 operates only in the G V mode and supplies the data on the bit lines CB2 and CB3 of the color bus to input terminals D0 and D1 of a binary to decimal decoder 24 and at the same time prevents the data on the bit lines CB2, CB3, CB6 and CB7 of the color bus from being supplied to input terminals D2 and D3 of a binary to decimal decoder 23 and of the decoder 24. When the bit shift circuit 22 is in the nonoperative state, the data on the bit lines CB0 to CB3 are supplied to the input terminals D0 to D3 of the decoder 23, and the data on the bit lines CB4 to CB7 are supplied to the input terminals D0 to D3 of the decoder 24. Each of the decoders 23 and 24 outputs a selection signal to select one of the color data output sections 20 1 to 20 16 in accordance with the data supplied to the input terminals D0 to D3 thereof. In this case, the selection signals outputted from the decoder 23 are supplied to the buffer amplifiers BFb as enable signals, while the selection signals outputted from the decoder 24 are supplied to the buffer amplifiers BFa as enable signals. Therefore, output signals of the registers Referring again to Fig. 2, shown at 16 is a VRAM interface for controlling transfer of data between the image data processing circuit 10 and the VRAM 5. The VRAM interface 16 outputs at proper timings a row address strobe signal The mode of this system to display a still image will now be described. There are a plurality of still image display modes in this system, which are broadly classified into a pattern display mode in which selected patterns each composed of, for example, 8 x 8 or 8 x 6 display elements or dots are displayed, and a dot map mode in which colors of the display elements constituting the entire display screen are designated individually. This dot map mode further includes three kinds of display modes, namely, G IV, G V and G VI modes. Each of these display modes will now be described. In this G IV mode, the screen is constituted by 256 x 192 display elements as shown in Fig. 6 a and color codes or amplitude data corresponding respectively to those display elements are stored in a still data image area 5a of the VRAM 5 in the order shown in Fig. 6 b . In this case, each color code or amplitude data is composed of four bits so that each address of the still image data area 5a stores two color codes. And as each color code is composed of four bits, one of sixteen colors can be designated with respect to each display element in this display mode. In this G V mode, as shown in Fig. 7 a , the screen is constituted by 512 x 192 display elements and the color codes or amplitude data of all the display elements are stored in the still image data area 5a in the order shown in Fig. 7 b . Each color code or amplitude data in this mode consists of two bits and four color codes or amplitude data are stored in each address of the still image data area 5a. In the G V mode, the number of bits of one color code is two, so that up to four colors can be designated per one display element. The VRAM 5 in this G V mode and in the foregoing G IV mode is constituted by dynamic RAMs having addresses each composed of eight bits. The VRAM 5 latches a row address when the signal In this mode, as shown in Fig. 8 a , the screen is constituted by 512 x 192 display elements and each color code or amplitude data is composed of four bits similarly to the G IV mode. In this G VI mode, storage area of the VRAM 5 is formed by two dynamic RAMs DRAM1 and DRAM2 as shown in Fig. 8 b . Color codes or amplitude data corresponding to all display elements on the display screen are stored in still image data areas 5a 1 and 5a 2, provided respectively in the DRAM1 and DRAM2, in the order shown in Fig. 8 b . In this case, the DRAM1 and DRAM2 are arranged so as to have the same addresses. The DRAM1 and DRAM2 latch a row address when the signal A digital color encoder 18 produces a digital composite video signal on the basis of the five bit gradation data or color data RD, GD and BD which are supplied from the color palette circuit 13, and outputs this video signal through a DAC to the CRT display unit 4. Fig. 11 shows an arrangement of the digital color encoder 18. A burst timing generating section 30 sequentially and repeatedly outputs a 0 The coefficients which are selectively used by the multipliers 31 to 33 will now be briefly described. As is well known, the composite video signal of the NTSC system is expressed by the following equation The color difference signals of blue and red are expressed respectively by Fig. 13 shows phases of the color difference signals B Y and R Y in the case where the phase of the color burst signal is set to 180 In this embodiment, the composite video signal represented by the foregoing equation 1 is synthesized using the following equations which are derived when the sampling is performed at a frequency which is three times as high as that of the color subcarrier. Fig. 14 shows, by way of example, a circuitry of the multiplier 31, the other multipliers 32 and 33 being similar in construction to the multiplier 31. As shown in Fig. 14, the multiplier 31 comprises twelve full adders FA, eighteen delay circuits On the other hand, when the signal BW is supplied, the decoder DS Fig. 14 outputs data representative of a predetermined coefficient, which is suitable for the black and white display. More specifically, the decoder DS outputs such a coefficient data that causes the portion three bits of the gradation data, which is supplied to this multiplier 31, to be outputted from the third to fifth output terminals D2 to D4 of the multiplier 31. Also, a decoder DS of the multiplier 32 not shown outputs such a coefficient data that causes the portion two bits of the gradation data, which is supplied to this multiplier 32, to be outputted from the first and second output terminals D0 and D1 of the multiplier 32, while a decoder DS of the multiplier 33 not shown outputs such a coefficient data that causes data of 0 to be outputted from the multiplier 33. The color burst generator 34 Fig. 11 outputs the color burst signal data six bits at a predetermined timing, i.e., at a timing corresponding to a back porch of the horizontal synchronization signal. The color burst generator 34 will now be more fully described with reference to Fig. 15. The color burst generator 34 comprises eighteen one bit registers The case where the signal BW is outputted will now be described. When the signal BW is outputted, this signal BW is supplied to the multipliers 31 to 33, and at this time the AND gates AN10 to AN12 Fig. 11 are closed so that the 0 The operation of this system will now be described. In the operation of this system, there is a case where the display of a still image is performed in accordance with the color codes stored in the VRAM 5. There is also another case where the display of a still image is performed in accordance with the amplitude data stored in the VRAM 5. And therefore, by way of example, the former case in the G V mode is first described and thereafter the latter case in the G VI mode will be described. In this mode, the number of bits of still image data which are read from the VRAM 5 during a period of one horizontal scanning is 1024 2 bits x 512 1024 bits , so that data of 128 bytes must be read from the VRAM 5 during that period. To read out the still image data of about 128 bytes during one horizontal scanning, it is not necessary to provide an extremely high access speed, and therefore, an access to the VRAM 5 to the conventional manner is performed. More specifically, the image data processing circuit 10 calculates each address of the VRAM 5, in which color codes necessary for displaying display elements of the still image are stored, in accordance with the contents of the horizontal and vertical counters 7 and 8. Then, the image data processing circuit 10 sequentially outputs to the VRAM 5 the row address and column address corresponding to the calculated address. At the same time, the VRAM interface 16 sequentially outputs the row address strobe signal Figs. 9 a and 9 b show the signals The data of one byte read from the accessed address of the VRAM 5 is once stored in the register 12a of the switching register 12 and the switching circuit 12b outputs in sequence the upper four bits and the lower four bits of the stored data onto the bit lines CB0 to CB3 of the color bus. Next, the operation of the color palette circuit 13 will be described. As described above, each data which is sequentially outputted onto the bit lines CB0 to CB3 of the color bus includes two color codes. The bit shift circuit 22 supplies one of the two color codes on the bit lines CB0 to CB1 to the input terminals D0 and D1 of the decoder 23 and supplies the other one of the two color codes on the bit lines CB2 and CB3 to the input terminals D0 and D1 of the decoder 24. Each of the decoders 23 and 24 then outputs the corresponding selecting signal so that one of the color data output sections 20 1 to 20 16 is selected in accordance with the color code supplied thereto. The color data in the register When the color data GD, RD and BD are supplied respectively to the multipliers 31, 32 and 33 at a speed of 10.74 MHz 93 nsec and when the 0 In this case, amplitude data, each composed of four bits and obtained by sampling the external video signal by the video digitizer 9 at a rate of 10.74 MHz, are stored in the VRAM 5. Also predetermined sixteen gradation data each composed of five bits are stored respectively in the color data output sections 20 1 to 20 16, each gradation data being stored in the fifth to ninth registers When making an access to the VRAM 5, the image data processing circuit 10 outputs both of the access request signal RQ and high speed read signal HSR to the VRAM interface 16 and also outputs a row address data to the VRAM 5. Subsequently, the VRAM interface 16 outputs the signal The amplitude data thus read from the DRAM1, which includes two amplitude data, is temporarily stored in the register 12a of the switching register 12 and is then outputted onto the bit lines CB0 to CB7 of the color bus. And thereafter, the amplitude data read from the DRAM2 is temporarily stored in the register 12a and is then outputted onto the bit lines CB0 to CB7. The decoder 23 outputs the selection signal to select, in accordance with the amplitude data on the lower four bit lines CB0 to CB3 of the color bus, one of the color data output sections 20 1 to 20 16 which contains the gradation data corresponding to this amplitude data, while the decoder 24 outputs the selection signal to select, in accordance with the amplitude data on the higher four bit lines CB4 to CB7 of the color bus, one of the color data output sections 20 1 to 20 16 which contains the gradation data corresponding to this amplitude data. And thereafter, the decoder 23 outputs the selection signal to select one of the color data output sections 20 1 to 20 16 in accordance with the lower four bits of the amplitude data read from the DRAM2, while the decoder 24 outputs the selection signal to select one of the color data output sections 20 1 to 20 16 in accordance with the higher four bits of the same amplitude data. The output signals of the OR gates OR1 and OR2 and AND gate AN1 in this G VI mode are in the same states as those in the foregoing G V mode. Therefore, the gradation data in the color data output section selected by the decoder 23 and the gradation data in the color data output section selected by the decoder 24 are alternately outputted through the OR gates OR. As a result, the gradation data are sequentially supplied to the input terminals of the digital color encoder 18 at an interval of 93 nsec. In this case, as each gradation data is composed of five bits, thirty two gradations can be realized. However, the number of the color data output sections is sixteen, so that desired sixteen gradations for example, those selected from every two of the thirty two gradations or the sixteen gradations in the bright portion are previously selected. Next, the operation of the digital color encoder 18 will be described. In the case where the display of image should be performed in accordance with the amplitude data the signal BW is outputted so that the AND gates AN10 to AN12 are closed. The signal BW is supplied to the multipliers 31 to 33, whereas the 0 When it is desired to display the image in black and white, the color burst generator 34 is rendered inactive so that no color burst signal is generated. This is realized by, for example, previously storing 0 into all of the registers When it is desired to display the image with colors, the color burst generator is rendered active so that the color burst signal is generated. And in the case where amplitude data of the color burst of the standard NTSC system are stored in the memory blocks B0 to B3 of the color burst generator 34, the image is displayed in the same colors as those of the original image whose video signal has been sampled by the video digitizer 9. On the other hand, if the amplitude data stored in the memory blocks B0 to B3 are of a color burst signal whose phase is shifted from that of the standard color burst signal, the demodulation axes in the CRT display unit 4 are deviated so that the image can be displayed in colors different from those of the original image. In this embodiment, the color information is given at three points, i.e., at 0 As described above, with the construction of this embodiment, the number of gradations of the gray scale can be increased without increasing the number of bits of the primary color data or of the image data of each display element. In addition, with the construction of this embodiment, an image based on the reproduced video signal can be displayed in any desired colors.