# Method and apparatus for natural language processing

## Claims
Verarbeitungsvorrichtung für eine natürliche Sprache, zur Verarbeitung einer Zeichenfolge einer natürlichen Sprache, aufweisend

## Description
The present invention relates to a method and apparatus for processing a natural language such as Japanese, Korean, Chinese, etc., and in particular, to a method and apparatus for natural language processing suitable for processing sentences which contain vocabularies not registered in a dictionary hereinafter referred to as undefined words . In performing sophisticated processing of a natural language, generally, syntax analysis of a sentence is carried out, and based on the analysis, composition and editing of a new sentence are performed. However, in order to achieve the natural language processing, all vocabularies possible to compose a sentence are not always registered in a dictionary entirely, and thus even when a large dictionary is made available, undefined words which are not registered in the dictionary frequently appear in the sentence in many cases. A technique to solve this problem is disclosed in Japanese patent unexamined publication Nos. 58 175074 1983 , 58 175075 1983 and 58 175076. In the technique disclosed in these publications, for an undefined word occurring as a result of failure in consulting a dictionary, the user is requested to input a synonym included in the words which have been registered and existing in the dictionary, and depending on this user s response, information for syntax analysis is added. However, in this technique, it is necessary for the user to memorize beforehand synonyms, etc., registered in the dictionary, or it is necessary for the system to output a list of all vocabularies registered in the dictionary so that the user himself extracts a synonym or the like from the list. Accordingly, in the case of a sophisticated processing, the number of registered words increases, and the burden on the user increases remarkably, and thus it has been difficult to carry out the natural language processing in a simple manner and effectively. A language processing system to be used in connection with machine translation is disclosed in Fujitsu Sci.Tech. J. 18,1, pp. 117 133, March 1982. In view of the problems mentioned above, an object of the present invention is to provide a method and apparatus for natural language processing which is capable of performing a sophisticated and practical natural language processing in that even when an undefined word appears in a sentence to be processed, the user is provided with information of a synonym from the apparatus to enable the processing with a dictionary of a limited storage capacity. In the present invention, as claimed, when an undefined word appears in an input character train of a natural language, an upper concept of the undefined word is obtained by semantic analysis means which determines a semantic concept of the vocabulary by using a case dictionary, and then by using a vocabulary hierarchy dictionary which registers vocabularies in a hierarchy structure formed according to the upper concept, a group of vocabularies corresponding to a lower concept is extracted. Further, it is also a feature of the invention that the extracted group of vocabularies is displayed on a display device and the user is enabled to select a synonym from the group. Another feature of the invention resides in that when an undefined word appears in an input character train of a natural language, an upper concept of the undefined word is obtained by semantic analysis means which determines a semantic concept of a vocabulary by using a case dictionary, and then by using a vocabulary hierarchy dictionary which registers vocabularies in a hierarchy structure formed according to the upper concept, a group of vocabularies corresponding to a lower concept is extracted, and a synonym is selected by inference means which selects from the extracted group of vocabularies of the lower concept a vocabulary by inference, which vocabulary is in conformity with the intention of the inputted character train, and then the undefined word is replaced by the selected synonym. An embodiment of the present invention will be described with reference to the drawings. Fig. 1 shows an overall arrangement of the invention, that is, shows an intelligent guidance system of the question answer type in which the user inputs by means of an input device 1 e.g., a keyboard, voice recognition device, hand written character input device, etc. a natural language e.g., Japanese into a processing unit 2, and the processing unit 2 executes processing as regards the natural language, and provides the user with information by displaying the contents and results of the processing on a display device 3. Here, the processing unit 2 is composed of a keyword dictionary 8, a conjunction relationship dictionary 9, an inflectional ending dictionary 10, and morphemic analysis means 4 for dividing an input sentence into vocabularies by use of information of these dictionaries 8 to 10 a grammatical rule dictionary 11, and syntax analysis means 5 for obtaining a syntax of the input sentence by use of the dictionary 11 a case dictionary 12, a vocabulary hierarchy dictionary 13, and semantic analysis means 6 for extracting a meaning of the input sentence by use of these dictionaries 12 and 13 a sentence pattern dictionary 14 containing several patterns of answer sentences, and sentence producing means 7 for producing a sentence by use of this dictionary 14. Next, individual processings in the processing unit 2 will be described in detail by way of an example in which as shown in Fig. 2A, a sentence in kana characters Japanese syllabary in solid writings is inputted as an input sentence. First, in the morphemic analysis, by using the keyword dictionary 8, conjunction relationship dictionary 9, and inflectional ending dictionary 10, it is found whether or not a keyword exists in the character train of the input sentence, and a conjunction relationship is checked, and then the input sentence is divided into vocabularies. Here, in Tables 1, 2, and 3, examples of the keyword dictionary 8, conjunction relationship dictionary 9, and inflectional ending dictionary 10 are respectively shown. In the keyword dictionary 8, there are registered with addresses, keywords, parts of speech, and conjunction conditions, and in particular, in the conjunction conditions, there are registered forward and backward conjunction relationships of each keyword. Further, in the conjunction relationship dictionary 9, there are registered correspondences between the conjunction relationships of each keyword mentioned above. For example, when a vocabulary having a forward conjunction condition of α3 and another vocabulary having a backward conjunction condition of β6 are possible to be connected with each other, then this relationship is registered as 1 . The inflectional ending dictionary 10 is used to register beforehand the endings of each keyword corresponding to conjugations of the keyword since the keyword conjugates when it is a verb. In this respect, in the keyword dictionary 8, when a keyword sa ku se i su ru to draw up is the word which conjugates, the backward conjunction relationship is registered as γl so that the inflectional ending dictionary 10 can be used in looking up immediately. With reference to Fig. 3, the processing procedure of the morphemic analysis means 4 will be described. First, in step 20, flag, pointer, stack, etc., required for the subsequent processing are initialized. Next, in step 21, it is decided from a pointer of the input character train whether or not a character train following the pointer exists in the keyword dictionary 8, and when the result of the decision indicates that a keyword exists, the process proceeds to step 24 otherwise proceeds to step 22. When the keyword does not exist, in step 22, one vocabulary is fetched from an alternative solution stack, and it is decided whether or not the fetched vocabulary can be connected with a vocabulary before the fetched one. Here, when the fetched vocabulary is not connected to the preceding vocabulary, and if the stack for alternative solutions is vacant, proceeds to step 23, and undefined words of various lengths are prepared for the input character train following the pointer under the assumption that any one of the undefined words corresponds to the input character train, and after storing these undefined words in the alternative solution stack returns to the processing of the character train following the pointer in step 21. When the fetched vocabulary is not connected with the preceding vocabulary, and if alternative solutions are available in the alternative solution stack, the process in step 22 is again tried for the alternative solutions. In step 21, when the keyword exists,the process proceeds to step 24, and the longest one of the vocabularies found in step 21 is fetched and the rest are stored in the alternative solution stack, and it is checked by using the conjunction relationship dictionary 9 whether or not the fetched vocabulary is connected with a vocabulary appearing just before the fetched vocabulary in the input sentence. When the connection possible, the process proceeds to step 25 and decides whether or not the analysis has progressed to the end of the sentence, whereas when the connection is not possible, the process in step 22 is executed. Further, in step 22, when there is an alternative solution and the connection with the preceding vocabulary is possible, proceeds to step 25. In step 25, when the analysis has not reached the end of the sentence, the process in step 26 is executed, and a post processing for updating the pointer and flag is executed, and returns to step 21. On the other hand, in step 25, when the analysis has reached the end of the sentence, proceeds to step 27, and when undefined words exist in the analysis which has reached the end of the sentence, the shortest one among the undefined words is selected as a first candidate, and the morphemic analysis is completed. Further, in steps 22 and 24, in the case of checking the possibility of connection, it is supposed that the undefined word can be connected with any vocabulary. Next, the morphemic analysis which is to be carried out when the sentence shown in Fig. 2A as an example is inputted will be described. When the sentence is inputted to the morphemic analysis means 4, in the initializing step 20, by looking up in the keyword dictionary of Table 1 a vocabulary in which the pointer is located at the beginning of the sentence, i.e., a position of mi gi shi ta ... and the vocabulary begins with mi gi shi ta address 0008 in the keyword dictionary of Table 1 are obtained. Then by applying a rule the longest coincidence rule based on the experimental rule that the longest vocabulary has the highest probability of being correctly punctuated, mi gi shi ta is obtained, and then in step 21, a forward conjunction condition of αl is obtained, and in step 24, from the conjunction relationship dictionary of Table 2, data at the intersection of the beginning of the sentence and the conjunction condition of αl is fetched. Here, the data at the intersection is 1 , and since the conjunction condition is met, in step 26 via step 25, the pointer of the post processing indicates no ba sho . Returning to step 21, by looking up in the keyword dictionary Table 1 , a case particle ku u ha , ku u ha ... , and these undefined words are stored in the alternative solution stack, and first, u ha ... , and results in a failure. Then, by selecting ku u ha ku i ki , proceeds to step 25, and the cutting out of vocabularies thus reaches the end of the sentence, and vocabularies of undefined words can be cut out as shown in Fig. 2B. Here, a method of using the inflectional ending dictionary in Table 3 will be described hereinafter. Specifically, at the time when the vocabulary of sa ku se i draw up is cut out in step 21, it is found that this vocabulary is an irregular conjugation verb whose ending is inflected in the sa ku se i shi is the continuative form and an auxiliary verb of As a result of such cutting out, a character train of vocabularies is obtained as shown in Fig. 2C, and ku u ha ku i ki is obtained as an undefined word. The character train obtained in the morphemic analysis means 4 is the input to the next processing in the syntax analysis means 5. The syntax analysis means 5 executes a processing which determines a grammatical rule applicable by using the grammatical rule dictionary 11, and determine with which role in the grammatical rule the inputted vocabulary is burdened. Here, an example of the grammatical rule dictionary 11 is shown in Table 4. The grammatical rule dictionary 11 registers systematized grammatical rules, and for example, as a result of the morphemic analysis, when mi gi shi ta and With reference to Fig. 4, the processing procedure of the syntax analysis means 5 will be described. First, in step 30, a variable, stack, etc., required for the syntax analysis are initialized. Next, in step 31, a grammatical relationship which is identical with the one between a phrase at the beginning of the stack and grammatical information exists in the keyword dictionary 8 of a vocabulary at the beginning of the input sentence is searched from the right side of the grammatical rule dictionary 11 shown in Table 4, and it is decided whether or not a rule corresponding to that grammatical relationship exists, and when the rule exists in the dictionary 11, step 32 is executed, and when the rule does not exist in the dictionary 11, step 33 is executed. In the case in which the rule exists in the dictionary 11, the process proceeds to step 32, and when a plurality of rules are found, these rules are stored in data for alternative solutions, and by using one rule from these rules, the phrase at the beginning of the stack is combined with the beginning of the input sentence, and by assigning the grammatical condition to the left side of the grammatical rule, the combination is made as a vocabulary phrase in this case at the beginning of the input sentence. However, when there is an undefined word, since it is impossible to determine the grammatical condition of the undefined word, it is supposed that the undefined word can be connected with any vocabulary. When the rule does not exist in the dictionary, in step 33, a processing to stack the phrase at the beginning of the input sentence is executed, and in step 34, it is decided whether or not the input sentence after stacking on the stack has reached the end of the sentence, and when the end of the sentence has not yet been reached, the processing in step 31 is executed, whereas when the sentence end has been reached, the processing in step 35 is executed. In step 35, it is decided whether or not an alternative solution has existed in the processing in step 31, and when the alternative solution has existed, the process proceeds to step 36, and when the alternative solution has not existed, the syntax analysis is completed. In the step 36, one of the candidates of alternative solution stored in step 32, and data obtained as a result of the analysis conducted up to step 31 are set, and this enables to continue the processing subsequent to the processing in which the candidates for alternative solutions have been found. Next, an example of operation for this processing will be described. As an input sentence, the sentence as shown in Fig. 2B and additional grammatical information are inputted. Since the stack is vacant at first, steps 31 and 33 are executed, and mi gi shi ta is stored in the stack. Next, in step 31, a conjunction relationship between mi gi shi ta in the input sentence is consulted with the grammatical rule dictionary in Table 4, and it is found that noun particle in the right side in rule No. 5 is applicable, and thus these portions of the input sentence are stored in the stack as one noun phrase. Next, since ba sho is not connected with the aforementioned noun phrase, the noun ba sho is stacked on the stack. Supposing that ba sho and ku u ha ku i ki is a noun, it is found that ku u ha ku i ki and sa ku sei shi ta i is a predicate, and that by applying the left side of rule No. 2, these portions of the input sentence constitute a clause. Further, from rule No. 4, since noun phrase clause right side is clause left side , it is decided that ku u ha ku i ki wo sa ku se i shi ta i is a clause. In this manner, by analyzing until the end of the input sentence is reached, it is found in accordance with clause end mark in rule No. 1 that the input sentence is a grammatical or meaning sentence, and the analysis is successful. Based on the result of the syntax analysis, the semantic analysis means 6 obtains an upper concept of the undefined word from a grammatical condition by using the case dictionary 12, and further performs a semantic analysis by using the vocabulary hierarchy dictionary 13 in which the upper concept is further formed in a hierarchy structure. Here, an example of the case dictionary 12 is shown in Table 5, and an example of the vocabulary hierarchy dictionary 13 is shown in Fig. 5. The case dictionary 12 registers a semantic concept in a corresponding relationship with the grammatical condition of a vocabulary in this case, sakuseisuro draw up . For example, when noun sakuseisuru , according to this dictionary, it can be understood that the noun represents an animal as its concept. Here, the default value is intended to mean a value which is applied to an omittable item which will be described later in the course of the semantic analysis. Further, in the vocabulary hierarchy dictionary 13 shown in Fig. 5, there are registered with vocabularies of a lower concept in a hierarchy structure whose upper concept is the concept in the case dictionary 12. With reference to Fig. 6, a processing procedure of the semantic analysis means 6 will be described. First, in step 40, from the output of the syntax analysis means 5, a vocabulary e.g., a verb constituting a predicate of a highest priority is taken out with the exception of an undefined word, and information of the vocabulary is obtained by using the case dictionary 12 as shown in Table 5. Next, in step 41, from phrases in the input sentence, a phrase which satisfies the grammatical condition of the vocabulary obtained in step 40 is selected, and the selected phrase is substituted in a slot a concept enclosed in a block in Fig. 7 of a syntax tree. And in step 42, it is checked whether or not the completed syntax tree satisfies the semantic condition, and when an undefined word exists,the process proceeds to step 43, and when the semantic condition is not satisfied it proceeds to step 44, and in other cases it returns. In step 43, a concept of the slot in which the undefined word is to be entered is obtained, and its lower concept is obtained from the vocabulary hierarchy dictionary 13 in order to use as data for producing a sentence. In step 44, the processing is programmed to obtain an alternative solution of the syntax analysis, when the semantic analysis is not successful. This operation will be described as regards the example used in the previous description. In step 40, it is made clear that the verb constituting the predicate is sakuseisuru draw up , and the case dictionary in Table 5 is fetched. A phrase corresponding to an item of the grammatical rule of the case dictionary is fetched from the output of the syntax analysis means 5, and this phrase is applied to the item. For example, since a phrase noun migishita no basho place at the lower right ku u ha ku i ki migishita no basho ni represents a place. In this case, the semantic condition for representing a position is satisfied. Since ku u ha ku i ki is an undefined word, the semantic condition is not satisfied. However, it is also found that for a semantic condition to be satisfied, it is required that the semantic condition is a concept of indication object . Fig. 5 is an example of the hierarchy structure of a vocabulary formed by putting such concept in order, and it is seen that ku u ha ku i ki is a lower concept of the indication object , and is a kind of window character . A syntax tree formed in this manner is shown in Fig. 7. The sentence producing means 7, based on the result of the semantic analysis means 6, calls a question pattern of the undefined word from the sentence pattern dictionary 14, and fills the question pattern with vocabularies of the hierarchy structure obtained by the semantic analysis means 6, and displays it as a question sentence as shown in Fig. 8, and enables the user to select a synonym. When the user selects the synonym, the system proceeds with the analysis further by using various information of the synonym in the dictionary. By virtue of such an arrangement, even when the sentence as shown in Fig. 2A is inputted, the undefined word of ku u ha ku i ki is fetched as a vocabulary, and the user is enabled to select a synonym from the vocabularies displayed on the display device 3 as shown in Fig. 8. When the user inputs a vocabulary of In the prior art, when it is not clear whether or not a synonym exists, a vocabulary is entered, and when there is no synonym, another vocabulary had to be entered again anew. However, in the present invention, vocabularies which belong to the concept of the undefined word are displayed, and these vocabularies are displayed without fail if synonyms thereof are registered in the dictionary. Accordingly, the system is very easy for the user to use. Next, another embodiment of the present invention will be described with reference to Figs. 9 to 12. Differences in this embodiment from that shown in Fig. 1 reside in that as shown in Fig. 9, an object 100, knowledge base processing means 101, knowledge base 102, and inference means 103 are added. Here, the object 100 serves to restrict a theme, and information is stored in the knowledge base 102 following on a variation in status, through the knowledge base processing means 101 which produces and updates the knowledge base 102. On the other hand, in the inference means 103, the syntax tree Fig. 7 which is the output of the semantic analysis means 6 mentioned in the previous embodiment is inputted, and by looking up in the knowledge base 102, a synonym of the undefined word is automatically substituted and displayed for the user. Here, as an example of the object 100, a processing of a natural language as regards an information terminal system will be described. Here, the information terminal system means an apparatus which includes an interface which deals with information between human and a computer. Thus, in the example of the language processing which will be described hereinafter, in conducting the inference by using the knowledge base, the object of a theme is restricted to a concrete operation method or processing method of the information terminal system . Naturally, in the present invention, the object 100 is not limited to the information terminal system , but the natural language processing is possible for other objects of themes. In the knowledge base processing means 101 connected with the information terminal on line, as a method of representing its knowledge base 102, various representations are available such as predicate logic, frame, and the like. For example, here, in representing a status of the picture screen of the information terminal as shown in Fig. 10A, if the picture screen status is represented as shown in Fig. 10B, the knowledge base processing means 101 actually performs a data conversion processing for converting an internal representation of the information terminal to a knowledge base description type. Here, in Fig. 10B, it is represented to mean that information given a name place 1 belongs to a kind of place, and its position is at the lower right place, and a sentence given a name sentence 1 exists at the place. Similarly, place 2 represents information of a kind of place, and its position is at upper left place, and a figure given a name Fig. 1 exists. Such information is represented so that the content of the picture screen display is varied each time the user manipulates the information terminal, and for example, it is arranged that when the figure at the upper left in Fig. 10A is erased, the items of place 2 ... ... in Fig. 10B disappear. On the other hand, in the knowledge base 102, in addition to the information a set of such information is called a status memory which varies following on a status change of the information terminal as described above and shown in Fig. 10B, a function memory which expresses the functions of the information terminal as shown in Fig. 11 is included. This function memory is composed of, for each address, 1 verb, 2 command name, 3 precondition, and 4 goal. In the 2 command name, in view of the fact that the status of the information terminal is varied each time a key is manipulated, a command name corresponding to the manipulation is stored. In the 3 precondition, a status of the information terminal which is the premise required to execute the key manipulation is stored. In the 4 goal, a new status produced after the execution of the key manipulation is stored. And in the 1 verb, verbs each verb and its synonyms, etc., are collected in a group, and included in an upper concept or the like in the input sentence are stored, and each verb is made to correspond to the 2 command name which is the action representing the key manipulation in the input sentence. Further, the representation method of these knowledge base is hereinafter referred to as a frame. Since the function memory of the knowledge base provides a general representation, names having a mark attached thereto are variables, and when correspondences of these variables with the input sentence and the status memory of the knowledge base are established, the variables are bound with respective constants with which the correspondences have been established. When executing the processing described in the foregoing embodiment, the output of the semantic analysis is the syntax tree Fig. 7 . Upon receipt of this syntax tree, the inference means 103 executes a processing as shown in Fig. 12. Here, since the syntax tree which is the output of the semantic analysis means 6 differs from the frame representation describing the knowledge base, a syntax tree conversion rule dictionary not shown in figure shown in Table 6, and a sentence type determination dictionary not shown in figure shown in Table 7 are used. In the processing procedure shown in Fig. 12, in step 110, by using the syntax tree conversion rule dictionary shown in Table 6, the syntax tree is converted to the frame representation, and in step 120, undefined words in this frame are made variables. Next, from the syntax tree in Fig. 7, since it is understood that this sentence is a wish, that is, a question as to an operation method of the information terminal, in step 130, by using this information and the sentence type determination dictionary shown in Table 7, the sentence type is decided and the process proceeds to step 140. In step 140, from the verbs in the input sentence, all commands which coincide with these verbs are selected from the knowledge base. In order to execute these commands, in step 150, a matching between the precondition which has to be satisfied by the information terminal and the status of the information terminal is executed, and also a binding of the variables is executed, and commands which have passed the matching are selected. In step 160, the goal status of the selected commands is matched with the content of the syntax tree, and the binding of the variables is executed, and items which coincide with the goal status are fetched. In step 170, the results of the binding between the variable and the constant e.g., place 1, Fig. 1, sentence 1, etc., executed in steps 150 and 160 are fetched. Before entering the main processing, since it can not be determined what the undefined words indicate, the undefined words have been regarded as variables, however, as a result of the execution in step 170, the constant which has been bound to the variable of the undefined word becomes a synonym of the undefined word. Here, the method of matching and binding of variable is described in detail in LISP by Patrick H. Winston Berthold K. P. Horn Addison Wesley Publishing Company, Inc., Reading, Mass., U.S.A. . This processing will be described by way of an example. The syntax tree in Fig. 7 is a logical sum of draw up kind action and place at lower right exist ku u ha ku i ki blank area , and it is converted in accordance with the syntax tree conversion rule dictionary in Table 6 in steps 110 and 120. Here, the mark indicates that the attached word is a variable. From the sentence type determination dictionary in Table 7, it is found that the type of the sentence is a HOW type a sentence which states a goal status and inquiries a means for realizing the goal as determined from an auxiliary verb of the wish. When searching from the knowledge base function memory of Fig. 11 a verb of the first item of the frame in step 120, which verb means draw up kind action , the matching is established with the space command and draw figure command. Next, matching is tried between the status memory this is also included in the knowledge base of Fig. 10B which being the present status and the precondition. When the place at lower right is substituted for the place name in the precondition, it becomes clear in step 150 that the matching with the space command is successful whereas the matching with the draw figure command is not successful. Step 160 is executed to obtain matching between the status directly represented by the input sentence, i.e., place at lower right ku u ha ku i ki blank area and place at lower right ku u ha ku i ki blank area and ku u ha ku i ki blank area is a synonym of ku u ha ku i ki should be interpreted by replacing it by In this embodiment of the present invention, it is shown that a synonym is made automatically selectable. In this embodiment, although the description is made in connection with the information terminal system , it will be apparent from the embodiment that the present invention is applicable not only to the information terminal system but to other systems. According to the present invention, even when the undefined word appears, information of the synonym is extracted and provided for the user. Thus, the user is not required to store all synonyms, and it is possible to achieve the natural language processing with a dictionary having a limited storage capacity, of which processing is practical also to the user and efficient.