# Method for encrypting a line scanned television signal and encrypting and decrypting apparatus.

## Abstract
A method for encrypting a line scanned television signal for example from a television camera 18 , each line of the signal having a first period during which video information is present and a second period where no video information is present comprises encrypting said television signal in accordance with an encryption key including a line storage device 14 by varying the durations of at least some of said second periods to both increase and decrease the same in accordance with said encyrption key, the extent of variations in the durations of said second periods being such that over a predetermined period of time the total of increases in said durations equals the total of decreases in said durations.

## Claims
CLAIMS 1. A method for encrypting a line scanned television signal of a type wherein in each line there is a first period during which video information is present and a second period where no video information is present, which method is characterised by comprising encrypting said television signal in accordance with an encryption key by varying the durations of at least some of said second periods to both increase and decrease the same in accordance with said encryption key, the extent of variations in the durations of said second periods being such that over a predetermined period of time the total of increases in said durations equals the total of decreases in said durations 2. A method for encrypting a line scanned television signal of a type wherein in each line there is a first period during which video irformation is present and a second period where no video information is present, transmitting the encrypted signal, receiving the encrypted signal, decrypting the encrypted signal and displaying the decrypted signal corresponding to said television signal before encryption, which method is characterised by comprising encrypting said television signal in accordance with an encryption key by varying the durations of at least some of said second periods to both increase and decrease the same in accordance with said encryption key, the extent of variations in the durations of said second periods being such that over a predetermined period of time the total of increases in said durations equals the total of decreases in said durations transmitting the encrypted signal receiving the encrypted signal providing a decryption key corresponding to said encryption key decrypting said television signal in accordance with said decryption key by restoring the durations of said at least some second periods each to a duration equal to the duration of said second period of said television signal prior to encryption and supplying the decrypted television signal to a television receiver for display. 3. A method for decrypting a line scanned television signal of a type wherein prior to encryption in each line there is a first period during which video information is present and a second period where no video information is present and wherein after encryption the durations of at least some of said second periods have been varied to both increase and decrease the same in accordance with an encryption key, the extent of variations in the durations of said second periods being such that over a predetermined period of time the total of increases in said durations equals the total of decreases in said durations, which method comprises decrypting said television signal using a decryption key corresponding to said encryption key by restoring the durations of said at least some second periods each to a duration equal to the duration of said second period of said television signal prior to encryption. 4. A method according to any preceding claim wherein said second periods are line blanking intervals. 5. A method according to claim 4 wherein some of said line .blanking intervals remain unchanged in duration. 6. A method according to claim 5 wherein over said period of time the average duration of said line blanking intervals is the same as the duration of the line blanking interval of each line of the television signal before encryption. 7. A method according to claim 6 wherein at any time the accuzulated change in the duration of the line blanking intervals of the encrypted signal is up to the duration of one line of the television signal before encryption. 8. A method according to claim 6 or 7 wherein said period of time is a field. 9. A method according to claim 6 or 7 wherein said period of time is a frame. 10. Encrypting apparatus for encrypting a television signal having means 12 for providing a line scanned television signal of a type wherein in each line there is a first period during which video information is present and a second period where no video information is present characterised by means 18 for providing an encryption key, and means including line storage means 14 for encrypting said television signal in accordance with said encryption key by varying the durations of at least some of said second periods to both increase and decrease the same in accordance with said encryption key, the extent of variations in the durations of said second periods being such that over a predetermined period of time the total of increases in said durations equals the total of decreases in said durations. 11. Decrypting apparatus for decrypting an encrypted line scanned television signal of a type wherein prior to encryption in each line there is a first period during which video information is present and a second period where no video information is present and wherein after encryption the durations of at least some of said second periods to both increase and decrease the same have been varied in accordance with an encryption key, the extent of variations in the durations of said second periods being such that over a predetermined period of time the total of increases in said durations equals the total of decreases in said durations, said apparatus being characterised by comprising means 23 for providing a decryption key corresponding to said encryption key, and means including line storage means 21 for decrypting said television signal in accordance with said decryption key by restoring the durations of said at least some second periods each to a duration equal to the duration of said second period of said television signal prior to encryption. 12. Decrypting apparatus according to claim 9 or 10 wherein said second periods are line blanking intervals. 13. Decrypting apparatus according to claim 9 or 10 wherein said line storage means 14, 21 comprises RAM memory. 14. Decrypting apparatus according to claim 9 or 10 wherein said line storage means 14, 21 comprises a plurality of shift registers. 15. Decrypting apparatus according to claim 10 including means for adding to said restored second periods line and field synchronizing signals and colour burst signals.

## Description
METHOD FOR ENCRYPTING A LINE SCANNED TELEVISION SIGNAL AND ENCRYPTING AND DECRYPTING APPARATUS BACKGROUND OF THE INVENTION This invention relates to methods and apparatus for encrypting and decrypting signals, particularly video signals, and is suited especially for use in cable and satellite video transmissions. There exists a need for secure encryption of video signals, such that only designated users may decrypt and display the information. In typical encryption systems, one or more parameters of the signal to be encrypted are modified according to a pattern which is determined at the transmitter. The pattern generally is a member of a large class of similar patterns, such that discovery of the pattern through exhaustive search is extremely unlikely. A precise description of the pattern used for encryption is delivered to designated receivers, which then are able to recover the original information. The description of the pattern is known conventionally as the encryption key . The process of informing designated users of the encryption key is known conventionally as key distribution . This invention relates to the choice of parameters of the original video signal to be encrypted, and to the techniques and apparatus for implementing the encryption and decryption at low cost. The problem of key distribution is not dealt with herein.Conventional and well known key distribution techniques can be employed.BRIEF DESCRIPTION OF THE DRAWINGS The invention is illustrated, merely by way of example, in the accompanying drawings, in which Figure 1 shows a standard NTSC television signal Figures 2a, 2b and 2c illustrate the encryption technique employed in the practice of an aspect of this invention and, in fact, illustrate the essence of the invention Figure 3 shows one form of an encryption decryption system embodying an aspect of the present invention Figure 4 shows an alternative receiving system to that shown in Figure 3 Figure 5 illustrates an encryption system embodying an aspect of the invention Figures 6 and 7 illustrate two different decryption systems each embodying different aspects of the invention Figure 8 shows a decryption system embodying an aspect of the invention and surrounding equipment and Figure 9 illustrates apparatus that may be employed for the encryption and decryption of video signals by a technique embodying the present invention.THE VIDEO SIGNAL Television signals are both produced and displayed as a result of a line scanning system. The picture material is scanned using a progressive series of horizontal lines which are transmitted sequentially in time. The transmitted signal is a continuous analogue of the brightness intensity corresponding to each point of the line. Such a signal is shown in Fig. 1, from which it may be seen that in a series of standard lines, any two adjacent active lines, during which video information is transmitted, are separated by a period in which no video information is transmitted.This latter period is known as the line blanking interval and is introduced to allow the scanning device in the receiver to reset to the line start position. In typical colour TV signals the active line period carries a single signal which simultaneously represents the instantaneous values of three colour components. The method by which the three independent signals are coded into one signal is standardised throughout North America, Canada and Japan, being known as the NTSC standard. Alternative standards known asPAL and SECAM have been adopted in other countries, but all of these have the same basic format, including a line blanking interval, and an active line period. New types of analogue video signals, which are particularly adapted to transmission by satellite or cable, and which lead to an improved picture quality in comparison with existing standards, are being studied.These are based on a time multiplex of the three independent signals during the active line. Instead of coding the three signals into one using NTSC, PAL orSECAM , they are sent sequentially using a time compression technique. One version of this type of signal is known as MAC Multiplexed AnalogueComponents . These signals in particular the MAC signal also adhere to the same basic format, including a line blanking interval, and an active line period.However, it should be noted that when a MAC signal is employed, digital data may be transmitted during the line blanking interval, as is shown by the dotted lines in Figures 2a and 2c. Therefore, speaking more generally, the standard line of a television signal may be separated into two components during one of which video information is transmitted and during the other of which no video information is transmitted. In the case of NTSC, PAL, SECAM or monochrome black and white television signals, the latter component is the line blanking interval, while, in the case of a MAC signal, it also may be a line blanking interval or, alternatively, a period of digital data transmission.It also is known, of course, in connection with an NTSC signal, for example, that line synchronizing signals and colour burst signals are transmitted during the line blanking interval, and these are shown at 10 and 11 respectively in Figure 1. Variations also have been made to NTSC, PAL and SECP5 signals in which data signals replace part of the line blanking interval.ENCRYPTION TECHNIQUES Referring to Figure 1, let the signal during the active line period be represented by y f t where y amplitude voltage t time Knowledge of both the signal amplitude y and the time at which it occurs t is necessary for accurate reconstruction of the video signal in a line scanned system. Encryption techniques may be classified as follows 1 Those which modify the amplitude y of the transmitted signal according to a prescribed pattern. y g f , where f f t Examples include amplitude reversal of randomly chosen lines Y g f f 2 Those which modify the time at which the signal is transmitted through the channel yl f t Examples include the reordering of television lines according to a prescribed pattern y f t d 3 Those which modify both amplitude and transmission time. It has been found that encryption techniques from the first category variation of amplitude cause impairments when the channel through which the signal is to be passed is non linear. In this case an amplitude y will be represented in the scrambled channel by various amplitudes according to the scrambling function in use at that instant. A channel non linearity therefore will cause imperfect reconstruction of the video information at the receiver. Since amplitude non linearities are very common, it has been concluded that an optimum encryption algorithm should be selected from the second category, and, in particular, from the subset yl f t d where d is constant during each standard line. In this case the channel is subjected to an undistorted signal, only the time at which the signal occurs being scrambled.Since almost all channels are essentially time invariant , this technique introduces few impairments. The system is known as time base scrambling. An obvious method of time base scrambling which has been used, is to reorder the television lines within the picture. This method, which results when d in the previous equation is an integral number of line periods, is expensive, because recovery of the picture in the receiver demands storage of many television lines.SUMMARY OF THE INVENTION According to the instant invention there is provided a time base scrambling method which can be implemented at low cost, requiring storage of as few as 1 3 television lines or even less than one line in the receiver depending upon the hardware employed. Various aspects of the invention are as follows A method for encrypting a line scanned television signal of a type wherein in each line there is a first period during which video information is present and a second period where no video information is present, which method comprises encrypting said television signal in accordance with an encryption key by varying the durations of at least some of said second periods to both increase and decrease the same in accordance with said encryption key, the extent of variations in the durations of said second periods being such that over a predetermined period of time the total of increases in said durations equals the total of decreases in said durations. A method for encrypting a line scanned television signal of a type wherein in each line there is a first period during which video information is present and a second period where no video information is present, transmitting the encrypted signal, receiving the encrypted signal, decrypting the encrypted signal and displaying the decrypted signal corresponding to said television signal before encryption, which method comprises encrypting said television signal in accordance with an encryption key by varying the durations of at least some of said second periods to both increase and decrease the same in accordance with said encryption key, the extent of variations in the durations of said second periods being such that over a predetermined period of time the total of increases in said durations equals the total of decreases in said durations transmitting the encrypted signal receiving the encrypted signal providing a decryption key corresponding to said encryption key decrypting said television signal in accordance with said decryption key by restoring the durations of said at least some second periods each to a duration equal to the length of said second period of said television signal prior to encryption and supplying the decrypted television signal to a television receiver for display. A method for decrypting a line scanned television signal of a type wherein prior to encryption in each line there is a first period during which video information is present and a second period where no video information is present and wherein after encryption the durations of at least some of said second periods have been varied to both increase and decrease the same in accordance with an encryption key, the extent of variations in the durations of said second periods being such that over a predetermined period of time the total of increases in said durations equals the total of decreases in said durations, which method comprises decrypting said television signal using a decryption key corresponding to said encryption key by restoring the durations of said at least some second periods each to a duration equal to the duration of said second period of said television signal prior to encryption. Encrypting apparatus for encrypting a television signal comprising means for providing a line scanned television signal of a type wherein in each line there is a first period during which video information is present and a second period whEre no video information is present means for providing an encryption key and means including line storage means for encrypting said television signal in accordance with said encryption key by varying the durations of at least some of said second periods to both increase and decrease the same in accordance with said encryption key, the extent of variations in the durations of said second periods being such that over a predetermined period of time the total of increases in said durations equals the total of decreases in said durations. Decrypting apparatus for decrypting an encrypted line scanned television signal of a type wherein prior to encryption in each line there is a first period during which video information is present and a second period where no video information is present and wherein after encryption the durations of at least some of said second periods to both increase and decrease the same have been varied in accordance with an encryption key, the extent of variations in the durations of said second periods being such that over a predetermined period of time the total of increases in said durations equals the total of decreases in said rations, said apparatus comprising means for providing a decryption key corresponding to said encryption key, and means including line storage means for decrypting said television signal in accordance with said decryption key by restoring the durations of said at least some second periods each to a duration equal to the duration of said second period of said television signal prior to encryption. As used herein and in the claims the terminology active video and video information shall be construed as meaning picture information. DETAILED DESCRIPTION OF THE INVENTION INCLUDING THE PREFERRED EMBODIMENT The method of the present invention is based on the derivation and use of a variable line period, as best shown in Figures 2a 2c. Referring to Figure 2a, portions of the active video components of lines N and N 1 are shown along with the line blanking interval of line N 1. The line shown in Figure 2a is of standard length and thus includes a standard line blanking interval. As discussed previously, and as shown in dotted outline inFigure 2a, instead of there being a line blanking interval, there may be a period of standard length for transmission of digital data. A line of minimum length is shown in Figure 2b and is obtained by virtually eliminating the standard line blanking interval or the period of digital data transmission. A line of extended length is shown in Figure 2c and is obtained by increasing the standard line blanking interval or the period of digital data transmission shown in Figure 2a, the dotted outline inFigure 2c also indicating digital data. An extended length line of the type shown inFigure 2c can be derived with simple hardware in the case where the line blanking interval hereafter reference only will be made to the line blanking interval, but it is understood that this equally well may be a period occupied by a digital data signal is double the line blanking interval of Figure 2a, and, in fact, the extended length line of Figure 2c has twice the line blanking interval of the standard line ofFigure 2a. Encryption is achieved according to an aspect of the present invention by varying the line blanking intervals of some of the lines to derive minimum and extended length lines, the transmitted television signal then being composed of lines of all three different lengths in accordance with an encryption key. It will be appreciated that over some specified period of time it is necessary for the average line length to be equal to the length of a standard line, i.e., that the long and short lines must cancel or balance each other out. This period is not critical.It may be one field, for example, or one frame, or it may be even a longer period, but, the longer it is, the longer it will take for the receiver to lock in. While Figures 2a 2c illustrate a preferred embodiment of the invention where the line blanking interval is standard, zero and two times standard, line blanking intervals between zero and standard can be employed as well as line blanking intervals more than twice standard and or between one and two times standard, and there may be a number of different line blanking intervals between zero and standard and a number of different line blanking intervals greater than standard. Generally speaking, however, employing a standard and more than two other line blanking intervals can be done only at the expense of more sophisticated hardware. In another embodiment of the invention no standard 3length lines may be employed, i.e., the line blanking intervals of all lines will be lengthened or shortened. Thus, in the practice of the present invention a television signal is modified in accordance with an encryption key to produce a television signal in which all active video lines are transmitted unchanged except for a time delay equal to the accumulated variance in the line blanking periods. More specifically, and as determined by the encryption key, some lines may be left with unchanged line blanking intervals, the line blanking intervals of other lines are increased, and the line blanking intervals of still other lines are decreased. The encrypted television signal is composed of all of these lines and is what is transmitted, the encryption key indicating which lines are standard lines, which long and which short, to enable decryption of the received signal. One additional condition is required to ensure a low cost receiver. This condition is that the accumulated change of the line blanking periods at any given time should remain within the range of from 0 1 line. With this constraint, the lines which arrive at the receiver do not require more than one line of delay before they are used in reconstructing the original signal, i.e., the signal prior to encryption. It is to be understood clearly, however, that this is not a limitation of the present invention. If the accumulated change in the line blanking periods at any given time will be more than one line, all that is required is to ensure that apparatus capable of storing the accumulated change is available, and this simply introduces greater cost and complexity. Because certain of the line blanking periods have been completely or partially removed, it is necessary to regenerate the blanking waveforms in the receiver.This can be achieved simply using electronic memories.More specifically, in the case of an NTSC signal, for example, regeneration of the line blanking intervals will require regeneration of the line synchronizing signals and the colour burst signals. This can be done using prior art techniques, however, and is not a part of the present invention. Thus, once the decryption key, which is the same as the encryption key, has been employed to restore the active video components to their proper time relationship with respect to each other, sync and colour burst signals correctly timed with respect to the video signals can be added readily and by known means. In the case where digital data is present during what would otherwise appear to be a line blanking interval, it might appear from Figure 2b that the digital data would be lost by the practice of this invention. It will not be lost, however, but rather will be transmitted during longer than standard digital data periods, as shown in Figure 2c, for example.IMPLEMENTATION The encryption decryption technique previously described herein can be implemented in a large number of ways using known techniques, equipment and components. Thus, referring to Figure 3, for example, the television signal produced by a TV camera 12 is supplied to an optional analogue to digital ADC converter 13, the digital output of which is supplied to a line storage device 14. The output of line storage device 14 is supplied to an optional digital to analogue converter DAC 15 whose output, which is an encrypted television signal in analogue form, is supplied to a transmitter 16 for broadcast to a satellite 17, for example. An encryption key for encrypting the television signal in line storage device 14 is supplied to encoding and timing networks 18 which vary the line blanking intervals of the television signal. The encrypted signal is received by a cable head end receiver 19 and supplied to an optional ADC 20 whose digital output is supplied to a line storage device 21. The output of line storage device 21 is supplied to an optional DAC 22 whose output, which is a decrypted TV signal the same in all respects as that derived at the output of camera 12, is supplied via cable to cable subscribers. A decryption key, which is the same as the encryption key, for decrypting the television signal in line storage device 21 is supplied to decoding and timing networks 23 which restore the shortened and extended line blanking intervals to the standard length shown in Figure 2a. In the case where the TV signal is an NTSC signal, for example, it may be necessary to restore line and field synchronizing signals and colour burst signals.This function is performed by blanking interval regenerating network 24. The TV signal may be processed in either analogue or digital form. The nature of line storage devices 14 and 21 will depend upon the format of the signal.Thus, if the TV signal is in analogue form, line storage devices 14 and 21 may be so called bucket brigade devices, while, if the TV signal is in digital form, line storage devices 14 and 21 may be shift registers, a RAM with at least one line memory capacity or CCD storage devices. It will be understood that cable distribution of the TV signal after decryption is not essential to this invention. Figure 4 discloses an arrangement whereby encrypted signals are received by an antenna 26 at a user location, e.g., a home, decrypted at that location and supplied to a TV receiver 25 at the location. One form of decryption system that can be used in practising the present invention is shown in Figure 6, line storage device 21 in this case being a one lineRAM memory. Components 27 and 28 simply are low pass filters. With the system of Figure 6, read and write cycles occur independently during each TV line. Another form of decryption system that can be used in practising the present invention is shown in Figure 7, storage device 21 in this case being a number of shift registers. With the system of Figure 7, the read in and read out cycles occur on different TV lines. The system of Figure 7 also can be implemented using CCD technology. An encryption system of a type paralleling the decryption system of Figure 6 is shown in Figure 5.Obviously an encryption system paralleling the decryption system of Figure 7 also could be used and would be identical to that shown in Figure 5 but with storage device 14 thereof being a plurality of shift registers connected as shown in Figure 7. Figure 8 shows a decryption system embodying the present invention in somewhat greater detail. Figure 9 shows how the decryption or encryption key is used to vary the line lengths. The decryption key which, in the embodiment shown, is updated once a frame is used as a starting vector for a pseudo random number generator circuit. This circuit produces for the NTSC case a sequence of 525 random numbers based on the decryption key. These random numbers then are combined with information derived from a counter, which is incremented once per line, in a line type selection circuit. This circuit selects which type of line i.e. determines the length of the blanking interval for the next line. This information then is fed to the line length controller which monitors the aggregate deviation in line lengths referenced to the start of the current frame and ensures that for this particular embodiment the following two conditions are met 1 The aggregate deviation never exceeds 1 full video line 63.55used for NTSC 2 The aggregate deviation at the end of the frame is zero. The line length controller then provides information to the horizontal counter and its associated decoder which enable this counter decoder to produce the correct line store control signals for the current line.