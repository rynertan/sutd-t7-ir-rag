# METHOD AND MEANS FOR ALTERING THE SPATIAL CHARACTERISTICS OF A DIGITAL IMAGE

## Claims
Verfahren zum Berechnen von Werten für Pixel 16 in einer neuen Matrix auf der Basis von Pixelwerten, die in einem Bildspeicher 76 als eine alte Matrix von einem Bild gespeichert sind, wenn die räumlichen Charakteristiken des Bildes geändert werden, wobei jede Matrix als Pixel definiert ist, die in Reihen und Spalten gemäß orthogonalen ersten und zweiten Achsen angeordnet sind, enthaltend die Schritte

## Description
This invention relates generally an improved method and apparatus for computing values for pixels according to the first part of claims 1 and 6, respectively. Such method and apparatus, respectively is known from EP A 0 105 707. The display of a digital image, for example on a video screen or photographic film, is controlled by a memory which stores values for picture elements or pixels. In a video display, an electron beam is scanned across the phosphor coated surface of the display screen, and the current of the electron beam is controlled in accordance with the stored values to thus control the light intensity of each pixel element as the electron beam impinges on the phosphor material. Alternatively, the digital image can be transferred to photographic film by scanning a laser beam across the film and modulating the intensity of the laser beam in accordance with the stored pixel values. Above mentioned EP A 0 105 707 shows an apparatus calculating new pixels from old ones by interpolation using table look up with offsets X and Y. Further XEROX Disclosure Journal, volume 5, no. 1, January February 1980, pages 115 116, H. LIAO Table Look up Realization of Digital Filtering mentions two dimensional interpolations obtained by two one dimensional filters using table look up. In any of the image processing tasks mentioned above, values for pixels at locations different than the original pixel lacations must be arrived at. The simplest technique for doing this is to use, for each output pixel, the value of the nearest input pixel. Minification is then performed by selectively deleting pixels while to magnify some or all of the pixel values are replicated. The resulting image quality is often not satisfactory. Values for the new pixel locations can be arrived at using linear interpolation in both directions. However, images magnified using this method are blurry and structured noise is sometimes visible. Improved fidelity and sharpness can be realized if the interpolation of new pixel values is a higher order polynomial interpolation. For example, in a third order interpolation of a pixel value in a new matrix to be described, the values of sixteen adjacent pixels in the old matrix are used. Generally, the higher the order of the polynomial used, the more fidelity and sharpness the new image will have. However, as the order of the polynorial interpolation increases, more computations are required in determining the new pixel values. Accordingly, an object of the present invention is an efficient method and apparatus for implementing polynomial interpolation of pixel values in a new matrix using pixel values of an old matrix. The object is solved according to the invention by the provisions of claims 1 and 6, respectively. Preferred embodiments of the invention are claimed in the subclaims. A feature of the invention as claimed is the implementation of polynomial interpolation by a weighted combination of the input pixels. Another feature is the use of a table of coefficients for polynomial interpolation of pixel values in a new matrix which are based on one dimensional e.g., x or y incremental spacing from pixels in an old matrix. Briefly, the pixels in the new pixel matrix are mapped in the old pixel matrix to obtain x and y offsets from old pixels. The offset for each new pixel in one dimension e.g., x dimension is determined and values for interim pixels are interpolated or obtained using values of a plurality of old pixels adjacent to each new pixel in the one dimension. The final pixel values are then obtained by polynomial interpolation in the other dimension e.g., y dimension using the calculated values of interim pixels. Importantly, the weighting coefficients for the one dimensional interpolations are precalculated for given incremental values. Thus, the time consuming tasks of calculating polynomial coefficients and evaluating polynomials are not required during the calculation of new pixel values. The invention and objects and features thereof will be more readily apparent from the following detailed description and appended claims when taken with the drawings, in which Referring now to the drawing, Figure 1 illustrates a portion of a matrix 10 of pixels of known value such as the pixels 11, 12, 13 and 14 in one horizontal row of the matrix. Assume that a new matrix of pixels is mapped on the old matrix 10 and the new pixel 16 is in the new matrix. As illustrated, the pixel 16 is offset from pixel 12 by a horizontal distance, Δ x, and a vertical distance, Δy. In general, the value of a new pixel 16 is arrived at by treating the region of the image in the neighborhood of pixel 16 as some function f x,y the details of which depend on the values of neighboring pixels. The value assigned to pixel 16 is then the value of the function f x,y at the position of pixel 16. This process is repeated for all the output pixels to arrive at the interpolated image. In polynomial interpolation as used in conjunction with this invention, the function f x,y is a polynomial function of x and y. The process of calculating the output pixel value then involves calculating the polynomial coefficients using input pixels neighboring the output pixel and then evaluating the polynomial. Typically, the number of input pixels used is equal to the number of polynomial coefficients of f x,y that must be determined. For example, suppose we wish to use as a model the polynomial Suppose we want to compute the value for a pixel to be located at x and, y and . Coefficients a For the model of Equation 1 this is done by solving a system of nine equations one for each input pixel with nine unknowns the coefficients . The coefficients are then used to calculate the output pixel value If the two dimensional polynomial model contains all terms up to nth order in either variable, where n is any integer, then the two dimensional interpolation process can be broken down into one dimensional interpolations. For example, the first step would interpolate in the x direction and arrive at interim pixel values for pixels x and, y In a n 1 square array of pixels surrounding the desired output location x and, y and x will take on values x is true for all the n 1 ² pixels in the square region surrounding x and, y and , and then using these to calculate the desired output Consider an interim pixel location at x and, y Note that the coefficients b and Equation 5 for the interim pixel becomes Equations 7 and 8 define an nth order one dimensional polynomial interpolation in x along the row Suppose that values for interim pixels x and, y The set c is true for all the interim pixels. Eq. 5 now becomes Equations 10 and 11 define one dimensional nth order polynomial interpolation in the y direction along the column defined by the interim pixels and which also contains the output pixel x and, y and . Again, since both equations 5 and 11 are nth order polynomials and since they agree at n 1 points the interim pixels they must give the same value at x and, y and . Thus, the two dimensional interpolation can be implemented using simpler one dimensional interpolation steps. Further, it will be clear to those skilled in the art that for the often used steps of image magnification, minification, and translation, many of the interim pixel values needed to calculate one output pixel can be stored and used to calculate other output pixels. We can now restrict ourselves to dealing with one dimensional interpolation. It will now be shown that the interpolated output value can be calculated as a linear combination of the input pixel values, where the combination coefficients depend on the relative position of the output point with respect to the input points. We use as a model Again, the coefficients a to be true for the n 1 pixels surrounding the output location, where x A is a row vector containing the polynomial coefficients, X is a square matrix containing the x values raised to the appropriate powers, and V is a row vector containing the pixel values. We solve for A by If the input pixels are equally spaced, the combination coefficients depend only on the normalized distance of the output pixel from the pixel to its left. We define this normalized distance by where x One advantage of using an odd number for the polynomial order n is that the number of input points used for each output point, n 1 , is even. Thus, the input points can be symmetrically located about the output. Following is a derivation of the combination coefficients for a third order interpolation n 3 . The model for this third order interpolation is Since x Equation 20B defines a Substituting Equation 20B and regrouping gives an expression for a₂ Subtracting Equation 20a from Equation 20c gives Substituting Equations 20b and 22 into Equation 20d and regrouping gives Equations 23 and 24 can be solved for a₁ and a₃ Substituting Equations 20b, 22, 25 and 26 into Equation 19 and combining like terms yields where Thus, to perform the cubic interpolation when the input pixels are equally spaced, it is not necessary to solve a system of equations for the polynomial coefficients and then to evaluate the cubic polynomial at the desired location. Instead, the combination coefficients for the four points surrounding the output location can be calculated using Equations 18 and 28 and then used with Equation 27 to calculate the output valve. Even with this method, there are many arithmetic operations involved in the interpolation since there are many operations needed to generate the combination coefficients for a given ΔX . However, this latter computational burden the operations involved in generating the coefficients can be eliminated. This is done by precalculating the coefficients for a set of values of Δx, and storing these in a table. When coefficients for a particular value of Δ x are needed, the coefficients for the nearest table entry are used. Alternatively, linear interpolation between table entries could be used. It has been found that for a particular application cubic interpolation using 64 sets of precalculated combination coefficients performs very well. Following is a table of combination coefficients for cubic interpolation at 64 equally spaced values of Δx In this method of interpolation, then, for a desired output pixel location x and, the first pixel to the left, x Referring again to Figure 1 a value for the interim pixel 15 is first calculated using Δx and the values of the four adjacent old pixels 11, 12, 13, and 14 for a third order polynomial . Similarly, values for interim pixels 17, 18 and 19 are calculated. A final pixel value is obtained for pixel 16 from the polynomial interpolation along the y axis using the values of the pixels 17 19 and the offset Δy. This procedure is illustrated in the computer system of Figure 2. The new pixel 16 from Figure 1 is located in the matrix map 20 using the matrix 10 of Figure 1. The x offset Δx is located at 22, and the y offset Δy is located at 24. The interim pixel values are then determined at 26 using the x offset, Δx, coefficients from the table of coefficients 28, and the values of the four adjacent pixels. The final pixel value of pixel 15 is obtained at 30 using the interim pixel values from 26, the y offset, Δy. and coefficients from the table 28. Figure 3 is a flow diagram for performing one dimensional interpolation using the present invention. The location x Figure 4 is a schematic diagram of one embodiment of apparatus in accordance with the invention which operates as described above. In this embodiment interim pixel values are derived for each column of the new matrix along the pixel rows of the old matrix based on interpolation of old pixel values. Then the final values of pixels in each column are derived based on interpolation of the interim values. The apparatus operates column by column in calculating the interim pixel values and the final pixel values. As will be described, many of the same elements are used to calculate both interim pixel values and final pixel values. First the x and y coordinates of the upper left most output pixel in terms of the input pixel array are loaded into the next column register 93 and the first y register 94, respectively. Similarly, the distance between output pixels in the x and y directions are loaded into the Dx register 61 and by register 62, respectively. To calculate interim pixels for the first column, switches 91, 92, 95, 89, 79 and 83 are set to their I positions. Switch 90 is set to the INT position to load the input address register 60 with the contents of the next column register and then is moved to the I position. The y register 73 is cleared. The input address register now contains the x coordinate of the first output column which is added to Dx at 64 and stored in the next column register in preparation for the next output column. The input address register is comprised of an integer part and a fractional part since it may lie between two columns of the old matrix. The fractional portion of the X input is applied through register 66 to address the coefficient memory 68. Assuming an interpolation of four values, four coefficients will be read from memory as the coefficient neighborhood address 69 is clocked through values 0, 1, 2, 3, as will be described below. The integer portion of the X input is applied through register 70 and combined in sequence at 72 with the address neighborhood e.g. 1, 0, 1, 2 from 74 and the sum is used alone in the y register 73 to address the input image memory 76 for obtaining the four input pixel values for interpolation. The address neighborhood 74 and coefficient neighborhood 69 are clocked and synchronized to present four pairs of coefficients and pixel values to multiplier 78. The four products are added at 80 and accumulated at 82. The resulting interim pixel value is stored at 84 using the y register 73 as an address. The accumulator 82 is cleared, the y address 73 is incremented and the next interim pixel is calculated. This process is repeated until all interim pixels for this column have been calculated and stored in 84. The final pixel values for this column are then calculated. Switches 91, 92, 95, 89, 79, and 83 are set to their 0 positions. Switch 90 is set to the INT position and the contents of the FIRST y register 94 is loaded into the input address register 60. Switch 90 is then set to the 0 position. The input image memory 76 and the y register 73 are not used in this step. The accumulator 82 is cleared in order to calculate the first output pixel value. Again, the value of register 60 is separated into integer and fractional parts. The fractional part is used to select coefficients from table 68 and the integer part is added to the address neighborhood and the sum is used to address the interim pixel memory. By clocking the address and coefficient neighborhood registers through their values 1, 0, 1, 2 and 0, 1, 2, 3 respectively and summing the product of interim pixel value and coefficient pairs a final pixel value is produced at 82 and stored in the output image memory 86. The accumulator 82 is then cleared, the input address 60 is incremented by DY by adder 64 and the next output pixel is calculated. The process continues until all output pixels for this column are calculated. Then the processes of calculating interim pixel values and final pixel values in the next column are performed. Switches 91, 92, 95, 89, 79, and 83 are set to their I positions. Switch 90 is used to load register 60 with the x coordinate of this column, the y register 73 is cleared and the x coordinate of the next column is calculated at 64 and stored at 93. The steps that follow are obvious to one skilled in the art. The device of Fig. 4 as described is best suited for image magnification, minification or stretching in one of the cartesian directions. It can be modified by one skilled in the art to allow a more general alteration of spatial characteristics. The device of Fig. 2 can be used for any of the tasks described above. While the invention has been described with reference to a specific embodiment, the description is illustrative of the invention and is not to be construed as limiting the invention. Various modifications and applications may occur to those skilled in the art without departing from the true spirit and scope of the invention as defined by the appended claims.