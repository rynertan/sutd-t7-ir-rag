# Geometric processing apparatus.

## Abstract
A geometric processing apparatus comprises a data converter unit 1 for dividing a plane forming a graphic model into a plurality of triangles TO,TA by diagonal lines drawn from a vertex thereof, and for producing vertex coordinates of the triangles, a normal vector operation unit 2 for receiving the data from the data converter unit and finding normal vectors moving outwards of the triangles and infinity point coordinates thereof, an interference test operation unit for calculating values of 4 x 4 determinants as well as logic values of the determinants, and an interference point coordinate calculation unit 4 for operating the result of the interference test operation unit. The arrangement is such that, in operation, vertex coordinates of two triangles are extracted from the graphic model for determining the interference condition and infinity point coordinates thereof, are selected to define a triangle, a 4 x 4 determinant is constituted by a vertex coordinate of the triangle and by a coordinate of another given point, the 4 x 4 determinant is operated by the interference test operation unit, and the interference point coordinate calculation unit is operated based upon the results of the interference test operating unit.

## Claims
CLAIMS 1. A geometric processing apparatus characterised by comprising a data converter means 1 for dividing a plane forming a graphic model into a plurality of triangles To ,TA by diagonal lines drawn from a vertex thereof, and for producing vertex coordinates of the triangles a normal vector operation means 2 for receiving data from said data converter means 1 and finding normal vectors pointing outwards of said triangles and infinity point coordinates thereof an interference test operation means 3 for calculating values of 4 x 4 determinants as well as logic values of the determinants and interference point coordinate calculation means 4 for operating on the result of said interference test operation means 3 , the arrangement being such that, in operation, vertex coordinates of two triangles extracted from the graphic model for determining the interference condition and infinity point coordinates thereof, are selected to define a triangle, a 4 x 4 determinant is constituted by a vertex coordinate of said triangle and by a coordinate of another given point, said 4 x 4 determinant is operated by said interference test operation means 3 and said interference point coordinate calculation means 4 is operated based upon the result of the interference test operating means. 2. A geometric processing apparatus as claimed in claim 1 characterised in that the interference test operation means 3 comprises a first determinant operation unit 31 for examining the relation between two planes that include the triangles. 3. A geometric processing apparatus as claimed in claim 2 characterised in that the interference test operation means 3 comprises a second determinant operation unit 32 for determining whether the two triangles which exist on the same plane interfere with each other. 4. A geometric processing apparatus as claimed in claim 2 or 3 characterised in that the interference test operation means 3 comprises a third determinant operation unit 33 for determining, when a plane including a first triangle interferes with a plane including a second triangle in the three dimensional manner, whether the first and second triangles interfere with each other. 5. A geometric processing apparatus as claimed in claim 4 characterised in that the interference test operation means 3 comprises a fourth determinant operation unit 34 for determining whether the first triangle interferes with a side of the second triangle. 6. A geometric processing apparatus as claimed in claim 5 characterised in that the interference test operation means 3 comprises a fifth determinant operation unit 35 for determining whether the first triangle interferes with a line segment that does not exist on the plane which includes the first triangle. 7. A geometric processing system comprising a data converter means which divides a plane forming a graphic model into one or a plurality of triangles by diagonal lines drawn from a vertex thereof, and which produces vertex coordinates of triangles a normal vector operation means which, relying upon the data from said means, finds normal vectors pointing outwards from said triangles and point at infinity coordinates thereof an interference test operation means which calculates values of 4 x 4 determinants as well as logic values of the determinants and interference point coordinate calculation means which operates relying upon the operated result of said interference test operation means wherein vertex coordinates of two triangles extracted from a figure for determining the interference condition and point at infinity coordinates thereof, are suitably selected to imagine a triangle, a 4 x 4 determinant is consituted by a vertex coordinate of said triangle and by a coordinate of another given point, said 4 x 4 determinant is operated by said operation means, and said interference point coordinate calculation means is operated based upon the operated result.

## Description
GEOMETRIC PROCESSING APPARATUS This invention relates to geometric processing apparatus that is, for example, adapted tovgraphic output and modelling systems. More particularly, the present invention relates to a geometric processing apparatus for detecting interference condition among figures. There has been a desire to display precisely desired figures since the widespread adoption of computer aided design CAD or computer aided manufacture CAM and a so called polyhedron approximated solid model has been employed by modelling figuresH and J to be displayed as shown in Figure 15 by using planes h11 h2, h3 h41 h5, h61 ... and j1, j , j j In a graphic output or modelling system used for CAD, CAM or for the production of animation, it has been attempted to constitute a new figure by adding the two independent graphic models or figures H and J together Fig. 16 a or by subtracting the two independent figures H and J Fig. 16 b . In reconfigurating the figures, it is important to grasp the overlapping or interference condition of the individual figures. Up until now interference among the graphic models has been examined by calculating each of the models using functions that represent boundary planes constituting the models. Complex computation is required, and the operation has to be carried out on a large scale. The present invention seeks to provide a geometric processing aparatus which is capable of uniformly determining the interference of figures that are represented by sets of planes. According to the present invention there is provided a geometric processing apparatus characterised by comprising a data converter means for dividing a plane forming a graphic model into a plurality of triangles To,TA by diagonal lines drawn from a vertex thereof, and for producing vertex coordinates of the triangles a normal vector operation means for receiving data from said data converter means and finding normal vectors pointing outwards of said triangles and infinity point coordinates thereof an interference test operation means for calculating values of 4 x 4 determinants as well as logic values of the determinants and interference point coordinate calculation means for operating on the result of said interference test operation means, the arrangement being such that, in operation, vertex coordinates of two triangles extracted from the graphic model for determining the interference condition and infinity point coordinates thereof, are selected to define a triangle, a 4 x 4 determinant is constituted by a vertex coordinate of said triangle and by a coordinate of another given point, said 4 x 4 determinant is operated by said interference test operation means and said interference point coordinate calculation means is operated based upon the result of the interference test operating means. The interference test operation means may comprise a first determinant operation unit for examining the relation between two planes that include the triangles. The interference test operation means may further comprise a second determinant operation unit for determining whether the two triangles which exist on the same plane interfere with each other. The interference test operation means preferably comprises a third determinant operation unit for determining, when a plane including a first triangle interferes with a plane including a second triangle in the three dimensional manner, whether the first and second triangles interfere with each other. In the preferred embodiment the interference test operation means comprises a fourth determinant operation unit for determining whether the first triangle interferes with a side of the second triangle Further, there may be provided interference test operation means comprising a fifth determinant operation unit for determining whether the first triangle interferes with a line segment that does not exist on the plane which includes the first triangle. The invention is illustrated, merely by way of example, in the accompanying drawings, in which Figure 1 is a block diagram of one embodiment of a geometric processing apparatus according to the present invention Figure 2 is a block diagram of an interference test operation device used in the apparatus of Figure 1 Figures 3 to 12 are flow charts illustrating the operation of the apparatus of Figure 1 Figure 13 is a diagram which illustrates the division of figures by a geometric processing apparatus according to the present invention Figure 14 is a diagram for defining triangles that will be operated upon by geometric processing apparatus according to the present invention Figure 15 is a perspective view showing examples approximated to polyhedrons and Figure 16 is a diagram showing examples of synthesised figures. Referring first to Figure 13 there is shown the division of figures by a geometric processing apparatus according to the present invention. First, boundary planes L, M forming polygons that represnt figures are, respectively, divided into triangles Tot T1, T2, ... and TA, TB, Tc, ... with their vertex as a starting point and other vertices as ending points. If the triangle To representing one figure is regarded as a major triangle, the triangleTA representing another figure is regarded as a dependent triangle, and whether the two figures interfere with each other or not is determined by calculating 4 x 4 determinants. When they interfere, coordinates of the interference points are determined. Figure 1 is a block diagram of one embodiment of a geometric processing apparatus according to the present invention. A data converter circuit 1 divides a polygon Fig. 13 which defines an approximated polyhedron, into triangles by diagonal lines, and forms coordinates VO XO, YO, ZO , V1 X1, Y1, Z1 , V2 X2, Y2, Z2 and VA XA, YA, ZA , VB XB, YB, ZB , VC XC YC, ZC of three vertices of each of the two triangles TO,TA, the interference of which is to be investigated as shown in Figure 14, and that produces outputs to an input data table Table 1 . Table 1EMI4.1 tb SEP XO SEP XA tb SEP Vertex SEP YO SEP Vertex SEP YA tb SEP VO SEP ZO SEP VA SEP ZA tb SEP X1 SEP XB tb Triangle SEP Vertex SEP Y1 SEP Triangle SEP Vertex SEP YB tb TO SEP V1 SEP 21 SEP TA SEP VB SEP ZB tb SEP X2 SEP XC tb Vertex SEP Y2 SEP Vertex SEP YC tb V2 SEP Z2 SEP VC SEP ZC tb An operating unit 2 for operating normal vector pointing outwards uses data of vertex coordinates from the data converter unit 1, finds the areas of the triangles, finds the vectors that represent the directions of triangles with the side toward the reader as the positive direction when the vertices are followed in the counterclockwise direction, i.e., finds normal vectors pointing outwards of the triangles N nX, nY, nZ nx YO ZO 1 whereEMI4.2 tb Y1 SEP Z1 SEP 1 tb Y2 SEP Z2 SEP 1 tb EMI5.1 SEP ZO SEP XO SEP 1 tb ny SEP SEP Z1 SEP X1 SEP 1 tb Z2 SEP X2 SEP 1 tb SEP XO SEP YO SEP 1 tb Hz SEP SEP X1 SEP Y1 SEP 1 tb X2 SEP Y2 SEP 1 tb and finds homogeneous coordinates nx, ny, HZ, O of points at infinity in the direction of the normal vector pointing outwards. Reference numeral 3 denotes an interference test operation unit which, based upon the vertex data of triangles and normal vectors pointing outwards, determines the interference condition among the interior of triangles, sides and vertices relying upon the 4 x 4 determinant, which writes the interference condition onto an interference condition table Table 2 , and which, when they interfere simultaneously, requests an interference point coordinate calculation unit 4 to calculate interference point coordinates. Table 2EMI5.2 Triangle tb SEP Sides SEP Vertices tb SEP TA SEP EA SEP EB SEP EC SEP VA SEP VB SEP VC tb SEP T0 SEP tb SEP E0 SEP tb SEP Sides SEP 1 SEP tb Triangle SEP Vertices SEP E2 tb SEP VO tb SEP V1 tb SEP 2 SEP tb The principle for operating the interference test operation unit 3 will now be described. A 4 x 4 determinantEMI6.1 x SEP y SEP z SEP 1 tb A SEP A SEP A tb XO SEP y0 SEP z0 SEP 1 tb X1 SEP Y1 SEP Z1 SEP 1 SEP ... SEP 1 tb X2 SEP Y2 SEP Z2 SEP 1 tb is constituted for a plane that includes three points Vg XO, YO, ZO , V1 X1, Y1, Z1 and V2 X2, Y2, Z2 and for a given point VA XA, YA, ZA and tree dimensional space the determinant representing the relation between the point VA and the triangle To defined by vertices VO V1, V2 is hereby referred to as SAO12 . If the result of the operation is a SAO12 D, the pointVA exists on a plane that includes the triangle Tg, b if the result is SAO12 O, the point VA exists ahove the plane that includes the triangle Tot and c if the result is SAO12 O, the point V A exists below the plane that includes the triangleTo. Figure 2 is a block diagram of the interference test operation unit 3. A first determinant operation unit 31 examines the relation between two planes that include triangles. The first determinant operation unit 31 constitutes a determinant which is given by determinant 1 above in order to determine whether three verticesVA, VB and VC of the triangle TA exist on the plane which include the triangle TO and whether vertices VO V1 and V2 of the triangleTo exist on the plane that includes the triangle TA, based upon three vertices VO V1, V2 and three vertices VA7 VB V C of the triangles To and TA. The first determinant operation unit 31 examines whether the following condition SAO12 O SBO12 0 SCO12 0 SOABC 0 S1ABC 0 S2ABC 0 ...12 holds true relying upon the 4 x 4 determinants. When the above condition holds true, the first determinant operation unit 31 determines that the two triangles TO,TA exist on the same plane, and direct data to a second determinant operation unit 32. When the above condition does not hold true, the first determinant operation unit 31 determines that the planes which include triangles interfere with each other in a three dimensional manner, and sends data to a third determinant operation unit 33.The second determinant operation unit 32 determines whether the two trianglesTo and TA that exist on the same plane interfere with each other, i.e. whether they overlap at least partially or not. The second determinant operation unit 32 sends data relating to three sidesEO E1, E2 and vertices VO, V1, V2 of the triangle Tot and the data related to three sides EA, EB, E C and vertices VA, VB, V C of the triangle TA to a fifth determinant operation unit 35 which determines whether the two triangles Tot TA interfere with each other on a plane. The determined results are sent to the interference condition table Table 2 . The third determinant operation unit 33, when a plane including the triangle To interferes with a plane that includes the triangleTA in a three dimensional manner, determines whether the triangle Te and the triangle TA interfere with each other or not. The third determinant operation unit 33 sends data relating to the three sides Eg, E1, E2 and end points VO, V1, V2 of the triangle and and the data relating to the three sides EA, EB, EC and end points VA, BV, VC of the triangle TA to a fourth determinant operation unit 34 which determines whether the two triangles T and TA interfere with each other or not.The thus determined 0 A results are sent to the interference condition table Table 2 . The fourth determinant operation unit 34 determines whether the triangle To interferes with a line segment that exists independently of the triangle, ie. whether the triangle To inter feres with the side B of the triangle T . The fourth determinant A A operation unit 34 determines whether a starting point coordinate V and an ending point coordinate VB of the side B A establish A the following condition SA0l2 O t SB0l2 0 ... 3 for the triangle Tot relying upon the 4 x 4 determinants.When the above condition holds true, the fourth determinant operation unit 34 determines that they are on the same plane, and transfers the data to the fifth determinant operation unit 35. When the above condition does not hold true, the fourth determinant operation unit 34 determines that they are not on the same plane, and transfers the data to a sixth determinant operation unit 36 and, at the same time, sends the determined results to the third determinant operation unit 33. The fifth determinant operation unit 35 examines the relation between the triangle To and the side EA that exists on a plane that includes the triangle TO, The fifth determinant operation unit 35 expands the triangle To into three sides EO, E1, E2 r transfers the data to a seventh determinant operation unit 37 to have the latter determine whether the sides EO, E1, E2 interfere with the side B A of the triangle TA or not, and, at the same time, transfers the data to an eighth determinant operation unit 38 to have the latter determine whether the coordinates VA, VB of the side EA exist inside the triangle To or not. Based upon the operating results of the seventh and eighth determinant operation units 37,38, the interference condition of the triangle To andTA is determined, and the determined results are sent to the interference condition table Table 2 and to the second and fourth determinant operation units 32,34. The sixth determinant operation unit determines whether the triangle To interferes with the line segment B A that does not exist on the plane which includes the triangle To The sixth determinant operation unit 36 determines whether a starting point exists on one side of the plane which includes the triangle Tor an ending point exists on the other side, and whether either the ending point or the starting point exist inside the space defined by three planes formed by the starting point or the ending point of the segment and by two vertices of the triangle.The sixth determinant operation unit 36 determines whether the following condition SA012 0 SB012 0 SB01A 0 SB12A 0 SB20A 0 SB012 0 SA012 0 SA01B 0 SA12B 0 SA20B 0 ............................. 4 holds true or not, relying upon the 4 x 4 determinants. When the above relation holds true, the sixth determinant operation unit 36 determines that the triangle T0, interferes with the line segment EAT and produces the determined results to the interference condition table and further requests, at the same time, the interference point calculation unit 4 to calculate the coordinates of interference points. The seventh determinant operation unit 37 determines whether two line segments that exist on the same plane interfere with each other or not. The seventh determinant operation unit 37 assumes two triangles under the conditions where the line segment EA is defined by two end points VA, VB the line segment E0 is defined by two end points V0 V1, one line segment serves as a side, and end points of the other line segment serve as vertices, and determines whether the following condition SN01A 0 SN01B 0 SN01A 0 SN01B 0 SNAB0 0 SNAB1 0 SNAB0 0 SNAB1 0 ... 5 holds true, relying upon the 4 x 4 determinants.When the above condition holds true, the seventh determinant operation unit 37 determines that the two line segment interfere with each other on a plane, and requests the interference point calculation unit 4 to calculate the coordinate of the interference point and, at the same time, sends the determined result to the interference condition table and to the fifth determinant operation unit 35. The eighth determinant operation unit 38 determines whether a point V that exists on a plane which includes a triangle A is located inside or outside the triangle Tow The eighth determinant operation unit 38 assumes a triangle formed by the point V A and the sides Eg, E1. E2 of the triangle Tg, and determines whether the following conditionEMI10.1 holds true, relying upon the 4 x 4 determinants When the above condition holds true, the eighth determinant operation unit 38 determines that the point exists inside the triangle.When the above condition does not hold true, the eighth determinant operation 38 determines that the point exists outside the triangle, and sends the determined results to the interference condition table and to the fifth determinant operation unit 35. A ninth determinant operation unit 39 determines in what relation a point exists with respect to a plane which includes a triangle. The ninth determinant operation unit 39 determines the following conditions a 5A012 0 b SAO12 O ....... 7 c SAO12 0 with respect to the triangle and the point, relying upon the 4 x 4 determinants. If the condition a holds true, the ninth determinant operation unit 39 determines that the point exists above the plane, if the condition b holds true the ninth determinant operation unit 39 determines that the point exists on the plane, and if the condition c holds true the ninth determinant operation unit 39 determines that the point exists below the plane.The ninth determinant operation unit 39 then sends the determined results to the interference condition table Table 2 and to the sixth, seventh and eighth determinant operation units 36,37,38. The ninth determinant operation unit 39 further determines whether the vertex of the original figure is convex or concave, i.e., calculates the conditions a 5N012 0 b SNO12 O c SNO12 O with regard to a vertex e.g. V1 of a polygon and the neighbouring two vertices e.g. VO V2 . If the condition a holds true, the ninth determinant operation unit 39 determines that the vertex is convex, if the condition b holds true, the ninth determinant operation unit 39 determines that the vertex is linear, and if the condition c holds true, the ninth determinant operation unit 39 determines that the vertex is concave. Reverting to Figure 1, the interference point coordinate calculation unit 4 performs the operation in accordance with an equation P V A V B VA x SAO12 A012 SBO v 8 for the request of interference point calculation from the seventh determinant operation unit 37, and which performs the operation in accordance with the equation P V V V x S A B A NOlA SNO1A SNO1B VO V1 VO x 2NABO SNABO SNAB1 .............. 9 for the request from the sixth determinant operation unit 36, in order to find interference point coordinate P x, y, z .The intereference point coordinate calculation unit 4 then sends outputs to an interference point coordinate table Table 3 . Table 3EMI12.1 TA SEP BA SEP EB SEP Bc SEP tb SEP To tb SEP EO tb SEP E1 tb SEP E2 tb An output unit 5 produces data of the interference condition, and stores outputs from the interference test operation unit 3 and from the interference point coordinate calculation unit 4 in the interference condition table and in the interference point coordinate table. The output unit 5 further stores in an arranged manner the volume of a tetrahedron formed by a triangle incidentally calculated through the step of operation and by another point as well as unit normal vectors pointing outwards in a characteristics value table Table 4 . Table 4EMI13.1 tb SEP T0 SEP TA SEP tb A tb V tb N tb Operation of the thus constructed geometric processing apparatus will be described below in conjunction with flow charts shown in Figures 3 to 12. Upon receipt of data representing two models having an interference condition which is to be examined, the data converter unit 1 divides the respective models into a plurality of triangles by diagonal lines, to produce coordinate data of vertices VO V1, V2 and VA, VB V C of the triangles To TA. Based upon the coordinate data, the operating unit 2, operates normal vectors Not N A pointing outwards and, at the same time, normalises the vector values to store them in the characteristic value table Table 4 .Upon receipt of data related to vertices VO V1, V2 and VA, VB VC of triangles Tot TA, and outwardly pointing normal vectors Not NA, the interference test operation unit 3 executes an interference test. Based upon the data of vertices VO V17 V2 and VA, VB VC the first determinant operation unit 31 performs the operation in accordance with condition 2 SAO12 SBO12 O SC012 SOABC O S1ABC O S2ABC When the above condition holds, the first determinant operation unit 31 determines that the triangles To and TA exist on the same plane, and transfers the operation to the second determinant operation unit 32.When the above condition does not hold, the first determinant operation unit 31 determines that the trianglesTo and TA do not exist on the same plane, and transfers the operation to the third determinant operation unit 33 Figure 3 . I. When the triangles To and T exist on the same plane 0 A The second detorminant operation unit 32 expands the triangle TO into three sides E0, E1, E2 and vertices V0, V1, V2, expands the triangle TA into three sides EA, EB, EC and vertices VA, VB, VC, and once transfers the control to the fifth determinant operation unit 35. The fifth determinant operation unit 35 expands the triangle To that is received from the second determinant operation unit 32 into three sides and transfers them to the seventh determinant operation unit 37.The fifth determinant operation unit 35 further expands the three sides EA, EB, EC into end points VA, VB, Vc, and transfers them to the eighth determinant operation unit 38. Based upon the sides EO, E1, E2 and the sides EA, EB, EC of the two triangles Tor TA that are received, the seventh determinant operation unit 37 determines whether the sides forming the triangles are interfering with each other. When the sides interfere, the seventh determinant operation unit 37 requests the interference point coordinate calculation unit 4 to calculate the interference point coordinates. The eighth determinant operation unit 38 determines whether the end points VA, VB, V C exist inside or outside the triangle To.The determined results of the seventh determinant operation unit 37 and of the eighth determinant operation unit 38 are sent to the fifth determinant operation unit 35 which determines whether the triangle To interferes with the side BA of the triangle TA The thus determined result is sent to the second determinant operation unit 32 with determines whether the triangle To and the triangle TA interfere with each other on the same plane Figures 4, 7 and 9 . The determined results are sent to the interference condition table Table 2 , and the interference point coordinates are sent to the interference point coordinate table Table 3 and are stored therein respectively. Xl. When the triangle To and the triangle T do not exist on A the same plane. The third determinant operation unit 33 expands the triangleTo into three sides Eo B11 E2 and vertices VO, V1, V2, and once transfers the control to the fourth determinant operation unit 34 which determines whether the triangle To that is received and the side BA of the triangles exist on the same plane or not. When they exist on the same plane, the fourth determinant operatin unit 34 transfers the control to the fifth determinant operation unit 35 which executes the interference test on the plane through the same steps as mentioned in I above.When the triangle To and the side BA do not exist on the same plane, on the other hand, the fourth determinant operation unit 34 transfers the control to the sixth determinant operation unit 36 which determines whether the triangle To and the side B A interfere in a three dimensional manner or not. When it is determined that they interfere with each other in a three dimensional manner, the sixth determinant operation unit 36 requests the interference point calculation unit 4 to calculate the coordinates of interference points. The determined results of the fifth and sixth determinant operation units 35,36 are sent again to the fourth determinant operation unit 34 which determines whether the triangle To and the side B A interfere with each other or not. The determined result of the fourth determinant operation unit 34 is further sent to the third determinant operation unit 33 which determines whether the triangles To and TA interfere with each other in a three dimensional manner or not Figures 5, 6 and 8 . The determined results are sent to the interference condition table Table 2 , and coordinates of interference points are sent to the interference point coordinate table Table 3 , and are stored therein, respectively. The operation steps I and II are then selectively adapted to the triangles divided by diagonal lines, in order to determine interference condition on all of the planes constituting figures. Based upon the data from the sixth, seventh and eighth determinant operation units 36,37,38, the ninth determinant operation unit 39 performs side tests Figure 11 of points for a plane that includes triangles and performs concavity tests Figure 12 . According to the geometric processing apparatus described above, figures of which the interference condition is to be investigatedaredivided into triangles by diagonal lines drawn from vertices thereof to obtain data related to the vertex coordinates thereof, normal vectors pointing outwards, and points at infinity of the vectors. Therefore, interference condition among complex figures can be determined through the uniform process relying upon the 4 x 4 determinant operation. Accordingly, a graphic processing operation can be executed simply and at high speeds, making it possible to form, analyze and display polyhedral models at high speeds and easily.