# ENTROPY GUIDED DECONVOLUTION OF SEISMIC SIGNAL

## Claims
Geophysikalisches Explorationsverfahren umfassend

## Description
The invention relates to seismic exploration for oil, gas and other underground resources as disclosed in WORLD OIL, 199, Nov. 1984, pp.83 88 and to improving seismic mapping of subsurface formations by the use of a deconvolution technique which gives good results even when the observed seismic signals are not minimum phase or highly non Gaussian. In a broader sense, one aspect of the invention relates to improving a signal resulting from the physical interaction convolution of an unknown wavelet with an unknown stationary random sequence such that the smoothing effect of the wavelet can be removed, or at least substantially removed, and the random sequence can be revealed. In that sense, the wavelet resulting from the explosion which can be used in seismic exploration is an example of an unknown wavelet, the positions of the subsurface seismic reflectors are an example of the members of a stationary random sequence, and the signal to be improved is the seismic trace based on surface measurements of the seismic signal resulting from the interaction convolution of the wavelet caused by the explosion and the subsurface reflectors at the interfaces of subsurface layers having different acoustic properties . Other aspects of the invention are addressed in the detailed description below. Subsurface reflection seismology involves mapping of subsurface formations on the basis of the arrival times of events reflected from subsurface layers. Seismic energy generated at the surface penetrates the earth s layered media and some of it is reflected back at the interfaces between layers. The reflected energy arriving at the surface is measured by receivers detectors at the surface. On land, seismic energy typically is generated by chemical explosions, vibrating machines or thumping devices. Preplaced receivers, also called detectors or geophones, arranged in an array or spread, detect the seismic energy which comes back. At sea, a source such as an array of air guns is actuated every few seconds as the ship moves over a predetermined course. The returning seismic energy is picked up by detectors embedded in a cable a streamer , trailing the ship. The complexity of the subsurface structure and the noise and other imperfections of the observed signals make it necessary to process these signals through a number of operations, each involving serious approximations and shortcuts, before a useful map of the subsurface formations can be deduced. One major operation in such signal processing is velocity analysis, made necessary by the fact that the seismic signal observed at the surface shows the reflection events as a function of time, and must be converted into a function of depth in order to derive a more useful map of the subsurface structure. However, seismic waves have a velocity which is very much dependent on the propagation medium, and velocity changes significantly as the waves travel into the earth. Generally, the velocity increases with depth, although occasionally there may be layers in which a decrease in velocity occurs. For a given surface point, the velocity plotted as a function of depth is typically called the velocity function. Thus, there are two important variables time of reflected events and velocity. From knowledge of these variables, the depth to the reflecting horizons can be determined. Because there are important lateral changes in velocity, and the velocity function varies from one location to another, a given velocity function cannot be assumed to be valid for the entire prospect but must be continuously corrected from place to place over the area of exploration. When a deep enough borehole is available in the right place and can be logged, the velocity function can be estimated from the outputs of seismic detectors placed in the hole at various depths, or by vertical seismic profiling VSP . In most cases, however, it is necessary to estimate the velocity function by measurements confined to the surface, and by subjecting these measurements to sophisticated signal processing. Velocity analysis results are also used in the so called dynamic corrections outlined immediately below. Another major operation in processing the observed signals involves corrections applied to the receiver outputs. The so called static corrections include a source correction and a detector correction, the combined effect of which is to put the seismic signal source and the seismic signal detectors in a fictitious horizontal plane. In practice, this is done by appropriately time shifting the respective receiver outputs. The dynamic corrections convert each receiver output to the output that would have been received if the source and receiver were at the same lateral point, e.g., the point midway between the actual source and receiver locations. In this conversion the traces are considered as made up of primary reflections, i.e., reflections resulting from a raypath from the source down to the reflecting horizon and then directly up to the receiver. If the layers are horizontal, then all the reflection points or depth points are directly beneath the midpoint between source and receiver. If the layers are dipping, then the depth points are offset from this midpoint. The dynamic corrections therefore depend on both the velocity function and the dip of the reflecting beds. The component of correction due to the separation of source and receiver is called the normal moveout correction, and the component due to dip is called the dip correction. Thus, four important corrections to the recorded traces detector outputs are the source corrections, receiver corrections, normal moveout corrections, and dip corrections. Each observed signal recorded trace can be considered as a time series made up of reflected events together with various interfering waves and noise. The desired reflected events are the primary reflections, that is waves that travel directly down to a given reflector and then directly back up to the surface where they are recorded. An important type of undesired interfering wave is the multiple reflection, which has a raypath that goes down to a given reflector, then up to another reflector, then down to a reflector, then up again, possibly with additional up and down paths, until the multiply reflected event reaches the surface and is recorded. In any layered system there can be infinitely many possible multiple reflections. The presence of such multiple reflections makes the identification of primary reflections difficult. Accordingly, it is necessary to attenuate the multiples as much as possible. To facilitate the extraction of the useful signal, typically multifold coverage is recorded by laying out a source and a spread of detectors, activating the source and recording the detector outputs, then moving the entire configuration laterally, along the detector line, and repeating the process. When the configuration is moved in small enough increments between shots, each depth point can be covered several times, thereby introducing considerable redundancy which allows subsequent enhancement of the primary events and suppression of multiple events. If all the traces in the prospect are segregated or gathered into sets called gathers such that all traces within a given gather have a common midpoint between source and receiver, the appropriate moveout correction should convert each trace in a given gather into about the same equivalent trace, namely that primary reflection trace which would have been received if source and receiver were directly at the common midpoint in question. Stated differently, the primary reflections of all the traces after appropriate moveout should tend to be in phase while the multiples should tend to differ as between traces and therefore should typically be out of phase. If this approach is used for the normal moveout correction first, then it can also be applied to making the appropriate source, receiver and dip corrections by different gatherings of the traces. Alternately, a simultaneous corrections approach can be used, either directly or through using iterative techniques. If the corrected traces in a common midpoint gather are added up, the result should be severe attenuation of the multiple events, because they should be out of phase with each other, and amplification of the primary events, which should be in phase with each other if the gathers were properly selected and corrected. Thus one output trace for each midpoint can be produced which is called the stacked trace for that midpoint. A special kind of multiple reflection is the so called reverberation. One conceptualization of reverberation is energy which gets trapped in the near surface layers and keeps being reflected up and down. This energy can become attached to the primary reflections as they travel through the near surface layers. As a result, instead of being sharp and clear and with good time resolution, the observed reflections are followed by long reverberation trains. These trains overlap with the trains of succeeding reflections, and thus the whole seismic trace observed signal can be given a ringing or sinusoidal character which makes it difficult or impossible to pick out the onset of the primary reflections. Cancelling the energy of each reverberation train, but leaving intact the primary reflection, can increase the resolution of all the reflected events. This process of cancelling the reverberation trains typically is called deconvolution, and can be thought of as the inverse of the geophysical process of convolving i.e., rolling together or interacting the source wavelet with the subsurface formations. However, as will become clearer below, this is not the mathematical process of deconvolution. One known type of deconvolution is based on considering a wavelet of the observed signal as made up of a primary reflection with its attached reverberation. With this assumption, the wavelet should be minimum delay, in the sense that most of its energy is concentrated in its initial part. Moreover, all such wavelets should be similar in overall shape. Because the primaries result from geologic beds believed laid down with irregular thicknesses, the arrival times of the primary events should be effectively random. Hence, the auto correlation function of the trace should be about the same as the auto correlation function of the wavelet, and so from this auto correlation function one can estimate the required inverse deconvolution operator. The application of this operator to the trace should yield the deconvolved trace, namely a trace where the reverberation components of the wavelets have been removed, thereby increasing the resolution of the primary reflections. The process of deconvolution can be extended to remove certain long period multiple reflections as well. In practice, deconvolution can be applied to the seismic traces either before or after stacking, depending upon cost and other considerations. After deconvolution, the processed signals typically are subjected to a technique called migration or depropagation, which can be conceptualized as a process of propagating the waves observed on the surface backward in time into the earth to the underground structure, to reveal the actual spatial position of the subsurface reflection points at depth. This process can also be described as the transformation of signals observed at the surface to signals which would have been observed at depth. As discussed in an article by the inventor herein Wiggins, R.A., Minimum Entropy Deconvolution, Geoexploration, 16 1978 21 35 , if the source wavelet is known at least approximately, then wavelet shaping by estimating a least squares or Wiener inverse of the source wavelet can lead directly to a good estimate of the desired signal. If the source wavelet is minimum phase or minimum delay, and the desired signal is approximately white, then predictive deconvolution can be used. If the amplitude spectrum of the source wavelet is smooth with respect to that of the desired signal, then homomorphic deconvolution can be utilized. When the desired signal consists of a few large spikes and the ensemble of sample signals exists for which the time separations between the spikes differ while the source wavelet shape remains constant, then minimum entropy deconvolution can be used in the manner described in detail in the article. Further background information can be found in the references cited at pages 34 and 35 in the Wiggins article. Yet further background information can be found in Robinson, E.A., et al., Deconvolution of Geophysical Times Series in the Exploration for Oil and Natural Gas, Elsevier Scientific Publishing Co., 1969 and in Robinson, E.A., Time Series Analysis and Application, Goose Pond Press, 1981. The Wiggins article and said Robinson and Robinson et al. books are hereby incorporated by reference in this specification. The known deconvolution processes applied to seismic traces are believed to have a number of shortcomings. For example, they are not believed to work well with seismic traces which are not minimum phase delay or sufficiently non Gaussian, and different signal processing techniques must be applied depending on which one is the case. Moreover, it is believed that the known processes suffer from complexity and insufficient accuracy. Accordingly, an important object of this invention is to provide an improved technique of deconvolving the result of the convolution of a wavelet and a non Gaussian random process, such as the result of the interaction of a seismic source wavelet with the subsurface reflectors, in a manner which works well for all or most typical seismic traces, uses the same approach regardless of the type of trace, processes a trace only as long as needed to deconvolve it sufficiently, and operates rapidly and efficiently. In a broader sense, an important object is to find a practical solution to the so called blind deconvolution problem, encountered when an observed or measured signal can be considered for practical purposes to be the result of the convolution interaction of an unknown wavelet with a stationary random sequence. The goal is to remove the effects of the wavelet to an extent which would allow the underlying random sequence to be revealed and examined free, or substantially free, from the smoothing effects of the wavelet. The invention is particularly useful in solving in a practical manner a long standing problem in seismic exploration, but is also useful in other fields of geophysical exploration making use of acoustic signals and other signals which get contaminated by an interaction with wavelets which can be treated for practical purposes as convolution. In conceptual terms, and as applied to seismic exploration, the improved deconvolution technique involves finding what can be characterized as an inverse filter which, when applied to the observed signal, changes it to a good estimate of the reflectivities and locations in time of the depth points producing primary reflections giving rise to the observed signal. In practicing one nonlimiting example of the invention, this is done by successively modifying the observed signal by two term operators. The first operator is chosen on the basis of the observed trace and beliefs as to the entropy of the expected reflectivity series, and is applied to the observed signal to produce a modified observed trace. The second operator is chosen on the basis of the modified observed trace and similar entropy considerations, and is applied to that modified trace to produce a new modified trace. The third operator is chosen on the basis of the last modified observed signal and similar entropy considerations and is applied to the last modified observed signal to produce yet another modified observed signal, and so on until no significant further improvement is apparent. The latest modified observed trace is then a good estimate of the reflectivities and locations in time of the subsurface reflectors of interest. Each two term operator can be of the form 1,0,0,...,a or a,0,0,...,1 , where the separation between its 1 and a terms is determined from the lag of the maximum deviation of the auto correlation of the most recently modified if at all observed signal, and the amplitude of the term a is found from other characteristics of the most recently modified observed signal e.g., its auto correlation . Which of the possible operators is used in a given run through the process is determined on the basis of which gives less entropy of the modified observed signal, and this can be estimated, for example, by using a Varimax measure. The major steps of a particular nonlimiting example of practicing the invention, as applied to seismic exploration, are as follows Fig. 1 illustrates in schematic form certain relevant aspects of a system for reflection seismic exploration on land. Fig. 2 illustrates a a plot of an observed signal which is a mixed phase wavelet, and b a plot of the auto correlation of the observed signal. Fig. 3 illustrates a a1 a plot of a modified observed signal formed by convolving the observed signal of Fig. 2 with the operator c1 of Fig. 3, having the form 1,0,0,...,a a2 a plot of the same observed signal of Fig. 2 convolved with the operator c2 of Fig. 3, having the form of a,0,0,...,1 b a plot of the right half of the auto correlation of the modified observed signals in Fig. 3 a1 or a2 , which have the same auto correlation c1 a plot of the operator which is derived from the auto correlation function illustrated at b in Fig. 2 and has the form 1,0,...,0,a and c2 a plot of the operator which is also derived from the function illustrated at b in Fig. 2 but has the form a,0,...,0,1 . Fig. 4 illustrates a1 a plot of the modified observed signal formed by convolving the modified observed signal of Fig. 2 having the larger Varimax measure shown at a1 in Fig. 3 with the operator derived from the auto correlation function shown at b in Fig. 3 when used in the form 1,0,...,0,a a2 a plot of the signal formed by convolving the same signals as in a1 but with the operator having the form a,0,...,0,1 b a plot of the auto correlation of the signals illustrated at a1 and a2 in Fig. 4 c1 a plot of the accumulated operator formed by convolving the operator of Fig. 3 which gives the large Varimax measure shown at c1 in Fig. 3 with the operator which is derived from the auto correlation function illustrated at b in Fig. 3 and has the form 1,0,...,0,a and, c2 a plot of the accumulated operator which corresponds to that in c1 but has the form a,0,...,0,1 . Fig. 5 illustrates the same types of curves as Fig. 4, but derived at a later stage of the process, after seven iterations. Fig. 6 illustrates a flow chart of the major steps involved in processing observed signals to deconvolve them and produce a seismic map. Fig. 7 illustrates the nature of possible types of observed signals. Fig. 8 illustrates the identification and treatment of a nearly all pass wavelet. Fig. 9 illustrates the treatment of a wavelet which has a complex factorization. Fig. 10 illustrates the usefulness of the invention with observed signals within a certain Gaussian parameter. Fig. 1 illustrates a typical arrangement for reflection seismic exploration on land making use of an exemplary embodiment of the invention. A source of seismic energy 10 is on the earth s surface, and can be a truck using a vibrator for imparting mechanical vibrations to the earth, as in the so called Vibroseis technique, or can be any other suitable source of seismic energy. A wave of seismic energy travels downwardly into the subsurface formations 12, 14 and 16. Several raypaths of this wave are illustrated raypath 18a propagates downwardly to the interface between layers 12 and 14 and returns back to the surface as reflected raypath 18b a primary reflection and is received at surface geophone 20 and raypath 22a propagates downwardly to the same reflector and then goes up to detector or receiver 24 as reflected raypath 22b another primary reflection . Similar raypaths are illustrated as going down to the reflectors between layers 14 and 16 and at the bottom of layer 16 and going up to receivers 20 and 24 as primary reflections. In addition, a multiple reflection received at a detector 26 is shown raypath 28a goes down to the reflector at the bottom of layer 16, up as ray 28b, down as ray 28c, up again as ray 28d, down again as ray 28e, and up again as ray 28f. For simplicity, the refractions of the raypaths as they go from one layer into another are not illustrated. The outputs of the geophones can be amplified at one or more amplifiers schematically shown at 30, and can be filtered at one or more filters schematically shown at 32 and digitized at 34 before being sent to a storage and processing system schematically shown at 36. After a suitable number of seismic energy impulses have been imparted to the earth at a particular location and recorded by suitable receivers, the energy source 10 is moved to a new location. The receivers can also be moved to respective new locations, and the process can be repeated to get multifold coverage of the subsurface formations of interest. Assuming for simplicity that the outputs of the receivers have been processed through known techniques through the stacking step, assume that a stacked trace can be plotted as a time sequence which includes a wavelet having the shape illustrated at 40 0 in Fig. 2, where the vertical axis is amplitude and the horizontal axis is time increasing to the right. Due to a variety of interfering factors and noise, including reverberation of the seismic energy in the topmost few layers, the stacked trace by itself is not an adequate time map of the reflecting events or of the reflectivities and locations in time of the subsurface reflectors. Assume that in this case the stacked trace 40 0 the observed signal or, more accurately in this case, the illustrated portion thereof is a mixed phase wavelet rather than a minimum phase delay wavelet and is not so highly non Gaussian that minimum entropy deconvolution would work well. In accordance with one exemplary embodiment of the invention, an observed signal such as stacked trace 40 0 is modified by applying to it a succession of operators, each succeeding operator being applied to the observed signal as cumulatively modified by the application of each preceding operator, where each operator is selected on the basis of the extent to which its application reduces entropy, and this modifying is continued for as long as sufficient reduction in entropy is achieved, so that the resulting cumulatively modified observed signal can be used as a good estimate of the amplitudes and locations in time of the relevant subsurface reflectivities. To this end, in order to derive the zero order operator, observed signal 40 0 at line a of Fig. 2 is auto correlated to derive curve 42 0 at line b , which illustrates only the right hand side of the auto correlation results. The term a of the two term operator of interest is derived from curve 42 0 in the manner briefly described above and described in greater detail below. In Fig. 3 curve 40 1 at line a1 is the observed signal 40 0 as modified by applying thereto the two term operator 1,0,...,0,a illustrated at 44 1 at line c1 in Fig. 3 and curve 40 1 at line a2 is the modified observed signal obtained in the same manner except that the two term operator is of the form a,0,...,0,1 illustrated at 44 1 at line c2 in Fig. 3. Curve 42 1 at line b in Fig. 3 is the auto correlation the right hand half only of curves 40 1 and 40 1 , which have identical auto correlations. As illustrated in Fig. 3, the Varimax measure V for the modified observed signal at 40 1 is larger than that for the modified observed signal at 40 1 , and hence the operator having the form 1,0,0,...,a , which was used to modify observed signal 40 0 to produce observed signal 40 1, is chosen for further use. In Fig. 4, curve 40 2 at line a1 illustrates the result of convolving the curve of Fig. 3 having the larger Varimax measure curve 40 1 at line a1 of Fig. 3 with the two term operator derived from the auto correlation function 42 1 at line b in Fig. 3 when used in the form 1,0,...,0,a . Curve 40 2 at line a2 in Fig. 4 is the modified observed signal resulting from convolving the same curve of Fig. 3 with the larger Varimax measure curve 40 1 with the same two term operator derived from curve 42 1 in Fig. 3 but having the form a,0,...,0,1 . In Fig. 4, 44 2 at line c1 illustrates the accumulated operator formed by convolving i the two term operator 44 1 shown in Fig. 3 which leads to the larger Varimax curve 40 1 at line a1 in Fig. 3 with ii the two term operator which is derived from curve 42 1 in Fig. 3 and has the form 1,0,...,0,a . Curve 44 2 at line c2 in Fig. 4 illustrates the similarly accumulated operator formed in the same manner as 44 2 but using the two term operator which is derived from curve 42 1 and has the form a,0,...,0,1 . In Fig. 5 the illustrated curves, spikes and Varimax measures illustrate a later stage iteration in the process described in more detail below, and have the same relationship to those of the preceding stage iteration as that between Figs. 4 and 3. It is seen from Figs. 2 5 that the modified observed signal having the larger Varimax measure lower entropy in the respective figures tends to show more detail as additional two term operators are applied, and that the relevant accumulated operator 44 becomes more complicated. As seen in Fig. 5, the result after seven iterations passes through the process is a cumulatively modified observed signal 40 7 having significantly more detail than the original observed signal 40 0 in Fig. 2, and has a significantly larger Varimax measure, and hence lower entropy. The process can continue through additional iterations, for as long, as the Varimax measure of new modified observed signal shows a significant enough improvement, e.g., if the new Varimax measure is larger than the previous one by at least a selected threshold. The major steps of a non limiting example of a process embodying the invention, as applied in seismic exploration, are illustrated in Fig. 6, and start at step 50 with collecting the outputs of seismic receivers 1,2...,K, and supplying them to step 52 where they can be subjected, if desired, to conventional preprocessing, e.g. through the stacking step. At step 54 one stacked trace is used as the observed seismic signal y i , where i 1,2,...,I, and the samples y i of the digitized signal cover a period sufficiently long several seconds to allow for the return of primary reflections from the deepest reflector of interest. The sampling frequency is high enough to take into account for the highest frequency of interest in the analog version of observed seismic signal. At step 56 the now digitized observed seismic signal y i is subjected to auto correlation, using any of the suitable auto correlation techniques known in the art, to produce the auto correlation signal R yy i , which is also in digitized form and comprises samples identified by the index i. The lag d of the maximum deviation of this auto correlation function is then found in terms of the number of samples i separating the center lobe from the closest lobe to the right, e.g., the first positive or negative peak to the right , again using known techniques. Fig. 2 illustrates this lag d for the auto correlation function 42 0, and is the distance, in this example, from the origin to the largest positive or negative peak. Generally, it is preferred, but not essential, to use the distance to the largest in absolute value peak, whether positive or negative. However, it is possible to use, at least for some iterations, the distance to the first positive peak, or that to the first negative peak. At step 60 a check is made to determine if the term a approaches zero or infinity, as this can happen if the source wavelet is not a delta function but its auto correlation is a delta function. If the test at step 60 determines that the non zero and non unity term a of the two term operator does not approach zero or infinity, the process goes to step 62, to find if the Varimax measure V A , derived on the basis of an operator in which a is the last term, is greater than or equal to a selected multiplier B times the Varimax measure V A , derived on the basis of an operator in which a is the first term. The multiplier B can be, for example, 1.05. One con venient Varimax measure V is The identification and treatment in accordance with the invention of a nearly all pass wavelet present in the observed signal, is illustrated in Fig. 8. Wavelet X is a nearly all pass wavelet, in that its auto correlation R is nearly a spike. As known in the art, the presence of such a wavelet in the observed signal has little or no effect on the amplitude of the observed signal but can cause a significant phase shift. One practical way discovered as a part of the invention to confirm that an observed signal contains no all pass wavelet, is to examine the correlation of the wavelet or the observed signal with its cubed function. This correlation is designated G xx in Fig. 8. If no all pass wavelet is present, the correlation G xx should be as spike like as the auto correlation. This is not the case in the example of Fig. 8. The correlation G xx is not as spike like as the auto correlation of X, and this reveals the presence of the nearly all pass wavelet X This test detects the presence of an all pass wavelet even in considerably more complex functions resulting from the convolution of an all pass wavelet with another wave which is not all pass. Fig. 9 illustrates the effectiveness of the invented technique even with observed signals containing a wavelet which has a complex factorization. The 3 term wavelet A in Fig. 9 has a complex factorization. Prior art Wiener or least squares techniques are used to obtain the inverse B of wavelet A. The EGD inverse shown at C and derived in accordance with the invention by using the sequence of 2 term operators which are only real values gives the inverse C. Fig. 10 illustrates the effectiveness of the invented technique with observed signals having certain Gaussian characteristics. The residual wavelet in each case is the result of convolving the design wavelet with a 100 point random series, and then finding and applying a sequence of 2 term operators in accordance with the invention. The p values given in Fig. 10 identify the Generalized Gaussian parameter of the observed signal the result of convolving the design wavelet with the 100 point random series . As seen, the invention gives stable deconvolution at least where the observed signal has a p value less than about 1.5. The exemplary process described above in connection with Fig. 6 can be carried out by storage and processing system 36 illustrated schematically in Fig. 1, which can comprise a general purpose digital computer of suitable size and configuration, using the appropriate peripheral equipment needed to carry out the function described above. One example of a suitable digital computer is available from Digital Equipment Corporation under the designation VAX, and can carry out the process described above when programmed, e.g. by defining the steps of Fig. 10 in a suitable high level language such as Fortran and using available sub routines. In the alternative, some or all of the steps discussed above in connection with Fig. 10 can be implemented by hardwired and or firmwired circuitry. It should be noted that for drafting convenience the operators at lines c1 and c2 in Figs. 3 5 are illustrated as having some width along the time horizontal axis, while in fact they simply represent amplitudes with no width. In Figs. 8 10 a different representation is used, to show amplitude aligning the vertical axis with no suggestion of width. It should also be noted that in a special case it may be that the lag such as illustrated at d in Figs. 2 5 could happen to be so small that the terms of the two term operator will not be separated by zeroes. In such a case, the operator may have the form 1,a or a,1 , and it will be understood that such an operator is merely a special case of the operators 1,0,...,a or a,0,...,1 , and that such a special case is within the scope of this invention. A conceptual illustration is given in Fig. 7 of the effectiveness of the invented method as applied to seismic signals. As indicated, if seismic data tend to occupy the so labelled rectangle on the plot, the prior art minimum entropy and Wiener deconvolution techniques apply to a considerably lesser range of the data than the invented entropy guided deconvolution.