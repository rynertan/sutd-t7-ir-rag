# DATA MODEM SYSTEM

## Claims
Vorrichtung zum Empfangen und Demodulieren eines Information tragenden modulierten Datensignals mit einer vorgegebenen Modulationssymbolhäufigkeit, die eine Einrichtung 101, 103 zum Umsetzen des Signals in ein Digitalsignal aufweist, das ein analog moduliertes Trägersignal darstellt, dessen Trägerfrequenz ein ganzzahliges Vielfaches der Symbolhäufigkeit ist, wobei die Vorrichtung so betrieben werden kann, daß sie ein digital phasenmoduliertes Datensignal demoduliert, und aufweist

## Description
The present invention relates to data modems, and primarily to modems containing digital filters. The transmission of digital typically binary signals over a communications channel, such as a satellite link, generally involves modulating the digital signal onto a carrier and subsequently effecting a demodulation process to recover the original signal. Figure 1 of the accompanying drawings illustrates this process in block schematic form with the modulator block being referenced 1, the communications channel 2, and the demodulator block 3. Typical time domain and frequency domain signal representations for this process are shown in Figures 2 and 3 respectively. Considering first the form of binary signal to be transmitted over the communications channel 2, Fig. 2 A major drawback with the simple data modem described above is the excessive bandwidth occupied by the transmitted signal see Figure 3 It can be shown that for optimum system performance, the desired spectral shaping introduced by the modem filters should be equally split between the modulator and the demodulator. One way of providing filters with the desired spectral shaping characteristics is to calculate the corresponding required filter impulse response and then to construct a filter, known as a transversal filter, which generates the filter output signal as an approximate convolution integral of the input signal with the calculated impulse response. More particularly, for an input signal f t and a filter impulse response of h t , it is known that the filter output g t is given by where represents the convolution integral. This may be re written as where τ is the delay variable of the convolution integral. The foregoing can be approximated by where k is an integer. This approximation can be seen to be taking samples of the input signal f t at delays kΔτ, multiplying them by the area under the corresponding portion of the impulse response and summating the resultant values h τ being, of course zero for negative values of τ . The integral on the right hand side of Equation 3 is frequently approximated to h kΔ dτ. A physical realisation of this convolution approximation is illustrated in diagrammatic form in Figure 5 where the input signal f t is fed to a delay line 4 with taps at kΔτ, the output of each tap is multiplied in a multiplier 5 by the present weight h kΔτ Δτ or its integral form determined by the required filter response, and the weighted tap outputs are summed in a summer 6 to give the filter output g t . The overall delay length of the delay line 4 is determined by the time width over which the desired filter impulse response h t has significant values, while the value of Δτ and thus the number of taps determines the accuracy of the approximation represented by Equation 3 . In this latter respect, it may be noted that if f t is a digital signal of period T equal to any integer multiple, including unity, of Δτ, then Equation 3 ceases to be an approximation and is equivalent to Equation 2 for t nΔτ where n is an integer. Various implementations of transversal filters are known including the use of charge coupled devices, surface acoustic wave devices and digital computers. In the latter case, the desired impulse response is typically stored and then referenced to effect each weighting operation as required. Digital implementations of transversal filters are usually referred to as digital filters. A general description of transversal filters may be found in Introduction to Communication Systems by Ferrel G. Stremler published 1982, Addison Wesley. One example of a prior data transmission system is disclosed in US A 3971996 Motley et al . This system includes a transmitter in which binary data is split into quadrature components which are digitally filtered and then digitally modulated onto a carrier prior to transmission in analogue form. The receiver separates the received modulated carrier signal digitally into quadrature components using digital multipliers, filters these components digitally and applies them to a feedback phase tracker prior to decoding the components to yield the original data. EP A 0124031 Siemens discloses a method for digital quadrature amplitude modulation QAM in which two quadrature carrier signals of a frequency which is a quarter of the sampling frequency are combined to form an offset QAM signal for transmission. This document also discloses receiving the signal, subjecting the resulting parts of the signal to sign reversals and filtering to yield quadrature components. It is an object of the present invention to provide a data modem system in which the demodulation process is considerably simpler than in comparable prior art devices. According to a first aspect of the invention, apparatus for receiving and demodulating an information carrying modulated data signal having a predetermined modulation symbol rate comprises means for converting the said signal to a digital signal representative of an analogue modulated carrier signal having a carrier frequency which is an integral multiple of the symbol rate, whereby the apparatus is operable to demodulate a digitally phase modulated data signal, and comprises a free running local oscillator digital splitting means for splitting the carrier signal into quadrature components by subjecting samples of the digital signal to the combination of alternate weighting by 1 and 1 and an inhibiting operation thereby to generate digital quadrature component representations each having a weighting sequence 1, 0, 1, 0, ... digital filter means coupled to the digital splitting means and arranged to produce a plurality of filtered digital sample values representative of a demodulated information signal containing the said information means coupled to the digital filter means to derive a phase angle signal from the sample values and a phase estimating circuit coupled to receive the phase angle signal to remove phase errors resulting from the use of the free running oscillator in a feedforward compensation manner. A demodulated phase angle signal may be derived by performing an inverse tangent calculation on at least portions of pairs of the sample values. Typically, the splitting means forms part of a demodulator including a digital circuit for down converting a signal representative of the modulated carrier signal, the circuit receiving a local oscillator signal having a frequency which is a multiple of the symbol rate. The invention also includes, in accordance with a second aspect thereof, a method of receiving and demodulating an information carrying digitally phase modulated data signal having a predetermined modulation symbol rate, including the step of converting the said signal to a digital intermediate frequency signal representative of an analogue modulated signal of a carrier frequency which is an integral multiple of the symbol rate, whereby the demodulation is carried out using a free running local oscillator, the demodulation including the further steps of digitally splitting the digital intermediate frequency signal into quadrature components by subjecting samples thereof to the combination of alternate weighting by 1 and 1 and an inhibiting operation thereby to generate digital quadrature component representations each having a weighting sequence 1, 0 1, 0, ..., and digitally filtering the said components to produce a plurality of digital sample values representative of a demodulated information signal containing the said information, deriving a phase angle signal from the sample values, and feeding the phase angle signal to a phase estimating circuit which removes phase errors resulting from the use of a free running local oscillator in a feed forward compensation manner. A primary application of the system, apparatus and method of the invention is in transmission of data over a satellite communications link. Referring now to the digital filter means that may be used in a data modem system in accordance with the invention, in a first class of filter means each location of the memory means stores a digital value representing the right hand side of Equation 3 or its non integral approximation in its entirety, that is, the value of the filter output signal g t appropriate to the current input signal history. This value is, of course, determined by the state of the input signal f t over a preceding period equal to the time width of the significant portions of the desired filter response h t , this also being the total delay of the delay means. The current input signal history is characterised by the digital signal values at the tap points and these digital values are used in addressing the appropriate memory location for each clock period Δτ of the filter output. In these embodiments, the clocking rate of the addressing means equals that of the filter output. In a second class of filter means, each location of the memory means stores a digital value representing a component of the filter output signal, each component being appropriate to a particular input signal value at a particular period of the input signal history. During each clocking period of the filter output, the addressing means takes the digital value of each tap point in turn to address each of the memory locations holding a component appropriate to the current input signal history, these components being subsequently added together in a summer of the digital filter to form the filter output. In general, each newly calculated output value produced by the summer will be fed to a latch to serve as the actual filter output during the next output clock period while the summer calculates the next output value. In these embodiments, the clocking rate of the addressing means will preferably be a multiple of that of the filter output by a factor equal to the number of taps along the delay means. In fact, rather than processing each tap output in turn, it would be possible to process the tap outputs in parallel though this would of course require multiplication of the addressing and memory means the main advantage of parallel processing would be in speed of operation. The implementation of a digital filter using addressed memory means in accordance with the invention avoids the need for weighting computations and, in the case of embodiments of the first class referred to above, also avoids the need to summate the weighted tap components to form the filter output. The first class of filter means while being simpler in form require much larger memory sizes than those of the second class since in the former case all possible input signal histories over the input response period must have corresponding output values stored in the memory whereas in the latter case, it is only necessary to store a set of output signal component values for each value of k, each value in a set corresponding to a particular input signal value at the delay kΔτ. The first class of embodiments are thus most suited to cases where the filter input signal is binary in form and the maximum value of k is small the second class of embodiments is more suited for analog input signals represented in the filter by, for example, 6 or 8 bit binary samples. For this reason, the first class of embodiments is more suited to the transmitter portion of a data modem while the second class is more suitable to the receiving portion. In preferred embodiments of either said first or said second class the delay means comprises a digital delay line made up of a plurality of shift register cells possibly multi bit connected in series and clocked at a rate R₁ equal to 1 Δτ, the tap points of the line being the outputs of the individual cells. Assuming that the input signal to the digital delay line has a basic period T corresponding to a rate R₂ the signal either being a digital signal of period T input to the filter or an analog signal sampled in the filter at a rate R₂ , then the clocking rate R₁ of the digital delay line is, advantageously, equal to an integer multiple N including unity of the input signal rate R₂ or, in other words, Δτ T N. Clearly, for a given value of T, the greater the value of N, the less the value of Δτ and the greater the number of tap points along the delay line which of course leads to an increase in the accuracy of the convolution approximation effected by the digital filter. The penalty for having N large is the very large size of the memory means then required. As the input signal is clocked down the delay line at rate R₁, the output of the taps taken overall, will change at a corresponding rate. Prima facie this would appear to set a limit on the rate of evaluating the filter output g t since evaluation at a faster rate would simply mean re evaluating, in the same manner, information already used. Accordingly, the clocking rate R₃ of the addressing means should prima facie be such as to set the clocking rate R₄ of the filter output equal to R₁. In fact, while for strict compliance with Equation 3 the maximum rate of evaluation of g t does correspond to R₁, it is feasible to calculate approximate intermediate values of g t between sucessive points in time t in calculating the filter output. These intermediate values are, however, inferior approximations since the values of f t after t t In embodiments of the invention using either class of filter where the aforesaid intermediate values are used, the addressing means not only uses the tap output values to address the memory means but it also utilises a cyclic counter that provides an indication of which value is next to be addressed, that is for example, the value for where three intermediate values are provided. The advantage of using intermediate values as discussed above will be seen from the following example. For a binary input signal of period T, it is desired to obtain 4 output samples per period. This could be achieved by setting N 4 so that Δτ T 4 and then outputting one value of g t for each clocking of the delay line. If the significant time width of the impulse response h t was, for example, 8T then there would be 32 taps which, for embodiments of the first class would require 2³² memory locations or, for embodiments of the second class, 2⁸ memory locations. Now, if instead Δτ is made equal to T giving 8 taps and intermediate values ae used, then for embodiments of the first class, the required memory capacity is 2¹⁰ locations while for embodiments of the second class, the required capacity is 2⁶ locations. Thus for a given output rate, the use of intermediate values is highly advantageously in reducing memory capacity requirements though it should be noted that the accuracy of the output values is less than where extra taps are used to give the necessary output rate . The use of intermediate values is, of course, also possible where an analog delay line is employed together with analog to digital converter means to convert the tap outputs to digital form. In contrast to the immediately preceding discussion regarding the provision of intermediate values between clockings of the delay line, in certain circumstances not only may the use of intermediate values not be required, but it may not even be required to provide an output corresponding to the tap point signals after each and every clocking of the delay line or sampling of the tap points of an analog delay . Such circumstances may arise where the filter output values must be accurately determined, requiring a small value of Δτ and thus a high delay line clocking rate R₁ but these output values are only required at a rate less than R₁. One particular example where this may apply is where an analog input waveform has been sampled at the Nyquist rate which is also used as the clocking rate R₁ of the delay line. In order to avoid aliasing effects in the filter output, all relevant samples of the analog signal must be used in determining the appropriate filter output. However, where the filter s response is such as to restrict the signal band width in a manner reducing the applicable Nyquist rate at the filter output, then the clocking rate of the filter output can be made less than that of the delay line without introducing aliasing problems. This, of course, implies that not every new combination of the tap point values is utilised to determine an output value and that an output value may need to be held after the corresponding tap values have disappeared. For the aforesaid first class of digital filter means, this can be readily achieved either by appropriately latching the outputs of the tap points or the output of the memory means at the required filter output rate. For the second class of embodiments where the filter output is evaluated by summing a plurality of components each determined by the output of a corresponding tap point, the output latch of the filter could also be latched at the required output rate with the operation of the summer being occasionally ignored. This approach does, however, miss out on the opportunity to utilise the time fruitlessly spent in calculating unwanted outut values, to extend beyond one clocking period of the delay line the time spent in calculating the output values that are used operation of the filter in this manner would enable the filter to be run at higher input data rates than otherwise possible. One possible arrangement for effecting filter operation in this manner comprises a FIFO shift store First In First Out disposed in front of the delay line and clocked jointly with the delay line. This clocking is no longer evenly effected but is carried out at minimum intervals where output values are to be calculated from the resultant tap output combinations and at extended intervals where output values are to be calculated from the current tap outputs. Thus, for example, where only one output value is to be calculated for every four input samples, then when a output value is due the next four input samples held in the FIFO are rapidly clocked into the delay line and thereafter clocking is ceased for the whole of the filter output clock period while the next output value is calculated from the tap point values, the last preceding calculated value being held in an output latch and constituting the filter output. At the end of the output clock period, the newly calculated value is input into the output latch and four new input sample values are rapidly clocked into the delay line. Preferably, the FIFO and the filter clocking circuitry are arranged to cope with various different ratios between the input and output clocking rates. In certain data modems in accordance with the invention, the filters may be required to deal with data signals of various different rates. Generally in these circumstances the filters will be required to effect the same general spectral shaping but referred to the data rate concerned. The way in which modems embodying the invention are arranged to deal with this requirement will usually depend on whether the input signal to the filter delay line is a binary data stream as would be the case in the transmitting half of a data modem or multi bit samples of an analog waveform as would be the case in the receiving half of a modem . In the former case, the values stored in the memory means for effecting spectral shaping at one data rate can also be used to effect shaping at the other date rates simply by changing all the clocking frequencies appropriately. This does, however, have the drawback that aliased outputs would reduce in frequency with reducing data rates so that while circuitry subsequent to the digital filter can be designed to cut out the aliases of the higher data rates, the aliases of the lower rates would, if not otherwise prevented, be passed on. This can be overcome by providing at the digital filter output a bank of low pass filters for blocking the aliases, the low pass filter appropriate to the data rate selected being switched in series with the digital filter output. As an alternative to the foregoing arrangement of changing all the clock frequencies and providing anti aliasing filters, the output clocking rate of the digital filter can be kept constant for all data rates which would enable the subsequent circuitry to be designed to remove all aliases and one of the following arrangements adopted The latter arrangement is preferred and can be used with both said first and second class of filters. Considering next the situation referred to above where it is desired to implement a variable data rate filter when the latter is fed with multi bit signal samples, it will be assumed that the sampling has been carried out at or above the Nyquist rate for the highest data rate to be handled and that this sampling rate cannot be reduced with reductions in the data rate of the signal. This situation may arise where the signal concerned is the output of the initial receiving stages of a modem, as the signal will generally have been band limited to a band having a width set by the highest data rate typically four times the latter in such situations, if the sampling rate were simply reduced for the lower data rates, this would result in the aliasing back into the signal band of noise components not cut out by the band limiting. One way of providing the desired variable data rate filter is to clock the incoming signal samples into the filter delay line at the sampling rate with the delay line having a length equal to the full significant time width of the desired impulse response as applied to the lowest data rate. The number of delay line taps required to be used is dependent on the data rate since the time width of the corresponding impulse response is inversely proportional to the data rate. Note that in order to avoid aliasing problems, all relevant input samples must be used so that it is not possible simply to vary the spacing of a constant number of taps along the delay line in dependence on the data rate. Due to the differing number of taps used for the different data rates, the ROM is required to store a set of output values or components thereof for each data rate. With all the relevant input samples involved in calculating each filter output sample, the problem of aliasing back noise is avoided and the sample output rate can be dropped to that appropriate for the data rate involved. As previously explained, it is in fact possible to avoid the need to calculate the output samples that are to be discarded, the corresponding processing time being reallocated, by use of an input FIFO store, to the calculation of the desired output sample. A filter of this form can be of either the said first or second class of embodiments, though, for the reasons already discussed, the second class are more suitable when multi bit samples are involved. In fact, the form of filter described in the last preceding paragraph requires complex hardware for its implementation. In order to simplify this hardware to a degree, the filter can be implemented in two stages, namely a variable bandwidth filter stage which can be matched to the signal data rate thereby to cut out noise components outside the signal bandwidth, and a spectral shaping filter stage to which the samples output by the varible bandwidth filter are fed at a rate related to the signal data rate. The form of the variable bandwidth filter stage is similar to that described in the last preceding paragraph, the simplication involved being that the impulse response modelled by the filter requires a shorter delay line due to the less severe filtering being effected. The main spectral shaping filter stage is also of simpler form since the input clocking rate is directly related to the signal data rate so that the same number of delay line cells, and the same set of stored output values or components thereof can be used for all data rates. In a modulator, the modulating process is effected in the filter itself by weighting the values stored in the memory means by sample values of a carrier frequency ω Generally, of course, the values stored in the filter s memory means are not accessed in any predetermined order but in an order determined by the current input signal history as a result each output value to be weighted by a carrier sample value and stored will generally require to be stored with several different carrier signal sample weights, the addressing means being arranged to access the value appropriately weighted for the carrier sample next in turn. In fact, where several output values are produced from the same input signal history as is the case where the aforesaid intermediate values are stored, then since these values are accessed in a predetermined sequence, it is possible to assign a single carrier sample weighting to each stored value. Advantageously, four sample values of a carrier sin ω Where the carrier signal sample weightings are 1 and 1 , then as an alternative to weighting the values stored in the memory means, the output of the memory means or, for the said second class of embodiments, the output of the summer can be fed to a digital inverter arranged to invert that is, turn into its negative representation every other filter output value assuming that O values are not output . A similar process to that described above for carrier modulation can be effected in accordance with the invention in filters operating in demodulators, the weighting of the values stored in the memory means of the filter serving in this case to reverse the process effected in the modulator. Various other aspects and features of the system will become apparent from the following description, given with reference to Figure 6 onwards of the accompanying diagrammatic drawings, of a data modem that includes digital filters in its modulator and demodulator blocks, it being understood that this description is given by way of example and is not to be construed as limiting the scope of the present invention. In the drawings of which Figures 1 to 5 have already been referred to The data modems now to be described with reference to Figures 6 to 19 of the accompanying drawings are intended for use in a satellite communications link. They operate on the principle of quadrature multiplexing in which two amplitude modulated signals are combined in phase quadrature. Such a modulation process is generally referred to as QAM, that is Quadrature Amplitude Modulation. The modulator block of a modem is shown in Figure 6 and, as can be seen, includes an input demultiplexer 10 arranged to receive an incoming binary data stream B and to divide this stream into two sub streams B₁ and B₂ for further processing in separate, but virtually identical, channels hereinafter referred to as the P and Q channels. It will be appreciated that the data rate of the B₁, B₂ streams is half that of the input stream B by way of example, the stream B will be hereinafter taken as having a maximum data rate of 512 kilobits second kb s and selectable lower rates of 256,128, 64 kb s. Furthermore, for ease of explanation, the binary data streams will be considered to be in the non return to zero NRZ format and to be random in nature. Disregarding for the moment the presence of the digital filters 11 in the P and Q channels, the substreams B₁, B₂ are individually modulated onto a carrier of frequency ω phase shifter 15. The modulation process is such that a binary 1 in the B₁ stream produces a signal A cos ω The outputs of the multipliers 12 and 14 are then added in a summer 16 to form the modulator output. The above described form of QAM modulator may also be considered a quaternary phase shift keyed QPSK modulator since as a result of all the signals output by the multipliers 12, 14 having the same amplitude A, the signal output from the summer 16 while having a constant amplitude will have one of four possible phase states. This can be readily seen by reference to the phasor diagram of Figure 7 which shows the four possible outputs A cos ω relative to the reference phase established by the basic carrier signal cos ω Assuming that the binary streams B₁ and B₂ are in phase, the modulator output will change between its possible phase states once every period of the streams B₁, B₂, the output of the modulator during each period being considered as a symbol transmitting two bits of the original binary stream B these bits being shown in brackets next to the relevant output phasors in Figure 7 the bit passed to the P channel being given first . The spectrum of the modulator output is the same as that of each of the two channel signals fed to the summer 16 and will have the sin over argument form similar to that illustrated in Figure 1 c . In order to restrict the bandwidth occupied by the modulated signal, filters 11 are provided in the P and Q channels to shape the spectrum of the binary substreams B₁, B₂ prior to modulation. These filters 11 which will be described in detail hereinafter modify the time and frequency domain representations of the streams B₁, B₂ in a manner similar to that described and illustrated with reference to Figures 2d and 3d though these representations strictly apply to analog filters whereas the filters 11 are digital . The rounding off of the B₁, B₂ pulse waveforms by the filters 11 has the effect of causing the phase transitions in the modulator output to be progressive between the four main phase states rather than of stepwise form though at the mid point of each symbol, the phase ϑ should be equal to one of the four main values However, at the same time, the envelope of the modulator output now also varies which can under certain circumstances be a disadvantage. The modulator output spectrum will be similar in form to that of Figure 3 d but shifted to the carrier frequency ω In the modulator of Figure 6, it is desired to effect an overall 30 raised cosine spectral shaping in the modulator demodulator link Figure 8 illustrates the frequency response of a filter for effecting such shaping. In Figure 8, T represents the period of the data stream being shaped from which it will be appreciated that the filters desired characteristics are dependent on the data rate of the stream. In fact, in order to obtain optimum performance, the spectral shaping is equally split between the modulator and demodulator with each effecting a As already noted hereinbefore, transversal filters, including digital filters, operate by determining an approximate value for the convolution integral of the input signal with the desired impulse response of the filter. This impulse response can be readily derived from the desired frequency response since the latter is the Fourier transform of the former. Figure 9 shows the desired impulse response for each digital filter 11 for a data rate of the streams B₁, B₂ of 256 kb s for lower data rates, the impulse response would be proportionately extended along the time axis. Figure 10 shows the P channel digital filter 11 in block diagram form, the Q channel filter 11 being identical. The P channel filter 11 basically comprises a digital delay line composed of seven serially interconnected 1 bit shift register cells 20 fed at one end with the binary sub stream B₁, and an output value ROM Read Only Memory 21 addressed by the outputs of the cells 20. In the present filter, the delay line cells are clocked at a rate R₁ equal to the data rate R₂ of the stream B₁. The filter 11 operates on the principle that the value of the 8 bit binary word constituted by the filter input and the outputs of the cells 20 represents the current history of the filter input f t , constituted by the stream B₁, over the period relevant to determining the current filter output g t , that is, over a period equal to the significant time width of the filter s desired impulse response in the present example, this time width is taken as being 7T where T is the period of the stream B₁. The binary word constituted by the outputs of the cells 20 is used as an address code on address lines A₀ A₇ to look up in the ROM 21 the filter output an 8 bit word appropriate to the current relevant signal history, the ROM storing output values appropriate to all possible values of the addressing binary word that is, appropriate to all possible input signal histories . The output value stored in the ROM for each particular input signal history is pre evaluated in accordance with the convolution approximation which corresponds to Equation 3 given above but with Δτ set to T τ being, as before, the delay variable . This approximation is diagrammatically depicted in Figure 11 at time t t Since the filter is required to simulate four different impulse responses, one for each possible data rate R₂ of the stream B₁ R₂ 256 kb s, 128 kb s, 64 kb s, 32 kb s the ROM 21 stores four sets of output values, the appropriate set being selected via an output set selected unit 26 controlling address lines A₁₃, A₁₄ of the ROM 21. Furthermore, rather than one output value being provided during each period T of the stream B₁ which could lead to aliasing problems, the ROM 21 is arranged to output a plurality n of values during each period, each value corresponding to a respective portion of the period T and being determined by the combination of the binary word generated from the delay line during that period and the output of a cyclic counter 27 controlling address lines A₈ A₁₂ of the ROM 21. As regards the pre evaluaton of the n outputs during any particular period T, clearly while Equation 4 can be used to evaluate one value, since the input signal f t does not change during the period T the delay line only being clocked once each period T , it is necessary to use a modified form of Equation 4 to calculate the remaining n 1 values, hereinafter termed intermediate values. The modification necessary is to change the limits of the integral of the impulse response so that for the r In the present filter, the output clocking rate R₄ of the filter and also the clocking rate R₃ of the ROM 21 is arranged to be constant at 1024 kb s for convenience, hereinafter referred to as 1MHz . As a result, the value of n will depend on the value of the data rate R₂ of the stream B₁, n being equal to 4,8, 16 and 32 for R₂ 256, 128, 64, and 32 kb s respectively. To access the differing number of output values relevant to each data rate R₂, the counter 27 controlling the ROM address lines A₈ A₁₂ takes the form of a programmable counter clocked at 1 MHz and set, in dependence on the value of R₂, to cyclically alter the addressing data on lines A₈ A₁₂ in an addressing cycle of period T the period of the stream B₁ this cycle takes in four different codes for R₂ 256 kb s, eight different codes for R₂ 128 kb s, sixteen codes for R₂ 64 kb s, and thirty two codes for R₂ 32 kb s. The number of output values stored in the ROM 21 for R₂ 256 kb s is equal to the number 256 of possible values of the 8 bit word derived from the delay line, multiplied by the relevant value of n 4 , that is, a total of 1024 values requiring 1K of memory space. Similarly, the memory space required at the data rates 128, 64, and 32 kb s is 2K, 4K, and 8K giving a total of 15K. In the Figure 10 filter, the various clocking signals are derived from the system clock 22 shown within the dashed box. This clock comprises a 1MHz oscillator 23 and a programmable divider 24 dividing the oscillator output by a factor of 4, 8, 16 or 32 depending on the desired value of the data rate R₂ of the stream B₁. The delay line made up of the cells 20 is clocked by the output of the divider 24 at the rate R₂ while the programmable counter 27 is clocked by the output of the oscillator 23. The clock 22 also controls timing in the de multiplexer Fig. 6 and in the circuitry not shown used to generate and process the stream B prior to feeding to the modulator in this manner proper synchronisation throughout the system is assured. The setting of the programmable divider 24, of the programmable counter 27, and of the output set select unit 26 is controlled by a data rate select input 25 in dependence on the desired data rate. In operation of the filter, the filter is first set up for a particular data rate value R₂. Thus, for example, if R₂ is to be 256 kb s, the divider 24 is set to divide by four, the counter 27 is arranged to cyclically count to four, and the unit 26 is set to select, via lines A₁₃, A₁₄, the set of output values appropriate to the rate R₂. Upon each new bit of the stream B₁ being clocked into the delay line, the ROM 21 outputs, in dependence on the value of the binary word derived from the delay line, a first value which is held for a quarter of the stream period T, this value corresponding to an evaluation in accordance with Equation 4 above. As the output of the counter 27 changes for the second quarter of the current period T, a first intermediate value is output, this value having been evaluated in accordance with Equation 5 for r 1, n 4. Further clocking of the counter 27 results in the third and fourth quarter outputs being produced at the ROM output. Thereafter, the delay line is clocked again and the process is repeated. For different data rates R₂, the filter operates in a similar manner but with differing numbers of intermediate values being output during each period of the stream B₁. The output of the ROM 21 is fed to a digital to analog converter 30 Fig. 6 before being passed to the multiplier 12. A latch not shown clocked at the addressing rate R₃ of the ROM 21 may be provided between the output of the ROM 21 and the D A converter 30. A variant of the Figure 6 modulator block is shown in Figure 12. In this variant, the actual modulation process is effected by pre weighting the filter output values stored in the P and Q channel digital filter ROMs 21 by sample values of respective cos and sin carrier waveforms. Apart from the weighting of the filter output values stored in the ROMs 21, the digital filters 11 of the Figure 12 variant are identical in form and operation to that shown in Figure 10 with the delay lines of the filters being clocked at the data rate R₂ of the incoming binary substram B₁ or B₂ and their ROMs being clocked at 1MHz. The outputs of the ROMs 21 are combined by a multiplexer 31 which is clocked at 2MHz and serves the same function as the analog summer 16 of Figure 6. A digital to analog converter 32 is connected to the output of the multiplexer 31. Figure 13 illustrates the modulation process effected by the Figure 12 arrangement for the case where the data rate R₂ of the streams B₁, B₂ is 256 kb s, each ROM 21 outputting in this situation four values during each period T of the streams B₁, B₂. As can be seen from Figure 13a, which shows the ROM clocking waveforms, the clocking of the Q channel ROM 21 is effected in anti phase to that of the P channel ROM. In the case of the Figure 6 modulator where the ROMs of the digital filters 11 are not weighted by cos and sin sample values, the P and Q channel ROM outputs might, for example, vary over a period t The values stored in the P and Q Channel ROMs 21 are respectively weighted by sample values of a cos and a sin waveform of ½ MHz frequency. Figure 13c shows such waveforms in dashed lines together with four sample values per cycle, equi spaced at angles of π 2 starting at t The sample values occur at 2 MHz and, as can be seen, are so mutually arranged as between the P and Q channels that at any one time the weighting provided by the latest sample in one channel will be zero while the weighting provided by the latest sample in the other channel will be 1. Since, therefore, after weighting, only one channel will at any one time provide a contribution to the modulator output, it is possible to combine the channel signal by use of the multiplexer 31 clocked at 2MHz. Furthermore, this use of a multiplexer means that the value of the channel output not selected by the multiplexer at a particular moment can be of any value and does not need to be zero. It is therefore unnecessary for the ROMs 21 to store zero weighted output values but only values weighted by the 1 samples each ROM value is then output for two clock periods of the multiplexer 31 during only one of which is that output value used by the multiplexer. Figure 13d shows the ROM outputs of Figure 13b after weighting by the 1 sample values of Figure 13c, while Figure 13e shows by hatched areas the periods for which each channel ROM is selected by the multiplexer 31. The multiplexer output is shown in Figure 13f. The multiplexer output is shown in Figure 13f. It will be noted that the multiplexer is arranged to change between selected channels intermediate transitions in the channel outputs. The output signal of the digital to analog converter 32 is fed to a frequency up converter not shown, but which may be of any suitable form to translate the output signal to the same carrier frequency W The output of the modulator whether of the Figure 6 or Figure 12 form is then subjected to further frequency up conversion for transmission via a satellite link. Referring to Figure 14, a further variant of the modulator block dispenses with separate ROMs 21 of the Figure 12 variant by multiplexing the outputs of the P and Q channel delay shift registers in a multiplexer 33 and feeding the multiplexed signal history inputs to the address lines of a single ROM 34, the data outputs of the ROM 34 being coupled directly to the D A converter 32. This simiplified variant cannot be used at such high data rates as the variant of Figure 12 and is typically useful for data rates of less than 512 ksymbols sec. The intermediate sample values are accessed as before, and, referring to Figure 15, if the output rate from the ROM 34 is at a 4MHz rate with the transmitted signal on a 1 MHz carrier, then the impulse response used for each channel is sampled at 2 MHz as shown, the output being zero on alternate samples in each channel. In fact, the convolution in each channel is carried out by sampling the impulse response at 4 MHz but accessing alternate samples for the P and Q channels, for example the P channel accessing on even addresses and the Q channel on odd addresses. The modulation of a carrier is carried out as before by multiplying the intermediate sample pairs by 1 and 1 alternately. Offset QPSK modulation is sometimes used to reduce envelope variations in a transmitted signal, and this can be performed in the modulation blocks of Figure 12 or Figure 14 in a relatively simple manner by delaying the Q channel data stream by one half a symbol period such that the P channel data changes in the centre of the Q channel symbol period and vice versa. To do this a ½ symbol period time delay can be added into the clocking of one of the sets of delay registers. Alternatively, the relevant ROM or ROM portion can be arranged to store the data corresponding to the convolution of a delayed impulse response as shown in Figure 16. Here the normal P channel impulse response is interleaved with a delayed Q channel response. In this way, the modulation format can be changed on a software level simply by altering the content of the ROM. The possibility of additional out of band components can be avoided if necessary by increasing the delay register length with a consequent increase in memory space. This same technique could be used to implement various other forms of offset keying where the delay is not necessarily half a symbol period but could be ⅛, ¼, ⅜, etc. Figure 17 illustrates the demodulator block of the data modem. The input to the demodulator is of the form cos ω The input signal cos ω In the mixer 51, the input signal is mixed with a signal output from a voltage controlled oscillator 53 that forms part of a phase locked loop for convenience of description the oscillator output will, for the moment, be taken to be cos ω The output of the mixer 51 is fed to a low pass filter 55 to produce a signal of the form sin 8. In the mixer 52, the input signal cosω phase shift circuit 54. The output of the mixer 52 is passed to a low pass filter 56 to produce a signal of the form cos ϑ. The outputs of the filters 55, 56 are next converted into 6 bit binary words in analog to digital converters 57, 58 which operate at a sampling rate of 1MHz, that is, at twice the maximum frequency allowed through the bandpass filter of the demodulation down converter. The conversion effected in the converters 57, 58 takes the form illustrated in Figure 18 from which it can be seen that the most significant bit MSB of the converter output effectively acts as a sign bit. The output, of the A D converters 57, 58 are then fed to digital filters 59, 60 which are matched to those of the modulator and effect a 30 raised cosine spectral shaping. The filters 59, 60 will be described in detail hereinafter. The output of each filter 59, 60 is, again, a 6 bit binary word. The values of the outputs of the filters 59, 60 at the midpoint of each transmitted symbol period, represents the values cosϑ and sinϑ where depending on the values of the two substream bits being sent see Fig. 7 . The effect of the spectral shaping effected by the digital filters in the modulator and demodulator is to cause ϑ to progressively vary between its mid symbol values. However, to facilitate explanation of the demodulation process, the values of cos ϑ, sin ϑ and ϑ referred to below will be the midpoint values. In order to derive the value of ϑ and thus determine the value of the two substream bits being transmitted during each symbol period, it is necessary to use both the cos ϑ and sin ϑ signals provided by the filters 59, 60 since these signals are not normalised. In fact, the determination of the value of ϑ can be effected by determining the angle quadrant in which ϑ lies this latter is readily derived from the signs of the cos ϑ and sin ϑ signals, that is, from the MSBs of the filter outputs. Thus, for example, if the MSBs of both filter outputs are 1 , then ϑ lies in the first angle quadrant which from Figure 7 means that the P and Q channel bits B₁ and B₂ streams are also both 1. The Table shown in Figure 19 gives the values of the B₁, B₂ substream bits for the various combination of filter output MSB values, the relevant portion of the Table being the row designated ψ 0 . The least significant bits LSBs of the outputs of the filters 59, 60 represent the in quadrant value of 6 which should, of course, be whatever the absolute value of ϑ that is, whatever the value of the two substream bits being transmitted during the current symbol period . In the foregoing discussion of the general operation of the demodulator, it has been assumed that the output of the oscillator 53 is cosω so that the frequency and phase of the oscillator can be controlled by the in quadrant value of ϑ at the output of the filters 59, 60. This in quadrant value of ϑ is determined by feeding the LSB s of the digital filter outputs to a tan ¹ decoding ROM 61 this ROM is designed to give an output representative of an angle X when fed with sinX and cosX inputs, whatever the value of X may be . The phase locked loop controlling the oscillator 53 is then completed by feeding the output of the ROM 61 through a digital to analog converter 62, an amplifier 63, and a low pass filter 64 back to the oscillator 53. The parameters of the units 61 to 64 are such that the oscilator locks up at a phase giving an in quadrant value of ϑ of In fact, since only the in quadrant value of ϑ is used as the feedback signal in the phase locked loop, the oscillator can lock up at any one of four phases, that is with an output of cos ω The effect of the oscillator locking up in a state other than ψ 0 is that the relationship between the MSBs sign bits of the digital filter outputs and the actual values of the transmitted substream bits is no longer as set out in row ψ 0 of the Figure 19 Table. However, provided the value of ψ can be determined, then the substream bit values can still be readily determined from the MSBs of the digital filter output and the Figure 19 Table shows the required conversions for the four possible values of ψ. The determination of the value of ψ at which the oscillator 53 has locked up can be achieved by the transmission of a predetermined unique reference bit sequence. This sequence will produce one of four possible sequences of MSB values at the output of the digital filters 59, 60 depending on the value of ψ. By comparing the actual MSB sequence with each possible sequence the value of ψ can be determined. In the Figure 14 demodulator, this process is effected in a reference sequence identification unit 65 a fuller description of such a unit is given in International Application No. W084 01874. The unit 65 is arranged to output a two bit code identifying the value of ψ. This code is fed to a quadrant correction ROM 66 together with the MSBs of the digital filters 59, 60. The ROM 66 holds a look up table corresponding to that of Figure 19 and the output of the ROM represents the two bits of the substream B₁, B₂ for the current period signal. These two output bits are combined in a multiplexer 67 to reconstitute the stream B. As already indicated, the proper operation of the demodulator requires the recovery of a symbol timing information from the incoming signal the rate of symbol transmission, and therefore receipt, being that of the substreams B₁, B₂ that is, the rate R₂ . This clock recovery process is effected in a clock recovery circuit 68 one possible form of which is shown in Figure 20 it being appreciated that any other suitable form of clock recovery circuit may alternatively be used . The clock recovery circuit of Figure 20 is fed with the MSBs output by the digital filters 59, 60. One or both of these MSB s will change in value between successive symbol periods provided that there is a change in the data being transmitted between these periods. These changes in the MSBs are used to define the transition times in the recovered symbol clock in the manner described below. Each MSB is fed to an exclusive OR gate 70 both directly an via a delay 71 equal to half the symbol rate period T the demodulator is preset to receive at a particular data rate and the delays 71 are set up by a signal on line 72 to this rate . The outputs of the exclusive OR gates 70 are pulses of duration T 2. These pulse outputs are added in an OR gate 73 and used to generate an error signal for driving a phase locked loop. This loop comprises a voltage controlled oscillator 74 a programmable divider 75 controlled via the data rate set line to divide the oscillator output down to the current data rate, an AND gate 76 combining the output of the gate 73 and divider 75 to produce the loop error signal,, and a low pass filter 77. This arrangement provides a clock output at the symbol rate R₂, this output being maintained during any temporary absence of transitions in the MSB s output from the digital filters 59, 60. A phase correction circuit 78 may be provided to introduce a predetermined phase correction into the clock recovery circuit output to ensure that the demodulator evaluates the incoming signal at the optimum time during each symbol period. The output of the clock recovery circuit is used to control clocking of the digital filters 59, 60, the reference sequence identification unit 65, the ROMs 66 and 61. A secondary output not shown from the programmable divider 75 is used to provide a signal at twice the rate R₂ for clocking the multiplexer 67. The form and manner of operation of the digital filter 59 will now be described with reference to Figures 18 and 19, the digital filter 60 being identical in all respects to the filter 59. The primary purpose of the digital filter 59 is to effect the same spectral shaping as that carried out by the digital filters in the modulator, that is, in the present example, a In reality, the fact that the bandpass filter of the modulator down converter has fixed 500 kHz bandwidth, means that while the above filter arrangement is satisfactory, for 256 kb s assuming a sampling rate of 1MHz , at lower data rates any proportionate reduction in the effective sampling rate that is, in the actual sampling rate or in the rate at which the samples are clocked into the filter will result in the noise let through the down converter bandpass filter being aliased back into the signal. To overcome this problem, a variable bandwidth low pass transversal filter stage is placed in front of the main spectral shaping filter and is used to reduce the signal bandwidth for the three lower data rates thereby enabling the sample rate for these data rates to be reduced to four times the data rate. This lowpass filter stage must, of course, deal with samples at the 1MHz sampling rate this being the sampling rate of the A D converter 57 to avoid aliasing problems even though its sample output rate need only be four times the set data rate. Since in practice the response of the low pass filter stage will not be flat, the spectal shaping effected by the main filter stage will need to be modified from The variable bandwidth low pass filter stage is shown in Figure 21 and comprises a digital delay line composed of thirty one interconnected 6 bit shift register cells 80, the input of the first cell being connected via a FIFO first in, first out store 81 to the output of the A D converter 57 . For ease of explanation, the presence of the FIFO 81 will initially be ignored and the clocking rate of the delay line cells 80 will be taken to be an even 1MHz that is, the sampling rate of the A D converter 57. The input to the first cell 80 and the output of all the cells 80 are connected via 6 bit wide lines to the input of a 32 way multiplexer 82. This multiplexer 82 is controlled by a programmable counter 83 one count cycle of which takes the multiplexer 82 and also the filter stage as a whole through one cycle of operation. Disregarding the presence of the FIFO 81, the count cycle of the counter 83 has a duration equal to the clocking interval of the delay line, that is 1µs. The number of counts in a count cycle is dependent on the selected data rate and during each cycle of separation the multiplexer B2 is arranged to cyclically switch a corresponding number of its input lines through to a ROM 84 to provide address codes therefor. The ROM 84 is also addressed by the output of the counter 83 and by the data rate select line 72 in practice this line takes the form of two binary signal lines . The output of the ROM 84 is connected to a summer 85 which serves to sum all the ROM outputs produced during a cycle of operation of the multiplexer 82, the resultant sum being then fed to a latch 86 where it is held for the duration of the next multiplexer cycle. During each cycle of operation, the low pass filter stage taken in turn, each delay line tap value of relevance and determines, with regard to the particular signal history period represented thereby, the magnitude of the component of the filter output resulting there from. This determination is effected by using each digital tap value as an address code to look up in the ROM 84 the output component magnitude appropriate to that value for the signal history period defined by the current count value of the counter 83, this latter count value also being used as part of the total ROM address. The filter output is then computed by summing all the output components corresponding to the top values of relevance. The actual number of tap points of relevance is greater the lower the data rate selected since the cut off frequency of the low pass filter stage is designed to reduce in proportion with the data rate and the resultant extenson in the time width of the impulse response cannot be compensated for by reducing the delay line clocking rate for the reasons already discussed . It is to deal with this increase in tap points of relevance at the lower data rates that the count cycle of the counter 83 and thus the number of tap points accessed by the multiplexer 82 must be set according to the data rate. Similarly, it is not possible to use only a single set of stored output component values in the ROM 84 but a separate set must be stored for each data rate, the appropriate set being selected via the line 72. Thus, for the data rate of 128 kb s where it is desired to halve the signal bandwidth from 500 to 250 kHz, the filter is designed to have an impulse response as shown in the uppermost graph of Figure 21 corresponding to a slow roll off low pass filter since this impulse response has a duration of 8µs, the counter 83 is set to cycle through a count of nine to cause the multiplexer 82 to feed in turn to the ROM 84, the input to the first cell 80 an then the output of each of the first eight cells 80. This cycle takes 1 µs and the resultant nine ROM output values are summed in summer 85 to produce a filter output sample value. After each count cycle is complete, the delay line is clocked to bring in a new value into the first cell and shift the other values down the line therefter the filter cycle repeats. Now, if every output value so produced was actually output by the filter, this would, of course, result in a sample output rate of 1MHz, however, as already noted, it is possible and desired to reduce the output rate to four times the data rate. This is done for the 128 kb s data rate by only clocking into the latch 86 every other final sum value produced by the summer 85, the output rate of the filter then being 512 K samples second as desired. For the 64 kb s data rate, the low pass filter is designed to reduce the signal bandwidth by a factor of four the corresponding impulse response has a duration of 16 µs so that the counter 83 is set to cycle through a count of seventeen in 1 µs. In other respects, the filter operates in a manner analogous to that described above except that only one in four summer outputs are latched into the latch 86 giving a filter output rate of 256 k samples second that is, 4 data rate . For the 32 kb s data rate, the filter impulse response has a duration for 32 µs and the counter 83 is set to cycle through a count of thirty two the last 1 µs of the impulse response is, in fact, ignored . Only one in every eight samples is output giving an output data rate of 128 k sample second. The total storage capacity required for the ROM 84 is equal to 2⁶ 9 17 32 6 bit values, the factor of 2⁶ being the number of possible values of each digital tap signal. It will be appreciated that operation of the Figure 21 filter in the above described manner is highly inefficient due to the processing time spent calculating output values that are then discarded ideally, this processing time would be redeployed to ease the task of calculating the values actually output from the filter. The FIFO 81 in fact serves this purpose in the manner now to be described. The FIFO 81 is arranged to receive the samples output by the A D converter 57 at an even 1MHz. Since none of these filter input samples can be discarded without risking aliasing problems, the output clocking rate of the FIFO 81 must also average 1MHz however, the samples are not clocked evenly from the FIFO. Considering the 128 kb s data rate setting where only half the possible filter output values are required, the FIFO 81 is arranged to rapidly output two samples to the delay line and then wait 2 µs. During this 2 µs, the multiplexer executes one operating cycle on the current state of the delay line and one output value is determined in the summer 85 and latched into the latch 86 the counter 83 thus now has a 2 µs cycle time. At the end of each 2 µs period, another pair of input samples is successively clocked from the FIFO 81 into the delay line and a new output value then determined during the next 2 µs period. The possible output values corresponding to the delay line stage that briefly exists following clocking in of the first sample of each pair are not calculated so that the output rate of the filter is half its input rate. In a similar manner, for the 64 kb s data rate setting where only one in four of the possible output values are required, the input samples are clocked into the delay line in fours at 4 µs intervals. Each 4 µs interval is used to calculate one output sample and the counter 83 has a 4 µs cycle time. Again, for the 32 kb s data rate setting, the input samples are clocked into the delay line in weights at 8 µs intervals, each 8 µs interval being used to calculate one filter output sample. In this case, the cycle time of the counter 83 is 8 µs. The main spectral shaping stage of the digital filter 59 is shown in Figure 22. As explained above, this stage is arranged to receive 6 bit samples at four times the selected data rate whatever that rate may be. The form of the Figure 22 spectral shaping filter stage is similar to that of low pass filter stage of Figure 21, except that the FIFO is omitted and the whole delay line is used at all data rates. More particularly, the Figure 22 filter stage comprises a delay line made up of 6 bit cells 90 into which the input samples are clocked at four times the data rate a multiplexer 91 arranged, between each clocking of the delay line, to access in turn the input to the first cell 90 and the output of all the cells 90, the operation of the multiplexer 91 being controlled by a cyclic counter 92 a ROM 93 storing components of the filter output, the ROM 93 being addressed by the outputs of the multiplexer 91 and the counter 92 a summer 94 for summing the set of output components supplied by the ROM 93 between each clocking of the delay line and an output latch 95 arranged to hold each sum value output by the summer of the subsequent clocking period. The impulse response emulated by the Figure 22 filter stage is that shown in Figure 9 that, If the response of the low pass filter stage were ideal, then a single set of output components stored in the ROM 93 could be used for all four data rates. However, in practice, it will be necessary to compensate for variations in the response of the low pass filter between data rates by providing a separate, compensated, output sample set in ROM 93 for each of the four possible data rates. Selection of appropriate output component set is achieved by feeding the line 72 to the ROM to provide further addressing information. The output of the latch 95 constitutes the output of the digital filter 59, the samples appearing at the filter output being subsequently processed in the manner already described to derive the P and Q channel sub streams B₁, B₂ from which the original stream B is finally reconstituted. Figure 23 shows an alternative arrangement for the Figure 17 demodulator block this alternative arrangement employing digital demodulation techniques. In the specific example illustrated in Figure 23, a 200 MHz input signal is band limited in a SAW filter 100 before being down converted to 1 MHz, this latter process being effected by mixing the 200 MHz signal with a 199MHz signal in a mixer 101 and then filtering the mixer output in a filter 102. The filter 102 is centred on 1 MHz and has a bandwidth of 2 MHz. The output of the filter 102 is sampled and digitised in an A D converter 103 at a 4 MHz rate that is, at the Nyquist frequency . The digital signal stream output by the converter 103 is mixed in digital mixers 104, 105 with quadrature 1 MHZ digital waveforms before being passed to digital filters 106, 107 that correspond to the filters 59 and 60 of the Figure 17 demodulator. The outputs of the filters 106, 107 are processed in substantially the same manner as the corresponding filter outputs in Figure 17, the MSBs being used to recover the original data streams B₁, B₂ while the LSBs are fed to a Tan ¹ ROM 61 to derive an inquadrant phase angle signal for use as a phase locked loop PLL feedback signal. However, whereas in the Figure 17 demodulator this feedback signal controls the phase of the quadature signals fed to the cos and sin channel mixers 51 and 52, in the Figure 23 arrangement the feedback signal produced by the ROM 61 is fed to PLL circuitry 108 to control the 199 MHZ supplied to the mixer 101. In standard manner, the circuitry 108 includes a voltage controlled oscillator and loop filter not shown . The 1 MHz signals fed to the mixers 104 and 105 are digital simulations of cos and sin signals and weight the samples output from the A D converter 103 by the amounts indicated in Figures 24A and 24B respectively. Thus, the cos signal fed to the mixer 104 provides sample weightings of 1, 0, 1, 0, for the four samples occupying each cycle of the 1 MHZ signal see Fig. 24A similarly, the sin signal fed to the mixer 105 provides weightings of 0, 1,0, 1 in each cycle. It will be appreciated that these weightings are implimented digitally, for example, by sign bit inversion and inhibit operations. Figure 25 shows a modified version of part of the Figure 23 arrangement where the digital mixers 104 and 105 are replaced by a single digital mixer 110 followed by a demultiplexer 111. The mixer 110 is fed with 1 MHZ signal that weights alternate pairs of samples output from the converter 103 by 1 and 1 as depicted in Figure 24C. The demultiplexer 111 that follows the mixer 110 is clocked at 2 MHZ at points in time indicated M in Figure 24C whereby to achieve the same effective sample weighting of the inputs to the filters 106 and 107 as in Figure 23. The signals used to drive the A D converter 103 and the mixers 104, 105 or the mixer 110 and demultiplexer 111 are all derived from a common clock circuit. Referring now to Figures 26 and 27, a further demodulator embodiment dispenses with the phase locked loop of the embodiments of Figures 17, 23, and 25. Phase locked loops have certain disadvantageous behavioural characteristics such as the time to lock onto a signal, the pull in frequency range, and the tracking range. To obtain an improvement in one of the characteristics e.g. lock on time, requires sacrificing performance in one or both of the other characteristics. It has been proposed in the past to overcome these problems by employing digital circuits carrying out complex mathematical calculations to obtain carrier recovery. The embodiment of Figures 26 and 27 allows the phase and frequency of the demodulated signal to drift and then compensates for the drift without the need for complex mathematical operations, bringing advantages over the phase locked loop technique in terms of an improved frequency range and a very short signal acquisition time. In this embodiment, the local oscillator 53 is free running and arranged to be near in frequency to the incoming carrier of intermediate frequency I.F. signal frequency. A primary constraint is that its frequency should be a multiple of the recovered symbol rate. It should also be relatively stable. If the incoming signal is a pure carrier, the down converted signal in each quadrature channel will be a sine wave at a frequency equal to the frequency difference between the local oscillator frequency and the incoming signal frequency. In the present example, the down conversion is carried out digitally by first converting the incoming signal to digital form in A D converter 103 clocked at, for example, 4 MHz by the local oscillator 53, and then down converting and multiplexing into cos and sin P and Q components in a digital circuit 120 also clocked by the local oscillator 53 together with a divider 121. The whole of the filtered output from each digital filter 59, 60 is then fed to a decoding ROM 122 containing tan ¹ information extending over 360 C at the same difference frequency, i.e. the difference between the frequency obtained from the divider 121 and the incoming frequency. This produces a demodulated output on line 123 representing a constantly rotating phasor, the rotation being due to the free running local oscillator. The addition of data to the incoming signal results in instantaneous phase jumps from the rotating phasor so as to represent the transmitted data. It is this combined rotating phasor and data signal that is processed by a phase estimating circuit 124 which compensates for the phase and frequency differences resulting from the use of a free running local oscillator and yields an output on line 125 having four possible constant phase angles in the case of QPSK modulation are required. This output is then processed in known manner by phase decoder 126 giving the wanted data output. Referring to Figure 27, the phase estimating circuit 124 typically comprises a subtraction stage 130 to remove the phase error due to the frequency difference referred to above, which is then coupled to a stage 131 for removing the phase jumps due to data. Clearly the difference between the input and output of this stage 131 represents the wanted data which is available at the output of a second subtraction stage 132. The other input of the first subtraction stage 130 is coupled to processing circuitry coupled to the output of the data removal stage 131. Thus, the latter output feeds a loop including an adder 133 coupled to an averaging filter 134 which is in parallel with a slope detecting and projecting circuit comprising a sample difference calculator 135, filter 136 and multiplier 137. The filter 134 and the multiplier 137 are coupled to respective inputs of a second adder 138 having an output coupled back to the second input of the first adder 133 via a delay stage 139. The signal produced by the loop represents an estimate of the overall error in the phase signal produced at the output of the demodulating ROM 122, so that when subtracted from that phase signal in subtraction stage 130, it yields the wanted phase coded data plus some residual phase error. The operation of the phase estimator circuit of Figure 27 is as follows. The signal produced on line 123 the output of the demodulating ROM 122 comprises a series of 8 bit digital samples of the phase ϑ nT of the received signal. This phase comprises, in the general case, the phase information representing the wanted data superimposed on the rotating phasor