# SOLID STATE COLOR IMAGING APPARATUS

## Claims
Festkörper Bildaufnahmevorrichtung, umfassend

## Description
The present invention relates to a solid state color imaging apparatus according to the pre characterizing part of claim 1. Such apparatus is used to obtain a color television signal by the use of a solid state image sensor such as a CCD Charge Coupled Device or a MOS type color image sensor. Various types of solid state color image sensors each combined with a color filter have hitherto been developed. The output signals of the solid state color image sensor include luminance information and chrominance information. The former information is obtained by passing the output signal of the solid state color image sensor through a low pass filter, and is used as a luminance signal Y . On the other hand, the latter information is obtained by passing the output signal from the solid state color image sensor through a band pass filter. This latter information, i.e., chrominance information is separated into red information and blue information, by a separating means. This separating means includes a one horizontal line period hereinafter, referred to simply as 1 H delay circuit, an adder, and a subtractor. In the adder, non delay chrominance information constituting an output of the band pass filter and delay chrominance information constituting an output of the 1 H delay circuit are added together, whereby red information is obtained from this adder. On the other hand, in the subtractor, subtraction is performed between the non delay chrominance information and the delay chrominance information. From this subtractor, blue information is obtained. The red and blue information are subjected to detection by a detector, to become a red signal R and a blue signal B , respectively. The red signal R , blue signal B , and luminance signal Y are inputted into an encoder, in which a color video signal is composed with the use of these input signals. In order to obtain a color signal from the output signal of the solid state color image sensor in the above mentioned way, it is necessary to perform an operation between the chrominance information of one horizontal line and that of another horizontal line which is adjacent thereto. That is to say, the red signal R and the blue signal B are obtained with the use of the vertical correlation between the two adjacent horizontal lines. Accordingly, a means for performing said operation generates a color alias with respect to that portion of the foreground to be picked up which has no vertical correlation. Namely, a conventional color signal separation circuit carries out its operation based on the assumption that a vertical correlation exists between the colors and brightness of the foreground. And also, when the foreground contains a portion where no vertical correlation exists between its color and that of the background i.e. when the color and or brightness of that particular portion of the foreground are in sharp contrast with the color and or brightness of the background the video images of the foreground and background contain a color alias at their boundaries. Further, as mentioned above, the conventional circuit is arranged so that the red information and blue information are subjected to detection by a detector, to become a red signal R and a blue signal B , respectively, which are inputted into the encoder. In the encoder, the red signal R and the blue signal B are matrixed, whereby a green signal G is prepared. In the encoder, thereafter, the red signal R , blue signal B , green signal G , and luminance signal Y are composed. According to circumstance, in order to simplify the circuit, the red signal R , the blue signal B and the luminance signal Y are directly used for obtaining the TV signal without the green signal being made. In such cases, the linearity of the signals are important factors in determining the white tracking, white balance, and hue correction of the picture. However, since the conventional color signal separation circuit is such that the blue information and red information are subjected to AM detection, where a signal having a low brightness level in particular is processed, the white balance deteriorates because the linearity of the detector circuit diode detector circuit is bad. That is, it is difficult to obtain a uniform white balance from high to low illumination portions of a subject. Further, for the R, G, B and Y signals, corresponding to signals which are obtained through filters having good spectrum sensitivity , a color adjustment circuit is provided in many cases. The color adjustment circuit uses the R, G, B and Y signals in its calculations. However, the white balance deteriorates because the signal ratio is changed by the calculations. Further, if all combinations between R, G, B and Y signals are calculated, the calculation circuit is complicated and the adjustment is complex. For this reason, the adjustment can not be achieved in a limited adjusting width. EP A 0057923 discloses a solid state imaging apparatus in accordance with the pre characterizing part of claim 1. According to this reference, a gate control means is provided, and a gate control signal is produced on the basis of the detection results relating to both vertical correlation and horizontal correlation of the video signal. Amplifiers are provided before the separating means. By way of using the gate control means it is intended to obtain a better color reproducibility. FR A 2464611 discloses a control circuit for automatically setting to zero the color difference signals. Specifically, the document discloses to adjust the levels of the primary color signals R and B such that the difference signals R Y and B Y become zero. The present invention has been made in view of the above mentioned circumstances to provide for an apparatus which is capable of eliminating the color alias, thereby improving the quality of the picture. The problem underlying the present invention is to provide a solid state color imaging apparatus which permits the white balance to be stably maintained in the picture and which makes it possible to easily adjust the hue correction. In order to solve the above problem, the present invention provides a solid state color imaging apparatus of the above type and having the features of the characterizing part of claim 1. This invention can be more fully understood from the following detailed description when taken in conjunction with the accompanying drawings, in which Fig. 1 shows a solid state color imaging apparatus according to an embodiment of the present invention. A solid state color image sensor 11 has a color filter array 20 shown in Fig. 2 with respect to its picture elements. In the color filter array 20, W, G, Ye, and Cy represent the following filter portions, respectively. The output signal of the solid state color image sensor 11 is inputted into a one horizontal line period delay circuit 17 and an adder 18, which together constitute a composing means, and also imputted into a signal separation circuit 12. The adder 18 adds the output signal of the solid state color image sensor 11 to the output signal of the 1 H delay circuit 17. Assuming now that the output signal of the adder 18 is S3, The S3 indicates a fundamental composite signal for demodulating the R, G and B signals at an aftermentioned operation circuit 19. In the above formula 1 , the Ws, Gs, Ys, and Cs represent the following signal amounts. The signal separation circuit 12 separates the output signal from the solid state color image sensor with respect to each individual picture element. That is to say, with respect to the nth line, the circuit 12 separates the output signal Ws of the picture element corresponding to the whole color light transmission filter portion W and the output signal Gs of the picture element corresponding to the green color light transmission filter portion G . With respect to the n 1 th line, the circuit 12 separates the output signal Ys of the picture element corresponding to the yellow color light transmission filter portion Ye and the output signal Cs of the picture element corresponding to the cyan color light transmission filter portion Cy . Namely, with respect to the nth line, the signals are obtained from the signal separation circuit 12. With respect to the n 1 th line, the signals are obtained from this circuit 12. The signals a1 and b1 of the above formula 2 or 3 which have thus been obtained from the signal separation circuit 12 are inputted into a gain control circuit 13. This gain control circuit 13 gain controls one or both of the two input signals a1 and b1 and produces the two gain controlled output signals a2 and b2 which are inputted into a subtractor 14. In the gain control circuit 13, gain control is previously made so that the difference between the output signals a2 and b2 , when an image having some color is pick up by the image sensor, is zero. The image having some color is one having a white achromatic color, for example. Accordingly, when the white object has been imaged on the entire screen of the solid state image sensor 11, gain control is made such that a2 Ws b2 Gs with respect to the nth line and a2 Ys b2 Cs with respect to the n 1 th line, by previously rearranging the characteristic of the gain control circuit 13. In these formulae, the symbols parenthesized indicate the filter portions corresponding to the output signals a2 and b2, respectively. The gain control circuit 13 contains a first amplifier for amplifying the signal a1 and a second amplifier for amplifying the signal b1 , the gain of said second amplifier being changed over to α or β with respect to each horizontal line so as to cause the formulae 6 and 7 , as later described, to be established. The gain control circuit 13 may contain a first amplifier for amplifying the signal a1 and second and third amplifiers for amplifying the signal b1 . In this case, the second and third amplifiers have their gains set to α and β respectively, as later described, and with respect to the nth line the output of the second amplifier is drawn out by a switch while with respect to the n 1 th line the output of the third amplifier is drawn out by a switch. Assume now that the entire screen of the solid state image sensor is exposed to a white colored image and that the signal amounts contained in the output signals of the picture elements are represented by Ws wh , Gs wh , Ys wh , and Cs wh . At this time, the two output signals a2 and b2 of the gain control circuit 13 are expressed as follows with respect to the nth line, the reference signal is Ws and the reference signal is Ys . Hereinafter, for simplification, Assume now that the difference signal of the subtractor 14 obtained with respect to the nth line is S1 while the difference signal of the subtractor 14 obtained with respect to the n 1 th line is S2. Then, these difference signals S1 and S2 are expressed as follows. Namely, Accordingly, from the subtractor 14, the signal S1 or S2 is alternately obtained with respect to each horizontal line. The color signals R, G and B are prepared with the use of the above mentioned signals S1 and S2 and the above mentioned signal S3 from the adder 18. However, since the signal S1 or S2 is alternately obtained with respect to each line, these signals S1 and S2 are required to be synchronized with each other so as to be simultaneously inputted into specified terminals of an operation circuit 19 with respect to whatever line on which the scanning operation is being performed. The means whereby such synchronization is performed is a one horizontal line period delay circuit 15 and one horizontal line period changing over switch 16. That is to say, the output signal from the subtractor 14 is inputted into one input terminal of the 1 H changing over switch 16 as well as into the 1 H delay circuit 15. To the other input terminal of the 1 H changing over switch 16 is inputted an output signal from the 1 H delay circuit 15. The 1 H changing over switch 16 has an output terminal for the signal S1 and an output terminal for the signal S2. Its input signal is alternately changed over to a mode shown in Fig. 1 by a broken line, or a second mode shown in Fig. 1 by a one dot chain line, with respect to each scanning line. Thus, the signals S1 and S2 are synchronized and then inputted into the operation circuit 19. For example, a horizontal synchronizing pulse which is used to drive the color image sensor 11 is used as a control signal for controlling the 1 H changing over switch 16. Thus, the signals S1, S2 and S3 are inputted into the operation circuit 19. Preparing the signal S3 is possible without using the 1 H delay circuit 17. In this case, the line from the solid state image sensor to the 1 H delay circuit 17 and the adder 18 is cut off, then the signals S1, S2 are inputted into the adder 18 as shown Fig. 1 by one dot chain lines. That is, it is also possible to prepare the signal S3 with the use of the not gain controlled signals a1 and b1 which constitute the output signals of the sample and hold circuit 12. In this case, with respect to the nth line, Another way of preparing the signal S3 is possible without using the 1 H delay circuit 17 and the adder 18. In this case, the output signal from the solid state image sensor is used, as it is, as the signal S3. The signal S3 can be disclosed by the formulas 8 , 9 . The color signal information processing circuit which is enclosed by a broken line of Fig. 1, and which has been explained above, effectively works to prevent the generation of a color alias. That is to say, in the gain control circuit 13, the gains α and β of the amplifiers which have previously been explained in connection with the formulas 4 to 7 are controlled. Namely, the gain control circuit 13 is so set that when the screen of the sensor 11 is entirely pick up by the image sensor with a white colored image, Ws αGs and Ys βCs with the result that the difference signals S1 and S2 are zero. These difference signals S1 and S2 are prepared from the output signals obtained by scanning a single horizontal line. At the stage where the signals S1 and S2 have been obtained, therefore, even if a foreground portion having no vertical correlation in brightness is imaged in a video screen, the output signal obtained by scanning an adjacent horizontal line is prevented from affecting the output signal obtained by scanning the present horizontal line. As a result, the generation of a color alias is prevented. The gains α and β of the amplifiers contained in the gain control circuit 13, as stated before, were controlled so that, in the state wherein the entire white color image is picked up by the image sensor, the signals S1 and S2 may become zero. The reason for this is that the reproduction of false colors in the white colored picture image in particular is prominent. The operation circuit 19 is a circuit which is intended to obtain the signals R, G, and B necessary for composing color video signals by using the signals S1, S2, and S3. The operation coefficients in the operation circuit 19 are determined when the respective color signals outputted therefrom are SR, SG and SB, as follows. The signals S1, S2 and S3 are expressed with the use of the formulae 1 to 7 , as follows. Assume now that M is defined as follows. Then, the signal amounts SR, SG, and SB of the signals R, G, and B are expressed with the use of the inverse matrix, as follows. Accordingly, by setting into the operation circuit 19 the operation coefficient shown in the formula 12 above, it is possible to obtain the signals R, G and B necessary for composing the color video signals. The signals SR, SG, and SB which have been composed through the calculation made in the operation circuit 19 are inputted into an encoder 20 and thus become color video signals of standard format. In the above mentioned signal processing operation, where the white color image is pick up by the image sensor, S1 S2 0 even when a difference exists between the nth line and the n 1 th line in respect of brightness level. Accordingly, in this case, each of the signals SR, SG, and SB is prepared from the signal S3 in the following form. The respective coefficients of the signals S3 in the above formula 13 are intended to make the ratio between the signals SR, SG, and SB 1 1 1 under the state of white balance. Further, as is obvious from the fomula 13 , if the respective coefficients of the signals S3 are set to 1, the ratio between the signals SR, SG, and SB is 1 1 1. Therefore, in the fomula 12 , when the respective coefficients of the signals S3 are set to 1 and the other coefficients are normalized according to the signals S3, the white balance can be obtained in a balanced state. In this case, the signal amounts of SR, SG, and SB of respective signals R, G and B are shown in the following formula 14 . In the present invention, as long as the color of a foreground subject is white, the requirement of S1 S2 0 is satisfied. Therefore, the formula of SR SG SB 1 1 1 is established even when a difference exists between the portions of the foreground as vertically viewed in respect of brightness level. The color of the reproduced foreground portion is white and it is not possible for any false signal to be generated. That is, at the stage where the output signals SR, SG and SB have been obtained from the operation circuit 19, a good state of white balance is already obtained. Usually, a final hue adjustment in the camera is performed by photographing a standard color chart such as, for example, a color bar chart in advance and viewing a color monitor. This adjustment is performed by adjusting the signal amounts of the signals Y, R and B inputted into the encoder, through the operation between these signals Y, R and B. In the prior art color signal processing circuit, however, in some cases when the hue adjustment is performed, since the signal ratios between signals Y, R and B are changed, the white balance is lost. Therefore, the white balance adjustment is again required. As a result, the adjustment is complicated and the width of adjustment latitude is small. In contrast, according to the present invention, the hue correction is achieved at the same time as the color separation by the coefficients of S1, S2 in the M ¹ of formula 12 , which are changed. In this case, the width of adjustment for the color signal is large and the adjustment can be performed independently corresponding to each color signal. Further, since the formula S1 S2 0 has been obtained for the foreground, the hue correction can be provided independent of the white being balanced. Accordingly, the latitude with which the hue adjustment can be performed is made wider. Thus, the present invention can contribute to obtaining a video image having good reproduced colors. The standard color television signal is made by using the above mentioned R, G and B signals. But when the number of picture elements in the horizontal direction of the solid state image sensor is less, the resolution in the horizontal direction is insufficient. This means, R, G, B and Y signals are produced by using an output signal which is obtained from every other picture element in the horizontal direction. In this case, the resolution in the horizontal direction is improved by the output from the solid state image sensor. The resolution is improved, when R, G and B signals obtained from the invention system are used as the chrominance signal, and when the output signal from the solid state image sensor is used, as it is, as the luminance signal. The solid state color image sensor and color filter which are used in the present invention are not limited to those which have been used in the above mentioned embodiment. In the above mentioned embodiment, the solid state color image sensor wherein its picture element and the filter portion of its color filter array are 1 1 was explained. However, the arrangement of the picture elements may be of the type wherein, as shown in Fig. 3 by broken lines, one picture element in one horizontal line is shifted 180 from its corresponding picture element in an adjacent horizontal line. In this case, the color filter 23 is such that strip like filter portions Ye, W, Cy and G are repeatedly arranged side by side in the horizontal direction. In this type of color picture image sensing means as well, the operation processing is carried out by using as the operation units the output signals of 2 2 picture elements, i.e., horizontal two picture elements and vertical two picture elements. In this type of color picture image sensing means, the output signal of, for example, the picture element 24 is a composite signal of the signals sensitive to the lights passed through the filter portions Ye and W . The output signal of the picture element 25 is a composite signal of the signals sensitive to the lights passed through the filter portions Cy and G . The output signal of the picture element 26 is a composite signal of the signals sensitive to the lights passed through the filter portions W and Cy . Further, the output signal of the picture element 27 is a composite signal of the signals sensitive to the lights passed through the filter portions G and Ye . The output signals of these picture elements 24, 25, 26 and 27, in combination, are used as the basic operation units, whereby the processing of the operation involved is carried out. Where said color picture image sensing means is used, a good horizontal resolution is obtained. Since the strip like color filter portions are arranged in the form of a stripe, manufacture of the filter is easy. In the above example, the operation processing was carried out by using as the basic operation units the output signals of 2 2 picture elements, i.e., horizontal two picture elements and vertical two picture elements. However, the operation processing can also be performed by using as the basic operation units the output signals of 2 4 picture elements. In this case, color filters 28 and 29 which are shown in Figs. 4A and 4B are used. According to the image sensor having the color filter 28 or 29, output signals from two picture elements divided into high and low signals adjacent to one another are added and read out as horizontal signals, and the combination of the picture elements, to be interlaced, is changed in each field. Where the image sensor which uses the color filter 28 or 29 is used with respect to an odd field, the information in the nth line, the n 1 th line are read out as shown and, with respect to an even field, the information in the n 263 th line, the n 264 th line are read out as shown. Therefore, the cyclic period in which the information of the picture elements in this image sensor is read out is 1 2 of the cyclic period in which the information of the picture elements in the image sensor having the filter array of Fig. 2 is read out. Accordingly, in the case of this color image sensing means, the time period in which the information of each picture element is accumulated is 1 2 of the time period required in the case of the image sensor described in the preceding first embodiment Fig. 1 . In this color image sensing means, therefore, an advantage that the residual images are lessened is offered. The color image sensor used in the present invention is not limited to the type which has been used in the preceding first embodiment. That is to say, the technical concept of the present invention is not limited to the above mentioned method whereby the output signals are drawn out from the picture elements and the above mentioned method whereby such signals are gain controlled. Fig. 5 shows another embodiment of the present invention. In Fig. 5, the same parts or sections as those which appear in Fig. 1 are denoted by like reference numerals. The solid state color image sensor 31 used in this second embodiment is one which is capable of reading out the output signals of picture elements corresponding to four picture elements two horizontal picture elements and two vertical picture elements , through four lines, simultaneously. Accordingly, the use of this type of image sensor eliminates the necessity of providing the sample and hold means and synchronizing means provided in Fig. 1. By composing the signals Ws, Gs, Ys and Cs read out from the image sensor 31 having the color filter array shown in Fig. 2 through the operation of an adder 36, the signal S3 is obtained. Further, if the signal Gs is gain controlled in a gain control circuit 32 and the operation of Ws αGs is performed in a subtractor 34, the signal S1 will be obtained. Further, if the signal Ys is gain controlled and the arithmetic operation of Ys βCs is carried out in a subtractor 35, then the signal S2 will be obtained. That is, in the subtractors 34 and 35, the operations in the above mentioned formulae 6 and 7 are performed. It should be noted here that the gains α and β of the gain control circuit 32 are previously controlled so that S1 S2 0 under the condition wherein a white colored foreground portion is pick up by the image sensor over the entire screen of the image sensor. In the foregoing description, when subtraction is performed, the output signals of two horizontally adjacent picture elements were used as one set of signals. This indicates that, for example under the condition wherein the white colored foreground portion is entirely pick up by the image sensor, generation of color alias is prevented even when a great difference in brightness exists between the vertical portions of the video image. The present invention is not limited to said combination of operational factors output signals of picture elements . That is, as shown in Fig. 5 by broken lines, the output signal of the gain control circuit 33 is inputted into the subtractor 34 and the output signal of the gain control circuit 32 is inputted into the subtractor 35, as another combination. In this case as well, the gain of each gain control circuit 33 or 32 is so controlled that S1 S2 0 under the condition wherein the white colored foreground portion is entirely pick up by the image sensor. When the operational factors are combined in that way, the following operations are performed. Namely, The type of output signal of the present invention is not limited to said standard color TV signal. That is, the type of output signal may be transformed according to the apparatus which needs the output signal of the color image system. R, G, B signals are used as they are, for example, when a monitor television set has terminals that can be input R, G and B signals. Further, when a magnetic recording reproducing apparatus needs the output signal of the color image system, the preferred type of output signal is the chrominance and luminance signal. As stated above, according to the present invention, the false signals which may be generated from the edges of a foreground portion as viewed in a specified direction can be lessened in accordance with the method of combination of the two difference signals. Further, the degradation in the detection characteristic of the detector conventionally used in the signal processing of such things as the frequency separation process, can be covered by the high linearity of the signal separation circuit, whereby the color displacements when the image is low in illumination are improved. Further, hue corrections can be individually performed according to each color signal without disturbing the white balance. Further, in the case of the on wafer filter wherein color filters are directly formed on the solid state image sensor, it is generally known that the lens like effect is produced due to the variation in shape of its surface with the result that a balanced signal, from the respective picture elements, is lost. This phenomenon is also prevented from occurring, at the stage where the difference signals are gain controlled. As a result, a picture signal of good quality can be obtained. As stated above, the present invention can solve the problems which are inherent in the prior art and contribute to obtaining a high grade of reproduced color picture images.