# CRYPTOGRAPHIC SYSTEM FOR DIRECT BROADCAST SATELLITE NETWORK

## Claims
System zum Senden von verschlüsselten Informationen von einem Übertragungsknoten zur Verteilung an eine Mehrzahl von Empfängerknoten mit jeweils ihrer eigenen Adressennummer, wobei das Sendesystem gekennzeichnet ist durch

## Description
The present invention is generally concerned with information distribution in which information in encrypted form is sent from a transmitter or sender node to a plurality of receiver nodes at which the encrypted information is decrypted to provide the information in clear. Such information distribution may be found in subscribers networks where only authorised subscribers are to be allowed access to the information. In a subscribers network in which the distribution of information, for example television programming, is done by direct broadcasting by satellite DBS , the distribution of encrypted information affords a means of discriminating between subscribers and non subscribers who may have receiver units capable of receiving the satellite transmission but who should be prevented from having free access to the programme content. Thus security of transmission becomes particularly important in DBS and has led to arrangements for controlling access by individual subscribers as will be discussed below. The invention relates to a system for sending encrypted information for distribution to a plurality of receiver nodes, to a receiver for use as a receiver node with the sending system, and to a network of such receivers and of the sending system and such receivers. The invention further relates to a method of sending information from a transmitter node to a plurality of receiver nodes. The invention finds particular, though not exclusive, application to information distribution using direct broadcast by satellite and still more particularly information distribution which includes television programmes. The invention will be described in detail in the context of television programme distribution by DBS. The availability of small, low cost television receive only terminals in recent years has resulted in an increasing demand for direct broadcast satellite services. Such services include Pay TV, tele conferencing, tele seminar, private broadcast networks, and the like. Moreover, as receive only television antenna technology improves and the cost of television receive only terminals decreases, the demand for direct broadcast satellite services is expected to increase. Unlike land lines and terrestrial microwave links, satellite transmissions lack privacy. Such transmissions can be received by any TV receive only terminal whose antenna is situated to receive the satellite signals. Accordingly, the secure transmission of video and audio programming and data signals is required to provide the privacy essential to many applications. A simple example of a direct broadcast satellite network in which security is required is one which broadcasts television signals to paying subscribers. Since any receiver having an antenna in the broadcast signal area can receive the satellite signals, it is necessary that the signals be encoded in a way which can be decoded only by subscribers receivers. Certain subscribers may have paid for certain programs or program groups, whereas others may have paid for other programs or program groups. The signals must then be further encoded such that subscribers who have paid for particular programs or groups of programs can receive same, while other subscribers cannot. In addition, it may be desirable to design the system such that a particular subscriber can preview a program and then decide whether he she wishes to watch the program and, hence, pay for the privilege. In such an impulse pay per view system, the decision of the subscriber must be recorded and communicated to a billing facility for appropriate billing. In such instances, the control signals to the subscriber s receiver instructing the receiver how to communicate with the billing office must be secure in order to eliminate the possibilities for theft of the service. We shall describe below a DBS service having the facilities outlined above and to which the teaching of the present invention is applied. Stated in broad terms, in one aspect the invention provides a system for sending encrypted information from a transmission node for distribution to a plurality of receiver nodes each having an individual address number, the sending system comprising As will be explained more fully below the above master encryption key is stored only at the sending or transmitter end of a complete network which greatly benefits maintenance of security within the network. It is preferred for additional security that the individual receiver keys generated within sending system are generated in real time. To this end the sending system may comprise a real time controller operable to control the selection of address numbers and the operation of the second encryption stage such that, at each encryption of the common key by the third encryption stage, the relevant individual receiver key is generated in real time by the second encryption stage. A further action to enhance security is to arrange for the common key generating means to change the common key from time to time. In the sending system to be described the second, third and first encryption stages operate according to the Data Encryption Standard algorithm, a block cypher algorithm and a stream cypher algorithm respectively. For distribution of the encrypted common keys to the relevant receivers, the sending system may further comprise means for selecting the address numbers of the plurality of receiver nodes in a sequence for encryption by the second encyption stage and means for assembling a data stream for distribution to the receiver nodes which includes the encrypted common keys and respective address information identifying the receiver node for which each encrypted common key is intended. In the embodiment to be described the means for assembling this data stream is adapted to provide addressed packets of data each comprising the address number of a receiver node and the encrypted common key pertaining to that address number. The data stream may be incorporated within a television signal format having video signal portions and horizontal blanking intervals, the data stream being inserted into the horizontal blanking intervals to form a composite television signal. Furthermore, in this composite television signal the encrypted information may also be inserted in the horizontal blanking intervals. The information in clear from which the encrypted information is derived may be audio accompanying a television picture transmission. Another aspect of the invention lies in providing a receiver for use as a receiver node with the sending system of the invention, comprising It will be shown hereinafter how in the preferred embodiment of the invention, the individual receiver key stored in the receiver is generated at the time of manufacture of the receiver by means of an encoding system in which the master key is stored and encrypts the individual address number allotted to the receiver in question. This encryption may use the Data Encryption Standard already mentioned. In this case there is produced a stored receiver key which is identical to the individual receiver key that will be generated by the sending system when that particular receiver node is to be sent a data message such as the encrypted common key. The individual receiver keys which are used internally at both the sending end and at the receivers do not need to be transmitted between the two and thus cannot be intercepted. It will be appreciated that the philosophy of the encryption and decryption underlying this invention enables a subscribers network of receiver nodes to be controlled from the sending end, each node being allotted a different address number and comprising a receiver as defined above storing a receiver key related to the individual address number. Thus in combination with the sending system of the invention, the subscribers network of receiver nodes constitutes an information distribution network in which the master key is neither stored in, nor need be sent to, the subscribers network. The master key is kept secure at the factory and the sending end of the distribution network which in the Applicants view makes it most difficult to establish a non authorized decoding of the encrypted information. The receiver of the invention may also have features commensurate with preferred features of the sending system discussed above such that the two operate in a complementary fashion. In yet another aspect of the invention there is provided a method of sending information from a transmitter node to a plurality of receiver nodes in which the information is distributed in encrypted form from the transmitter node to the receiver nodes and in which each receiver node has an individual address number allocated thereto, comprising the steps of In the preferred implementation of the method of the invention the encryption of the common key to obtain each encrypted common key is done with a block cypher algorithm, and the decryption at a receiver node of the encrypted common key to obtain the common key is done with a block cypher algorithm. In this preferred implementation encryption of the information in clear to obtain the encrypted information may be done with a stream cypher algorithm and the decryption at a receiver node of the encrypted information to obtain the information in clear may be done with a stream cypher algorithm. It is preferred that the encryption of each receiver node address number to obtain the individual receiver key is done with the Data Encryption Standard algorithm. The encrypted common keys are preferably assembled together with associated receiver node address information into a data stream for distribution, and each receiver node stores its address information and uses it to identify the encrypted common key pertaining to that receiver node. More particularly, in the distribution arrangement to be described, the data stream distributed to the receiver nodes comprises addressed packets of data each comprising the address number of a receiver node and the encrypted common key pertaining to that address number, and the address information stored by each receiver node is its address number. The data stream may be incorporated within a television signal format having video signal portions and horizontal blanking intervals the data stream being inserted into the horizontal blanking intervals. The encrypted information may also be inserted into the horizontal blanking intervals. The information in clear to be sent in encrypted form may comprise audio accompanying a television picture signal. As already noted the invention finds particular application in information distribution by direct broadcast by satellite and an embodiment of the invention for DBS purposes will now be more fully described with reference to the accompanying drawings in which We shall firstly describe in general terms the principles of a television broadcast system using DBS with which the invention finds application. In the direct broadcast satellite service in which the cryptographic techniques of the present invention are used, the video signals are processed and transmitted in analog form. Audio signals are digitized and transmitted in digital data form. Addressable control data is organized into packets according to address and transmitted in the same digital form as the audio signals. All of the signals are combined in baseband using time division multiplex techniques. The combined baseband signal is then transmitted over the satellite link to subscribers receivers using FM modulation. In general, the transmission end equipment consists of a program processing unit and a real time controller. The program processing unit performs video signal processing and scrambling, audio digitization, encryption of the audio data, and baseband signals time multiplexing. The real time controller generates audio cryptographic keys, encrypts the addressable control messages, generates the packet messages in accordance with the transmission protocol, maintains the user data base and communicates with other processing units. The receiving end equipment includes an addressable controller decoder designed for use with a receiver which has the necessary interface for interaction with the decoder. The addressable controller decoder demultiplexes the baseband signal, controls the terminal, descrambles the video signal, decrypts the audio data, and converts the audio data into analog form. The baseband signal utilizes a composite video signal format which includes active video portions and horizontal blanking interval portions. The two audio channels and control data channel occupy a portion of the horizontal blanking intervals. The video frame synchronization information and the zero level reference are transmitted during the vertical blanking interval. The audio data and the control data are transmitted in a burst, synchronous mode. The data is non returnable to zero binary encoded. A two level video scrambling screen is used. The first level is achieved by removing the line and frame synchronization pulses completely from the video signal. A unique sync word is transmitted in the vertical blanking interval for synchronization purposes. The addressable controller decoder establishes synchronization by searching and locating the sync word. Once the sync word is located, all the sync pulses are reconstructed with reference to the sync word. This technique is used in conjunction with video signal inversion, which is the second security level. The sequence of video inversion is controlled by a binary bit stream at the transmitting end. The same bit stream is used to recover the inverted signal at the receiving end. Unlike video scrambling, a highly secure audio encryption system can be achieved relatively inexpensively. The decryption circuit, being totally digital, can be implemented using semi custom or custom integrated circuits. It is highly important that the encryption system employed achieve zero transmission error propagation, that is, one bit in error in the encrypted bit stream results in only one bit in error in the decrypted bit stream. The system uses an encryption scheme in which the clear audio bit stream is combined with the bit stream generated by a stream cipher using an exclusive OR operation. The receiving end decrypts the audio bit stream using the same stream cipher bit stream. The stream cipher bit stream is generated by a secret key and an initializing vector. The algorithm for generating the bit stream is secret. The secret key is used for the duration of the communication session and is transmitted in encrypted form through the control data channel. The initializing vector Is used for the duration of each NTSC frame in the United States and is transmitted in the clear form in the horizontal blanking interval. Extremely low error rate for the initializing vector is achieved by transmitting each bit many times. The addressable control data channel carries a lot of sensitive information such as audio decryption keys and authorization tier levels. The present system is designed to prevent an eavesdropper from receiving the correct information and to prevent a legitimate terminal from receiving more information than is authorized. The encryption system utilized in accord with the present invention uses the concept of different terminal keys. A different key is used for the encrypted transmission to each receiver terminal. In this way, even in the unlikely event that a terminal key is compromised, damage can be stopped quickly by deleting the key. The addressable control data are organized into blocks of 128 bits and encrypted using a secret block cipher. The length of the terminal key is 64 bits. When compared with the conventional Data Encryption System algorithm, the present block cipher has a larger block and a longer key. Accordingly, brute force attacks on the cipher will take considerably more effort. In general, the cryptographic system to be described is designed for use in a pay television distribution network and employs three keys to provide security against unauthorized program viewing. First, a master factory key is arbitrarily chosen as a system constant. Second, the master factory key is used in conjunction with an individual subscriber unit address to produce a second key, called a subscriber unit signature key, unique to each subscriber. A third key, the common audio decryption key, is arbitrarily chosen to encrypt the audio signal at the transmission end. The third key is distributed to each authorized subscriber through the use of the first and second keys. At the factory, the subscriber unit signature key is pre loaded into a memory in a specific subscriber receiver unit. To distribute the common audio key, it is encrypted using the subscriber unit signature key as the key input of a unique block cipher algorithm. The resulting encrypted common audio key is delivered to the specific subscriber by an addressed packet in an addressable data stream. At the specific subscriber receiver unit, the received encrypted common audio key is decrypted using the unique block cipher algorithm which employs the factory pre loaded subscriber unit signature key as the decryption key. The resulting common decryption key is then used to decrypt the audio signal. The integrity of the three key system depends on the effectiveness of the security measures employed to keep the master factory key safe from independent discovery or unauthorized use. The system now described eliminates the necessity for protecting a separate key for each subscriber unit. In the present system, only a single key, the master factory key, need be protected at the transmission end. Since the direct broadcast satellite network in which the cryptographic system is employed is designed to accommodate 2 3 million different subscriber receiver units, the avoidance of the burdonsome need to a protect a different key for each subscriber unit is an advantage. The three key cryptographic system now proposed eliminates this problem entirely as it requires only a single master factory key be protected. As seen in Fig. 1, the audio channel inputs AUDIO 1 and AUDIO 2 form the inputs to a delta modulator and multiplexer 10 of conventional design. The digitized output from modulator 10 is encrypted in an audio stream encryption circuit 12. The output of encryption circuit 12 is the encrypted audio signal which forms a portion of a data stream. The data stream illustrated in Fig. 4 is inserted into the horizontal blanking intervals of the composite television signal which is transmitted via satellite from the transmission end to each of the subscriber receiver units. The digitized audio signal is encrypted using a common audio key generated by a common audio key generation circuit 14. The common audio key generating circuit 14 has capability for changing the common audio key periodically, either on a program by program basis or on a time basis such as hourly, daily, etc. The common audio key is transmitted in encrypted form to each subscriber unit. The encrypted common audio key is individualized for each unit. Each of the individualized encrypted common audio keys, one of which is present for each subscriber receiver unit, is placed in a different addressed portion of the data stream. These portions of the data stream can be received only by the particular subscriber unit for which the individualized encrypted common audio key is intended. Each individualized encrypted common audio key is generated through the use of a subscriber unit signature key. The subscriber unit signature key is unique to a particular unit. Each individualized encrypted common audio key is generated by encrypting the common audio key using the unique subscriber unit signature key in a block cipher algorithm circuit 16. Each unique subscriber unit signature key is based on the subscriber unit address number for the subscriber unit to which the portion of the data stream including the individualized encrypted common audio key is addressed. More specifically, each unique subscriber unit signature key is derived by encrypting the subscriber unit address number, stored in a memory 18, using the master factory key, stored in a master factory key memory 20, in an encryption circuit 22 which employs the Data Encryption Standard algorithm. As shown in Fig. 2, the transmitted encrypted audio signal is extracted from the data stream in the horizontal blanking intervals of the received composite television signal and forms an input to an audio stream decryption circuit 24. The encrypted audio signal will be decrypted using the common audio key. The common audio key is derived from the individualized encrypted common audio key which is transmitted to the receiver. The receiver monitors the data stream in the horizontal blanking intervals until it detects the portion thereof with its unique address number. The individualized encrypted common audio key for the particular subscriber unit is then obtained from the addressed portion. The individualized encrypted common audio key is then decrypted in a block cipher algorithm circuit 26 and used to decrypt the encrypted audio signal, also transmitted in the data stream. The subscriber unit signature key for the particular subscriber unit is utilized as the key for the block cipher algorithm circuit 26. The unique subscriber unit signature key for each subscriber unit is stored in a memory 28 within the unit. The unique subscriber unit signature key for the particular unit is stored in the unit memory in the factory. Fig. 3 schematically depicts the factory encoding system. At the factory, the subscriber unit address is read from the subscriber unit address memory 18 and stored in the subscriber unit address memory 32 in the subscriber unit. The subscriber unit address is encrypted in the Data Encryption Standard algorithm circuit 22 using the master factory key from memory 20 and is then stored in the subscriber unit signature key memory 28 in the subscriber unit. Later, when signals are being transmitted, the master factory key from memory 20 is used in the Data Encryption Standard algorithm circuit 22 to generate the unique subscriber unit signature key for each subscriber unit, as described above. Fig. 4 schematically represents the transmitted composite TV signal which comprises a plurality of active video portions, sync portions, and horizontal blanking portions. The data stream is inserted into consecutive horizontal blanking portions. The data stream includes a run in code for synchronization, an addressable data stream portion, the encrypted digitized audio signals, an audio code portion indicating whether the audio signals are stereo or bilingual, video inversion code, and spare bits. The addressable data stream includes a header portion, containing information for addressing certain groups of subscribers and certain program related information common to all subscriber units in the addressed group. The addressable data stream also includes a plurality of addressed packets 1...n, each containing the address number for a different subscriber unit. Each addressed packet also contains the individualized common audio key for the addressed unit. Each subscriber unit captures the encrypted audio information, finds a header with its group number, and then searches for the addressed packet with its address number. When the packet with its address number is located, the unit obtains the individualized common audio key therein and uses it, in conjunction with the unique subscriber unit signature key stored in the unit to decrypt the audio signals. It will now be appreciated that the three key cryptographic system that has been described permits the secure distribution of digitized signals to a large number of subscriber units without the necessity for storing a different key for each subscriber unit. Only a single master factory key most be protected in order to maintain the integrity of the entire system. Moreover, there is nothing stored in any particular subscriber unit which, if obtained, would permit the cryptographic system to be broken. Even interception and analysis of all individualized encrypted common audio keys will not provide information concerning the master factory key. Further, periodically changing the common audio key further increases the security of the system.