# ADDRESSING ENVIRONMENT STORAGE FOR ACCESSING A STACK ORIENTED MEMORY

## Claims
Speicheradressierungsumgebungseinheit, die an einen Speicher 36 zur Bildung von absoluten Speicheradressen angeschlossen ist, um auf im Speicher 36 als eine Reihe von Datensätzen angeordneten Datenelementen zuzugreifen, die durch ein Adressenpaar spezifiziert werden, welches aus einer Datensatzanzeige und einem Offset Wert zusammengesetzt ist, der die Verschiebung des Datenelementes gegenüber dem Basisspeicherplatz BASE 0, BASE 1, ... des Datensatzes repräsentiert, wobei die Einheit 33 Datensatzbasisadressenregister enthält, wobei jedes Register eine Adresse eines Datensatzbasisspeicherplatzes BASE 0 BASE 1 ... enthält, und au Berdem ein Eingangsregister 40 enthält, um das Adressenpaar aufzunehmen, wobei das Eingangsregister 40 an die Datensatzbasisadressenregister angeschlossen ist, um die Datensatzanzeige als übrig gebliebener Teil der Adresse an eines der Datensatzbasisadressenregister zu übertragen,

## Description
This invention relates to an addressing environment storage and more particularly to such a storage employed in accessing data items arranged in pushdown stacks which are stored in a computer memory. Most computer systems made to this day are of the conventional von Neumann organization which has remained relatively unstructured with the objective of being general purpose . However, over the past two decades, better understanding has been achieved in the exploitation of the potential of block structured programming languages that represent complex algorithms. Block structuring of algorithms, i.e., nested declarations, is a natural form for the expression of such complex algorithms. A particular computer system that was designed to employ such block structured, or nested languages, and also nested data structures is described in US A 3,461,434 US A 3,546,677 and US A 3,548,384. These documents describe a stack oriented data processor where the stack mechanism, a first in last out mechanism, handles the flow of operators and associated parameters in a manner which reflects the nested structure of particular higher level languages that are designed to handle natural forms for the expression of complex algorithms. Such languages include ALGOL and ALGOL type languages, such as PL 1, EULER, and so forth, which are based on the block structuring of algorithms, i.e., nested declarations. While this may appear to impose unnecessary constraints on system development, the resulting products, measured in terms of throughput and flexibility, suggest that design constraints may really have been design opportunities Cf., E. I. Organick, A system of the type described in the above identified documents is oriented around the concept of a segmented memory and specially treated segments called stacks. The processor runs in an expression stack operators take their arguments from the top of the stack and leave their results on the top of the stack. The data addressing space of the executing program is mapped into the stack as well as other stacks linked to it and data segments referenced by descriptors contained in the stack structure. The addressing environment of the executing code stream consists of a set of local addressing spaces contained within the stacks. These are called activation records or lexical regions and each consists of a set of variables addressed by an index relative to the base of the activation record. That is to say, addressing of a given data item is by way of an address couple of the form Lambda, Delta , where Lambda is lexical level of a given activation record in the stack and Delta is the offset to the variable from the base of the activation record at level Lambda. In order to access any activation record within a stack, the respective records, or lexical regions, are linked together by pointers from the base of the topmost activation record to the lowest level activation record. In the above described Barton patents, addressing is optimized by defining an array of display registers maintained in such a manner that element i in the array contains the base of the activation record at level i. This allows quicker access to any of the display values or addresses to the base of any particular activation record and is much quicker than evaluating links by following links from the top activation record down to activation record i. Activation records are created by executing a procedure entry operator and deleted by executing a procedure exit operator. Both operators may cause a change in the addresses of the various activation records and thus require that the display buffer be updated, which may take a non trivial amount of time to do. It is then an object of the present invention to provide such an addressing environment mechanism where changes in the make up of a given stack may be made and a set of display registers updated without taking an inordinate amount of time. It is still a further object of the present invention to provide such an addressing environment mechanism where a deleted set of display registers may be reused at a future time with the absolute minimum of evaluation necessary. In order to achieve the above identified objects, the present invention provides a memory address environment unit coupled to a memory for forming absolute memory addresses to access data items arranged in said memory as a series of records, which data items are specified by an address couple consisting of a record indication and an offset value representing the displacement of the data item from the base memory location of that record, said unit comprising record base address registers, each register containing an address of a record base memory location, and further comprising an input register to receive said address couple, said input register being coupled to said record base address registers to supply said record indication as the remaining part of said address to one of said record base address registers, characterized by a plurality of different sets of record base address registers, each set of record base address registers representing a particular memory address environment and a pointer register coupled to said plurality of sets of registers and containing a value indicating a particular memory address environment to be currently addressed, said value representing part of an address to a record base address register, said record indication serving to complete said address of said record base register. The present invention resides in a stack oriented data processor that employs a plurality of sets of display registers so that the current set of registers does not have to be updated each time the processor moves to a different area of data in the memory, which data is arranged in push down stacks. In this manner, the programmer only needs to provide a designation of a lexical level in a particular stack and the offset value from the base of a particular activation record in that stack for addition to obtain the actual memory address. The current set of display registers does not have to be updated when either the position or the lexical level of the topmost activation record in the current set is changed. A new set of displays may be created. In this case, the base of the topmost activation record is calculated and the remaining lower activation record bases are copied from the previous set of bases in the display buffer. A feature then of the present invention resides in a stack oriented data processor for accessing data arranged as pushdown stacks in main memory which processor has a plurality of sets of display registers, each of which contains a lexical level of base of a particular activation record in a particular stack so that a plurality of different stacks may be accessed by the processor without time consuming updates of the display registers. The above and other objects, advantages and features of the present invention will become more apparent from a review of the following specification when taken in conjunction with the drawings wherein The processor of the conventional type described in US A 3461434 is illustrated in FIG. 1. This processor is stack oriented and the function of the stack mechanism, a first in last out mechanism, is to handle the flow of operators and associated parameters in a manner which reflects the nested structure of a particular higher level language. In FIG. 1, the stack mechanism includes A register 11 and B register 12 together with a group of storage locations in memory 10. F and S registers in the group of program registers 13 store addresses for memory locations in memory 11 and are used in keeping track of the memory locations being used as a stack. A and B registers 11 and 12 respectively form the top two storage locations of the stack and are time shared between information stacks. Information is put into A register 11 and transferred down to B register 12, then transferred to the corresponding storage locations of the respective stacks in memory 10 by gate 14 under control of a control and timing unit 15 upon execution of an operator in operator register 16. Information is brought back out of a stack in a reverse order and taken out of the top of the current stack from A register 11. The information in the rest of that stack is effectively pushed up one position by appropriately changing the content of the S register contained in the group of program registers 13. The contents of S register point to the top of the current stack. The processor of FIG. 1 also includes a group of display registers 17 which are referenced by the symbols D0,...,DN. Each of the display registers 17 contain an absolute address of a memory location in memory 10 which absolute address references a lexical level or base of a particular activation record in the stack currently being addressed. Associated with display registers 17 it is a selection matrix 18 and a display register selection register DRSR 19. The lexical level value is stored in the DRSR register and designates a Particular display register. The selection matrix 18 is responsive to a lexical level value contained in register 19 to provide a signal causing the content of the corresponding display register to be read out of one of the group of display registers 17. Address adder 20 is provided to create the sum of the contents of one of the display registers 17 and a displacement value selected from A register 11, B register 12 or C register 21 to form an absolute memory address to thus access any location in any one of the corresponding blocks of storage in a particular stack. The reader is referred to the above referenced Barton et al. patents for a more detailed description of this prior art stack oriented processor. A data stack as might exist in memory 10 of FIG. 1 is illustrated in FIG. 2a and consists of four activation records at lexical levels 0 3, where the value of the topmost lexical level is stored in register LL of FIG. 1. The actual addresses in memory of the respective bases of the activation records are shown in FIG. 2a and these respective addresses are stored in display registers 17 of FIG. 1 in a manner illustrated in FIG. 2b. The order of lexical levels in FIG. 2b are inverse to that of display registers 17 in FIG. 1 for the purpose of easier correspondence between FIG. 2b and FIG. 2a. As was indicated above, activation records are created by the execution of a procedure entry operator by the processor. Thus, for the purposes of illustration, FIG. 2c illustrates that the processor is now working in a different stack or portion of memory. As a result, the display registers of FIG. 1 have had to be updated and this update is shown by the new contents of the display registers as shown in FIG. 2d. While the employment of a set of display registers provides the benefit of fast access to items in the given data stack, this benefit can be immensely overshadowed by the updating of the display register values to reflect changes in the addressing environment being employed by the processor. As illustrated in FIGS. 3a and b, the present invention employs a number of different sets of display registers. At any one time, however, only one set of display registers is visible. That set is indicated by pointer EC to the current set of displays as illustrated in FIG. 3b. When there is a change in addressing environment, the pointer may be changed to make another set of displays visible to the processor. A general purpose processor employing the present invention is illustrated in FIG. 4. It is distinct from the prior processor illustrated in FIG. 1 which is of a sequential nature. The processor of FIG. 4 is of a parallel or concurrent nature with a number of different units operating simultaneously. The processor of FIG. 4 includes a program scanner or program control unit 30 which receives strings of code from memory 36 by way of memory addressing unit 35 and supplies operators and parameters to execution unit 31, reference unit 33 and write unit 34 and also data or literal values to central data buffer 32 which can be accessed by both execution unit 31 and reference unit 33. Reference unit 33 of FIG. 4 computes absolute memory addresses from address couples that are received in the code stream from program control unit 30 of FIG. 4. A portion of reference unit 33 which does this computation is illustrated in FIG. 5. Display buffer 41 contains fifteen sets of sixteen display registers each for the purposes that were described in relation to FIG. 3B. These sets of display registers are loaded with the respective addresses of different base locations of particular activation records whose addresses are received from other portions of the reference unit as the activation records are being loaded and or created. The address couples are received from the program control unit by register 40 which is sixteen bits wide. The four most significant bits are used to specify an activation record or lexical region while the least significant twelve bits contain the displacement or offset within the activation record from that base address. The particular set of display registers currently being used is selected by pointer EC received from register counter 50 of the reference unit when the reference unit encounters a procedure entry operator or a procedure exit operator from the program control unit 30 of FIG. 4. Register counter 50 can be incremented upwardly or downwardly or set equal to zero. The four bit EC signals and the four bit lexical region designation signals address one of the display registers in display buffer 41 with the selected address of the activation record that was selected being transferred to base register 42 while the displacement value from register 40 is transferred to index register 43. These two values are then added together by address adder 44 with the sum being transferred to adder output register 45. This register addresses the data cache 46 and selects a particular item to be loaded into register 47. This register then loads the control data buffer 32 of FIG. 4 and makes the item available for use by other units in the processor. If the data item is not in cache 46, the adder output is sent to memory address unit MAU 35 of FIG. 4. Cache 46 is loaded from the MAU. In at least one sense, the entire memory of the data processing system may be thought of as a single global stack, or block, with other stacks, or blocks, nested in it down to any level. Any particular stack may be deleted or increased, which required prior art display registers in such an environment to be updated. With the present invention, the creation of a stack, or the change in a stack, can be accomplished by merely moving the display pointer EC to another set of display registers which renders the previous stack invisible to the processor. Also such a stack can be considered as deleted from memory when a procedure exit operator is executed, again, by moving the display pointer EC to another set of display registers. When a procedure exit operator is executed, the contents of the corresponding set of display registers can be deleted without requiring the calculations needed for display register update. For example, referring again to FIG. 3b, the processor is currently operating in a data stack in memory, such as illustrated in FIG. 3a. The corresponding display set set 1 is pointed to by pointer EC. If a procedure entry operator is encountered, changing or enlarging that data stack, display pointer EC is merely shifted to set 2 of the display registers. It will be understood that FIG. 3a merely represents a segment of storage locations in memory and is actually extended downwardly to storage location 0 and upwardly to the limit of memory. The uniqueness of this invention centers around deciding whether a particular procedure entry operator benefits most from updating the current set of display registers or creating a new set. Creating a new set also requires deciding whether to calculate all but the top display or copy them from the previous set. when a new set has been created, the subsequent procedure exit operator benefits immensely, since the current set of displays is simply thrown away by decrementing EC by 1. No display update is necessary. Also, by carefully monitoring the stacks on which the processor is running, the most recently deleted set of display registers deleted by an exit operator may contain the values except for the topmost display that the next enter operator will attempt to create. In this case, only the topmost display is calculated, and EC is incremented by 1 to point to this set. Prior art processors would have had to update all displays. An address environment storage unit for a stack oriented data processor has been described for operating in data sets arranged as structured blocks, or nested pushdown stacks. The address environment storage employs a plurality of sets of display registers such that the current set of display registers does not have to be updated each time the processor moves to a different area of data in memory. In this manner, the programmer only needs to provide a designation of a lexical level in a particular stack and the offset value from the base of the particular activation record in that stack for addition to obtain actual memory address. when the processor executes a procedure enter operator that calls for a new section of memory in which to operate, the display pointer is merely changed to point to the set of display registers provided for accessing that new area of memory without any loss of time such as would be required in prior art stack oriented processors.