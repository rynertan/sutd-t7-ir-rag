# APPARATUS AND METHOD FOR REPRODUCING AN ORIGINAL COLOUR IMAGE

## Claims
Vorrichtung zur Wiedergabe eines Originalfarbbildes mit Eingabemitteln 1, 3 zur Ableitung einer Anzahl von Farbsignalen, die jedem Bildelement des Originalfarbbildes entsprechen mit Trennmitteln 7 , die an die Eingabemittel 1, 3 angeschlossen sind, um die Farbsignale in eine Gruppe von entsprechenden Luminanz und subtrahierten Farbsignalen umzuwandeln mit Umwandlungsmitteln 11 , die an die Trennmittel 7 angeschlossen sind, um vorgegebene Treibersignale bezüglich der Gruppen von Luminanz und subtrahierten Farbsignalen zu speichern, die Farben aus einem Bereich von Farben entsprechen, um die Gruppe der Luminanz und subtrahierten Farbsignale von den Trennmitteln 7 in eine Gruppe von Treibersignalen gemäß den gespeicherten Treibersignalen umzusetzen und mit Ausgabemitteln 13 , die an die Umwandlungsmittel 11 angeschlossen sind, um das Originalbild gemäß der Gruppe der Treibersignale wiederzugeben

## Description
The present invention relates to the field of colour image reproduction. Advancements in colour image technology in recent years has been accompanied by considerable research and development directed to practical applications of colour photocopiers and printers. There are two types of colour photocopiers presently known in the art. In one type, colour reproduction is accomplished by photoelectric conversion of the original colour image to electronic signals which are processed and used to form the reproduced colour image. This method, however, is deficient because of poor resolution of the reproduced image and lack of quality due to the generation of noise components during the photoelectric conversion process. In another type of photocopier known in the art, the colour image is formed by chemical processing in the same manner as in conventional photocopiers. Though the electronic conversion method of colour image reproduction has the above mentioned deficiencies, it has received a great deal of attention because it does not require the cumbersome handling of chemicals and can be used to process images in a variety of ways. In a conventional colour image reproduction system where the original image is electronically processed, the original image is electronically scanned through colour filters to provide three colour signals. These analog signals are then converted to digital signals by an analog to digital converter A D converter . The digital signals are then subjected to separation and conversion to a luminance signal and two subtracted colour signals. The luminance and subtracted colour signals are converted to output signals by a ROM based conversion table for application to a reproduction device such as a photocopier or printer. The conversion table converts the luminance and subtracted colour signals to ink concentration signals which match the characteristics of the inks used by the particular photocopier or printer. Processing the scanned image signals by an A D converter and performance of the other processing steps, such as shading correction, gamma adjustment and separation into luminance and subtracted signals, can be done by comparatively simple circuitry. However, the conversion of the luminance and subtracted colour signals to the requisite ink concentrations is generally a very complex operation. A look up table is usually used for the conversion. Mathematical calculations are used to develop the conversion table so that specific combinations of ink concentrations for reproducing colours can be determined for the particular sets of luminance and subtracted colour signals. Such mathematical calculations are disclosed by John A.C. Yule in a publication entitled Principle of Color Reproduction, 1967, pp. 255 281. In actual practice, however, not all the specific sets of luminance and subtracted colour signals can be converted to corresponding ink concentrations which can be reproduced by the reproduction device. e.g. US A 2,902,539 Thus, no information is reproduced for these signals. In practice, there is a strong likelihood that luminance and subtracted colour signals which have no corresponding ink concentrations will be produced due to the generation of random noise components in the system. Thus, the quality of the reproduced image will be poor. It is an object of the present invention to provide a method and apparatus giving improved quality of colour image reproduction. It is another object of the invention to provide a method and apparatus for reproducing a colour image which is relatively immune to noise interference. Reference is directed to the appended claims in which the apparatus and method of the invention are set out. The invention will be more readily understood by way of example from the following description of colour image reproduction equipment in accordance therewith, and its method of operation, reference being made to the accompanying drawings, in which As shown in Figure 1, image input unit 1 provides original image information as a plurality of colour signals 2 and may, for example, be constructed in the manner shown in Figure 2. In Figure 2, document surface 21 constituting an object to be copied is illuminated by white light source 22. The image of document surface 21 is focused on the light receiving surfaces of photodetector arrays 24 by lens 23. Filters 25 of three different colours with different spectral transmission characteristics are disposed in corresponding relationship with a succession of three photodetector arrays 24. A set of three successive photodetector arrays 24, with their respective colour filters, constitute one picture element. The photoelectric analog outputs of these arrays are produced as colour signals 2 shown in Figure 1 which holds colour information for particular picture elements. Colour signals 2 are digitalized by A D converter 3 and the resulting digitalized colour signals 4 are normalized by shading correction circuit 5 to provide colour signals 6. Shading correction circuit 5 includes a table of data on the sensitivity and offset correction for each photodetector array 24 and uses this information to normalize each array 24 with respect to each other array 24. Thus, the effective output of each array is the same value for the same input picture element. Normalized colour signals 6 are separated into one luminance signal 8 and two subtracted colour signals 9a and 9b by luminance and subtracted colour signal separation circuit Y C separation circuit 7. Designating normalized colour signals 6 supplied to separation circuit 7 as x1, x2 and x3 and output signals 8, 9a and 9b from separating circuit 7 as y1, y2 and y3, separation circuit 7 performs the matrix operation indicated by the following equation. Output luminance signal 8 of separation circuit 7 represents the brightness of a picture element and subtracted colour signals 9a and 9b represent the hue of the picture element. If the input picture element is achromatic, both subtracted colour signals 9a y2 and 9b y3 are 0. Luminance signal 8 is further subjected to non linear conversion by gamma adjustment circuit 10 whose input output characteristics are shown in Figure 3. As is well known, gamma adjustment of the luminance signal is done in order to match the signal to the human characteristics which enable a person to discern levels of darkness. The range of subtracted colour signals 9a and 9b produced as outputs from separation circuit 7 and luminance signal 8 obtained from gamma adjustment circuit 10 is close to the colour tone discriminability characteristic of humans. Luminance signal 8 and subtracted colour signals 9a and 9b are converted to output signals for application to a reproduction device, e.g. colour printer 13, by conversion table 11. Colour printer 13 controls the concentrations of inks of different colours in accordance with ink concentration signals 12 from conversion table 11 and prints the colour image. Conversion table 11 is included within a ROM for producing outputs of ink concentrations dependent on the level of the luminance and subtracted colour signals that are supplied to it. The data in conversion table 11 is generated as follows. Sets of concentrations of the inks of three colours used by colour printer 13 are first specified. Correct colour reproduction is made possible by using the set of original ink concentrations as the conversion values output signal values provided by conversion table 11 in response to a set of luminance and subtracted colour signals. As shown in Figure 4, the sets of luminance and subtracted colour signals corresponding to all possible ink concentration sets with which output is possible does not fill the whole of the available luminance and subtracted colour space. In Figure 4, i represents the luminance signal axis, y and q represent the two subtracted colour signal axes, curved structure 41 represents the region of luminance and subtracted colour signal sets which correspond to sets of ink concentrations producible as output, and outer curved structure 42 represents the available luminance and subtracted colour signal domain total luminance and subtracted colour space . Thus, in the region outside curved structure 41 in Figure 4, the luminance and subtracted colour signal sets do not fall within the ink concentrations which are reproducible as output by the printer. In the present case, however, conversion to ink concentration signals which are reproducible as output by the printer is achieved even for those sets of luminance and subtracted colour signals that do not normally correspond to colours producible as output. An example of this will be described with reference to Figure 5. Figure 5 is a cross section of the luminance surface in the plane indicated by dotted line 43 in Figure 4. Shaded portion A is a cross section of curved structure 41 indicating the region in which values for conversion to ink concentration signals determined by the above noted calculation defined conversion values region . The conversion values for a signal at a point X in unshaded portion B undefined conversion values region falls outside the defined conversion values region. However, the conversion values for point X are assigned the conversion values for a point X . Point X is located at the intersection of the boundary of the defined conversion values region A with a line drawn between origin 0 and point X. Performing this operation for the whole of the undefined conversion values in region B and processing in a similar manner for all equal luminance planes makes it possible to provide conversion data for all sets of luminance and subtracted colour signals so that a colour image may be fully reproduced. An example of an algorithm for filling the undefined conversion values for region B in conversion table 11 will now be described with reference to the flow chart of Figure 6. In step 101, the conversion values for the defined region A shown in Figure 5 are determined by calculations using theoretical formulae, for exmaple using a Negebauer equation or by a masking equation. These values are then entered in the conversion table. In step 102, the calculation is begun for determining the conversion values for undefined region B shown in Figure 4. In step 103, parameters i, y and q are initialized. In step 104, a determination is made whether point i, y, q lies within the defined conversion values region A. If it does not, it is assigned the conversion values for point X. Point X is located at the intersection of the boundary of the defined conversion values region A with a line drawn between the origin i, 0, 0 and point i, y, q . For this purpose, point i, q, y is shifted very small amounts towards the point or origin O, as indicated by steps 105 and 106. The vector representing this movement is dϑ, and its q component dq is given by If the determination in step 104 is that point i, y, q is contained in region A, there is a move to step 109 and q is incremented by 1 and point i, y, q is shifted to the right as shown in Figure 5. There is then a return to step 104. If it is determined in step 110 that q has reached the upper limit nq 2 as a result of this shift, q is returned to the lower limit nq 2 and y is incremented by 1 in step 111 so that point i, y, q is shifted upward as shown in Figure 5. There is then a return to step 104. If it is determined in step 112 that y also has reached the upper limit ny 2, i is incremented by 1 and there is a return to step 104. Thus, if step 104 gives the answer YES , steps 109 to 114 operate to alter the positional parameters until the point i, y, q falls outside the region A. The program then passes to steps 105 to 108 to store the conversion values i, y1, q1 . Thereafter, the program moves to step 109 to select different positional parameters and a return is made to step 104. The iteration is continued until it is determined in step 114 that upper limit ni has been reached, when the operation of filling in region B is complete. Constructing conversion table 11 in the above described manner offers the following advantages. There is a strong correlation among normalized colour signals 6 and so the S N ratio for luminance signal 8, which is the sum of these signals, is higher than for the normalized colour signals. On the other hand, the S N ratio of subtracted colour signals 9a and 9b, which represents the difference between the pairs of normalized colour signals 6, is lower than that of normalized colour signals 6. Therefore, noise added to colour signals 2 affects colour signals 9a and 9b more than luminance signal 8. When a conversion table of the construction described in this embodiment is used, reproduction of good colour images is possible. Also, since human vision has greater discriminating ability with respect to luminance than with respect to hues, if there is input of signals for colours that cannot be represented by the inks used by the colour printer, those of the colours representable by these inks that are visually the closest to these unpresentable colours can be regarded as having the same luminance and being the colours that are the nearest within the relevant equal brightness plane. The conversion table construction described in this embodiment makes it possible to effect output of visually close colours even when there is input of signals for colours that are not producible as output. Although in the above embodiment, the conversion values signal values for output assigned for a particular set of luminance and subtracted colour signals that are not producible as output are conversion values which represent the closest sets of luminance and subtracted colour signals that are producible as output, it is also possible to have the conversion table so constructed that the conversion values assigned are the conversion values of a point corresponding to a colour producible as output in the luminance and subtracted colour space in the vicinity of the above noted closest set of luminance and subtracted colour signals. For example, conversion values relating to an outside point Y, shown in Figure 4 being located outside of curved structure 42, are derived according to the following procedure. First, normalized colour values y1, y2, y3 of a point Y are derived in normalized colour space, point Y corresponding to point Y. Figure 7 shows a normalized colour space having three axes x1, x2 and x3, each corresponding to one of the normalized colour signals curved structure 51 corresponds to curved structure 41 in Figure 4 but has a slightly deformed appearance because normalized colour signals are more correlative than luminance and subtracted colour signals. Normalized colour values x1, x2, x3 of a point X in which an error distance E becomes minimum are calculated. Error distance E is defined as follows where V The conversion values relating to point Y are derived as conversion values of point X in Figure 4 which corresponds to point X in Figure 5. The above procedure is repeated for all outside points of the curved structure. Thus, conversion table 11 can produce a high quality image by eliminating the influence of noise imposed on colour signals 2. Such noise is considered to have a rather low correlation and Gaussian distribution. The probability P of normalized colour signals x1, x2, x3 within the curved structure becoming normalized colour signals y1, y2, y3 outside the body caused by noise is given by the expression Thus, conversion values for point Y should be represented by the value which becomes the maximum of the probability. This condition is equivalent to finding the minimum of error distance Figure 8 shows a block diagram of another embodiment wherein Figure 1 is modified by the provision of a high frequency correction circuit 14 between separator 7 and gamma adjustment circuit 10. According to this embodiment, the high frequency range of signal 8 is emphasized by high frequency correction circuit 14 and then gamma adjusted by circuit 10. The high frequency correction circuit 14 is used in order to correct the decrease in the high frequency range of the image signals caused by the optical system of the image input unit. The gain to frequency characteristic of high frequency correction circuit 14 is shown in Figure 9. The higher the frequency, the higher the gain of the luminance signal. Thus, such signals having a slow change in luminance as shown in Figure 10A are corrected to a rapid change in luminance as shown in Figure 10B. It does, however, generate overshoots near the edge portions as shown in Figure 10B because of the incomplete correction by circuit 14. This causes sets of luminance and subtracted colour signals which do not correspond to colours that are producible as output. Figure 11 shows a cross sectional view of the curved structure shown in Figure 4 whose cross sectional plane includes the luminance axis or achromatic colour axis. Shaded region A is a cross section of curved structure 41 in which conversion values from luminance and subtracted colour signals to ink concentration values are given by equations. Unshaded regions B and C are located outside of curved structure 41 but inside of body 42, and is separated by a tangent line which touches the outermost point of the curved structure 41. Conversion values for points in region B are determined as follows First, a point P of region B is specified. Then a point P1 which is inside region A is determined. Point P1 represents the subtracted colour signals and should be an equal distance from the luminance axis and be close to the luminance value. The conversion values of point P is determined by the conversion values of point P1. Such an operation is repeated for all the points included in region B. Conversion values for points in region C are determined as follows. First a point Q of region C is specified. A point Q1 on the tangent line is then determined. Point Q1 has the same luminance as point Q, i.e. it is the crossing point between the tangent line and a line which passes through point Q and is perpendicular to the luminance axis. Next, a point Q2 which is inside region A is determined in a similar manner. That is, point Q2 is the outermost point in region A. Thus, the conversion values of point Q is determined by the conversion values of point Q2. Such an operation is repeated for all the points included in region C. The conversion table can be constructed so that a set of luminance and subtracted colour signals that do not correspond to a colour producible as output is assigned output signal values that are the same as those assigned to sets of luminance and subtracted colour signals that correspond to colours producible as output. The present invention is not just for production of colour images in the form of hard copy in a colour photocopier as described by way of example in the above embodiment, but, as long as a similar conversion table is employed, it may be applied, e.g. to an apparatus for showing colour images in a colour display, etc. Obviously, many modifications and variations of the above described preferred embodiment will become apparent to those skilled in the art from a reading of this disclosure. It should be realised that the invention is not limited to the particular apparatus disclosed, but its scope is intended to be governed only by the scope of the appended claims.