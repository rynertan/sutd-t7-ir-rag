# Digital data processing system.

## Abstract
The system comprises processor means PU 106 providing addresses to a memory 102 on an address bus MAD 108 . Data and instructions pass between the memory and the proces sor means by way of a data bus MDA 110 . Within the processing means PU 106 there is an internal databus DBUS 112 which provides the data to a central processor CPUP 122 which performs the arithmetical and logical operations commanded by the user program instructions. The output of the CPU passes to another internal bus YBUS 124 a memory data buffer MDB 132 is used to transfer data from the internal databus DBUS 112 to the main memory and from the main memory to the internal output bus YBUS 124 connected between the internal buses are a nibble shifter NIBS 126 and a scratch pad memory SPAD 128 which provides general scratch pad memory space, general registers for the CPU 122 and space for tables used in transfilming logical addresses to physical memory addresses via a memory address unit MAD 130 . The system operates under microprogram control effected by a control unit CU 104 includ ing means IPD 114 prefetching instructions and partially decod ing the same and a microsequencer US 116 which has a permanent store for kernel microcode and a writable memory for further microcode which can be entered via the main memory 102 to adapt the system to a specific instruction set. A memory control unit MC 118 performs error detection and correction and other memory related operations. Serial input output SIO 134 provides communication with a soft console while another unit DBIO 136 provides communication with bulk memory devices.

## Claims
CLAIMS I. A data processing system comprising processor means 2U 106 responsive to instructions for processing the data and for providing physical memory addresses for reacting the data from and writing the date to a main memory 102 which is responsive to the memory addresses for storing and providing the data and instructions, and memory bus means MAD 108, MDA 110 or conducting the memory addresses, data and instructions between the processor means andthemain memory means, characterised in that the processor weans PU 106 comprise first and second buses YBUS 124, D BUS 112 , input means and output means DB 132 connected between, on the one hand, the memory bus means MAD 108,MDA 110 and the first bus and the second bus respectively, C2U means 122 having an input connected from the sea s and an output connected to the first bus, and processor memory means SPAD 128 connected between the first bus YDS 124 and the second bus D BUS 112 , the processor r.rry means providing firstly aq scratch pad memory and general registers for arithmetic and logical operations of the processor cans, and secondly for storing and providing address information for relating user program logical addresses to corresponding physical addresses of corresponding storage locations in the ain memory 102 . 2. A system according to claim 1, characterised in that the processor memory means SPAD 128 comprises third and fourth buses LAR BUS 132, SPAD BUS 132 an addressing buffer LARR 136 connected from the first bus YBUS 124 to the third bus, a bidirectional buffer SPAD 152 connected between the second bus DBUS 112 and the fourth bus, a scratch ad memory s An.M 129 for storing and providing the address information and providing the general registers, having a bidirectional data port connected from and to eh fourth bus SPAD BUS 134 and an addressing input, and scratch pad addressing means SPAM 144 having an addressing output connected to the scratch pad memory addressing input and a first address input connected from the third bus LAR Bus 132 . 3. A system according to claim 2, further comprising instruction. receiving and storing means IPD 114 connected from the memory bus means MDA 110 to microinstruction control means US 116 responsive to instructions for providing seQuc nees of microinstructions for controlling the operations of the system, characterised in that the scratch pad addressing means SPAM 144 further comprises a second addressing input ACD, ACS connected from the instruction receiviing and storing means IPD 114 for addressing the scratch ra memory SPADM 129 with certain portions of c ertain of the instructions, and a third addressing input UIR connected from the microinstruction control means US 116 for addressing the scratch pad mernory with certain portions of certain. of the microinstructions. 4. A system according to claIm 2, characterised in that each one of said logical addresses comprises a logical page number field and a page offset field, each one of said corresponding physical address comprises a corresponding physica page number field, and said page offset field, and the address information stored and provided by the scratch pad memory SPADM 129 comprises the physical page number fields, and this memory is responsive to the logical page number fields provided to the said addressing input for providing the corresponding physical page number fields on the fourth bus SPAD BUS 134 . 5. A system according to cl aim 4, further characteried by a memory address unit MAD 130 haqving first and second inputs . L 150 and bLDM 140 for respectively receiving the physical pace number field and. corresponding page of set field of the physical addresses, and an output connected to the memory bus means MAD 108 for providing the physical addresses to the main memory 102 and in that the processor memory means SPAD 128 further comprisos a page offset bus connection from the third bus LAR BUS 132 to the memory address unit second input MADM 140 , a page number bus connection from the fourth bus SPAD BUS 134 to the major redress unit first input MAL 150 , and an internal page number buffer 142 connected from the third bus to the fourth bus, and in that the processor memory means SPAD 128 is responsive to operation of the system, a when a physical address is provided on the fourth bus SPAD BUS 134 from the addressing buffer LARR 136 , to provide the physical page number field to the memory address unit first input through the path including the internal page number buffer 142 and the page nu. er bus connection and to concurrently provide the corresponding page offset to the memory address unit second input through the page offset bus connection, and b when a logical address is provided on the fourth bus SPAD BUS 134 from the addressing buffer LARR 136 , TO provide the logical page number field to the scratch pad memory SPADM 129 through the scratch pad addressing means SPAM 144 and to concurrently provide the corresponding bysical page number field povided at the scratch pad memory data port to the memory address unit first input through the path including the fourth bus and the page number bus connection and the corresponding page offset field to the memory address unit second input through the page offset bus connection. 6. The processor means of claim 2, characterised in that the scratch pad memory SPADM 12 is comprised of a multiplicity of individually eddressable storage locations, each one of the storage locations is structure as a first set of data storage spaces ard a second set of data storage spaces, and in eacn one of the storage locations, the first and second sets of data storage spaces are separately addressable. 7. A data processing system comprising processor cans PU 106 for processing the data, a main memory 102 for storing the data and instructions for directing operations of the recessing means, or..ory bus means 2A 110 for conducting the ta ann instructions between the rain memory and the processor means, and instruction control means CU 104 , characterised in that the instruction control moans comprise instruction decoding moans IPD 114 connected frozen the memory MDA bus means DECODING 110 for receiving and initially decoding each instruction and microcode control means US 116 connected from the instructions decoding means IPD 114 and responsive to each instructions and to the initial decoding operations of the instruction decoding means for providing corresponding sequences of microinstructions for controlling the operations of the processor means PU 106 , and in that the instructions cons rise first, second and third sets of instructions having first, second and third formats respectively. 8. A system according to claim 7, characterised in that the first set of instructions Ku define a first cc r0.lete set of operations to be performed by the system, the second set of b,stnictions VUM define as an extension of the first set of instructions a further second complete set of operations to be performed by the system, and the third set of instructions HUM define as an extension to the first and second sets of instructions a third complete set of operations to be performed by the system. 9. A system according to claim 8, characterised in that each instruction of the first set includes an 8 bit operation code field Op, AC, commat , INDEX and an optional 8 bit offset field 8 bit displacement containing information for locating certain of the data to be operated upon, each i ,trucL ion of the second set of instructions includes a 16 bit operation cycle field 1, INDEX, AC, Op, 1001 and an optional 16 bit offset field containing information 15 or 16 bit displacement for locating certain of the data to be operated upon, and each instruction of the third set includes a 16 bit operation code field and an optional offset field of either 16 or 32 bits containing information for locating certain of the data to be operated upon. 10. A system according to claim 7, 8 or 9, characterised in that the microcode control means US 116 comprises means D BUS 112, UIM 554 connected from the instruction control means IPD 114 for receiving the instructions, means CONM 550 connected from otherportions of the system for receiving information regarding the state of the system, microcode memory means KUM 532, VUM 534, HUM 543 for storing and providing the sequences of microinstructions, and microcode sequence control weans USCL 500 responsive to the received instructions, to operation of the Instruction decoding means and to the state information for providing to the microcode memory means addresses for selecting the sequences of microinstructions. 11. A system according to claim 10, characterised in that the microcode sequence control reans US 116 comprises a register UAR 506 for receiving and storing an initial address of a selected microinstruction sequence, microcode program counter means UPCI 516, UPCR 514 connected from this regIster for receiving the initial as nd rFg successIve addresses of the selected seTJences, an address providing multiplexer UAM 502 connected from the register means and microcode program counter means for providing the addresses to the microcode memory means KUM 532,VUM 534, HUM 548 , and control logic USCLC 520 responsive to operation of the microcode sequence control means USCL 500 and to the microinstructions UINST DECODE and the state information CONM for providing signals for controlling operation of the sequence control means. 12. A system according to claim 11, characterised in that te nicrocode sequence control means USCL 5n0 further comprises microcode state save me state register means UPCSR 526, CONSR 552 connected from the sequence control means USCD 500 for receiving and stroing an address and state of execution of a currently executing microinstruction, and miccocode stack means USTACK 510 having its connected from said rrcrooode state register means and outputs connected to the address multiplexer UAM 502 for savIng and restoring the state of execution of interrupted microinstructions, and in that the control logic USCLC 520 is responsive to execution of each microinstruction to provide the control signals to transfer the address and state of execution of each interrupted microinstruction to the microcode stack means upon occurrence of a microinstruction interrupt, to provide an initial address of a selected interrupt handling microinstruction seence, and to restore the address and state of execution information of the interrupted microinstructicn at completion of the interrupt handling microinstruction sequence. 13. A data processing system including processor cans PU 106 for processing the data, a main memory 102 for storing and providing the data, and memory bus means MDA 110 for conducting the data between the processor means and the memory means, characterised in that the processor rears U 106 comprise first and second buses YBUS 124, D BUS 112 input means and output means MDB 132 connected from the memory bus means MDA 110 to the first bus and from the second bus to the memory bus means, CPU means 122 heving an input connected from the second bus and an output connected to the first bus, and nibble shift means NIBS 126 having an input connected from the first bus and an output connected to the second bus for a conducting data between the first bus and the second bus, b perrorming selective nibble shift data manipulation operations in conjunct on with arithmetic and logical operations performed by the CPU means, and c performing data alignment operations upon data being read from the main memory means to the CPU means and upon data resulting from the CPU operations being written from theCPU means to the main memory. 14. A data processing system comprising processor mears PU 106 for processing the data, internal memory 1O2, SPAD 128 for storing the data and instructions for directing operations of the system, bus means MDA 110 for conducting the data and instructions betwcen the internal memory and the processor means, external terminal. means for providing co.ands for directing the operation of the system, external memory means, input output means SIO 134, DBIO 136 connected between the terminal menus, the external memory means and the bus means for conducting the commands and data between the terminal means, the external amory means and the bus means, and microcode control means CU 104 for providing sequences of microinstructions for controlling the operation of the system, characterised in that the control means CU 104 comprise a kernel microcode rer. ry KUM 532 responsive to first certain instructions and commands and permanently storing and providing to the system corresponding first microinstruction sequences, a writable microcode memory VUM 534 responsive to second certain instructions ant ommands and storing and providing to the system corresponding second microinstruction sequences, and in that the external r rv means store an initial copy of the second microinstruction sequences, and the first microinstruction sequences including microinstruction sequences for a controlling the system to read a second copy of the second microinstruction sequences from the external memory means to the internal memroy 102, SAD 128 and b to read the second copy of the second microinstruction sequences from the internal memory to the writable microcode memory VUM 534 . 15. A system according to claim 14, chaeracterised in that the first instructions comprise an instruction set for an eight bit data processing system and the first microinstruction sequences allow the sp tem to operate as the eight bit data processing system, and the second instructions comprise a second set of instructions comprising an exicnsion of the first instrnction and the second microinstruction sequeilces allow the system to operate on a sixteen and thirty two bit instruction set. 16. A system according to claim 14 or 15, characterised in that the first commands comprise single character co r ands, and the second commands comprise m lltiple character commands. 17. A system according to claim 14, 15 or 16, chaacterised in that the first command include a system reset commands. 18. A data processing system comprising processor means PU 105 for processing the data, a main memory 102 for storing t 1 data and instructions for directing operations of the system, bus means MDA 110 for conducting the data and instruction between the memory and processor means, and microcode control means CU 104 for providing sequences of microinstruction fbr controlling the operations of the system, characterised in that the control means CU 104 coi . ise means IPD 114, UIM 554 connected from the bus means MDA 110 for receiving be instructicns, means CONM connected from other portions of the system for receiving information regarding states of operation of the system, a vertical microcode memory VUM 534 for storing sequences of microinstructions corresponding to the instructions, a horizontal microcode memory HUM 548 for storing sequences of microinstruction corresponding to certain of the states of operation of the system, microcode selection means connected from said instruction receiving means and said state receiving means and responsive to said instruction and said certain of said states for providing corresponding microinstruction selection addresses to said vertical and said horizontal microcode memory means, said vertical and said horizontal microcode memory means individually responsive to said corre selection sequences for providing said corresponding microin uction sequences for controlling said operations of said system. 19. A data processing system including processor means PU 106 for processing the data and including addressing means MAD 130 for providing memory read and write addresses, a main memory 102 for storing the data and responsive to the addresses for transferring data to dbd from the processor means, bus means MAD 108, MDA 110 including data lines and check bit lines for conducting the addresses and data between the main memory means and the processor means, and memory control means MC 118 , characterised in that the memory control means MC 118 comprise an internal bus CDATA 507 with a plurality of data line corresponding to the bus means data lines MDA 110 DATA 32 , check bit checking and providing means FLE 503, SLE 505 having first inouts connected from and first outputs connected to the internal bus and second inputs connected to the check bit lines MD 110 CHECK BITS 7 of the bus means, and bidirectional buffer seans EDIB 509, EDOB 511 connected between the bus mean data lines and the internal bus data lines, and in that the memory control means are responsive to operation of the processor means PU 106 and the main memory 102 . a during memory write operations for accepting the data to be written into the memory from the bus means data lines to generate corresponding check bits, and provide these bits on the bus means check bit lines, and b during memory read operations for accepting the data and corresponding check bits read from the memory from the bus means data and check bit 1 lI es and determining whether the data read from the memory contains errors concurrently with the data read from the memory being received by the processor means. 20. A s system according to claim 19, characterised in that the bic. recticnal buffer means EBIB 509, EDOB 511 comprises a plurality of independently selectable by the input connected r separate bytes of the bus means data lines MDA 110 DATA 32 to co rc rc ding bytes of the internal bus data lines CDATA 507 and responsive to operation of the processor r.a.s PU 106 to selectively transfer bytes of the data from the bus means to the internal bus, and a plurality of independently selectable byte output buffers connected from the separate bytes of the internal bus data lines to corresponding bytes of the bus means data lines and responsive to operation of the processor means to selectively transfer bytes of the data from the internal bus to the bus means, and in that the check bit means FLE 503, SLE 505 co nprises a plurality of independently controllable byte input register IA, IB connected from corresponding bytes of tile internal bus data lines for selectivel receiving bytes of data, end a plllra ity of independently controllable byte output reqisters OA, OB connected to the corresponding bytes of the internal bus data lines for selectively providing bytes of data to the internal bus. 21. A system according to claim 20, characterised in that the processor means PU 106 comprises a plurality of independently controllable byte output registers MDR 602, C,D,E,F connected to corresponding bytes of the bus means data lines DA 110 DATA 32 fcr selectively transferring bytes of data from table processor creams to the bus means. 22. A system according to claim 21, characterised in that each memory write operation is of a fixed plurality of bytes of data equal to the plurality of bytes of the bus means data lines .MDA 110 DATA 32 . 23. A method of operating a system according to claim 22 in order to write a number of bytes of data less than the fixed plurality of bytes, comprising the steps of a reading from the main memory 102 a fixed plurality of bytes, b receiving these bytes and the corresponding check bits into the check bit means input registers IA, Is , c correcting the bytas if an error is detected therein, d transferring the byte or bytes to be written from the processor means PtJ 106 and through the corresponding output registers MDR 602 C,D,E,F, to corresponding bytes of the bus means data lines MDA liO DATA 32 , e transferring the bytes from the said corresponding bytes of the bus means and through the corresponding bytes of the control means input buffers FDIB 5C9 and the corresponding bytes of the Internal bus CDATA 507 into the corresponding bytes of the check bit means Input registers to form, in combination with non corresponding bytes of the fixed plurality of bytes originally read into these registers, a new plurality of bytes, d generating corresponding check bits for the new plurality of bytes, and e transfrerring the new plurality of bytes and their check bits on to the bus means and writing the bytes and check bits Into the main memory. 24. A data processing system comprising processor means PU 106 for processing the data, a main memory 102 for storing the data and instructions for directing operations of the system, and bus means MDA 110 for conducting the data and instructions between the memory and the processor means, characterised by the combination of CPU processor means CPUP 122 connected from the nus means DA 110 for performing arithmetic and logic operations on the data, and microcode processor means IPD 114, US 116 connected from the bus means end responsive to the instructions and the operations of the system for manipulating and providing sequences of microinstructions for controlling the operations of the system. 25. A system according to claim 24, characterised in that the microcode procossor means IPD 114, US 116 comprises means tpd 114, UAM 554 connected from the bus means MDA 110 for receiving the instructions, means USCLC 520 connected from other portiions of the system for receiving information regarding the state of the eperations of the system, microcode memory means KUM 532,, MUM 534 for storing and providing the sequences of microinstructions, and microcode sequence control means USCL 500 responsive to the received instructions and to the state information for providing addresses to the microcode memory means for selecting the sequences of microinstructions. 26. A system according to claim 25, characterised in that the microcode sequence control means USCL 500 comprises a register UAR 506 for deceiving and storing an initial address of a selected microinstruction sequence, microcode program counter means UPCI 516, UPCR 514 connected from the register for receipting the initial. address and providing successive addresses of the selected sequence, an address multiplexer UAM 502 connected from the register means and microcode program counter means for rcviing the addresses to the microcode memory means KUM 532, VUM 534, HUM 548 , and control logic USCLC 520 responsive to operation of the microcode sequence control means USCL 500 and to the microinstructions UINST DECODE and the state infermation CONM , for providing signals for controlling operation of the sequence control means. 27. A system according to claim 26, characterised in that the microcode sequence control means USCL 500 further comprises microcode state save means, including mirocode state register means UPCSR 526, CONSR 552 connected from the sequence control means USCL 500 for receiving and storing an. address and state of execution of a currently executing microinstruction, and microcode stack means USTACK 510 having Inputs connected from said microcode state register means and outputs connected to the address multiplexer UAM 502 for saving and restoring the state of execution of interrupted microinstructions, and in that the control logic usclc 520 is responsive to execution of cach mi roinstruction to provide the control signals to transfer the address and state of execution of each interrupted microinstruction to the microcode stack means upon occurrence of a microinstruction interrupt, to provide an initial address of a selected Interrupt handling microinstruction sequence, and to restore the address and state of execution information of the interrupted microinstruction at completion of the interrupt handling mjicroinstruction sequence.

## Description
DIGITAL DATA PROCESSING SYSTEM The present invention relates to a high speed, compact data processing system and, more particularly, to circuitry therein to enhance operating speed, efficiency and capabilities of such a system A common practice in the computer industry is for a manufacturer to provide a family of related computer, or data processing, systems Various computers in such a family will be distinguished byslze, complexity, capability and cost. Because of cost and, therefore, complexity constraints, lower level systems in such a family are usually not able to provide the capabilities and functions of the higher level systems. A lower level system may not, for example, provide as high a speed of operation or as large a memory space as a higher level system.In addition, a lower level system often may not be able to execute a program written for a higher level system because the lower level system does not offer the full functions and capabilities of the higher level system Such a family of systems may therefore have upward capability, that is, programs written on lower level systems may be executed on higher level system, but will not provide corresponding downward compatibility. For full compatibility within a computer system family, the lower level systems should offer, in general, the functionality and capabilities of the higher level systems. The present invention provides improvements in digital data systems which bear upon the above noted computer system capabilities, thus improving computer system speed, efficiency and capability, and also providing a solution for the aforementioned problems and limitations of the prior art, as will be discussed in detail herein below. The various features of the invention are defined in the appended claims. The system may have separate kernel, vertical and horizontal microcode, separate loading of vertical microcode and a permanently resident kernel microcode, and a soft console with dual levels of capability. The system may include a processor having both an arithmetic and Logic processor and a microcode processor, and an instruction proc essor. The former processor may incorporate a multifunction processor memory, a multifunction nibble shifter, and a high speed look aside memory control. It is thus advantageous to incorporate the present invention into a computer system because capability and efficiency are increased. The invention will now be described in more detail by way of example, with reference to the accompanying drawings, in which Fig 1 is a block diagram. of a computer systems incorporating the present invention Fig 2 is an illustration of certain, typical instructions Fig 3 is a diagrammic representation of a single level address translation Fig 4 is a diagrammic representation of a two level address translation Figs 5 and 5A are a detailed block diagram of the present system control unit Figs 6 and 6A are a detailed block diagram of the present system. processor unit, and Fig 7 is a detailed block diagram of a portion of a memory control unit. The following description presents the structure and operation of a computer system incorporating a presently preferred embodiment of the present invention.In the following description, the general structure and operation of the present system will first be described in an introductory overview. Next, certain basic features of the present system will be further described as a further introduction to following detailed descriptions of certain features of the present system as necessary. The following introductory review will fírat identify and briefly describe the major elements of the present digital computer system. Certain features of operation of the present system will then be described in further detail as an íntroduction to following detailed descriptions of the present system. A. System Overview Fig I Referring to fig 1, a block diagram of a ComputerSystem CS 101 is shown. Major elements of CS 101 areMemory MEM 102, Control Unit CU 104, and ProcessorUnit PU 106. MEM 102 is used to store, for example, user programs comprising data and instructions.EMI8.1 EMI8.2 MEM 102 will not be described in further detail herein except as necessary for understanding of the structure and operation of the remaining elements of CS 101. CU 104 and PU 106, which will be described in detail in the following descriptions, respectively perform system control and program execution functions. Major buses of CS 101 include Memory Address MAD Bus 108, which conducts memory read and write addresses from PU 106 and CU 104 to MEM 102. Memory Data MDA Bus 110 conducts data and instructio EMI8.3 MEM 102EMI8.4 CU 104 and PU 106. Data D Bus 112 is connected between CU 104 and PU 106 as a primary path of information exchange between CU 104 and PU 106. Referring to CU 104, major elements of CU 104 areInstruction Prefetch and Decoder IPD 114,Microsequencer rUs 116, Memory Control MC 118, andSystem Clock Generator SCG 120. IPD 114 is connected from MDA Bus 110 to receive instructions from MEM 102. IPD 114 operates in conjunction with certain elements ofPU 106 to perform instruction prefetch operations, in addition, IPD 114 performs certain initial instruction decode operations, for example, with respect to instruction and data type, to initially determine certain subsequent operations to be performed by CU 104 and PU 106 withrespect to execution of received instructions. IPD 114 provides certain outputs to D Bus 112, for example, information used by PU 106 in addressing and fetching data from MEM 102. IPD 114 also provides instruction outputs to US 116 for use by US 116 in controlling operations of CS 101. As will be described in detail in following descriptions, US 116 includes memory and logic for providing microinstruction control of CS 101. In addition to certain outputs described below to D Bus 112, US 116 provides control outputs to other elements of CS 101 and accepts control inputs from other elements of CS 101. Finally, SCG 120 comprises a central clock generator which provides clock outputs to all elements of CS 101. For clarity of presentation, the clock outputs of SCG 120 are not shown individually, but will be described in the following detailed descriptions as appropriate. Referring to PU 106, as described above PU 106 performs functions directly associated with execution of user S programs. In this respect, Central ProcessingUnit Processor CPUP 122 performs arithmetic and logic functions and is connected between D Bus 112 and v Bus 124. Y Bus 124 is an information transfer path withinPU 106. Nibble Shifter NIBS 126, also connected between D Bus 112 and Y Bus 124, operates in conjunction with CPUP 122 and other elements of CS 101 to perform, for example, nibble shifting, memory address and data alignment operations. Scratch Pad and Address Translation Unit SPAD 128 is a multifunction element also connected between D Bus 112 and Y Bus 124. SPAD 128 operates as a scratch pad memory for PU 106 and also performs certain address mapping operations, as will be described in detail in the following descriptions. Memory Address Unit MAD 130 is connected fromSPAD 128 and has outputs connected to MAD Bus 108. MAD 130 provides read and write addresses to MEM 102. In addition to other functions, MAD 130 operates in conjunction with IPD 114 to perform instruction prefetch operations. Memory Data Buffer MDB 132 is connected betweenMDA Bus 110 and D Bus 112 and Y Bus 124 and is a primary path for data transfer between PU 106 and MEM 102. Finally, Serial I O SIO 134 and Data and BurstMultiplexer Channel I O DBIO 136 operate as principal paths of information exchange between CS 101 and external devices, such as terminals and bulk memory storage units. SIO 134 is used for communication of serial information between CS101 and, for example, a terminal. DBIO 136 provides, for example, three modes of parallel information transfer, such as, ProgrammedI O, Data Channel I O, and a Burst Multiplexer Channel.As indicated in Fig. 1, SIO 134 has a bi directional connection from D Bus 112 while DBIO has an input path from D Bus 112 and an output path to Y Bus 124. having briefly described the overall structure and functional elements of CS 101 with reference to Fig. 1, certain basic features of CS 101 will be described next below. B. Tnstruction Sets The present implementation of CS 101 is as a 32 bit computer system that is, CS 101 generates and manipulates 32 bit addresses and 32 bit data elements.CS 101 is designed to be compat ble with two earlier generations of data processing systems, that is, capable of executing programs created for use on the earlier data processing systems. One earlier family of data processing systems is a 16 bit system, for example, theData General Corporation ECLIPSE computer systems. A second earlier family of computer systems are 8 bit systems, for example, Data General Corporation NCVAs Computer systems. As such, CS 101 is capable of executing three different instruction sets, the NOVA instruction set, the ECLIPSE instruction set, and a new instruction set, that for the Data General Corporation ECLIPSE MV 8000 systems.Each of these instruction sets contain two classes of Instructions Arithmetic andLogic Class ALC Instructions, which define an arithmetic or logic operation to be performed, and memory reference instructions, which define operations to be performed with data to be written into or read from memory. ALC instructions in general include only an operation code opcode field defining the operation to be performed. In memory reference instructions, a displacement field containing information relating to the location, or address, of the data to be operated upon is added to the opcode field. NOVA instructions use 8 bit opcode fields while ECLIPSE and MV 8000 instructions use 16 bit opcode fields.NOVA and ECLIPSE instructions use, respectively, 8 and 16 bit displacement fields, while MV 8000 instructions use 16 or 32 bit displacement fields. NOVA and ECLIPSE instructions are referred to as narrow instructions and MV 8000 instructions as wide instructions. CS 101 s instruction set allows CS 101 to manipulate data elements having widths of 8, 16, or 32 bits. In addition, and as will be described further below, CS 101 is capable of generating addresses in two ranges. The first range, using 32 bit addresses, allowsCS 101 to address a logical address space of 4.3 billion bytes, or four gigabytes. The second, using 16 bit addresses, allows CS 101 to utilize a 64 kilabyte addressing range. During the following descriptions, a byte is defined as 8 bits of information, a word is defined as 16 bits 2 bytes , and a double word is defined as 32 bits 2 words, or 4 bytes . In general, most operations performed by CS 101, for example, generation of addresses and manipulation of data, are performed in double word 32 bit elements. C. Addressing As described above, CS 101 may utilize 32 bit addresses for byte addressing, or 31 bits in word addressing,and thereby has a logical address space, that is, a user visible address space, of four gigabytes.This logical address space is partitioned for purposes of memory management into eight 512 megabyte sections called segments and referred to as segments 0 to 7.Each logical address contains, in the three most significant bits, information identifying a particular segment in which a data item is located. The remaining 29 bits icentify the location of the data item in the segment. The size of CS 101 s logical address space means that not all logical address locations can be represented in MEM 102 at the same time. For this reason, CS 101 s logical address space is further divided into pages. Each page is a two kilobyte block of contiguous logical or physical addresses. A demand paging system moves pages between MEM 102 and external storage devices upon demand and tracks pages currently in MEM 102. An address translation unit, described in detail below, translates logical addresses into corresponding physical addresses in MEM 102 for pages represented in MEM 102. Logical addresses may use to reference two types of information, data and instructions. To reference instructions, PU 106 uses logical addresses generated by a program counter PC , located in PU 106, which is incremented to read sequential instructions from memory.As described above, bits 1 to 3 of the PC specify a current segment from which instructions are being read, while bits 4 to 31 specify an address within that segment. It should be noted that logical addresses generated by the PC contain 31 bits of address rather than 32 as CS 101 performs addressin g on the word level. As will be described further below, CS 101 actually reads or writes only double words to and fromMEM 102, thus requiring 30 bits of address rather tan 31 or 32 bits. In contrast to instructions, which are addressed directly, data is addressed indirectly through instructions. CS 101 utilizes information coded in the referencing instructions to construct the logical addresses of the data so referenced. Among other factors, data appears in different types and lengths and the structure of the data effects the generation of logical addresses referencing data. The Data types may include, for example fixed point numbers, floating point numbers, decimal numbers, alphanumeric character strings, and bit strings. Data lengths may,for example, include bits, bytes 8 bits , words 16 bits , and double words 32 bits . In addition, the locations of various data items may be specified as a displacement, or offset, relative to various base addresses, as will be described below. To reference an element of information in logical memory, therefore, a referencing instruction will provide information used by CS 101 to construct a logical address of the referenced data item. Various typical Instruction formats used in CS 101 and containing such information are illustrated in Fig. 2.The instruction illustrated on line A represents a narrow instruction of 8 bits, while the instructions illustrated on the remaining lines represent typical 16 and 32 bit instructions, as previously described. As shown in Fig. 2, each instruction includes an Operation, OP Code indicating an operation to be performed with the referenced data, and an Acczmulator AC Field designating a source or destination accumulator as appropriate. Each instruction includes a displacement field of 8, 15, 16, 31, or 32 bits, depending upon whether the instruction is referencing a byte or a word of data. vach instruction further includes an index bit field identifying the source of the base address from which L .e displacement offset specified in the displacement field is taken to determine the logical address. The index bits are capable of specifying four different addressing modes, that is, four different sources for a base address from which displacement is taken to locate the data referred to by the instruction displacement field. A first mode is Absolute mode and uses logical address zero as base address. A second mode is Program Count C relative wherein the present PC address is used as base address.The remaining two modes select as base address the contents of either of two accumulator registers residing in PU 106. Both the Instructions and the logical addresses resulting from the operation described above contain a single bit field which identifies whether the logical address is a final logical address, or whether indirect addressing has been specified. In indirect addressIng, a logical address resulting from resolution of the instruction is treated as a pointer to yet another address. The address pointed to may, in turn, be a final logical address or, as indicated by its indirect bit field, may be an Indirect pointer to yet another logical address. Finally, as previously described the logical address space of CS 101 is larger than the physical address space of MEM 102. As such, two Kbyte pages of information storage containing instructions or data, or both, are transferred between MEM 102 and external storage devices as required. As a result, logical addresses generated by CS 101 must therefore be translated Into equivalent physical addresses In MEM 102 or paces residing therein. CS 101 performs logical to physical address translation operations through the use of Page Tables PTs and Segment Base Registers SBRs . A PT is a table of entries containing information for translating logical addresses to a physical addresses. Each entryIn a PT, referred to as a Page Table Entry PTE , contains the necessary information relevant to one page of storage residing in MEM 102. In conjunction, there exists a SBR for each segment of CS 101 s logical address space. Each 53R contains the physical base address of a PT containing entries for those pages of the corresponding segment resicing MEM 102.The contents of each SBR indicates whether the corresponding segment is currently defied, that is, usuable by CS 101, the number of PT levels necessary for logical address translation, as will be described further below, and the address translation information. Each PTE contains information indicating whether a particular page is currently defined, that is, accessible to CS 101, and whether the corresponding page is presently residing In MEM 102. Each PTE also contains information regarding acces rights to the information stored in the corresponding page that is, whether a reference to the corresponding page may perform a read operation, a write operation, or execute instructions contaIned therein. Each PTE also contains physical page address information defining the physical address or location in MEM 102 of the page corresponding to a particular logical address.The physical address contained in each PTE may reference either of two items, depending upon whether a one level PT translation is to be performed or a two level PT translation is to be performed. If a one level translation is to be performed, the PTE physical address contains the physical address of the page referenced y the corresponding logical address. If a two level translation is to be performed, the PTE address field contains the address of a second PT, which in turn contains the final physical address of the page referenced by the logical address.The utilization of both one and two level PT translations allows CS 101 s address space to be tailored to a particular user program. For a smaller program, a one level mechanism would be utilized, while for larder programs two level translations would be performed.Referring to Fig. 3, a diagrEMI21.1 representation of a one level page table translation is shown. Represented therein is a logical address to be translated, one of CS 101 s SBRs, and a typical page table containing a plurality of PTEs. As indicated in Fic. 3, the logical address includes an SBR Field identifying a particular one of CS 101 s Ss, in this case the SBR represented in Fig. 3, a single level page table actress field, ano 2 page offset field. CS 101 utilizes the SBR field of the logical address to select a corresponding one of CS 101 s eight SBRs. CS 101 reads from that SBR a physical address field which Identifies the start, or base address, of a corresponding page table, that is, the page table represented in Fig. 3.The single level page table address field of the logical address represents an offset, from the start of the page table located by the physical address field of the SBR, to the particular PTE containing the physical address information corresponding to the logical address to be translated. Together, therefore, the physical address field of theSBR identified by the SBR field of the logical address and the single level page table field of the logical address loentify the physical address of a correspondingPTE in the page table. A PTE so identified includes, as indicated in Fig.3, a valid resicent physical address field which identifies the physical starting address of a particular page residing in MEM 102. The page offset field of the logical address specifIes an offset, relative to the start of the page in . 102 identified by the valid resident physical address field, of the PTE of the particular word to be addressec.The physical al address field of the PTE and the page offset field of the logical address thereby together comprise the physical address in MEM 1C2 of the word referenced by te logical address represented in Fia. 3 and the logical to physical address translation has been completed. Referring to Fig. 4, a two level page table translation is represented. As indicated therein the general procedure for a two level page table translation is similar to that of a one level page table translation except that an additional reference through a second page table is performed. The logical address includes, in addition to the single level page table address field, a double level page table address field. The double level page table address field of the logical address is utilized, together with the physical address field of the SBR identified by the SBR fiel d of the logical address, to generate a physical address of a particular PTE in a first page table.The valid resident physical address field of the PTE of the first page table is then combined with the single level page table address field of the logical address to generate a physical address of a second STv in a second page table. In this case, the valid resIdent physical address field of the PTE of the first page table identifies the physical starting address of the second page table. The single level page table address field of the logical word address identifies an offset, relative to the start of the second page table, of the second PTE. The physical address field of the second PTE is then combined with the page offset field of the logical address to generate the final physical address referred to by the logical address. Finally, as described above, CS 101 transfers pages between MEM 102 and external storage as necessary. This operation is performed by CS 101 s memory management system, of which CS 101 s address translation mechanism is a part. CS 101 s address translation mechanism performs, in particular, two functions with regard to CS i01 s memory management mechanism. First, CS 101 s address translation mechanism monitors which of the pages resident in MEM 102 are referenced in read or rite operations, and which pages are most frequently referenced.When it is necessary to transfer a page out of MEM 102 to external storage in order to transfer in another page, CS 101 s memory management system utilizes tis reference information to determine wnicn pages have not been referenced or have been least frequently referenced in determining which pages resident in MEM 102 can be replaced. Secondly, CS 101 s address translation mechanisrn monitors which of the pages in MEM 102 have been referenced by write operations, that is, which pages in MEM 102 have been modified and are no longer identical to the copies of those pages residing in external storage.If a particular page has been referenced in Åa write operation, it is necessary for CS 101 to copy that page back external storage when that page is replaced by another page from external storage.If that particular page has not, however, been referenced in a write operation, CS 10i may simply dIscard that page by wrIting a new page from external storage into the same address locations in MEM 102, thereby reading the execution time required for a page swap. CS 101 s address translation mechanism stores the above described memory management inform form of rfeferenced modified bits, in MC 118, which will be described in greater detail below. Detailed System Description Having described the overall structure and operation and certain basic features of CS 101 above, CS 101 will be described below in further detail. CU 104 will be described first, followed by PU 106. Referring to Figs. 5, 5A, 6 and 6A, these figures comprise 2 detailed block dIagram of CU 104 and PU 106.Figures 5 and SA present CU 104 and Figures 6 and 6A present PU 106. Figures 5, 5A, 6 and 6A may be placed side to side, in that order from left to right, to comprise a complete detailed block diagram of CU 104 andPU 106. For purposes of certain of the following discussions, it will be assumed that the reader has so assembled Figures 5 and 6 into such a block diagram. A. CU 104 Figs. 5 and 5A Referring to CU 104 in Figs. 5 and SA, as previously described tne major elements of CU 104 areMicrosequencer US 116, instruction Prefetch and Decode IPD 114, Memory Control MC 118, and System Clock Generator SCG 120. These elements will be described next below in that order. Referring to US 116 , US ll contains CS 101 s microcode control logic, including microcode memories for storing microinstruction sequences for controlling operation of CS 101, microcode sequencing control logic for selecting and manipulating microinstruction secuences, and condition logic for providing nicroinstruction control of CS 101 in response to certain conditions occurring therein and, for example, branches in microinstruction sequences. Microcode control functions provided by US 116 also Include microcode state save and restore mechanism for use in executing microcode traps and interrupts.In addition to the above functions directly concerned with execution of users programs, US 116 also provides all console control functions through the provision of microcode therein cirectly responsive to commands entered through a soft console, that is, a user keyboard as opposed to front panel switches. As will be described further below, US 116 microcode resides in three microcode memories, reflecting the microcode organization of CS 101. A first microcode set, referred to as kernel microcode, resides permenently in US 116, as does horizontal microcode. Vertical icrocoe is not permanently resident in US 116.That is, vertical microcode is stored in Random Access Memories RAMs comprising writable control store and are loaded into CS 101 at system start. Briefly, kernel microcode resides Permenently in US 116, and in addition to providing console and other functions, is available at system star to to perform system Initialization, including loading of vertical microcode. typically, vertical microcode ill reside in, external emory devices, such as disk memories.At time system s initialization, vertical microcode is read from eternal memory and, under control of kernel microcode, is transferred into I 102 S file to reside therein. hen, still under control of kerne L microcode, vertical microcode is read from MEM 102 and loaded into vertical microcode remory in US 116. At that time, the full functionality of CS 101 is available. The core of US 116 s microsequencer is comprised of Microsequence Control Logic USCL 500. USCL 500 is comprised, for example, of 4 AMD AN2930 bit slice program control units connected in parallel. USCL 500 Includes logic to implement Microprogram Count UPC increment, a seventeen word deep last in first out stack, a separate register as a source of microinstruction addresses, an input port for jumping out of sequentIal microprogram execution, and an output port for providing microinstruction addresses to US 116 s microcode memories.USCL 500 also includes an Internal microprogram control unit for controlling operation of USCL 500. vScL 500 s microinstruction address output is provided from the output of Microinstruction Address Multiplexer UAM 502. UM 502 is provided with a first input from. USCL 500 s Input, which is connected fromMicroinstruction Input UIN Bus 504. A second input ofUAM 502 is connected from Microinstruction AddressRegister UAR 5C6, whose input is connected fromMicroinstruction Address Register Multiplexer UARM 508.UARM 508 is provided with a first input connected from USCL 500 s input, that is, from I Bus 504, and a second Input from output of U 5 502. U.AM 502 S third input is connected from output of blicfostack USTACK 510 as described above, USTACK 510 is a seventeen word deep last In first out stack. USTACK 510 has an input provided through a microstack multiplexer USM. 512 which has a first Input connected from UIN Bus 504 and a second input connected USCL 500 s microprogram counter, described next below.UAM 502 s fourth input is similarly connected from the output of USCL 500 s microprogram counter. USCL 500 s microprogram counter includes Microprogram Counter Register UPCR 514 whose output is connected to inputs of UAM 502 and USM 512. Input ofUPCR 514 is connected from output of Microprogram Count increment UPCI 516, which has an input connected fromMicroprogram Count Multiplexor UPCM 518. Inputs ofUPCM 518 are connected from the output of UAM 502 and from the output of UPCR 514. U CM 518 allows an initial microcode starting address to be loaded from ctt of tM 502 and into UPCR 514 through UPCI 516. Thereafter,Microprogram Count UPC may be sequentially incremented by transferring current U C from output cf UPCR 514 and through second input of UPCM 513 to UPCI 516 currentUPC may then be incremented by one by UPCI 516 and the resulting next sequential UPC loaded into UPCR 514. Other operations of USCL 500 in generating microinstruction addresses for US 116 s microcode memories will be described further below. Finally, USCL 500 includes internal microcode control logic USCLC, which USCLC receives and decodes control and instruction inputs from MicroinstructionDecode UID 522, which will be described below, to control operation of USCL 500. Redfessing to the output of USCL 500, 16 bit micrococe actress output of UAM 502 is connected to UYBus 524. UY Bus 524 in turn provides 2 single bit input to Microprogram Counter Save Register UPCSR 526 and a sixteen bit input to UY Register UYR 528. UYR 528 in turn provides a sixteen bit output to D Bus 108. Sixteen bit UY Bus 524 is connected, through a buffer, to sixteen bit Next Microprogram Counter NXUPC Bus 53C. NXUPC Bus 530 also receives, through a buffer, a sixteen bit input from UIN Bus 504. NXUPC Bus 530 provides sixteen bit address inputs to Kernel Microcode memory UN 532 and Vertical icrocode Memory VUM 534. NXUPC Bus 530 also provides z fifteen bit input toUPCSR 526. Referring to KUM 532 and VUM 534, thirty two bit microinstruction outputs of kernel and vertical microcode memories are provided to Microcode Cutput UCO Bus 536. Thirty two bit input of Microinstructlon VIR Register VIR 538 is connected from UCO Bus 536, and thirty two bit output cf UIR 538 is connected toMicroinstruction Register UIR Bus 540. As will be described further below, kernel and vertical microinstructions are distributed to other portions ofCS 10i from UIR Bus 540. Returning to UCO Bus 536, UCO Bus 536 provides sixteen bit microinstruction inputs to Microinstruction Saved High Register UIRSHI 542 and to MicroinstructionSave Low Register UIRSLO 544. Sixteen bit microinstruction outputs of UIRSHI 542 and UIRSLO 544 via UCD bus 546 are connected to D Bus 112. Certain bits of thirty two bit UCD Bus 546 are provided as data input to VUM 534 through Buffer 535.Returning toEMI32.1 Bus 540, tYIR Bus 540 provides an address input to Horizontal Microcode Memory HUM 548.As described above, and described in further detail below, HUM 548 stores and provides horizontal extensions to vertical microcode dealing with random control cf CU 104, IPD 114, and D Bus 112, among other functions. UIR 540 also provides certain selected microinstruction bits as inputs to UID 522. UID 522 in turn provides instruction and control outputs to USCL 500 and to SCG 120. UIR Bus 540 also provides control inputs toCondition Multiplexer CONN 550. Data inputs to CONM 550 are registered and unregistered conditions occur ring at various Fonts throughout CS 101. CONM 550 s output is provided as an input to UID 522 and as an Input toCondition Save Register CONSR 552. An output of UPCSR 526 is connected through a buffer 5 to the output of CON.M. 550 so that UPCSR 526 s output may be provided to the same inputs of UID 522 and CONSR 552 as the output ofCONM 550. Finally, certain of UIR Bus 540 s thirty two microinstruction bits are provided as one of five Inputs to Microinstruction Multiplexer UIM 554. UIR Bus 54G s input to UIM 554 is, as will be described further below, provided to implement out of sequence jumps to new microinstruction addresses while executing microinstruction sequences.Referring toEMI34.1 554, UIM 554 s output is connected to UIN Bus 504 and UIM 554 s inputs are connected to various sources used, as described below, to select microinstruction sequences to be executed by US 116 and, therefore, CS 101. As just described, one input or UI 554 is connected from certain bits of UIR Bus 540.Another input of UIM 554 is connected from D Bus 112, yet another input is connected from CONSR 552, and another Input connected from UPCSR 526. Finally, a last input of UIM 554 is, as will be described in detail below, connected from an output PD 114. Referring finally to the upper portion of US 116, therein are represented three registers having outputs connected to D Bus 112. These registers are provided to store certain conditions and flags occurring in CS 101, for subsequent transfer on to D Bus 112. A first register is Error Log Register error 556, 2 second register s Is Diagnostic Register DIAGR 558, and a third register is Flag Register FLAGR 560. Having described the overall structure of US 116 and certain features of the operation thereof, the operation of US 115 will be described in further detail next below. b. US 116 Operation 1. Introduction As described above, USCL 500 provides functionality for microprogram control and selection operations.Input to USCL 500 is through UIM 554 and UIM Bus 504 while USCL 500 s output is through UY Bus 524. Referring first to USCL 500 s input through UIM 554 and UIN Bus 504, IM 554 is provided with Inputs fre iVC sources. A first input source for us UI 554 is from D Bus 108 and provides, for example, instruction rrom PD 114. A second source is from UIR Bus 540 andIs utilized for jumping to nonsequential microinstruction addresses in microcode memoryl. A third source is from IPD 114, described below, and is used for certain Instruction pre execution operations and certain preliminary operations regarding addressing from instruction. A fourth source is a microcode conditional input comprised of selected portions of UIM 554 s inputs from UPCSR 526 and UIR Bus 540. Finally, the fifth source is again a conditional input provided by the output of UPCSR 525. Referring to NXUPC Bus 530, either UY Bus 524, which is USCL 500 s direct output, or UIM Bus 504 may be selected to drive NXUPC Bus 530 and thereby directly address RUM 532 and VUM 534. For a microinstruction fetch, that is, a microinstruction read from microinstruction mem.cry, either KUM 532 or VUM 534 is enabled, based upon the state of a Kernel Flag KFLAG stored in FLAGR 560 and asserted during fetch operations. If KFLAG is asserted, fetch is from KUM 532 and, if KFLAG is not asserted, fetch is from VUM 534. KFLAG may be set, or asserted, for example, on system initialization or upon occurrence of a microparity error, as described below. KFLAG may be loaded into KFLAGR 560 as a bit output from UIR Bus 540 through operation of an NCU ranoom control output provided from HUM 548. The 32 bit outputs of KUM 532 and VUM 534 are ORed together on UCO Bus 536 and are loaded into UIR 538 at the end of each microinstruction read cycle to appear onUIR Bus 540. KUM 532 and VUM 534 outputs may each be selectively disabled for this ORing operation. All microcode visible operations of CS 101 are controlled by the 32 bit microinstruction appearing on UIR Bus 540 from UIR 538. In addition to being loaded into UIR 538, microinstruction outputs apprearing on UCO Bus 536 may be loaded into and saved in UIRSHI 542 and UIRSLO 544.Outputs of UIRSHI 542 and UIRSLO 544 ry then be transferred onto D Bus 112 to allow reading of kernel and vertical microcode memorizes. As will be described further below, all microinstructions appearing at UIR 538 output on VIR Bus 540 are checked for error by operation of MicroparityChecker UPARC 562, which is connected from UIR Bus 540. As described above, each microinstruction output appearing on UIR Bus 540 from UIR 538 contains 32 bits of ..microcode control information. Although there is certain overlap of functions controlled by various microinstruction fields, certain portions of each microinstruction may be generally described as controlling certain CS 101 functions.For example, in general UIR Bus 540 bits 0 and 3 through 30 are provided to PU 106 to control all PU 106 microcode visible functions. UIR us 540 bits 7 through 13 may be used to select a detected and registered condition occurring inCS 101 to be testes curing a current microinstruction cycle. For this purpose, its 7 through 13 from VIR Bus 540 are provided as control inputs to CONM 550, which in turn selects conditions to be testec. Other microcode controlled functions will be described further in the following descriptions. Having described the general operation of US 116, certain features of US 116 operation will be described in further detail next below. sic Microi A microinstruction cycle Is defined, for purposes of the following descriptions, is the tie between consecutive CS 101 clock cycles and is the period of time during which single microinstruction functions are executed. In general, during each microinstruction cycle e the microinstruction is fetched from either KUM 532 or VUM 534 and a previously fetched microinstruction stored in UIR 538 is executed. The following presents a typical sequence of steps occurring in US 116 during consecutive microinstruction cycles 1 USCL 500 has placed on UY Bus 524 a microinstruction memory address specified by decode of the certain bits C ó currently appearing on UIR Bus 540 and the output of CONM 50. Information appearing on CONM 550 s outtut from CONM 550 and UPCSR 526, may include the contents of UPCSR 526, information indicating the current top of USTAC 510, the contents ofUAR 506, or on Input appearing on UIN Bus 504. 2 The microcode accress appearing on UY Bus 524 is incremented by UPCI 516 and the incremented microprogram count loaded into UPCR 514. In all microsequencer operation, except certain operations described below, the microcode actress appearing on UYBus 524 is transferred onto NXUPC Bus 530 to address either KUM 532 or VUM 534. Therefore, UPCSR 526 will contain the address of the currently executing microinstruction plus one. 3 A new microinstruction addressed by the address presently appearing on NXUPC 530 is loaded intoUIR 538. 4 The address presently appearing on NXUPC 530 is loaded Into and saved in UPCSR 526, so that UPCSR 525 always contains the address of the currently executing microinstruction except on a TRAD condition as described below. 5 The output of CONM 550 from the microcycle just ending is loaded into CONSR 552. 6 US 116 s pointer to the top of the microstack residing in USTACK 510 is changed if the current US 116 operation specified in the cycle just ending has affected US 116 s microstack.7 The contents of UAREMI40.1 whose operation is described further in following descriptions, is changed if the US li6 operations specif ied in the microcycle just ending has affected UAR 506, or if other operations, described below, occurred during the same microcycle. Having described a typical microinstruction cycle sequence, US 116 operation for TRAPS will be described next below. 3. Trap Operation A TRAP condition occurs during execution of microcode when an exceptional condition occurs and it is desirable e to s cv the execution of 2 microinstruction in progress, service the exceptIonal condition, and then resume executicn of microcode from the suspended microinstruction. A TRAP process must save sufficient machine state so that the stopped microinstruction may be restarted.For those saved TRAPs that can be serviced entirely by microcode, the two pieces of state information trat must be saved In US 116 s microstack residing in USTACK 510 are, 1 address of the stopped microinstruction and 2 the output of CONM 550 from the stopped icroinstruction that Is, all conditions currently present. CONM 550 output rust be sawed because the Inputs toCONM 550 are registered, or tored, so state EMI41.1 may change during servicing of a TRAP condition and the microinstruction which was interrupted must recover the correct conditions selected upon resuming. A signal, TRAP is asserted by IPD 114 During execution of any r, cronnstructicn which is to be suspended. This event causes the following to occur 1 Clock to all CS 101 registers under explicit microcode control is stopped so that these registers are not loaded with altered information during servicing of the TRAP condition 2 USCL 500 s control input from UID 522 is forced into a state to force USCL 500 to do a jump operation to a TRAP handling microinstruction se2quence and 3 Control input to UIM 554 Is forced to the appropriate state to select UIM 554 s input to be that provided from IPD 114. The address of a TRAP handling microinstruction sequence is provided to UIM 554 s input from PD 114 by either CU 104 or PU 1G6, depending upon whether CJ 104 or PU 106 is the source of the TRAP signal. If both CU 104 and PU 106 have provided TRAP signals, then a priority mechanism will determine the TRAP handling microinstruction sequence to be selected.A TRAP handling address is the starting address of a TRAP handling microinstruction sequence and is placed directly upon NXUPC Bus 530 from UIN 504 through Buffer 505, At the end of a microcycle in whIch a TRAP condition occurs, the following occurs 1 UIR 538 is loaded with the microinstruction beginning the TRAP handling microinstruction sequence 2 UPCSR 526 is not loaded with the microinstruction address appearing on NXtPC Bus 530 UPCSR 526 will therefore contain the address of the trapped, that is, interrupted, microinstruction during the first microinstruction of the TRAP handling microinstruction sequence 3 The output of CONM 550 Is loaded intoCONSR 552. At conclusion of handling of the TRAP condition the original state of execution of the Interrupted microinstruction sequence is restored, using information retained in UPCSR 526 and CONSR 552 and through the state save restore mechanism described next below. 4. Basic State Save Restore nECHANISM US 116 S Basic State Save Restore Mechanism is USCL 500 s microstack residing in USTACK 510. During the first microinstruction cycle of a trap handling microinstruction sequence, signal TRAP is not asserted and any of the information stered in UPSCR 526 may change state. The first microinstruction cycle of aTRAP handling microinstruction sequence must therefore do a state save restore operation to save current state of US 116 and USTACK 510. During this operation, the contents of CONSR 552, that is, previous conditional states of execution, no the contents of UPSCR 526, that is, the address of interrupted microinstruction, are transferred through UIM 554 and onto UIN Bus 504.This state information is then transferred through USM 512 and onto the top of microstack residing in USTACK 510, thereby saving the conditions and address of the interrupted miicroinst uction. If a TRAP may be totally handled by a microcode, no further microsequencer state save is required. Resuming execution of the stopped microinstruction is accomplished by leaving the saved condition state and microinstruction address at the top of microstack residing in USTACK 510 and performing a resume operation which pops the top en try in USTACK 510. A pop operation fetches the stopped microinstruction while reading the saved condition state information from top of microstack and transferring this information from top of microstack through UAM 502 and into UPCSR 526.Saved condition state is a single bit of information fromUPCSR 526 and which represents the saved output of CONM 550. After being transferred into UPCSR 526, and during re execution of the interrupted mincroinstruction, the saved condition state information is transferred onto CONM 550 s output through Buffer 527, thereby providing saved condition state information to CONSR 552 and UID 522. Saved address of the interrupted inicroinstruction is concurrent y transferred through UAM 502, UPCM 518 and UPCR 516 to UPCR 514. At this point execution of the Interrupted microinstruction may be resu ed. Having described US 116 s basic state saVe restore mechanism, US 116 s state save restore mechanism for conditions requiring assistance from macrocode, that is, from instruction stored in MEM 102, will be described next below. 5. Macroinstruction Assisted State Save storeMechanism When a trap condition occurs requiring macrocode assistance for handling, the trap handler must save all microsequencer state and other PU 106 state In MEM 102 rather than in USTACK 510 s microstack. State saved in such conditions includes the current contents of USTACK 510 s microstack including the address of the currently executing microinstructions and current state condition information pertaining to the interrupted microinstruction, and the current contents of UAR 506As in the case described above, current condition fromCONSR 552 and UPCSR 526 are first pushed onto USTACK 510. Full state save then saves the contents of USTACK 510 and 506 in MEM 102. Current state conditions and current microinstruction address are read from CONSR 552 andUPCSR 526, respect.vely, and through UIM 554 to UIN Bus 504. This information, together with information fromUAR 506 and the contents of USTACK 510 s microstack, are read through UAM 502 and UY Bus 524 into UVR 528. State information so read from US 116 may then be transferred through D Bus 112 to MEM 102, or to scratch pad memory in PU 106, described in a following description of PU 106. State restore is accomplished by reading US 116 s saved state information from MEM 102, or scratch pad memory in PU 106, to D Bus 112. This information is then transferred into UIM 554 s input from D Bus 112, and onto UIN Bus 504. The saved contents of UAR 506 andUSTACK 510 may then be transrerred through UARM 508 toUAR 506 or through USM 512 to USTACK 510. Once completed, the saved condition state and interrupted microinstruction address will be the top entry in USTACK 510 and the interrupted microinstruction may be resumed as described in section 3 above. 6. Reading and Writing Microcode Memory As previously described, CS 101 implements vertical microcode In a writable control store, that is, VUM 534. A means, described next below, is provided to write vertical microcode from external memory to MEM 102 and from MEM 102 to VUM 534. This means also allows the to be contents of VUM 534 and and KUM 532 read from VUM 534 orKUM 532 to D Bus 112, for example, to verify microcode residing In VUM 534 or KUM 532 or to be read as a source of literal data. This mechanism operates under microcode control and the functIons described may be performed under control of microcode provided from either KUM 532 or VUM 534. During a microcode write to VUM 534, or a microcode read from VUM 534 or KUM 532, USCL 500 is forced to perform a conditional microinstruction jump to the appropriate microinstruction sequence, by means of 2 microcode it to UID 522 and a corresponding Instruction to USCLC 520.Microcode memory read and write addresses are provided to NXUPC Bus 530 from UAR 506 through UAM 502 and Sv Bus 524. UAR 506, In turn, is provided with read and write addresses from D Bus 112 through UIM 554 any EMI48.1 Bus 504. In microcode write operations to VUM 534, microinstruction words are provided on D Bus 112 and are transferred through UCD Bus 546 to VUM 534 s data input through Buffer 535. In microcode read operations from either KUM 532 or VUM 534, microinstruction words are read from KUM 532 or VUM 534 onto UCO Bus 536 and intoUIRSHI 542 and UIRSLO 544. Microinstruction words may then be transferred from UIRSHI 542 and UIRSLO 544 toUCD Bus 546 and to D Bus 112. 7. Microcode Paritv Errors Each micrqinstruction provided by KUM 532 or by VUM 534 is a 32 bit word comprising 31 bits of microcode information, plus 1 parity bit which is set to preserve odd parity. Parity of each microinstructicn appearing in UIR 538 is checked by UPARC 562 after each fetch of a microinstruction from KUM 532 orEMI49.1 534. If a parity error occurs, UPARC 562 will initiate a microparity error trap that prevents execution of the microinstruction in error and transfers control toKernel microcode in KUM 532 or error handling. 8. Crossing Instruction Boundaries In the above descriptions, IPD 114 was described as the source of instructions to be executed by means of corresponding microinstruction sequences provided by.US 116. An instruction boundary is crossed when the microinstruction sequence corresponding to a first instruction is ended, for example, by completing execution of the sequence or because of a trap condition, and execution of a second instruction is initiated. Microinstruction sequences provided by US 116 provide a mechanism for initiating the execution of new instructions. End of execution of a current instruction may be indicated by the appearance in UIR 538 of a particular microinstruction in the corresponding microinstruction sequence. If such an end of execution microinstruction occurs, UID 522 and USCLC 520 provide an instruction toUSCL 500 to jump to a state for receiving a next instruction. At this t me, UIN 554 is instructed to accept as input to UIN Bus 504 UIM 554 s input from IPD 114. IPD 114 will then provide, through UIM 554 andEMI50.1 Bus 504, the starting address in microinstruction memory of the next instruction to be executed. If an interrupt is pending, or if the next instruction has not yet been fetched, or if any one of several other conditions occurs, a next instruction may not appear or be available. IPD 114 will then provide to UIM 554 the address in, microinstruction memory of an appropriate routine to handle the existing condition. 9. Soft Console . As previously described, CU 101 incorporates a soft console . That is, operator console type commands may be entered through a terminal rather than through front panel switches. US 116 will detect the initiation of such a console command entry by means of a non maskable interrupt initiated by an initial console command. Upon such occurrence, an address will be forced at UIM 554 s input from IPD 114 which, provided to USCL 500 and thus to NXUPC Bus 530, is the initial address in KUM 532 of console microcode sequences stored therein. As previously described, at system initiation US 116 microcode memory contains only kernel microcode. In a present embodiment of the present invention, kernel microcode includes at least a portion of the NOVA instruction set microcode and is responsive to single character commands provided from a terminal through STO 120. Vertical microcode include microcode for the fullNOVA, ECLIPSE and MV 8000 instruction sets and is responsive to multiple character commands provided from a terminal through SIO 120. CS 101 thereby provides a limited raft console, that is, from a terminal, at system start upr and full console functions after vertical microcode has been loaded. Having described the structure and operation of US 116, the structure and operation of IPD 114 will be described next below.3. Instruction Prefetch and Decode IPD 114 Figs. 5 5 A As indicated in Fig. 5 and 5A, and as previously described, IPD 114 is connected between memory data MDA Bus 110 and D Bus 112 with an output to an input of UIM 554 in US 116. IPD 114 operates as pan up to four instruction deep Instruction pref etch, and as an initial instruction decoder. Some typical formats of instructions used in CS 101 have been previously described with reference to Fig. 2. a. Structure of IPD 114 Referring to IPD 114, 16 Hit Prefetch Register A PRA 564 and 16 bit Prefetch Register B PRB 566 have inputs connected from MDA Bus 110. 16 bit outputs ofPRA 564 and PRB 566 are connected to 16 bit PrefetchRegister PR Bus 568. PR Bus 568 is connected to 16 bit input ofDisplacement High Latch DISPRIL 570 and to 16 bit input of Displacement Low Latch DISPLOL 572. 16 bit outputs of DISPHIL 570 and DISPLOL 572 are connected to first and second 16 bit inputs of IPD Output Multiplexer IPDOM 574. Next Instruction Register NIR 574 has a 16 bit input connected from PR Bus 568 and 16 bit output connected to 16 bit input of Instruction Register IR 578. IR 578 in turn has a 16 bit output ccnnected to a third input of IPDOM 574. Finally, PR Bus 568 is connected to 16 bit input ofSingle Level Instruction Cracker SLIC 580. 9 bit output of SLIC 580 is connected to the input of 9 bitSingle Level InstructIon Cracker Register SLICR 582, and 9 bit output of SLICK 582 is connected to Input ofMacroinstruction Decode Memory MIDM 584. A first output of MIDM 58 is connected to the input of Decoded Instruction Register DIR 586. A first output of DIR 586 is connected to a fourth input of IPDOM 574 and in part controls IPDOM 574 Second outputs of DIR 586 are provided to other portions of CS 101, as will be described in following descritions. A second output of MIDM 584 is connected to a first input of Microinstruction Address Multiplexer UADRM 588. A second input of UADRM 588 is connected from TrapAddresses TA 590. Finally, IPD 114 s first output, from output ofIPDOM 574, is connected to D Bus 112 while IPD 114 s second output, from output of UADRM 588, is connected to the previously described input of UIM 554 in US 115. Having described the overall structure of IPD 114, the operation of IPD 114 will be described next. below. 2. T D 11 Oneroon As has been previously described, a typical instruction of CS 101 may contain 32 bits, including 16 bits of Instruction information opcode field and 15 or 16 bits of address displacement information displacement field . Certain instructions, however, will have a total length of 16 bits or will have a double word displacement field of 32 bits, for a total of 48 bits. As also previously described, and as will be further described in following descriptions, all writes to and reads from MEM 102 by CS 101 are of double words, that is, of two 16 bit words at a time.Upon each read from MEN 102, therefore, PRA 564 and PRB 566 will receive a 32 bit double word from MDA Bus 110, with one 16 bit word being received in PRA 564 and the other 16 bit word being received in PRB 556. A PrefetchRegister PR pointer generated by US 116 indicates, at any time, which of PRA 564 or PRB 566 presently contains or will contain a 16 bit instruction information of a current instruction field or which contains or will contain displacetent field nformation. Instruction displacement field information may be transferred from either PRA 564 or PRB 566 PR Bus 568 and either of DISHIL 570 or DISPLOL 572. Di placement field information may then be transferred from DISPHIL 570 or DISPLOL 572 and through IPDOM 574 to D Bus 112 for use by PU 106 In addressing data referenced by an instruction. Two displace field latches, that is, DISPHIL 570 and DISPLOL 572, are provided to enable displacement field information to be transferred to PU 106 in a single cycle for 15, 16 or 32 bit displacement fields. Instruction information fields may.be transferred from either PRA 564 or PRB 566 to PR Bus 568 and NIR 576 and in turn to IR 578.. From IR 578, instruction information fields may be transferred, simultaneously with the corresponding decoded output of SLIC 580 toSLICR 582, through IPDOM 574 to D Bus 112 and thereby toUS 116 through UIM 554 to select corresponding microinstruction sequences to be executed by CS 101.NIR 576 and IR 578, together with PRA 564 and PRB 566, provide an up to four instruction deep prefetch mechanism, allowing CU 104 to fetch instructions in advance of the instruction currently being executed. Certain of CS 101 s instructions cannot be executed itrznediately as receive from MEM 102. For example, instructions will frequently require additional processing of the instructions addressing Information before the data referenced by the instruction can be fetched from MEN 102 Additionally, due to the variety of instruction formats used by CS 101, CS 101 and US 116, in particular, must perform certain preliminary operations in order to properly interpret and respond to instructions. The instruction cracking and decoding circuitry provided by SLIC 580 and MIDM 584 and related logic provides a mechanism for interpreting instructions.First, SLIC 580 examines the 16 bit instruction information field of each instruction and extracts therefrom 9 bits, depending upon the instruction format, defining the operation to be performed. A first output is a 9 bit predecode address which is provided as an input to MIDM 584, described below. A second, 2 bit, output defines the index made for the instructions being decoded and other output may define the instruction class. The information so extracted includes information relating to data addressing, such as data width, displacement type and instruction width. MIDM 584 is a read only memory addressed by the 9 bit output of SLIC 580 and providing appropriate control outputs. MIDM 584 s first output to DIR 586 provides information relating to data width, displacement type and data length. MIDM 584 s second output, to UADRM 588 provides to US 116 the starting microaddress of microinstruction sequences to be executed, as previously described in the description of US 116. UADRM 586 s second input, from TA 590, provides information to UIM 554, and thus to US 116, regarding the starting microaddress of microinstruction sequences to handle trap conditions occuring in CS 101, as previously described. 3aving described the structure and operation of IPD 114, the structure and operation of MC 118 will be described next below. 3. Memory Control MC 118 Fig. 5, 5A and 7 MC 118, as previously described, performs interface functions between CU 101 and MEM 102. MC 118 Is a look aside interface device, that is, is connected In parallel from vYPS Bus 108 and MDA Bus 110, rather than being connected in series in these buses between CS 101 and MEM 102. MC 118 operates, however, as if connected in series in M D Bus 108 and MDA Bus 110 between CS 101 and MEM 102. MC 118 allows CS 101 and MEM 102 to share the same address and data signals on MAD Bus 108 and MDABus 110 while, at the same time, allowing CS 101 and MEM 102 to have different interface protocols. In addition to performing translation between CS 101 s memory bus protocol and MEM 102 s memory bus protocol. MC 118 provides MEM 102 refresh and sniffing .EMI59.1 EMI59.2 EMI59.3 is a mechanism and method for scanning MEM 102 locations being refreshed, detecting errors therein, and Correcting such errors.In addition, MC 118 performs memory error logging.Finally, as previously described with reference to CS 101 s addressing mechanisms and in particular CS 101 s demand paging mechanism, MC 101 monitors and logs, or records, referenced and modified pages residing in MEM 102. a. Structure or MC 118 Referring to Fig. 5 , MC 118 includes a MemoryControl Sequence MCS 592, which provides timing and control for all memory related operations, in particular those of MC 118. MCS 592 has a clock input from SCG 120, a refresh timing input from Refresh Timer REFT 594, and an error input from M 118 s ERCC logic, described below. In addition to other control outputs, MCS 592 provides outputs to Refresh Address CounterBuffer RAC3 596 and to Referenced Modified Bits Logic REFMOD 598. In addition to a timing output to MCS 52, REFT 594 provides a timing output to refresh Address Counter RkC 501. RAC 501 in turn provides refresh address outputs to RACB 596, and RACB 596 in turn provides refresh address outputs to MAD Bus 1G8 under control of the previously described control input from mCS 592. REFMOD 598, as previously described, monitors and logs referenced and modified pages in MEM 102 as part ofCS 101 s demand paging system by storing information bits pertaining to referenced and modified pages residing in MEM 102. In addition to a con trol input from MCS 592, REFMOD 598 includes an input from MAD Bus 108 and a bidirectional connection to MDA Bus 110. Finally, MC 118 incorporates Error Checking andCorrection ERCC logic which includes a first levelERCCER FLE 503 and a second level ERCCER SLE 505.FLE 503 and SLE 505 are implemented with Advanced Microdevices l 2960s connecte in a 32 bit configuration. MC 118 s ERCC logic is provided with an internal data bus, Check Data CDATA 507,which allows data to be transferred from MDA Bus 110 to MC 118 ERCC logic, manipulated, and transferred back onto MDA Bus 110.Data is transferred from MDA Bus 110 to CDATA Bus 507 through ERCC Data Input Buffer EDIB 509, and fromCDATA Bus 507 to MDA Bus 110 through ERCC Data Output Buffer EDOB 511. FLE 503 and SLE 505 each have a 16 bit bidirectional data input output connection to CDATA Bus 507 for receiving data from and transferring data toCDATA Bus 507. FLE 503 receives 7 bits of check bit RCC information, from IDA Bus 110 through FLE 503 s check bit CB input connected from MDA Bus 110 and provides a check bit output to check bit input of SLE 505 s C3 input. SLE 505 provides 7 check bits of ERCC information to MDA Bus 110 through ERCC Check bit OutputBuffer ECBOB 513. SLE 505 also provides error outputs, as previously described, to MCS 592 and to ER.RLR 556 in US 116. Having described the structure and certain features of the operation of MC 118, certain features of MC 118 will be described further next below. 2. Operation of MC 118EMI62.1 EMI62.2 The following description will pertain to CS 101 and CS 101 s interfaces to tiAD Bus 108 and MDA Bus 110 and CS 101 s functionality with respect to memory operations. As described above, CS 101 and MEM 102, will have differing interface protocols but share ne acdress and data signals appearing on MAD Bus 108 and MDA Bus 110. Translation between CS 101 and MEM 102 interface protocols involves the control signals exchanged therebetween and manipulation of check, or ERCC, bits appearing on MDA Bus 110. It should be noted that CS 101 may provide 30 bits of address, since, as previously described, CS 101 performs reads from and writes to MEM 102 double words only. The least significant bit of CS 101 s addresses are exchanged to be the least significant bit of the addresses received by MEM 102. This implies that consecutive double words written or read by CS 101 never appear in consecutive locations in MEM 102, allowing faster double word instruction fetches when MEM 102 interleave operation is considered. MC 118 operations may be divided into two broad classes, read operations d write operations. Read and write operations differ in that read operations may be pipelined, whereas write operation may not, due to the operation or the MEM 102. at is, address and control signals for a next read operation may be sent to MEM 102 while reading and checking the data read from MEM 102 in a present read operation. All data control and address control functions or a present write operation must, however, be fully completed bore initiating a subsequent write operation. MCS 592 ray be retarded as performing two mutually cependent operations with regard to memory read and write operations, address control and data control.Address control monitors operation of MEM 102 through control signals provided from MEM 102, initiates addressing operations, determines acceptance of addresses by MEM 102, and generates control signals to initiate operation of MCS 592 s data control logic on informati on transfers. MCS 592 s address control also monitors refresh operations, to allow sniffing operations. MCS 592 s data control logic gener control signals for MEM 102 s and CS lol s interfaces to MADBus 108 and MDA 110. MCS 592 s data control logic also generates all control signals for MC 118 RCC fctions and monitors the ERCC outputs of MC 118 s ERCC logic. As described above, MC 118 performs refresh operations upon information stored in MEM 102. Refresh is performed through cycle stealing operations, wherein MC 118 s refresh control circuitry takes control of MAD 108 and MDA Bus 110 at periodic Intervals to refresh successive portions of MEM 102 s address space.REFT 594 generates a refresh request signal at periodic intervals and, at tie of a refresh cycle, increments RAC 501 to generate successive refresh addresses. RAC 501 generates 21 bit addresses specifying double words to be read and checked for errors. A sniff operation, that is examining information stored in MEM 102 in storage locations currently being refreshed for error checking and correction, begins by requesting a refresh cycle. During refresh cycle, NC 118 takes control of m.D Bus 108 and MDA Bus 110 and asserts a refresh address from RAC 501 through RACB 596 to MAD Bus 108. Information read from corresponding locations in MEM 102 is checked for errors, while CS 101 is allowed to continue making memory references. If a correctible error is found, a refresh write back operation is initiated. A refresh write back operation is performed in the same manner as the original refresh except that the information is corrected and written back. When RAC 501 generates an address greater than the present address space of MEM 102, that address will address nonexistant memory. When this event occurs, MEM 102 will not generate a signal indicating that the refresh address has been accepted. This event causes RAC 501 to be reset to zero, allowing refresh to start over at the beginning of MEM 102 address space. A refresh and sniff in MEM 102 s address zero is performed immediately upon this occurrence. As described above, ERCC and error logging is accomplished through MC 118 s ERCC logic, including FLE 503 and SLE 505. Data inputs to FLE 503 and SLE 505 from MDA Bus 110, and data outputs from FLE 503 and SLE 505 to MDA Bus 110 are isolated from MDA Bus 110 through the bidirectional buffer comprising EDIB 509 and EBOB 511. As described above, CDATA Bus 507 operates as the data portion of MDA Bus 110, but is isolated from MDABus 110 by this bidirectional buffer. Check bits, that is ERCC bits appearing on ..CA Bus 110, aret however, provided directly to FLE 503 s check bit CB input fromMDA Bus 110.Check bit output SC of MC 118 s ERCC logic is provided from check bit output SC of SLE.505 to MDABus 110 through ECBCB 513. MCS 592 provides individual and separate controls of all data and check bit transfers through EDIB 509, EDOB 511, FLE 503, SLE 505, and ECBOB 513. ERCC upon information read from MEM 102 on to MDABus 110 is accomplished by reading data bits from MDABus 110 and through EDIB 509 to CDATA Bus 507, and thus into FLE 503 and SLE 505, while check bits are read directly into FLE 503. It should be noted that FLE 503 receives the 16 least significant bits of data while SLE 505 receives the most significant 16 bits of data. FLE 503 utilizes the check bit inputs from MDA Bus 110 and the 16 least significant data bits received from CDATABus 507 to generate an appropriate check bit output toSLE 505 for those check and information bits.SLE 505 in turn utilizes the most significant 16 bits of data rom ODATA 507 and the check bit input from DLr 503 to generate a final check bit output. ERCC upon Information read from MEM 102 is performed at the same time that the information is passed on to the requestor, in most cases PU 106. That is, ERCC is performed in parallel with the read operation. If an ERCC error is detected, a signal halting memory operations is asserted and 2 correction cycle Initiated. During correction cycle, error syndrome bits indicating the error which has occurred are provided at output ofSLE 505 and are driven onto MDA Bus 110 through ECBOB 513. From MDA Bus 110r error syndrome bits are transferred into FLE 503, which provides appropriate outputs to the check bit input of SLE 505. FLE 503 ana SLE 505 then generate corrected data onto CDATA Bus 5G7.The corrected data is then transferred through EDOB511 to MDA Bus 110 and thereby to the requester. Because comparitively few read operations will result in correctIon cycles, the parallel operation of MC 118 sERCC Logic, wherein informatiob is passed on to the requester while ERCC s performed, will result in faster average read operations than will a series SRCC openation. MC 118 s ERCC Logic also generates ERCC bits during write operations to MEM 102. As previously described, all write operations, as are all read operations, are of double words. Data appearing on MDA Bus 110 to be written into 1 M 102 is accepted on to CDATA Bus 507 through EDIB 509. FLE 503 and SLE 505 access is oata as inputs and generate corresponding check bis from the output of SLE 505. These write check bits are then transferred onto the check bit portion of MDA Bus 110 through ECBOB 513, and the data and corresponding check bits written into MEM 102. CS 101 may also perform partial write operations, that is, writes of single words of single bytes. As described above, all read and write operations of CS 101 from anc to MEM 102 are of double words, that is, of two sixteen bit words at a time. As has also been previously described, CS 101 is also capable of generating read and write addresses referencing single words 16 bits and single bytes 8 bits . The operation of CS 101, and in particular MC 118, in performing single word and byte read and write operations will be described next below. Referring to Fig. 7, a block diagram of certain portions of CU 104 and PU 106 is shown, in particular CU 104 s ERCC circuitry, including FLE 503 and SLE 505 andCDATA us 507, and PU 106 s MDS 132, in particular MDR 602. In Fig. 7, FLE 503, STE 505, EDIB 59, EDOB 511,MDR 602, and MDRB 603 have been redrawn to illustrate the operation of these elements in yet greater detail.In particular, MDR 602 and Y.DRB 603 of S 132 are indicated as operating, respectively, as four Independently controllable 8 bit registers and buffers,C, D, E, and F, rather than as a single 32 bit register and buffer. In FLE 503 and SLE 505, input latches I have been represented as each comprising two independently controllable 8 bit latches And B, while output latches 0 have beep similarly represented as each comprising two Independently controllable 8 bit latches,A and B.Similarly, EDIB 509 is represented as comprising four independently controllable 8 bit Input bufers, while EDIB 511 is represented as comprising four independently controllable 8 bit output buffers. For clarity of presentation of the following description, CDATA Bus 507 is shown as divided in two parts, one part corresponding to FLE 503 while the second part is associated with SLE 505. This division is made for illustrative purposes only and the two halves of CDATA Bus 507 shown in Fig. 7 are in fact a single bus. MDA Bus 110 is represented as being comprises of a 32 bit data bus and a 7 bit check bit bus for ERCC bits. In as much as CS 101 performs only double word reads from and writes to MEM 102, a write of a single word or byte to MEM 102 is performed as a read, modify and write of a double word. Tttei double word containing the address location of the single word or byte to be written into S 102 is read from ZM 102. The double word read from MEM 102 is effectively modified by having the single word or byte written into the appropriate location in the double word, and the double word is then written back into MEM 102. The following will describe the operation of CS 101 In writing a single byte 8 bits into MEM 102.A single word write, that is, of 16 bits, or two bytes, is performed in the sam manner except that two bytes rather than one are written into the appropriate location in the double word. Referring to Fig. 7, at start of a single byte write operation a double word is read from MEM 102 onMDA Bus 110. Thirty ,wo data bits appear upon the data portions of MDA Bus 110, while seven check bits appear on the check bit portion thereof. The four 8 bit bytes comprising the 32 bit double word are transferred through the corresponding portions of EDIB 509 to CDATA Bus 507 and into the corresponding A and B portions of FLE 503 s and SLE 505 s input I latches. The check bits are transferred directly into FLE 503 s check bit C3 input. The 32 bit word received from MEM 102 and to FLE 503 s and SLE 505 s I latches are checked for errors, corrected if necessary, and transferred into FLE 503 s and SLE 505 s four 8 bit output 0 latches A and B. At the same time, the byte to be written into MEM 102 is loaded into one of MDR 602 s four single byte 8 bit latches, C, D, E, and F, from D Bus 112. The byte to be written into MEM 102 will appear in the one of MDR 602 s latches corresponding to the location that the byte is to be written into in the double word initially read from MEM 102. The byte to be written is then transferred from the corresponding byte register of MRD 602 and through the corresponding portion of MDRB 603 to the data portIon of MDA Bus 110 and therefrom into the corresponcing single byte input latch of FLE 503 or SLE 505.For example, a byte appearing in MDR 602 byte register E could correspondingly be transferred into FLE 503 s 1 latch A, while a byte appearing in MDR 602 s latch D would appear in SLE 505 s I latch B. At this time, three of FLE 503 s and SLE 505 s input latches contain corresponding bytes from the double word originally read from MEM 10 while cne ofFLE 503 S or SLE 505 s Input latches contains the bvte to be written Into NSA 102. FLE 503 s and SLE 505 s Input latches thereby contain the modified double word to be written back into MEM 102, that is, the double word containing the byte to be written into NM 102.FLE 503 and SLE 505 will then generate the new seven check bits for the modified double word. The check bits in modified double word are then transferred to FLE 503 s and SLE 505 s output latches and on to CDATA Bus 507 and MDA Bus 110 to be written into MBA 102, thereby completing the write of a single byte into MEM 102.As described above, a write or a single word, that is of to bytes at a time, is performed In the same manner as single byte write operation except that two bytes are received from K 602 and used to generate the modif led double word. Finally, as previously described, MC 118 s REFMOD 598 operates as part of CS 101 s demand paging system by monitoring and storing information relating to referenced and modified pages residing in MEM 102. REFMOD 598 may store Information pertaining to up to, for example, 8 megabytes of information store in MBM 102. REFMOD 598 stores two different types of information pertaining to each page in MEM 102. First,REFMOD 598 stores, for each page residing in MEM 102, a bit Indicating whether the page has been reverenced byCS 101, for example, in executing a user s program. Secondly, REFMOD 598 stores, again for each page In MEM 102, a bit incicating whether CS 101 has modified, that is, performed a write operation to, that page In MEM 102. Referenced Information bits are updated upon occurrence of each read or write operation to MEM 102, while mooiried bit information is updated curing each write operation.Updating of referenced and medified information in REFMOD 598 is perforred under control orCU 104 random control outputs from HUM 548 and US 115 as previously described, Having described the structure and operation of CU 104, the structure and operation of PU 106 will be corresponding described next below. B. PROCESSOR UNIT PU 106 STRUCTURE AND OPERATION Figs, 6 and 6A Referring to Fig. 6, a detailed block diagram of PU 106 is shown. As previously described, vV 106 operates under. microinstruction control of CU 104 to execute user s programs. Tha t is, PU 106 performs all data manipulation and calculation operations, addressing operations, and information transfers between CS 101 and external storage devices. 1. General Structure and Operation of PU 106 As previously described and as shown in Fig. 6, PU 106 includes CPU Processor CUPUP 122, Nibble Shifter NIBS 126, Stratch Pad and Address Translation Unit SPAD 128, Memory Addressing MAD 130, Memory Data Store MDS 132, Serial Input Output SIO 134, and Data BMC Input output DBIO 136. Referring first to CPUP 122, CPUP is a 32 bit processor comprised of 8 four bit Advanced Micro Devices AMD 2901C microprocessors connected in parallel. CPUP 122 performs all CS 101 arithmetic operations under microcode control of CU 104. CPUP 122 includes a random access memory RAM , a shift register buffer, a register file, an arithmetic and logic unit ALU , and other registers, shift registers, and multiplexers as needed to perform general purpose data manipulation operations, including arithmetic operations. CPUP 122 further includes internal microcode control, which receives instruction inputs from US 116. CPUP 122 receives two inputs, AR and BREG from US 116 microcode control output which selects, for certain operations, source and destination registers in CPUP 122 s register file.As indicated in Fig. 6, CZJP 122 has a 32 bit data input connected from D Bus 112 and a 32 bit output connected to Y Bus 124. The circuitry comprising CPUP 122 are commercially available components well known to those of ordinary skill in tne art, and will not be described further except as require2 for a more thorough understanding of CS 101 during the following detailed descriptions of other portions of PU 106. Having described PU 106 s CPUP 122, the transmission paths by which information, primarily data and addresses, are transferred between MEM 102 and PU 106, and in particular CPUP 122, will be described next below. These transmission paths include MAD Bus 108, by which read and write addresses are provided to MEM 102 by PU 106, and MDA Bus 110, by which Instructions and data are communicated between PU 106 and MEM 102. deaths internal to PU 106 include D Bus 112 and YBus 124. As indicated in Fig. 6,EMI77.1 132 is connected between D Bus 112 and ADA Bus 110 and between MDA Bus 110 and Y bus 124.EMI77.2 132 includes Memory DataRegister MDR 602, having a 32 bit input connected fromD Bus 112 and a 32 output connected through buffer driver MDRB 602 to L5DA Bus 110. F9S 132 also includesMemory Data Latch MDL 604, which has 32 bit input connected from MDA Bus 110 and a 32 bit output connected to Y Bus 124. Finally, PU 106 s internal data path further includes NIBS 126, having a 32 bit input connected from Y Bus 124 and a 32 bit output connected to D Bus 112.MAD 130, comprising PU 106 s address output to MAD Bus 108, will be discussed separately further below, in conjunction with the discussion ofSPAD 128. Considering first data transfers from MEM 102 to PU 106, data read from MEM 102 appears on MDA Bus 110 and may be received and stored in MDL 604. That data may be then transferred from MDL 604 to Y Bus 124, and may then be transferred from Y Bus 124 to NIBS 126. NIBS 126 is a nibble shifter and is capable of either passing data straight through or performing right or left shifts of data on a nibble by nibble basis.NIBS 126 is used, for example, to shift data within words received from MEM 102 into differing forts for subsequent operations by CPUP 122. NIBS 126 may, for example, be further used to reorganize data resulting from operations CPUP 122 into formats selected for storing such data in MEM 102. As previously described, NIBS 126 s output is connected to D Bus 112, so that data appearing on y Bus 124 may be transferred onto D Bus 112, either directly as a traight through put or after being operated upon by NIBS 126. As previously described the output of CPUP 122 is connected to Y Bus 124, so that data generated as a result OL CPUP 122 operations may be transferred, through NIBS 126, to D Bus 112. Again, data transferred through NIBS 126 from output of CPUP 122 may be passed directly through NIBS 126 or may be operated upon by NIBS 126. For example, NIBS 126 may perform alignment operations upon data outputs of CPUP 122 in preparation for subsequent write operation to MEM 102. Data appearing on D Bus 112 may then be transferred into MDR 602 and subsequently transferred through MDRB 603 to MDA Bus 110 and thus written into MEM 102.Alternatively, data appearing on D Bus 112 may be transferred into CPUP 122 s data input. Data appearing on D Bus 112 may also be transferred through Buffer 606 to DBIO 136 for subsequent transfer to extrnal storage devices. Before describing PAD 128 and MAD 130, two further features associated with operation of CPUP 122 will be described next. The first is the use of CPUP 122 to perform increment by two operations and the second is the multiple uses of Temporary Register TREG 608, whIch is bi dlrectionally connected from D Bus 112. A common operation, for example, in anipulating addresses and other arithmetic operations, is to increment a given number by two. The AMD 2901Cs utilized in CPUP 122 are, however, not directly capable of performing an increment by two operation. Minus 2Source MINUS2 6i0 having an output to D Bus 112, and a microinstruction sequence from US 116, allow CPUP 122 to perform Increment by two operations. MINUS2 510 Is a source for lacing on D Bus 112 a 32 bit number having a numeric value of minus 2. CPUP 122 contains the number to be incremented by 2 in its register file.It accepts the minus 2 operand provided by MINUS2 61C, and compliments it givIng a 1 and performs an add operation with the number to be Incremented to give a order equal to the operand to he incremented plus 1.At the same time, 2 plus 1 is forced into CP 122 s U carry input to provide a further plus 1 increment. The output of CPUP 122 s ALU will thereby be the original operand incremented by 2. MINUS2 610 thereby allows CPUP 122 to perform a commonly desired operation not originally provided for by the AY.D 2901 circuits employed therein. Referring now to TREG 608, TREG 608 is a 32 bit shift register which may be used for temporary storage of data appearing on D Bus 112, from which TREG 608 is connected by a bi directional 32 bit bus. TREG 608 is further utilized to generate 32 bit long control word sequences for controlling other operations of CS 101.Under microcode control, a D2 bit pattern of ones and zeros is loaded into TREG 608. That 32 bit pattern is then shifted right or left as necessary to generate bit sequences which are used, for example, to perform system resets, to perform timed input output operations, and to control buffers or programmed input and output operations. TREG 608 thereby provides an extenced means for controlling certain operations of CS 101 while utilizing already existing circuitry normally Intended for temporary data storage functions. Referring now to SPAD 128 and MAD 130, SPAD 128, having inputs connected from Y Bus 124, performs address translation and napping functions as previously described. SPAD 128, for example, accepts logical addresses from Y Bus 124 and provides corresponding physical addresses to MAD 130. MAD 130 transfer addresses from SPAD 128 to MAD Bus 108. In addition,MAD 130 operates in conjunction with IPD 114 as a prefetch mechanism by generating and providing prefetch read addresses to MEM 102 through MAD Bus 108. Referring first to S AD 128, the core of SPAD 128 is SPAD Memory SPADM 129. SPADM 129 is a random access memory used In part by PU 106 and CS 101 as a scratch pad memory. SPADM 129 is further utilized to store address mappIng Information, and thus is a part ofCS 101 s addressing mechanism. For example, SPADM 129 may be used to store address translation maps for CS 101 s data channel, burst multiplexer channel, programmed I O, through DBIO 135. SPADM 129 is also used to store addressing maps for logical to physical address translations.In addition, SPADM 129 contains cs 101 s Segment Base Registers SBRs , previously described, and 2 portion of SPADM 129 is utilized as accumulators for floating point operations. As indicated in Fig. 6, SPAD 128 includes an Internal addressing bus, referred to as Logical Address Register LAR Bus 132, and a data bus, referred to as SPAD Bus 134. LAR Bus 132 Is connected from Y Bus 124 through Logical Address Register LARR 136 and LogicalAddress Register Multiplexer LARM 138. LARR 136 has a 32 bit output to LAR Bus 132 and has inputs from Y Bus 124 and from LARM 138. LARR 136 and LARM 138 are utilized to provide logical and physical addresses to SPAD 128 and MAD 130.The general format of CS 101 s logical addresses has been previously described. In tnose descriptions, certain bits were indicated as representing physical or logical page numbers and page offsets, while other bits comprise various control fields. As shown in Fig. 6, LARR 136 has a first 16 bit input connected from V Bus 124 for receiving 16 bit physical and logical page offset fields from Y Bus 124.LARR 136 s second input is connected from LARM 138 and comprises those 16 bits of address used for logical and physical pace number fields,, various control fields, and also for short addresses. LARM 138 includes a first 16 bit Input connected from Y Bus 124 to receive, for example, a corresponding 16 bits of page number field from v Bus 124 when LARR 136 s first input is receiving a page offset feld. LARM 138 further includes 2 inputs to enable varying formats to be selected for bits 0 to 16 of addresses to be provided to SPAD 128. For example, three bits CRE of each of these two inputs represents which of CS 101 s 8 memory space segments CS 101 is to be addressed by a particular address, while other bits of these two inputs are taken from Y Bus 124. As indicated in Fig. 6, LARR 136 s 32 bit output is connected to I AR Bus 132, which in turn is a source of addresses to SPADM 129, to CS 101 s address translation unit control, T 146 and ATC 1 8, and to MAD i30. A first output of LAR Bus 132 is connected directly to MAD 130, and In particular to an input of MAD Multiplexer MADM 140. As will be described further below, MADM 140 is a source of physical address offset fields forMAD 130 s output. LAR Bus 132 s output directly to MADM 140 is used, for example, to provide physical page offsets to MADM 140 when PU 106 is directly physically addressing MEM 102.This path is also used, in further example, to provide sIngle and double level page table offset fields when performing single and double level page table translations of logical to physical addresses, as previously described. LAR Bus 132 is further provided with a direct path through Buffer 142 to SPAD Bus 134. As will be described further below, this path may be used to provide physical page number fields directly to memory Address Latch MAL 150 in MAD 130 from LARR 136 in conjunction with the corresponding offset field of a physical addres as described above.described further below, SPADM 129 is provided with a bi directional data input output connection to SPAD Bus 134. The path comprising LAR Bus 132, Buffer 142, andSPAD Bus 134 may also be used, for example, to write information, such as address maps, into SPADM 129 from LARR 136. LAR Bus 132 also provides an input Into SPAD Multiplexer SPAM 144, which has an address output connected to SPADM 129 s address input AD . SPAM 144 is the means by which SPADM 129 is addressed for read and write operations. The path comprising LAR Bus 132 and first input of SP. 144 is used, in part, to addressSPADM 129 SPAM 144 is provided with three further inputs. Two of these inputs, ACD and ACS, are provided rom IR 578 in IPD 114, respectively, and Identify destination and source accumulators. ACD and ACS may be used, for example, in addressing SPADE 129 s address locations assigned, for example, as floating point accumulators. SPAM 144 s fourth input is connected from UIR Bus 540 in US 116 is used to microinstruction control in addressing SPADM. The above combination of address sources for SPAM 144 allows, for example, ACS or ACD inputs to specify a base address in SPASM 129 and UIR microinstruction inputs to specify an offset from such a base address to a floating point source or destination accumulator. This addressing ode also allows the ACS field of IR 378 to be determined without performing a mass and shift operation to read ACS field from IR 578 the information s Instead determined from 2 read from SP.iM 129, with the results of such an ACS reac indicating the contents of IR 578 s ACS field, Microinstruction and IR 578 addressing of SPADM 129 also allows constants to be stored in and recovered from SPADM 129 as required. Finally, LAR Bus 132 provides an output to SPAD 128 s address translation control unit, comprIsIng Tag Compare TC 146 and Address Translation Control ATC 148. TC 146 receives certain portions of addresses appearing on LAR Bus 132 and SPAD Bus 134 and, utilizing this information, generates control inputs to ATC 148.ATC 148 has a bi directional connection to Y Bus 124 to receive address translation control information therefrom and to provide such control information onto YBus 124. Referring to SPAD Bus 134, as previously describedSPAD Bus 134 has a direct 32 bit connection fro L R Bus 132 through Buffer 142 and has a bi directional 32 bit input output to SPADM 129. Certain address fields, that is, physical page number fields, appearing on SPAD Bus 134 from SPADM 129, or from Buffer 142, may be transferred into Memory Address Latch MAL 150 In AD 130. Finally, SPAD Bus 134 has a 32 bit bi directional input output connection to D Bus 112 through SPAD Buffer SPADB 152. SPADB 152 allows operations to be performed on SPAD Bus 134, for example writing a page number into MAL 150, while leaving D Bus 112 free for other, concurrent operations. SPADB 152 allows information to be transferred between D Bus 112 andSPADM 129 or TC 146. For example, address information may be read from SPADM 129 to D Bus 112, or may be read from D Bus 112 and written into SPASM 129 for example, when loading address maps into SPADM 129.SPADB 152 is particularly used, for example, in floating point operations and for any operation wherein SPADM 129 is being used as PU 106 s scratchpad memory, or general registers. Having described SPAD 128, fID 130 will be described next below. 3. Memory Addressing MAD 130 As previously described, MAD 130 is connected from outp7uts of SPAD 128 and in turn has an to O MAD Bus 108. D 130 receives physical addresses from SAD 128 and transfers those physical addresses to MAD Bus 108 to address MEM 102 for read and write operations. MAD 130 also operates in conjunction with IPD 114 as an instruction prafetch mechanism by providing instruction prefetch physical addresses to MEM 102. As also previously described, physical addresses for reading from or writing to MEM 102 are comprised of a physical page number field and a physical page offset field. As described above, physical page number fields are provided by S2PD 128 to MAL 150 through SPAD us 134, either from SPAD M 129 or from LARR 136 through Buffer 142. Physical page offset fields are provided to MADM 140 by LARR 136 through the bus connection go directly from LAR bus 132 to an input of MADM 140. Outputs of MAL 150 and MADM 140 are connected toMemory addressing Internal MADI Bus 154, which is connected in turn through Dlempry Address Buffer MADB 156 to MAD Bus 108. Physical addresses received by MAD 130 from SPAD 128 may thereby be assembled from MAL 150 and MADM 140 onto MADI Bus 154 and transferred onto MADBus 108 to address MEM 102. That portion of MAD 130 which operates as part ofCS 101 s preftch mechanism inciudes Prefetch PageNumber Register PPNR 158, Prefetch Page Offset Counter PPOC 160, and Write Compare WCOMP 162. PPNR 158 has an input connected from and an output connected to MADIBus 154. PPOC 160 has an input connected from MADI Bus 154 and an output connected from PPNR 158 and MADI Bus 154 and provides outputs to IPD 114. An initial physical address, including page number and page offset, from which instruction prefetch is to begin is generated by SP 128 and is transferred ontoMADI Bus 154. Page number and page offset are then transferred from MADI Bus 15 into, respectively, PPNR 158 and PPOC 160. Thereafter, page ofFSET IN PPOC 160 is successively incremented and combined, throught MADM 1e0, with page number read from PPNR 158 to provide successive instruction prefetch read addresses on MADIBus 154 and thus onto MAD Bus 108 to fetch successive double words containing instructions from KEM 102.Sequential instructions are fetched from consecutive logical pages, thus barring address jumps. Consecutive logical pages need not be consecutive physical pages.PPNR 158 is implemented as a register, rather than a counter, to prevent prefetch from crossing physical page boundaries. When PPOC 160 overflows, prefetch is stopped until PPNR 158 15 loaded it a new physical page number, corresponding to the next sequential logical page of execution. WCOMP 162 checks each physical address to MEM 102 for rite operations and comparcs such addresses to addresses of instructions prefetched by MAD 130 and IFD 114. If a write operation is executed to a physical address within the sale page as a prefetched Instruction, WCOMP 162 provides an output indicating that the contents of I D 114 are no longer valid. CS 101 will respond by reinitlating prefetch to obtain new valid instructions from MEM 102.