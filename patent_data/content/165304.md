# PHASE ANALOG ENCODING SYSTEM WITH COMPENSATION

## Claims
Auf einem Stellungsmelder basierendes, phasenanalogisches Kodierungssystem zur Anzeige der Stellung, mit Ausgleich für eine inhärente elektrische Phasenverschiebung an dem Stellungsmelder, welches umfaßt

## Description
This application is related to U.S. Pat. application US A 4 577 271 published the 18.03.1986 entitled SAMPLED DATA SERVO CONTROL SYSTEM WITH DEADBAND COMPENSATION. This invention relates to a phase analog encoding system with compensation, used in connection with a resolver position transducer and utilized in servo control or monitoring applications. A resolver position transducer is a device which monitors the position of a rotatable shaft or a linearly displaceable member by measuring the angular displacement of the shaft or the linear displacement of the member with respect to a fixed reference point. The resolver, when excited with the proper electrical input will output an electrical signal whose phase is related to the position of the shaft or member. Thus the position of the shaft or member is encoded in an electrical signal in an analog manner. By putting the electrical signal from the resolver position transducer through more encoding circuitry, an electrical signal can be obtained which represents the position of the shaft or member. If one knows the position of the shaft or member, one can determine if a machine connected to the shaft or member is operating properly. Thus one is able to monitor the performance of a machine by measuring the angular displacement of a rotatable shaft or the linear displacement of a linearly displaceable member with a resolver position transducer. Additionally, if one knows the position of a machine s shaft or member, one is able to use that information in a feedback network to control the operation of the machine in order to obtain any desired performance. Used in this manner, the resolver position transducer is performing a servo control function. The phase shift errors inherent in a resolver position transducer are of particular importance in applications where the resolver is part of a phase analog encoding system. The phase analog encoding technique utilized in such systems involves applying reference signals to the resolver position transducer in the form of two sinusoidal signals displaced in time by 90 electrical degrees such as The typical phase analog encoder operates by measuring the relative phase difference The above encoding technique for measuring the mechanical displacement will be accurate as long as α remains constant. Usually does not vary by more than one or two degress. As a result, the overall phase analog encoding system utilizing this technique is low cost, easy to apply and very effective for applications where an accuracy of one or two degrees is acceptable. For many applications, however, the change in α with respect to temperature variations in input frequency manufacturing tolerances and other mechanical constraints such as shaft loading can be quite large, requiring some form of compensation. Typically, the most severe errors are introduced by variations in temperature. As a result, some form of compensation is necessary where the resolver will be operating in an environment with wide variations in the ambient temperature. There are two common forms of compensation for variations in temperature. One form involves mounting a temperature sensor in a network to compensate for the inherent electrical phase shift. The second form involves the use of an additional winding in the resolver position transducer and a separate encoding circuit which is used to monitor the electrical phase shift across the additional winding so that a compensating signal can be generated which is then used to correct the primary encoding circuitry of the resolver position tranducer. The disadvantage of both of the common forms of temperature compensation is that they involve additional components and more complex circuitry. This increases the total cost of the system and increase the possibility of component failure and system break down. US Patent specification US A 3,537,099 BA Johansson describes a resolver based phase analog encoding system for indicating position with compensation for an inherent electrical phase shift across said resolver comprising The object of the present invention is to provide an improved resolver based phase analog encoding system. A resolver based phase analog encoding system according to the invention is characterised in that The present invention overcomes disadvantages and objections associated with the prior art compensation for the electrical phase shift across the windings of a resolver position transducer. The disclosed invention is for an encoding technique wherein the inherent electrical phase shift across the windings of a resolver position transducer windings which are also part of the primary encoding circuit for determining the mechanical displacement of the position transducer is measured in a time multiplexed fashion to correct for deviations due to all sources, including variations in temperature. It is to be understood that this invention can be applied to any sinusoidal position transducer. Where the term resolver transducer is used, it is intended to include synchro, induction potentiometer resolver transmitter, control transfer transformer, differential control transformer and any other sinusoidal position transducer. It is to be understood that this invention can be used in connection with a rotary resolver position transducer or a linear resolver position transducer. In a rotary resolver, the mechanical displacement is an angular displacement and is equal to the rotor angle. In a linear resolver, the mechanical displacement is linear. In a rotary resolver, there are at least two stationary windings called the stator windings and at least one moveable winding called the rotor winding. A linear resolver has at least two windings which are the electrical equivalents of the stator windings, and at least one winding which is the electrical equivalent of the rotor winding. The invention utilizes a resolver position transducer in a phase analog encoding system wherein the total phase shift of the resolver transducer is determined by measuring the time interval between the zero crossing of the resolver sine reference and the zero crossing of the resolver feedback taken from the equivalent of a rotor winding of the resolver position transducer. The measured time interval between the zero crossings T is proportional to the sum of the mechanical displacement and the electrical phase shift across the windings of the resolver transducer α Under normal operation measurement cycle the two stator windings of the resolver transducer are driven by highly accurate sinusoidal signals displaced in time by 90 electrical degrees. If the stator windings are excited by the above signals, the resolver rotor winding provides a phase analog feedback signal of the form indicated in equation 3 . The time interval between the zero crossings of two waveforms which have the same form as equations 1 and 3 is proportional to α . This time interval can be used by a calculating means such as a computer or a microprocessor to determine α , , and many other useful variables by executing predetermined numerical manipulations. Periodically, at times selected by a calculating means and implemented by a reference switch in the resolver transducer encoding system, the resolver transducer is operated in a compensation mode. During the compensation mode, the resolver reference voltages the voltages applied to the stator windings are electronically switched and applied to the appropriate resolver stator windings. The appropriate windings are determined by the resolver encoding electronics to insure a large signal on the rotor windings. Depending upon the mechanical displacement , either a resolver reference signal of K₁SINωt or K₁SINωt is applied to one or the other of the resolver stator windings. This ensures that there will be the maximum possible output on the resolver rotor winding by applying a resolver reference voltage of the proper sign to the stator winding which has the most magnetic coupling for a given mechanical displacement . For instance, in a rotary resolver position transducer where the mechanical displacement is an angular displacement represented by the mechanical rotor angle When the resolver reference voltages are applied during the compensation cycle as indicated above, the resolver transducer behaves electrically like a transformer with the excited stator winding acting like a primary winding and the rotor winding acting like a secondary winding. As such, the voltage on the secondary winding will only differ in phase from the voltage on the primary winding by an amount equal to the inherent electrical phase shift across the resolver windings. Thus, when the resolver encoder measures the time interval between the zero crossing of the resolver sine reference and the zero crossing of the resolver feedback signal, the resulting time interval T is proportional to the inherent electrical phase shift across the windings of the resolver transducer α The encoded value of α is then utilized by the calculating means to correct for any changes in the inherent electrical phase shift with respect to previous measurements. Once a proper value for the inherent electrical phase shift across the resolver windings α is determined, the calculating means can determine the exact mechanical displacement by subtracting the value of α from the measured quantity obtained during the normal measurement cycle, α . The duty cycle between the normal measurement cycle measurement of α and the compensation cycle measurement of α only is determined by the calculating means and can be either a strict function of time and or a function of other variables as deemed appropriate to the application of the resolver encoding system. The phase analog encoding system with compensation for the phase shift error inherent in a resolver position transducer described by this invention has the additional feature of being self calibrating. The encoding system can be operated in a calibration mode in which the inherent phase shift error in the encoding circuitry γ is measured. If the inherent phase shift error in the encoding circuitry γ is taken into account, equations 4 and 5 , respectively become The calculating means uses the measured value of the inherent phase shift error in the encoding circuitry γ to compensate for the presence of this error during the normal measurement mode of operation and the compensation mode of operation. The phase analog encoding system described by this invention can be operated in a normal measurement mode, a compensation mode or a calibration mode of operation. During the compensation mode of operation, the inherent electrical phase shift of the resolver transducer is measured. This value is used during the normal measurement mode of operation to compensate the measurement of the mechanical displacement . During the calibration mode of operation, the inherent phase shift error in the circuitry of the encoding means γ is measured. This measured phase shift error is used to compensate the measurements made during the compensation mode and the normal measurement mode of operation so that they are independent of any phase shift error inherent in the encoding circuitry. The inherent phase shift error in the circuitry of the encoding means γ is measured in a time multiplexed fashion with the inherent electrical phase shift across the windings of the position transducer Periodically, at times selected by a calculating means and implemented by control electronics, the circuitry of the encoding means is operated in a calibration mode. During the calibration mode, the signal K₁SINωt is fed to the encoding circuitry instead of the feedback signal from the resolver transducer. This signal, K₁SINωt is the same as the reference signal that is being fed to the encoding circuitry. The measured time interval T between the zero crossings of these two signals is proportional to the inherent phase shift error in the encoding circuitry γ In an ideal situation, the time period representing the phase shift between an input signal of K₁SINωt and a reference signal of K₁SINωt should be Zero. However, in reality, this phase shift may not be zero because of an inherent error within the encoding circuitry due to such things as the electronic drift of component values over time and changes in temperature. If a value for the inherent phase shift error in the encoding circuitry γ other than zero is measured, this value can be utilized by the calculating means to compensate the measurements made during the calibration and normal measurement modes of operation. The duty cycle between the normal measurement cycle measurement of α , the compensation cycle measurement of α only and the calibration cycle measurement of γ only is determined by the calculating means and can be either a strict function of time and or a function of other variables deemed to be appropriate to the application of the resolver encoding system. The general theory for the measurement of the inherent phase shift error in the encoding circuitry γ is the same as for the measurement of the inherent phase shift error across the resolver windings α except that only K₁SINωt is needed as a reference signal and can be used by the encoding means whereas in the meansurement of α, K₁SINωt or K₁SINωt is applied to either the stator sine winding or the stator cosine winding and the rotor feedback signal is used by the encoding means. For a better understanding of the invention, reference may be had to the preferred embodiment exemplary of the invention shown in the accompanying drawings, in which In the preferred embodiement, the invention is used in connection with a rotary resolver position transducer. The mechanical displacement in a rotary resolver position transducer is the mechanical rotor angle representing the angular displacement of the rotor with respect to the stator windings. Referring to FIGURE 1, a rotary resolver transducer 2 is basically an angle transducer and is well known in the art. Generally, a rotary resolver transducer includes a rotor 5 having one or more sets of spaced apart windings and a stator 6 having two or more sets of spaced apart windings. These windings are called a rotor winding 10, and stator windings 20, respectively. Typically the resolver stator sine winding 21 is excited by a reference signal 25 of the form K₁SINωt and the resolver stator cosine winding 22 is excited by a reference signal 26 of the form K₁COSωt. When the stator windings 20 are excited by the above reference signals 25 and 26, the signal 27 on the feedback rotor winding 10 takes the form K₂SIN ωt α where the mechanical displacement is the mechanical rotor angle measuring the position of the rotor 5 with respect to the stator windings 20 and α is the inherent electrical phase shift across the resolver transducer 2. FIGURE 2 shows a typical phase analog encoding system consisting of a resolver transducer 2, as shown in FIGURE 1, a resolver encoding means and a resolver reference means, described hereinafter. A typical resolver encoding means consists of two zero crossing detectors 41 and 42 and a digital counter 43. The input to the first zero crossing detector 41 is from the sine reference signal 25, and the output is connected to the start switch of the digital counter 43. The input to the second zero crossing detector 42 is from the feedback rotor winding 10 and the output is connected to the stop switch of the digital counter 43. The encoding system operates by starting the digital counter 43 when the first zero crossing detector 41 determines that the sine reference signal 25 crosses zero voltage. The digital counter 43 then counts the reference frequency 44 until a zero voltage crossing on the feedback rotor winding 10 is detected by the second zero crossing detector 42. The digital counter 43 is then stopped. The accumulated value 28 in the digital counter 43 is equal to the sum of the mechanical rotor angle and the inherent electrical phase shift of the resolver transducer α . The resolution of the encoding system is determined by the reference frequency 44 which the digital counter 43 counts. The reference frequency 44 is generated by the resolver reference means which also generates the reference signals 25 and 26 which are applied to the resolver stator windings 20. A typical resolver reference means, as shown in FIGURE 2, consists of a reference signal generator 51 and two amplifiers 47 and 48 which are used to increase the strength of the reference signals 25 and 26 before they are applied to the resolver stator windings 20. The reference signal generator 51, as shown in FIGURE 3, consists of an oscillator 52, a divider 53 and a 90⁰ phase shifter 54. The oscillator 52, generates the reference frequency 44 that is counted by the digital counter 43. To generate the reference signals 25 and 26 which are applied to the resolver stator windings 20, the output of the oscillator 52 is divided by a value N in a divider 53. The value of N can be pre set or can be varied by the calculating means. Thus the reference frequency 44 is equal to N times the frequency of the reference signals 25 or 26 applied to the stator windings 20. The larger the value of N, the greater the resolution of the encoding system. The output of divider 53 is fed through amplifier 48 before being applied to the stator sine winding 21. To obtain the reference signal 26 which is applied to the stator cosine winding 22, the output of divider 52 must be fed through a 90⁰ phase shifter 54. This phase shifted reference signal is then amplified by amplifier 47 before being applied to the stator cosine winding 22. The timing diagram for the phase analog encoding system of FIGURE 2 is shown in FIGURE 4. The reference signal 25 to the stator sine winding 21 is depicted by waveform 71. The voltage on the feedback rotor winding 10 is depicted by waveform 74. Waveforms 72 and 75 show the output of the first zero crossing detector 41 and the second zero crossing detector 42, respectively. Waveform 73 is the output 28 of the digital counter 43. When the stator sine reference waveform 71 crosses zero, the first zero crossing detector 41 is activated as indicated by waveform 72 and this starts the digital counter 43 counting. The digital counter 43 continues to count the reference frequency 44 until it receives a signal to stop. When the feedback rotor winding waveform 74 crosses zero, the second zero crossing detector 42 is activated, as indicated by waveform 75 and this sends a stop counting signal to the digital counter 43. The time interval that the digital counter 43 has counted is equal to the sum of the mechanical rotor angle and the inherent electrical phase shift of the resolver transducer α . Typically the digital counter 43 is reset after the phase angle number is read in preparation for the next start stop sequence. The present invention discloses a novel and unique system for compensating for the inherent electrical phase shift error of a resolver position transducer in a time multiplexed fashion. Additionally, the invention has a self calibrating feature. FIGURE 5 shows the overall phase analog encoding system with compensation as described by the invention. The resolver reference means 50 generates reference signals 25 and 26 which are fed to the resolver transducer 2 and reference signal 44 which is used by the digital counter 43 in the resolver encoding means 40. Under normal operation the rotor feedback signal 27 from the resolver transducer 2 is used by the resolver encoding means 40 along with the stator sine reference signal 25 and the reference signal 44 to measure the sum of the mechanical displacement and the inherent electrical phase shift across the resolver α. The calculating means 80, uses the output 28 from the encoding means 40 along with any input control signals 84 to generate the reset signal 81 for the digital counter 43 and the system output signals 83 such as mechanical displacement, mechanical velocity, etc. The calculating means 80 also determines through control signal 82 which reference signals 25 and 26 of the resolver reference means 50 are applied to the resolver transducer 2. Control signal 82 determines whether the entire encoding system is measuring the sum α of the mechanical displacement and the electrical phase shift of the resolver α or just the electrical phase shift of the resolver α. If control signal 82 has the encoding system in the normal measurement mode of operation the output 28 of the resolver encoding means 40 is the sum α of the mechanical displacement and the inherent electrical phase shift of the resolver α. If the control signal 82 has the encoding system in the compensation mode of operation the output 28 of the resolver encoding means 40 is the inherent electrical phase shift of the resolver, α. This measured value of α is then compared with an old value of α by the calculating means 80 and a new value of α is calculated. The new value of α is then used by the calculating means 80 along with the output 28 of the resolver encoding means 40 under the normal measurement mode of operation to obtain a value for the mechanical displacement , which is independent of the inherent electrical phase shift of the resolver α . The calculating means 80, through control signal 119, also determines whether the entire encoding system is operating in the calibration mode or in the other modes of operation, FIGURE 6 shows the invention depicted by the block diagram in FIGURE 5 as applied to a rotary resolver position transducer. The calculating means 80 in the preferred embodiment is a microprocessor unit. However, it does not have to be so limited. It can be any type of computer, arithimetic logic unit, or appropriate control circuitry and software which is capable of processing the output 28 of the resolver encoding means 40 generating a control signal 82 for the resolver reference means which determines whether the encoding system is in the normal measurement mode of operation or in the compensation mode of operation and generating a control signal 119 for the resolver encoding means which determines whether the encoding system is in the calibration mode of operation or in the other modes of operation, The encoding system cannot be in all three modes of operation at once. It can only be in one mode of operation at a time. That is one of the advantages of this invention. It utilizes the same physical measuring circuit in a time sharing fashion to calculate the mechanical displacement , the inherent electrical phase shift of the resolver transducer α , and the inherent phase shift across the circuitry of the encoding means γ. The duty cycle between the measurement cycle measurement of α and the compensation cycle measurement of α only is determined by the software of the microprocessor unit and can be either a strict function of time and or a function of other variables deemed to be appropriate, depending on the specific use of the encoding system. If the duty cycle is a strict function of time, the measurement cycle occurs on the order of 1000 times a second and the compenstaion cycle occurs on the order of once every second. The duty cycle between the combination of the normal measurement cycle measurement of α , the compensation cycle measurement of α only , and the calibration cycle measurement of γ only is determined by the microprocessor and the control circuitry. Reference switch 87, which implements control signal 82, is shown in FIGURE 7. In the normal measurement mode of operation, switch 95 is closed connecting the sine reference signal 25 to the stator sine winding 21 and switch 96 is closed connecting the cosine reference signal 26 to the stator cosine winding 22. In the compensation mode of operation the reference signal K₁SINωt or K₁SINωt is applied to either the stator sine winding 21 or the stator cosine winding 22 depending upon the position of the resolver rotor 5 If the mechanical rotor angle of the resolver is 0 If the mechanical rotor angle of the resolver is 45 If the mechanical rotor angle of the resolver is 135 If the mechanical rotor angle of the resolver is 225 The reason for applying the different reference signal either K₁SINωt or K₁SINωt to either the stator sine winding 21 or the stator cosine winding 22 is to ensure that there is a large signal output on the resolver rotor winding 10 and that the measurement of α will be valid independent of the rotor position . The microprocessor unit determines what the value of is at any given point in time during the normal measurement cycle. This value of is then encoded into a binary number which determines which switch is closed and correspondingly which configuration of reference voltages is applied to the resolver stator windings. The table in FIGURE 7 shows which binary number corresponds to which range of values of and what the reference switch position will be for that binary number. FIGURE 8 shows an example of the control electronics 120 necessary to implement control signal 119. In this case, the control electronics 120 is composed of an electronic switch 121. Control electronics 120 can be more elaborate, although it does not have to be. It can be as simple as a relay that moves electronic switch 121 from pole 125 to 126 when a control signal 119 is received. In the normal, measurement mode of operation, or in the compensation mode of operation, electronic switch 121 is connected to pole 125 such that the feedback signal 27 is inputted into the second zero crossing detector 42 of the resolver encoding means 40. In the calibration mode of operation, the electronic switch 121 is connected to pole 126 such that the sine reference signal 25 is inputted into the second zero crossing detector 42 of the resolver encoding means 40. In the calibration mode, the resolver encoding means measures the electrical phase shift between the signal at pole 126, K₁SINωt, and the reference signal, K₁SINωt, inputted into the first zero crossing detector 41. If the resolver encoding means is working perfectly, the output 28 of the resolver encoding means 40 will be zero since there is no phase shift between two signals of the form K₁SINωt. If, however, the output 28 of the resolver encoding means 40 is a value other than zero, this value can be utliized by the calculating means 80 to compensate for this measured phase shift error when the encoding system is operating in the normal, measurement mode of operation or the compensation mode of operation. Calculating means 80 sends a control signal 119 to the control electronics 120 to determine whether the entire encoding system is operating in the calibration mode or in the other modes of operation,