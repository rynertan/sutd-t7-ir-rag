# AUTOMATIC GAIN AND FREQUENCY CHARACTERISTIC CONTROL UNIT IN AUDIO DEVICE

## Claims
Ein Audioverstärker mit einer automatischen Verstärkungs und Frequenzsteuereinheit, welche

## Description
The present invention relates to an automatic gain and frequency characteristic control unit in an audio device which automatically controls the amplification gain and frequency characteristic according to the level of external noise. In an automobile, sound such as music outputted by an audio device is often masked by the ambient noise. In order to prevent such masking, an automatic gain control unit is available which can automatically control the amplification gain according to the level of the noise. A conventional automatic gain control unit, as shown in Fig. 1, includes a noise detecting section 1 1 and a gain varying circuit 1 2. In the noise detecting section 1 1, external noise is picked up by a microphone 1 3, and the output signal of the microphone 1 3 is supplied through a microphone amplifier 1 4 to an LPF low pass filter 1 5 which extracts only the noise band component. The output signal of the LPF 1 5 is rectified by a diode 1 6 and smoothed by a smoothing circuit 1 7, the output of which is supplied to a logarithmic compression circuit 1 8. The output signal of the logarithmic compression circuit 1 8 is supplied, as a gain control signal from the noise detecting section 1 1, to the gain varying circuit 1 2. The gain varying circuit 1 2 is implemented with an electronic volume control circuit, for instance. The gain varying circuit 1 2 is inserted in a signal line which transmits an audio signal from a tape deck or tuner to a power amplifier to thereby vary the amplification gain of the audio signal according to the output signal level of the logarithmic compression circuit 1 8. Accordingly, as the external noise level increases, the amplification gain of the audio signal is increased, and the acoustic level of the sound reproduced by the audio device is also increased. In the case where the conventional automatic gain control unit is applied to an audio device mounted on a vehicle, as the noise level increases linearly as indicated by the solid line In the conventional automatic gain control unit, gain control is carried out according to the noise level only, that is, it is performed independently of the audio signal level or dynamic range. In the case where the audio signal has a narrow dynamic range, the masking correction effect is sufficiently high. However, for music such as a symphony which has a wide dynamic range, the reproduced sound of the low level part of the audio signal is masked by noise as indicated by an arrow c in Fig. 2. If the gain is increased in such a manner that the reproduced sound of the low level part of the audio signal is not masked by the noise, then the high level part of the audio signal becomes excessively large in volume. In order to overcome this difficulty, an automatic gain control unit has been proposed which, as shown in Fig. 3, includes a noise detecting section 1 1, a gain varying circuit 1 2, a signal detecting section 1 9 and an arithmetic circuit 1 10. The noise detecting section 1 1 and the gain varying circuit 1 2 are the same as those in Fig. 1. In the signal detecting section 1 9, an audio signal supplied to the gain varying circuit 1 2 is rectified by a diode 1 11 and smoothed by a smoothing circuit 1 12, and the rectified voltage is subjected to a logarithmic compression by a logarithmic compression circuit 1 13 to provide a signal detection output. The arithmetic circuit 1 10 is composed of a multiplier 1 14 with which the output voltage of the signal detecting section 1 9 is multiplied by a voltage Vα corresponding to a negative constant α , an adder 1 15 for adding a voltage Vβ corresponding to a positive constant β to the output voltage of the multiplier 1 14, and a multiplier for obtaining the product of the output voltage of the adder 1 15 and the output voltage of the noise detecting section 1 1. The output of the multiplier 1 16 is supplied as a gain control signal to the gain varying circuit 1 2. The constant α determines the increment in compression degree of an audio signal level with respect to an increment of a noise level for instance 0.04 α 0. The constant β determines an increment in gain of an audio signal reference level with respect to an increment of a noise level for instance, 0 β 1. If it is assumed that, in the conventional automatic gain control unit thus constructed, a noise level increment with respect to a reference noise level, which is provided by the noise detecting section 1 1, is represented by N, and an audio signal level increment with respect to a reference signal level, which is provided by the signal detecting section, is represented by S, then the output voltage of the arithmetic circuit 1 10 is proportional to In the case where the above described automatic gain control unit is applied to an audio device mounted on a vehicle, as the travel noise increases as indicated by the solid line However, the conventional automatic gain control unit suffers from the problem that the reproduced sound may not always be satisfactory in hearing sensation. Further, the invention relates to amplifier devices, and more particularly to an amplifier device in which the gain and the frequency characteristic can be changed simultaneously. A conventional device of this type, as shown in Fig. 5, includes an electronic volume control circuit 2 1 which can vary a gain according to a control signal I, and an electronic tone control 2 2 which can increase or decrease the bass or treble frequencies in response to a control signal II. In the conventional amplifier device, when a signal is applied to an input terminal 2 3, the gain can be changed by the electronic volume control 2 1, and then the bass or treble frequencies can be adjusted by the electronic tone control 2 2. The conventional amplifier device is disadvantageous in that the circuit is intricate because the device requires both the gain controlling electronic volume and the bass and treble adjusting electronic tone control, and because the device must be provided with two control signal systems. In JP A 5650607 it is disclosed that the noise component is obtained by a difference between ambient noise which includes sound produced by an audio system and sound level signal SP to produce a control signal, the sound level being controlled in response to the control signal and the sound quality, i.e. the frequency characteristic, being adjusted in order to achieve loudness control in response to variation in the sound level. Thus the sound quality control is carried out independently from the variation in the noise level. As the sound level increases listening sensitivity also increases in low or high frequency ranges as a result of which compensation is reduced by loudness control. Still further, the invention relates to an automatic sound volume and frequency characteristic adjusting device which adjusts the sound volume and frequency characteristic of an audio device automatically according to the level of ambient noise around the audio device. More particularly, the invention relates to a noise correcting device which, according to the noise level in a vehicle, adjusts the sound volume and the sound frequency characteristic. An object of this invention is to provide an automatic gain control unit which prevents sound masking caused by noise and which allows for the reproduction of sound which is satisfactory to a listener. In accordance with the above and other objects, the invention provides an audio amplifier having an automatic gain and frequency control unit comprising audio signal level detecting means for detecting the level of an input audio signal and producing a corresponding audio level signal noise level detecting means for providing a noise level signal according to the level of ambient noise subtracting means for detecting a level difference between the noise level signal and the audio level signal characterised by frequency gain characteristic varying means for selectively adjusting the gain of different frequency components in the input audio signal according to an output signal of the subtracting means and outputting an adjusted audio signal. The invention provides a simple amplifier device which can change the gain and the frequency characteristic simultaneously. Still another object of the invention is to provide a noise correcting device capable of preventing an occurrence of abrupt variation in the reproduction level of sound, which may be caused by an application of a pulsive signal representing sounds produced by a percussion instrument for instance In the drawings A first embodiment of the present invention will be described with reference to Fig. 6A. In Fig. 6A, an audio signal outputted by an audio device such as a tape deck or a tuner is supplied to a frequency characteristic varying circuit 3 1 and a level detecting circuit 3 2. The level detecting circuit 3 2 provides an audio level signal which is a DC level corresponding to the level of the audio signal applied thereto. The audio level signal is applied to the negative input terminal of a subtractor. The output of microphone 3 4 which picks up the noise in the vehicle is applied to a noise level detecting circuit 3 5. The noise level detecting circuit 3 5 provides a noise level signal which is a DC level proportional to the average value or effective value of the amplitude of the ambient noise. The noise level signal thus provided is applied to the positive input terminal of the subtractor 3 3. The subtractor 3 3 supplies an error signal to an A D converter 3 6 indicative of the levels of the audio level signal and the noise level signal. The A D converter 3 6 converts the error signal into a digital signal, which is applied as a control signal to the frequency characteristic varying circuit 3 1. In response to the control signal, the frequency characteristic varying circuit 3 1 changes the levels of predetermined frequency components of the audio signal. The audio signal thus treated is applied as an audio signal output to the following stage where, for instance, a power amplifier not shown is provided to drive a loudspeaker. An example of the level detecting circuit 3 2 is as shown in Fig. 6B. In this figure, an audio signal is applied through an input terminal 11 and an input resistor 3 12 to the negative input terminal of a differential amplifier 3 13, the positive input terminal of which is grounded. The output terminal of the differential amplifier 3 13 is connected to the anode of a detecting diode 3 14 and the cathode of a detecting diode 3 15. The cathode of the diode 3 14 is connected to first terminals of resistors 3 16 and 3 17. The other terminal of the resistor 3 16 is connected to the negative input terminal of the differential amplifier 3 13. The other terminal of the resistor 3 17 is connected to one terminal of a capacitor 3 18 and an audio level signal output terminal 3 19. The other terminal of the capacitor 3 18 is grounded. The anode of the diode 3 15 is connected through a resistor 3 20 to the negative input terminal of the differential amplifiers 3 13. A second audio signal input terminal 3 21 is connected through a resistor 3 22 to the negative input terminal of the differential amplifier 3 13. The diodes 3 14 and 3 15 also have the same characteristics. In the circuit shown in Fig. 6B, the resistors 3 12, 3 16 and 3 20 determine the gain of the differential amplifier 3 13, tree diodes 3 14 and 3 15 detect the output of the differential amplifier 3 13, and the resistor 3 17 and the capacitor 3 18 are used to smooth the detection output. In the case when the second audio signal is supplied, the gain of the differential amplifier 3 13 is determined by the resistors 3 22, 3 16 and 3 20. The response characteristic in a predetermined frequency range of the level detecting circuit is as indicated by the characteristic curve The operation of the travel noise correcting device thus organized will be described. The noise in the vehicle is converted into an electrical signal by the microphone 3 4. The electrical signal is amplified by the noise level detecting circuit 3 5. The signal thus amplified is detected into a noise level signal proportional to the volume of the noise. The noise level signal is applied to the subtractor 3 3. The subtractor 3 3 outputs the error signal according to the noise level signal. The error signal is converted into a digital signal which is applied, as a control signal, to the frequency characteristic varying circuit 3 1. The frequency versus response characteristic of the circuit 3 1 is changed according to the control signal as shown in Fig. 8. For instance, as the value of the control signals increases to a₁, a₂, a₃, ..... and a On the other hand, if, when the supplied audio signal is relatively high in level, the above described operation were to be carried out, the sound volume would be excessively large or the output clipped by a protective circuit. Therefore, the subtractor 3 3 is provided with a function of increasing its output, namely, an error signal value, according to the noise level signal b₁, b₂, ...and b Thus, the listener can satisfactorily hear music or the like in the vehicle. A second embodiment of the invention will be describedwith reference to Figs. 10 and 11. In Fig. 10, those components which have been previously described with reference to Fig. 1 are designated by the same reference numerals. The noise detecting section 1 1 and a signal detecting section are connected to level converters 1 19 and 1 20, respectively. The level converter 1 19 outputs a voltage 0.3 times as high as the output voltage of the noise detecting section, while the level converter 1 20 outputs a voltage 0.4 times as high as the output voltage of the signal detecting section 1 9. The level converters 1 19 and 1 20 are connected to a subtractor 1 21 with which the output voltages of the level converters 1 19 and 1 20 are subjected to subtraction. The output terminal of the subtractor 1 21 is connected through an A D analog to digital converter 1 22 to a decoder driver 1 23. The decoder driver 1 23 has a plurality of output terminals which are connected to respective light emitting diodes 1 24. The decoder driver 1 23 converts a BCD binary coded decimal code digital signal into a decimal code digital signal, the number of bits of which is equal to the number of the output terminals, and, according to the conversion result, drives the light emitting diode 1 24 corresponding to the bit number. The output terminals of the decoder driver 1 23 are connected through a switch circuit 1 25 to a characteristic varying circuit 1 26. The switch circuit 1 25 is composed of a plurality of transistors not shown which are turned on and off according to an output level of the decoder driver 1 23. The frequency characteristic of the characteristic varying circuit 1 26 is changed according to the on off operations of the transistors. The characteristic varying circuit 1 26 is inserted in the audio signal line of an audio device. The frequency characteristic is changed, for instance, by varying the constants of the gain varying circuit 1 2 shown in Fig. 1 or 3. In the inventive automatic gain control unit thus constructed, a voltage V According to the output of the decoder driver 1 23, the transistors in the switch circuit 1 25 are turned on and off, thus determining the frequency characteristic of the characteristic varying circuit 1 26. When the audio signal level becomes higher than the reference voltage and the output voltage of the subtractor 1 21 becomes lower than a predetermined voltage, the gain established by the characteristic varying circuit 1 26 is a minimum and the frequency characteristic is flat, as indicated by the solid line In the noise detecting circuit 1 1, a time constant circuit is provided in the rear stage of the logarithmic compression circuit so that the signal rises slower than it falls. Furthermore, in the signal detecting section 1 9, the smoothing circuit is designed so that the signal rises faster than it falls. This is due to the fact that, if the audio signal level were to increase quickly and decrease gradually, reproduced sound is satisfactory in hearing sensation. As is apparent from the above description, in the automatic gain control unit of the invention, not only the gain but also the reproduction frequency characteristic is changed according to the ambient noise level and the audio signal level, which prevents the difficulty that the reproduced sound is masked by the ambient noise and improves the acoustic sensation of the reproduced sound. In other words, when the audio signal is relatively strong, a natural sensation in hearing the reproduced sounds is attained, and when the noise level increases, the audio signal is emphasized, for instance, in the low frequency range and in the high frequency range. Therefore, the reproduced sound is made distinct from the ambient noise. In the conventional automatic gain control unit shown in Fig. 3, depending on the value of the constant α , when the noise level increases, sometimes the relation between the high and low levels of the audio signal is inverted and the high level audio signal gain becomes less than 0 dB. However, this difficulty is prevented according to the invention. Fig. 12 is a circuit diagram showing an example of the characteristic varying circuit 1 26 shown in Fig. 10. This amplifier device includes an operational amplifier 2 5, the output terminal of which is connected through an impedance circuit Z₁ to its inverting input terminal 2 6. An impedance circuit Z₂ is connected between the inverting input terminal 2 6 and a reference potential, namely, ground potential. The noninverting input terminal 2 8 of the operational amplifier is used as the input terminal of the amplifier device. In this embodiment, the impedance of the impedance circuit Z₂ is changed to simultaneously change the gain and the frequency characteristic. Fig. 13 shows the circuit of the amplifier device in Fig. 12 in more detail. The impedance circuit Z₁ has a time constant circuit A₁ having a time constant τ₁ connected between the inverting input terminal 2 6 and the output terminal 2 7 of the operational amplifier 2 5. The time constant circuit A₁ is made up of a series circuit of a resistor R₁ and a capacitor C₁. A time constant circuit A₂ having a time constant τ₂ is connected between the terminals of the resistor R₁ and the capacitor C₁ in the time constant circuit A₁. Similarly as in the time constant circuit A₁, the time constant circuit A₂ is a series circuit of a resistor R₂ and a capacitor C₂. In the same manner, time constant circuits A₃, A₄, ..... and A Further, the impedance circuit Z₂ is composed of a series circuit of time constant circuits B₁, B₂, ... and B The connecting points of the time constant circuits B₁, B₂, ..... and B The operation of the amplifier device thus constructed will be described. First, a characteristic imparted by the impedance circuit Z₁ will be described. The characteristic in the low frequency range lower than 2 to 3 KHz is determined by the impedance circuit Z₁. It is assumed that the impedance circuit Z₁ is made up of the time constant circuits A₁, A₂ and A₃ only, and that the impedance circuit Z₂ is made up of the resistor R₀ only, as shown in Fig. 14. The time constant circuits A₁, A₂ and A₃ have the time constants τ₁, τ₂ and τ₃, respectively. These time constants relate to the gain and the frequency characteristic as shown in Fig. 15. In the frequency range lower than 100 Hz, the characteristic is raised at a rate of 6 dB octave. In the frequency range of 100 Hz to 1 KHz, two time constants τ₂ and τ₃ exist, and therefore the characteristic is of 2 to 3 dB octave as indicated by the broken line in Fig.15 . If, in the circuit of Fig. 14, the resistor R₀ has a considerably small resistance value and the gain is sufficiently high, in the frequency range lower than 100 Hz, a characteristic of 6 dB octave is obtained that is, the characteristic curve becomes ideal as a whole. If the resistance of the resistor R₀ is increased and the gain is decreased as a whole, then the characteristic curve in the frequency range lower than 1 KHz has a small inclination that is, the characteristic curve is made gradually flat. The characteristic imparted by the impedance circuit Z₂ will be described. When the transistor Q₁ is rendered conductive, the circuit of the amplifier device becomes equivalent to that shown in Fig. 16. If the time constant determined by the resistor R₁ and the capacitor C₁ in the time constant circuit B₁ is represented by τ When the transistor Q₂ is rendered conductive, the impedance circuit Z₂ becomes equal to that which is indicated in Fig. 18A. Fig. 18B shows a circuit which is equivalent to the circuit shown in Fig. 18A. The equivalent circuit is made up of a series circuit of a resistor R₁₂ and a capacitor C₁₂ , and the resistor R₁₂ connected in parallel with the series circuit. If the time constant determined by the resistor R₁₂ and the capacitor C₁₂ in the equivalent circuit is represented by τ The effects of the impedance circuits Z₁ and Z₂ on the characteristic have been described. Fig. 19 shows variations in the gain and frequency characteristics of the amplifier device. When the transistor Q₁ is rendered conductive by the drive circuit 2 9, the amplifier device is then formed of the operational amplifier 2 5, the time constant circuit A₁ through A When the transistor Q₁ is turned off and the transistor Q₂ is turned on, the amplifier device is formed of the operational amplifier 2 5, the time constant circuits A₁, A₂, ..... and A When the transistors Q₁ and Q₂ are rendered nonconductive while the transistor Q₃ is rendered conductive, the gain in the middle frequency range is further decreased, and the gain frequency characteristic is gradually made flat. When all the transistors Q₁ through Q As is apparent from the above description, in this embodiment of the invention, the gain and the frequency characteristic can be simultaneously changed by controlling the on off operations of the transistors Q₁ through Q In the embodiment of the invention shown in Fig. 13, the time constant circuits A₁ through A In the above described embodiments of the invention, the transistors are connected to the time constant circuits B₁ through B According to the invention, the first impedance circuit including the time constant circuits is connected between the inverting input terminal and the output terminal of the operational amplifier, and the second impedance circuit including the series connected time constant circuits is connected to the inverting input circuit. The connecting points of the time constant circuits in the second impedance circuit are connected through the switching elements to the reference potential. By controlling the on off operations of these switching elements, the time constant is changed while the resistance in the D.C. mode is changed. Therefore, the gain and the frequency characteristic can be changed. In an embodiment of the invention shown in Fig. 21, the level detecting circuit 3 2 in the device shown in Fig. 6A is modified as shown in the drawing. The level detecting circuit according to the invention will be described with reference to Fig. 21. In Fig. 21, circuit elements corresponding functionally to those described with reference to Fig. 6B are designated by corresponding reference numerals. Only circuit elements different from those in Fig. 6B will be described. A high pass capacitor 3 25 is connected between the signal input terminal 3 11 and the input resistor 3 12. Similarly, a high pass capacitor 26 is connected between the signal input terminal 3 21 and the input resistor 3 22. The high pass capacitors 3 25 and 3 26 attenuate the low frequency component of the audio signal. Capacitors 3 27 and 3 28 are connected in parallel with the resistors 3 16 and 3 20, respectively. The capacitors are used to attenuate the high frequency component of the audio signal. The capacitors 3 27 and 3 28 have equal characteristics. The remaining arrangement of the circuit is the same as that of the circuit of Fig. 6B. The level detecting circuit will be further described with reference to Fig. 22. The frequency versus response characteristic of the above described circuit according to the invention is indicated as a characteristic curve Fig. 23 shows a level detecting circuit of another embodiment of the invention. In this embodiment the frequency versus response characteristic is substantially in correspondence to that of an electrical filtering network used in a so called A weighted sound level meter. The circuit in Fig. 23 is different that in Fig. 21 in that a high pass capacitor 3 29 is connected between the audio signal input terminal 11 and the high pass capacitor 3 25 and the connecting point of the high pass capacitors 3 25 and 3 29 is grounded through a resistor 3 30. The other arrangement is the same as that of Fig. 21. That is, the high pass filter is employed as a secondary device and the low pass filter is employed as a primary device to obtain an A weighted characteristic curve The frequency versus response characteristic of the level detecting circuit 3 2 is described above. With this characteristic, the low frequency component and the high frequency component of the supplied audio signal are sufficiently attenuated so that only the frequency range in which the audio signal can be satisfactorily heard is converted into the audio level signal which is supplied to the subtractor 3 3. The subtractor 3 3 and the circuit elements following the subtractor are equal in arrangement to those in the conventional device, and accordingly operate in the same manner to adjust the sound volume and sound frequency characteristic. Effects similar to those described above maybe obtained by employing a high pass filter instead of the above described bandpass filter. As is apparent from the above description, in the travel noise correcting device according to the invention, a filter circuit whose characteristic is substantially equal to the characteristic of an A weighted filter widely used in a sound level meter, is provided in the level detecting circuit 3 2. Therefore, even when the supplied audio signal includes a large number of components in the lower frequency range or in the higher frequency range, or when such a pulsive signal as that representing a drum sound or a cymbal sound, which is high as an electric signal but not strong as hearing perception, occurs in the applied audio signal, the sound volume and sound frequency characteristic are always kept in a natural condition.