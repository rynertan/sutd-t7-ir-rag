# MASTER SLAVE TYPE FLIP FLOP CIRCUIT

## Claims
1. Mutter Tochter Flipflopschaltung, die eine normale Funktion in einem normalen Modus durch ein Taktsignal für den Flipflop Betrieb und eine Abtastfunktion in einem Abtastmodus durch einen Abtasttakt zum Testen einer integrierten Schaltung enthält, mit

## Description
The present invention is related to a flip flop circuit. More particularly, it is related to a master slave type flip flop circuit having a scanning function which is used in a test of an integrated circuit IC after manufacture. The master slave type flip flop circuit below master slave FF is constituted by two flip flop circuits, i.e., a master flip flop master stage and a slave flip flop slave stage . The master stage and the slave stage circuits have a similar arrangement and are activated by the leading edge and trailing edge of clock signals. For instance, US patent N 4 289 979 discloses a master slave flip flop configured with two pairs of differential transistors, respectively for taking in data and latching data, for both the slave and master stages. Accordingly, the flip flop operations using these two FF circuits are more accurate in comparison with one flip flop type. Consequently, many master slave FF s are provided as internal circuits of an IC together with many gate circuits. Circuits having a scanning function are used for testing the internal circuits of the IC, and each of these scanning function circuits is added to each of the master slave FF s. Accordingly, the performance test of the IC is achieved by testing the master slave FF through the scanning function. Conventionally, the scanning function circuit arrangement is provided at an external portion of each master slave FF arrangement, but this external circuit has the following problems, i.e., the circuit arrangement is complicated, power consumption is large, and the operation speed is slow. The primary object of the present invention is to provide a master slave type flip flop circuit having a scanning function which is used in a test of an integrated circuit after manufacture. Another object of the present invention is to provide a master slave type flip flop circuit having ia scanning function and enabling a simplified circuit arrangement for testing, a reduced power consumption, and a high speed operation. In accordance with the present invention, there is provided a master slave type flip flop circuit including a normal function in a normal mode for flip flop operation and a scanning function in a scanning mode for testing an integrated circuit, comprising a master stage having a first pair of differential transistors for taking in data, and a second pair of differential transistors for latching the data taken in to the first pair of differential transistors, and a slave stage having a first pair of differential transistors for taking in data from the master stage, and a second pair of differential transistors for latching the data taken in to the first pair of differential transistors, the master slave type flip flop circuit being characterized in that the master stage further comprises a third pair of differential transistors for taking in scanning data, and a fourth pair of differential transistors for activating the second and third pair of differential transistors in the scanning mode and the slave stage further comprises a third pair of differential transistors for latching scanning data, and a fourth pair of differential transistors for activating the first and third pair of differential transistors in the scanning mode. In the drawings Before describing the preferred embodiments, an explanation will be given of a conventional master slave type flip flop circuit having an external circuit for a scanning function. Referring to Fig. 1, 1 represents a master slave type flip flop circuit master slave FF , 2 and 3 OR gates, 4 and 5 AND gates, and 6 an inverter. The circuit for a scanning function is constituted by two OR gates 2 and 3, two AND gates 4 and 5, and the inverter 6. These circuits are provided at an external portion of the master slave FF 1. Accordingly, the master slave FF itself does not have such a scanning function. Refer ence C represents a clock signal, SC a scanning clock signal, D a data signal, SD a scanning data signal, and M a mode switching signal. Signals C and D are used in the normal mode, and SC and SD are used in the scanning mode. The scanning mode is used for the test of the internal circuit of the IC. These modes are switched in correspondence with the mode switching signal M. That is, when the signal M is high H level, the normal mode is selected, and when the signal M is low L level, the scanning mode is selected. An output signal Q and an inverted output signal NQ are obtained in the normal mode and a scanning output SO is obtained in the scanning mode. In the normal mode, the mode signal M is H level so that the output of the AND gate 4 is changed to the L or H level in correspondence with the L or H level of the data D. Here, the output of the inverter 6 is L level and the scanning data SD is set to the H or L level, and accordingly, the output of the AND gate 5 is set to the L level. Consequently, the output of the OR gate 2 is changed to the H or L level in correspondence with the H or L level of the data. Moreover, when the scanning clock SC is set to the L level, the output of the OR gate 3 is changed to the H or L level of the clock signal C. In the scanning mode, the mode signal M is L level so that the output of the AND gate 4 is L level. Here, the output of the inverter 6 is H level so that the output of the AND gate 5 is changed to the H or L level in correspondence with the H or L level of the scanning data SD. Accordingly, the output of the OR gate 2 is changed to the H or L level in correspondence with the H or L level of the scanning data SD. Moreover, when the clock signal C is set to the L level, the output of the OR gate 3 is changed to the H or L level in correspondence with the H or L level of the scanning clock SC. The scanning data SD is output from the OR gate 2 and input to the D terminal in the master slave FF 1. Here, the scanning clock signal SC is output from the OR gate 3 and input to the C terminal in the master slave FF 1. Based on the scanning clock SC and the scanning data SD the scanning out SO is obtained from the master slave FF 1 in accordance with the same operation as that for the clock signal C and the data D. Referring to Fig. 2, the master stage is shown on the left and the slave stage on the right of the figure. Accordingly, the master slave FF is constituted by the master stage and the slave stage. These stages are also constituted by a plurality of emitter coupled differ ential circuits. That is, pairs of transistors Q₁₁ and Q₁₂, Q₁₃ and Q₁₄, Q₁₅ and Q₁₆, Q₂₁ and Q₂₂, Q₂₃ and Q₂₄, and Q₂₅ and Q₂₆ constitute the differential circuits. V The operation of this circuit arrangement will be explained with reference to Fig. 3. In the normal mode, when the clock signal C is H level, the base potential of the transistor Q₁₁ becomes H level and the transistor Q₁₁ is turned ON, since this base potential is higher than the reference voltage V When the clock signal C is L level, the transistor Q₁₁ is turned OFF and the transistor Q₁₂ is turned ON. Accordingly, a pair of transistors Q₁₅ and Q₁₆ is activated and the data is taken in to the transistor Q₁₆. When the data potential is higher than the reference potential V The slave stage has the same circuit arrangement as that of the master stage. That is, a pair of differ ential transistors Q₂₅ and Q₂₆ corresponds to a pair of transistor Q₁₅ and Q₁₆, a pair of differential transistors Q₂₃ and Q₂₄ corresponds to a pair of transistors Q₁₃ and Q₁₄, a pair of differential transistors Q₂₁ and Q₂₂ corresponds to a pair of transistors Q₁₁ and Q₁₂, and a pair of emitter follower transistors Q₂₇ and Q₂₈ corresponds to a pair of differential transistors Q₁₇ and Q₁₈. Moreover, output emitter follower transistors Q₃₀, Q₃₁ and Q₃₂ output theinverted data NQ, the data Q, and the scanning output data SO. When the clock signal C is L level, the transistor Q₂₂ is turned OFF and the transistor Q₂₁ is turned ON. Accordingly, the transistors Q₂₃ and Q₂₄ are activated and the transistors Q₂₅ and Q₂₆ are not activated. In this state, the transistors Q₂₃ and Q₂₄ function as a latch circuit for latching outputs of the transistors Q₂₅ and Q₂₆. The data of the slave FF is held in the previous state. When the clock signal C is H level, the transistor Q₂₂ is turned ON. Accordingly, either the transistor Q₂₅ or transistor Q₂₆ is turned ON in response to the output of the transistor Q₁₇ or transistor Q₁₈. The H level and L level signals are output from each collector of the transistors Q₂₅ and Q₂₆. As shown in Fig. 3, these output signals Q and NQ are taken out from each emitter of the transistors Q₃₁ and Q₃₀. Accordingly, as explained above, in this master slave FF, when the clock signal C is L level, the data is taken in to the master stage and the output is latched in the slave stage. On the contrary, when the clock signal C is H level, the output is latched in the master stage and the latched data is transmitted to the slave stage and the data output from the emitters of the transistors Q and NQ. These flip flop operations are repeated in correspondence with the H and L level of the clock signal. There are, however, some problems in the above explained conventional circuit arrangement. That is, it is necessary to provide external circuits, i.e., two AND gates, two OR gates, and an inverter, to obtain the scanning function. These circuits are provided at the master slave FF as additional external circuits. Accordingly, because of these external circuits, the circuit arrangement becomes complicated, power con sumption becomes large, and the operation speed becomes slow, because the signal must pass through many stages to be input to the master slave FF. A master slave type flip flop circuit having a normal function in a normal mode and a scanning function in a scanning mode will be explained in detail herein after. Referring to Fig. 4, the same reference numbers as shown in Fig. 2 are attached to the same circuit elements. In this embodiment, transistors Q₄₀ to Q₄₄ and a diode Q₄₅ are added to the master stage, and tran sistors Q₅₁ to Q₅₅ are added to the slave stage. V In the slave stage, a pair of transistors Q₅₃ and Q₅₄ corresponds to a pair of transistors Q₂₃ and Q₂₄. These transistors Q₅₃ and Q₅₄ are used for latching in the scanning mode. A pair of transistors Q₂₅ and Q₂₆ is used for taking in the data and is used in common between a pair of transistors Q₅₃, Q₅₄ and a pair of transistors Q₂₃, Q₂₄, i.e., in common to the normal mode and scanning mode. R₃, R₄, R As is obvious from the above explanations, the transistors Q₄₀ and Q₄₄ and the diode Q₄₅ in the master stage and the transistors Q₅₁ to Q₅₅ in the slave stage are provided as a scanning function. Accordingly, it is not necessary to provide the external scanning function circuits 1 to 6 shown in Fig. 1. Moreover, it is not necessary to provide the mode switching signal M. The operation of this circuit will be explained in detail with reference to Fig. 5 and 6. The master slave FF is activated by L levels of the clock signal C in the normal mode, and by the scanning clock signal SC in the scanning mode, and is operated at the leading edge indicated by an arrow from the L level to H level. These clock signals C and SC are H level during a non operation. That is, as shown in Figs. 5 and 6, the states are shown in which the scanning signal SC is H level in the normal mode and the clock signal C is H level in the scanning mode. Accordingly, in the normal mode, the scanning clock SC is H level, and thus the transistor Q₄₁ is turned ON and the transistor Q₄₂ is turned OFF. Accordingly, the transistors Q₄₃ and Q₄₄ are not activated. Also, the transistor Q₅₁ is turned ON and the transistor Q₅₂ is turned OFF, so that the transistors Q₅₃ and Q₅₄ are not activated. Consequently, in this state, this master slave FF is operated in the normal mode. In the scanning mode, the clock signal C is H level. When the scanning clock signal SC is L level, the transistor Q₄₂ is turned ON and the tran sistors Q₄₃ and Q₄₄ are activated. Accordingly, the scanning data SD is taken in the transistor Q₄₃. When the scanning data SD is the H level, the transistor Q₄₃ is turned ON, and when SD is L level, the tran sistor Q₄₄ is turned ON. In the slave side, the transistor Q₅₂ is turned ON and the transistors Q₅₃ and Q₅₄ are activated. Accordingly, the output scanning data is latched by these transistors Q₅₃ and Q₅₄. When the scanning clock signal is H level, the transistor Q₄₁ is turned ON so that the tran sistors Q₁₃ and Q₁₄ are activated. Accordingly, the output of the transistors Q₄₃ and Q₄₄ is latched to the transistors Q₁₃ and Q₁₄ through the output emitter follower transistors Q₁₇ and Q₁₈. In the slave stage, the transistor Q₅₁ is turned ON and the transistors Q₂₅ and Q₂₆ are activated. Accordingly, the output of the transistors Q₄₃ and Q₄₄ is taken in to the transistors Q₂₅ and Q₂₆ through the output emitter follower tran sistors Q₁₇ and Q₁₈. This data is output from an output of the transistor Q₅₅ as the scanning output SO. As explained above, this data is latched to the tran sistors Q₅₃ and Q₅₄ through the emitter follower transistors Q₂₇ and Q₂₈ when the scanning clock SC is L level. Briefly, when the scanning clock SC is L level, the scanning data SD is taken in to the master stage and the output is latched in the slave mode. When the scanning clock SC is H level, the output is latched in the master stage, and the scanning data SD is taken in to the slave stage and is output from the slave stage. In this master slave FF, three pairs of differential transistors are provided in the form of three steps, for example, a first step having a pair of transistors Q₄₁ and Q₄₂, second step having a pair of transistors Q₁₁ and Q₁₂, and third step having a pair of transistors Q₁₅ and Q₁₆. In this case, the earth potential V