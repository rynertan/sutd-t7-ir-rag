# RADIATION IMAGE PROCESSING APPARATUS AND METHOD

## Claims
Bildbearbeitungsverfahren zum Abtasten eines Informationsspeichers zum Erhalten eines elektrischen Bildsignals aus diesem Speicher sowie zum Umsetzen des elektrischen Bildsignals in ein sichtbares Bild, wobei dieses Bildbearbeitungsverfahren die Schritte des Umsetzens des elektrischen Bildsignals in eine Anzahl von Digitalsignalen Dorg für jeweilige Bildelemente des genannten Bildes entsprechend Abtastpunkten und des Erhaltens eines Niederfrequenzsignals Dus für jedes Bildelement aus einer Gruppe der Digitalsignale innerhalb einer Maske einer vorgegebenen Abmessung, und des Leitens einer Operation von Dorg β Dorg Dus unter Benutzung eines Frequenzhervorhebungskoeffizienten β umfaßt,

## Description
This invention relates to an image processing method and apparatus therefor, and more particularly to a method of and apparatus for conducting an unsharp masking process on an image on a radiographic film hereinafter referred to as X ray image to improve the diagnostic accuracy when the X ray image is duplicated, and further to a method of and apparatus for frequency processing an image in a system for recording and reproducing a radiation image by use of stimulable phosphor sheet. Such an image processing method is known from the American patent number 4,317,179. In this patent, a method is disclosed in which the super low frequency component in an X ray image is emphasized in order to obtain an image of high quality which is better acceptable to visual sense and in which the high frequency component containing a large amount of noise is comparatively decreased. In this method, an original X ray image is scanned and converted to an electric signal and the electric signal is subjected to an image processing operation in which an unsharp masking operation of However, in this method there have been discovered some drawbacks as follows. By emphasizing the particular frequency component, edges or objects in the reproduced image are emphasized, regardless of the size of the objects. Therefore, in those parts of the image where a smaller object of interest is depicted together with a greater structured object, the enhanced edges of the greater object obscure the diagnostic details of the smaller object. Further, even in the area other than the one in which the images of a larger and a smaller object are overlapping, ghost images appear at the edges of the object in the reproduced image by overshooting or undershooting, which will of course affect the diagnosis. The above mentioned drawbacks inherent in said prior art will now be described in more detail with reference to the drawings, particularly to Figures 1A to 1D in case of an example of one dimension. In Figures 1A to 1D, the abscissa represents time position and the coordinate represents the level of the signal. According to said formula, the unsharp mask density Dus as shown in Figure 1B is subtracted from the original density Dorg as shown in Figure 1A to obtain Dorg Dus, which is multiplied by β to obtain β Dorg Dus as shown in Figure 1C, and this is added to the original density Dorg to obtain an image signal having emphasized edges with overshoot A or undershoot B as shown in Figure 1D. In this prior art method, there is an advantage that the contrast of an object is enhanced when the size of the unsharp mask is larger than the size of the object, but the edges are also emphasized undesirably. Further, since the emphasis of the edges occurs regardless of the size of the object but depends upon the gradient of the edge of the object, the edges of bones or the heart are emphasized though these structures have large size because these have steep edges. The emphasized edges having overshoot or undershoot appear as a ghost image and deteriorates the diagnostic accuracy and image quality. In view of the above mentioned drawbacks inherent in the prior art radiographic system, the principal object of the present invention is to provide a method of image processing an X ray image or a radiation image in which the frequency emphasis is conducted without making a ghost image caused by overshoot or undershoot. Another object of the present invention is to provide an apparatus for image processing an X ray image or radiation image by emphasizing a particular frequency component without making a ghost image caused by overshoot or undershoot. The method and apparatus for carrying out the frequency emphasis according to the present invention is characterized in that, in contrast to said prior art frequency emphasis in which the unsharp mask density or signal Dus, Sus was given based on an average of the image signals of all the picture cells in the unsharp mask, the unsharp mask density or signal is determined based on the median central value of the signals of the picture cells or elements the median the N² 1 2 th, data in the accumulated histogram when N is an odd number, the N² 2 th or N² 2 1 th data in the accumulated histogram, when N is an even number is adopted as the unsharp mask density or signal Dus, Sus . According to the present invention, since the median is employed as the unsharp mask signal, it becomes possible to limit the size of the object which is emphasized to those having a size smaller than a half of the size of the unsharp mask and occurrence of overshoot and undershoot is prevented and the ghost image can be eliminated. Therefore, by applying the present invention to the medical diagnosis, the edges of the large sized structures such as ribs and the heart are not emphasized but only the blood vessels are emphasized. Accordingly, this method is particularly suitable for extracting blood vessel shadows of an image of lungs and provides an image of high diagnostic efficiency and accuracy. Further, it is suitable for extracting stomach walls or fine structures of bones. Hence, the diagnostic efficiency and accuracy can be fairly improved in the filed of medical diagnosis. Furthermore, since the ghost images are prevented from being formed in the radiation images, the shape of the edges of bones can be correctly reproduced, which will prevent errors in diagnosis and is therefore very desirable in the medical diagnostic application. It should be noted that an image processing method and apparatus of the above mentioned kind are known from the European patent applications EP 031.952 and EP 032.237. In these patents a method of and apparatus for processing an image, specifically a radiation image or a radiographic image, are described. In the processing of the output signal from an image scanning device, said output signal is converted into an electric signal Sorg from which an unsharp mask signal, Sus, corresponding to the super low frequencies, is obtained for every scanning point. Thereupon a signal conversion represented by Now the present invention will be described in more detail with reference to several embodiments referring to the accompanying drawings. Figure 2 shows an embodiment of an apparatus for carrying out the method of image processing according to the present invention. A radiographic film 1 bearing X ray image information is attached on the surface of a rotating drum 3 made of transparent material, and the light from a light source 2 located in the drum 3 passing through the radiographic film 1 is received by a photomultiplier tube 4 located outside the drum 3 to convert the image information into an electric signal. The electric image signal is converted to digital values by way of a logarithmic amplifier 4 and an A D converter 5 to obtain digital values of original density Dorg. The X ray image information is digitized by use of a drum scanner in the above described example. However, it may be understood that a plan scanner using a CCD line sensor can be employed instead. The image signal indicative of the original density Dorg thus obtained or the signal taken out of a memory device 6 which memorizes the original density signal Dorg thus obtained in a magnetic tape or disc is input into a median calculating unit 7. In the median calculating unit 7, a median Dus of the image signal or digital data of the picture elements in an unsharp mask having the size of N x N is calculated, and the calculated median Dus and the original density signal Dorg are input into an arithmetic unit 8. In the arithmetic unit 8, an operation of Dorg β Dorg Dus , The above operation may be conducted by use of a multiprocessor in which synchronization is made for every line or as shown in Figure 3 by non synchronized calculation of median calculation and frequency processing calculation. That is, as shown in Figure 3, it is possible to input an image density Dorg into an image memory 10, and calculate the median and the frequency processing in a non synchronized manner in a median calculating unit 7 and a frequency processing calculating unit 8 based on the digital data stored in the image memory 10, which has as its output a final image signal indicating the final image density D from the image memory 10. The calculation according to the example as shown in Figure 3 is disadvantageous in that it is not a real time processing but is advantageous in that it is possible to output an image only based on the median. Further, it is of course possible to make the calculation in the median calculating unit 7 and the calculation in the frequency processing unit 8 synchronized with each other by use of a single processor. The output image signal is forwarded to a recording device or a reproducing device to record or reproduce an image. That is, the output signal may be recorded in a magnetic tape or disc to be stored or used for reproducing a visible image on a cat of a photosensitive material. Now referring to Figures 4A to 4E, the effect of the frequency processing or the unsharp masking process in which the median is used as the unsharp mask signal will be described as to the case wherein the object is regarded ideally as a rectangular wave, in one dimension. Figure 4A shows the original image data Dorg. The width of the object of the image is indicated by L in Figure 4A, whereas the width of the unsharp mask is N picture elements. Figure 4A shows the accumulated histogram for the picture elements within the mask for a position of the mask as is shown in Figure 4A. There are L picture elements having a high signal value Q and N L picture elements having a low signal value R. From Figure 4A it follows that the median is the signal value corresponding with 1 2 N picture elements. From the Figure follows that if 1 2 N N L, or N 2L the median equals Q when the centre of the unsharp mask is situated within the interval L, and equals R for other positions of the unsharp mask. This is shown in Figure 4D. From Figure 4A it also follows that, if N 2L, the median equals R for all positions of the unsharp mask, as is shown in Figure 4B. In this case the frequency processing using the median will result in the image signal D as shown in Figure 4C wherein only the part of the object is emphasized. Hence, by this method, only the object of small size can be emphasized. Further, as shown in Figure 4C, overshoot or undershoot is not observed at all. When the size of the unsharp mask N is not larger than double of the size of the object 2L , the unsharp mask signal Dus will become the same as the original image signal Dorg as shown in Figure 4D. Therefore, the final signal after the frequency signal D will become the same as the original signal Dorg as shown in Figure 4E. That is, in this case, the structure or object of a comparatively large size cannot be employed. In this case too, no overshoot or undershoot is observed. Though the above description is made only with respect to the ideal case in which the object is represented by a rectangular wave signal, it was confirmed by the inventors that similar results were obtained when the present method was applied to the practical medical images. In other words, according to the present invention, while the fine structures are emphasized, the structures of comparatively large scale are not emphasized and even the parts where the different size of objects are overlapping were observed without overshoot or undershoot. Accordingly, an image of high quality and high diagnostic efficiency and accuracy was obtained. Though according to the invention noises of high frequency are emphasized as well, the influence thereof can mostly be eliminated by using an emphasizing function F Dorg in place of the emphasizing coefficient β as shown in Figure 7. That is, since the X ray quantum noise mainly observed in an X ray image often appear in the low density area of the image or the low exposure area, the noise can be eliminated by using a non linear emphasizing function which reduces the emphasizing coefficient in the low density area. Thus, the emphasizing coefficient β can be a variable which varies according to the level of the original density Dorg. It should be noted, therefore, that the emphasizing coefficient may be a constant or a variable in this specification. Furthermore, although the above description is made only with respect to the image used for medical diagnosis, it will be noted that the present invention can be applied to images used for industrial engineering because the problem of the ghost image is also observed in the industrial images which is subjected to an image processing of various kinds. Now, an example of a concrete calculating method in the median calculating unit 7 will be described in detail with reference to Figures 5 and 6. As shown in Figure 5, it is assumed that the original density Dorg i, j is of the picture element at the position i, j . The unsharp mask density or the median therefore Dus is obtained as follows. At first, an accumulated histogram CUMUL I in the mask in the digital image is made Figure 6 . Concretely, assuming that the size of the mask is N 3 x N 3 and the image density data of the digital data is designated by 8 bits, the number of picture elements of the mask is N x N or 9, and the median M is the 5th data in the 9 data, which is compared with a value in the accumulated histogram CUMUL I . The comparing step may be initiated from 0 or from 255. Or, it may be started from the previous median which can be memorized with respect to the previous picture element. Then, the value I where CUMUL I becomes CUMUL I N² 1 2 is made the median at the position of the mask. That is, this is the unsharp mask signal Dus for the original density Dorg i, j . Then, when the mask is shifted one by one in Figure 5, the level of the signal gray level in Figure 5 with respect to the N number of image signals at the j 1 th row is subtracted from the accumulated histogram and thereto added is the level of the signal with respect to the N number of image signals at the j 2 th row. That is, the operations of Thus, the unsharp mask density or median Dus is obtained. Of course, the above mentioned 8 bits may be 10 bits, in which case 255 becomes 1023, or more bits. Further, the shape of the mask may not be a square but may be rectangular, M x N or may be a circle of the diameter R. Furthermore, only a part of the picture elements in the mask may be used for obtaining the unsharp mask taking into consideration that the spatial distribution of the image density of an X ray image changes gently or smoothly. Figures 8A, 8B and 8C show some of these examples in which not all of the image data in the mask is used for obtaining the median. Figure 8A shows a pattern of a cross, Figure 8B shows a pattern of X and Figure 8C shows a pattern of a combination of the cross and X . Such a method is able to shorten the calculating time owing to the reduced number of digital data. Figure 9 shows another embodiment of the present invention which is applied to a radiation image recording and reproducing system using a stimulable phosphor sheet. A stimulable phosphor sheet 11 in which radiation image information is stored is scanned by a laser beam 12A emitted by a laser source 12 and deflected in the main scanning direction by a galvanometer 13. The scanned stimulable phosphor sheet 11 emits light upon exposure to the laser beam 12 A which is received by a photodetector 15 such as a photomultiplier tube by way of a light guide 14. The photodetector 15 converts the light carrying the radiation image information into an electric image signal Sorg. The output signal Sorg is forwarded to a logarithmic amplifier 16, then to an A D converter 17, and further to a median calculating unit 18. The arithmetic unit 19 and a memory device 20 are equivalent to those as shown in Figure 2 as well as said elements 16 to 18. The function of these elements is quite the same as that of the elements as shown in Figure 2 and described hereinbefore with reference to the density signals D, Dorg and Dus for an X ray image duplication. Therefore, the detailed description of the embodiment shown in Figure 9 is omitted here, which will readily be understood by replacing D, Dorg and Dus with S, Sorg and Sus.