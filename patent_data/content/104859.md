# Multiprocessor memory map.

## Abstract
The present invention provides RAM locations in a main processor to store the inputs from other input output processors. Thus, inputs to an input output processor are also conveyed over a communication channel to the main processor and stored in the main processor s RAM. All control functions or processors needing a particular input value or responding to certain input values, would look to the input values stored in the master processor memory rather than in the local input loutput processor. Inputs to any particular input output processor or control code relying on the inputs can then be shifted to other processors. This would not effect the control since the control responds to the inputs centrally located in the master processor RAM.

## Claims
CLAIMS 1. An apparatus which comprises a plurality of operating components, a plurality of control devices for controlling operation of said operating components, one of said control devices being a master processor with a related memory and one of said control devices being an input output processor providing input data, a communication channel, said master and said input output processor being connected to the communication channel, and means to store the input data from the input output processor in said memory. 2. An apparatus according to claim 1 wherein said input data is from a specified input source and the storing means maps the data onto a portion of said memory corresponding to the specified source. 3. An apparatus according to claim 1 or 2 including a plurality of input output processors, the storing means mapping input data from each of the input output processors and related to respective sources onto respective portions of said memory corresponding to said specified sources. 4. An apparatus according to claim 3 including a first input output processor having an input A, a second input output processor responding to input A, and means for enabling the second input output processor to respond ito input A, input A being stored in said memory by said storing means. 5. An apparatus according to claim 3 or 4 wherein said processors are interconnected via a shared communication line. 6. An apparatus which comprises a plurality of operating components cooperating with one another to produce a result, and a system controller for controlling the operating components, said controller comprising a plurality of control devices, one of said control devices being a master processor with a related memory and one of said control devices being a remote processor, an input data source connected to one of said operating components and providing control information to said remote processor, a communication channel, said master processor and said remote processor being connected to the communication channel, said remote processor conveying said control information to the master processor via the charnel, and means to store the control information from the remote processor in a portion of the memory of the master processor designated for said input data source whereby said control information is accessible by any other control device and identified to said other control devices as being provided by said input data source. 7. An apparatus comprising a plurality of operating components and a system controller for controlling the operating components, said controller comprising a plurality of control devices for activating the operating components, each of the control devices including an arithmetic and logic unit for manipulating data one of the control devices being a master processor with memory the other control devices being input output processors an input data source connected to one of the operating components for producing control information to one of the input output processors, said memory having a portion dedicated to said input data source, a shared communication line, each of the control devices being interconnected to the shared comnunication line for data communication between the control devices said inputtoutput processor conveying said control infor mation to the master processor via the communication line, and means to store the control information in the memory portion dedicated to the input data source whereby said control information is accessible by all the other input output processors. 8. An apparatus according to claim 7 wherein said input data source is a switch. 9. An apparatus according to claim 7, wherein said input data source is a sensor. 10. Anapparatus according to any of claims 1 to 9 when an electrophotographic copying apparatus.

## Description
MULTIPROCESSOR MEMORY MAP This invention relates to multiprocessor machine control, in particular to memory mapping between processors. In multiprocessor controls, generally the control.algorithms reside in different processors. In a typical system of a master processor A with inputsA connected to input output processors B and C with inputs B and C, respectively, usually the processorA would provide the algorithms to operate on inputs A and processors B and C would provide the algorithms to operate on inputs B and C, respectively. It should be noted, however, this need not always be the case and the inputs to processor B conceivably could be changed to processor C or A and operated on by processor C or A. In fact, control requirements often chanSe as a machine is improved. It would be desirable therefore to be able to move some of the control functions or inputs from one of the processors to another processor. In prior art control systems, this would require a great deal of change in the control code. In particular, if an input is moved from processor B to processor C, any requirement or code that calls upon that particular input in processor B would now have to be changed to look to processor C. This would be a very time consuming and expensive control change. It would, therefore, be desirable to provide a multiprocessor control system in which changes in the inputs or changes in the control functions would be relatively easy to implement. It is, therefore, an object of the present invention to provide a new and improved multiprocessor controLIt is a further object of the present invention to provide a relatively easy method to change processor inputs in a multiprocessor control with minimal effect on the control. It is a further object of the present invention to provide input mapping in a multiprocessor control. Further advantages of the present invention will become apparent as the following description proceeds, and the features characterizing the invention will be pointed out with particularity in the claims annexed to and forming a part of this specification. Briefly, the present invention provides RAM locations in a main processor to store the inputs from input output processors. Thus, inputs to an input output processor are also conveyed over a communication channel to the main processor and stored in the main processor s RAM. All control functions or processes in the main processor needina a particular input value or responding to certain input values, would look to the input valu√©s stored in the master processor memory rather than in the local input output processor.Inputs to any particular input output processor or control code relying on the inputs can then be shifted to other processors. This would not effect the control since the control responds to the inputs centrally located in the master processor RAM. Since only filtered changes new and validated information are sent to the main processor, the volume of communication is considerably reduced. Because the volume of communication is reduced, response is generally improved. An input is generally read more often than it changes and its up to date state is stored in the main processor. The result is less delay and associated overhead in communication. Figure 1 is an elevational view of a reproduction machine typical of the type of machine or process that can be controlled in accordance with the present invention Figure 2 is a block diagram of the control boards for controlling the machine of Figure 1 Figure 3 illustrates some of the basic timing signals used in control of the machine illustrated in Figure 1 Figure 4 illustrates the synchronization between a master control board and an input output control board in accordance with the present invention Figure 5 illustrates the common mapping of data between an input output control board and a master control board and the downloading of instructions Figure 6 illustrates the filtering of input data at an input output control board and Figure 7 illustrates the method of selecting a particular filter and related time period. With reference to Figure 1, there is shown an electrophotographic printing or reproduction machine employing a belt 10 having a photoconductive surface. Belt 10 moves in the direction of arrow 12 to advance successive portions of the photoconductive surface through various processing stations, starting with a charging station including a corona generating device 14. The corona generating device charges the photoconductive surface to a relatively high substantially uniform potential. The charged portion of the photoconductive surface is then advanced through an imaging station. At the imaging station, a document handling unit 15 positions an original document 16 facedown over exposure system 17. The exposure system 17 includes lamp 20 illuminating the document 16 positioned on transparent platen 18. The light rays reflected from document 16 are transmitted through lens 22. Lens 22 focuses the light image of original document 16 onto the charged portion of the photoconductive surface of belt 10 to selectively dissipate the charge. This records an electrostatic latent image on the photoconductive surface corresponding to the informational areas contained within the original document. Platen 18 is mounted movably and arranged to move in the direction of arrows 24 to adjust the magnification of the original document being reproduced. Lens 22 moves in synchronism therewith so as to focus the light image of original document 16 onto the charged portion of the photoconductive surface of belt 10. Document handling unit 15 sequentially feeds documents from a holding tray, in seriatim, to platen 18. The document handling unit recir culates documents back to the stack supported on the tray. Thereafter, belt 10 advances the electrostatic latent image recorded on the photoconductive surface to a development station. At the development station a pair of magnetic brush developer rollers 26 and 28 advance a developer material into contact with the electrostatic latent image. The latent image attracts toner particles from the carrier granules of the developer material to form a toner powder image on the photoconductive surface of belt 10. After the electrostatic latent image recorded on the photocon ductive surface of belt 10 is developed, belt 10 advances the toner powder image to the transfer station. At the transfer station a copy sheet is moved into contact with the toner powder image. The transfer station includes a corona generating device 30 which sprays ions onto the backside of the copy sheet. This attracts the toner powder image from the photoconductive surface of belt 10 to the sheet. The copy sheets are fed from a selected one of trays 34 or 36 to the transfer station. After transfer, conveyor 32 advances the sheet to a fusing station. The fusing station includes a fuser assembly for permanently affixing the transferred powder image to the copy sheet. Preferably, fuser assembly 40 includes a heated fuser roller 42 and ba up roller 44 with the sheet passing between fuser roller 42 and backup roller 44 with the powder image contacting fuser roller 42. After fusing, conveyor 46 transports the sheets to gate 48 which functions as an inverter selector. Depending upon the position of gate 48, the copy sheets will either be deflected into a sheet inverter 50 or bypass Sheet inverter 50 and be fed directly onto a second gate 52. Decision gate 52 deflects the sheet directly into an output tray 54 or deflects the sheet into a transport path which carries them on without inversion to a third gate 56. Gate 56 either passes the sheets directly on without inversion into the output path of the copier, or deflects the sheets into a duplex inverter roll transport 58. Inverting transport 58 inverts and stacks the sheets to be duplexed in a duplex tray 60. Duplex tray 60 provides intermediate or buffer storage for those sheets which have been printed on one side for printing on the opposite side. In order to complete duplex copying, the previously simplexed sheets in tray 60 are fed seriatim by bottom feeder 62 back to the transfer station for transfer of the toner powder image to the opposed side of the sheet. Conveyers 64 and 66 advance the sheet along a path which produces a sheet inversion. The duplex sheets are then fed through the same path as the previously simplexed sheets to be stacked in tray 54 for subsequent removal by the printing machine operator. Invariably after the copy sheet is separated from the photo conductive surface of belt 10, some residual particles remain adhering to belt 10. These residual particles are removed from the photoconductive surface thereof at a cleaning station. The cleaning station includes a rotatably mounted brush 68 in contact with the photoconductive surface of belt 10. A controller 38 and control panel 86 are also illustrated inFigure 1. The controller 38 as represented by dotted lines is electrically connected to the various components of the printing machine. With reference to Figure 2, there is shown in further detail the controller 38 illustrated in Figure 1. In particular, there is shown a central processing master CPM control board 70 for carrnunicating information to and from all the other control boards in particular the paper handling remote PHR control board 72 controlling the operation of all the paper handling subsystems such as paper feed, registration and output transports. Other control boards are the xerographic remote XER control board 74 for monitoring and controlling the xerographic process, in particular the analog signals, the marking and imaging remote MIR control board 76 for controlling the operation of the optics and xerographic subsystems, in particular the digital signals. A display control remote DCR control board 78 is also connected to the CPM control board 70 providing operation and diagnostic information on both an alphanumeric and liquid crystal display.Interconnecting the control boards is a shared communication line 80, preferably a shielded coaxial cable or twisted pair with suitable communication protocol such as the Xerox Ethemet communication system Ethernet is a registered trade mark . Other control boards can be interconnected to the shared communication line 80 as required. For example, a RecirculatingDocument Handling Remote RDHR control board 82 shown in phantom can be provided to control the operation of a recirculating document handler. There can also be provided a not shown Semi ,Autcoatic Document Handler Remote SADHR control board to control the operation of a semi automatic document handler, a not shown Sorter Output Remote SOR control board to control the operation of a sorter, and a not shown Finisher Output Remote FOR control board to control the operation of a stacker and stitcher. Each of the controller boards preferably includes an Intel 8085 microprocessor with suitable Random Access Memory RAM and some for ofRead Only Memory such as ROMs or EPROMs. Also interconnected to theCPM control board is a Master Memory Board MMB 84 with suitableROMs EPROMs to control normal machine operation and a control panel board 86 for entering job selections and diagnostic programs. Also contained in theCPM board 70 is suitable nonvolatile memory. All of the control boards other than the CPM control board are generally referred to as remote control boards. In a preferred embodiment, the control panel board 86 is directly connected to the CPM control board 70 over a 70 line wire and the memory board 84 is connected to the CPM control board 70 over a 36 line wire.Preferably, the Master Memory Board 84 contains 56K byte memory and theCPM control board 70 includes 2K ROM EPROM, 6K RAM, and a 512 byte nonvolatile memory. The PHR control board 72 includes 1K RAM and 4KROM EPROM and preferably handles various inputs and outputs. The XER control board 74 handles 24 analog inputs and provides 12 analog output signals and 8 digital output signals and includes 4K ROM EPROM and 1K RAM. TheMIR board 76 handles 13 inputs and 17 outputs and has 4K ROM EPROM and 1KRAM. As illustrated, the PHR, XER and MIR boards receive various switch and sensor information from the printing machine and provide various drive and activation signals, such as to clutches, motors and lamps in the operation of the printing machine. It should be understood that the control of various types of machines and processes are contemplated within the scope of this invention. In accordance with one aspect of the present invention, a master timing signal, called the timing reset or Pitch Reset PR signal, as shown inFigure 2, is generated by PHR board 72 and used by the CPM, PHR, MIR andXER control boards 70, 72, 74 and 76. With reference to Figure 3, the PitchReset PR signal is generated in response to a sensed registration finger. Two registration fingers 90a, 90b on conveyor or registration transport 66 activate a suitable not shown sensor to produce the registration finger signal. The registration finger signal is conveyed to suitable control logic on the PHR control board 72. In addition, a Machine Clock signal MCLK is conveyed to PHR 72 via the CPM control board 70 to suitable control logic. In response to predetermined MCLK signals, the pitch reset signal is conveyed to the CPM board 70 and the MIR and the XER remotes 74, 76. The Machine Clock signal is generated by a timing disk 92 or Machine Clock sensor connected to the main drive of the machine. The Machine Clock signal allows the remote control boards to receive actual machine speed timing information. The timing disk 92 rotation generates approximately 1,000 machine clock pulses per second. A registration finger sensed signal occurs once for each paper feed and there are approximately 830 machine clock counts for every registration finger sensed signal as shown in Figure 3. A belt hole pulse is also provided to synchronize the seam on the photoreceptor belt 10 with the transfer station to assure that images are not projected onto the seam of the photoreceptor belt. With reference to Figure 4 there is shown a typical communication between CPM control board 70 and a typical remote control board, in particular the PHR board 72. The CPM and PHR boards 70, 72 are connected through the communication channel 80. In general, upon receiving switch or sensor information from a remote or input output board, the CPM board 70 responds with specific control information. In a typical case, upon receiving information from the PHR board 72, it is necessary, for example for the CPM board 70 to instruct the PHR board to turn a paper feed motor off. In particular, it may be necessary for the PHR board 72 to turn off the motor at a certain time period after it receives its instructions. For example, the PHR board 72 could be instructed to turn off the motor 300 machine clocks after receiving the instruction. In previous systems it would have been necessary for the CPM control board 70 to instruct the PHR board 72 to turn the motor off at the correct time. In other words, the CPM control board would have to count clock pulses and convey the correct timing information as well as the specific turn off instruction to the PHR control board.This type of communication, particularly over a shared communication system, is restricted to relatively non time critical operations However, in accordance with the present invention, the Machine Clock signal is not only conveyed to the CPM board 70 but also simultaneously to the PHR board 72. It is only necessary therefore for the CPM board 70 to generally instruct the PHR board 72 to turn the feed motor off after 300 machine clocks after receiving a switch or sensor change to the appropriate state. This is often referred to as downloading an instruction from the CPM board to a remote board. The CPM board can then forget about the PHR board and further timing instructions and continue on with other control functions.The PHR board 72, on the other hand, can turn off the motor 300 machine clocks after receiving the input change because it now has its own synchronized clock signal. Having received the instruction to turn the feed motor off 300 machine clocks after the input change, it has the preciseMachine Clock signals to perform the function at the correct time. A typical instruction sequence would be WAIT S1 Paper that is, wait until a switch S1 senses paper WAIT 300 machine clocks, then FEED MOTOR OFF turn off the feed motor In other words, the typical operation is to instruct the remote board to sense a certain switch or input and then perform a specified operation, often requiring a time delay. By merely having key timing signals such as a Pitch Reset, and the Machine Clock signals conveyed not only to theCPM board 70 but to all the remote control boards, it is possible to insure timely performance of required functions. There can be timely performance even though the communications system may be too busy, slow or inconsistent in the amount of time it requires to process a message from one processor to another.It should also be noted that this example is merely one sample of many different types of instructions that can be downloaded. The general format of performing this type of operation is merely to list the key elements, that is the input needed, the time period of delay in machine clocks or milliseconds, and the output required. For example, INPUT WAIT OUTPUT T F X mc. I O On Off where depending upon the input switch or sensor being true or false, a particular output transition state is made on or off after a time delay of X milliseconds or machine clocks. The instructions are maintained in RAM on both the CPM board 70 as well as on the particular remote board receiving the instruction as illustrated in Figure 4 by RAM section 120 on CPM board 70 andRAM section 122 on PHR board 72. Another example of downloading these critical time events would be the CPM board 70 to send a message to the MIR board 76 to flash a lamp, in particular to flash the lamp 50 machine clocks after the Pitch Reset. If theMIR board 76 did not have direct access to the machine clock and Pitch Reset signal, it would have to wait for this timing information from another source.However, the general message or instruction is downloaded to the MIR board 76 and after sensing the Pitch Reset signal directly, the MIR board can count its own 50 machine clocks and flash the lamp at the required time with no further communication with a central or master processor in particular CPM board 70. The CPM board 70 is able to centrally control operations and yet be able to download messages, offloading local control to the inputjoutput or remote control boards. This takes a great deal of the processor load off theCPM board and places the processing load in the input output control boards.The input output control boards can be instructed well in advance that at a certain time they should perform a certain function. The input output control board, not generally having a relatively heavy workload of processing, can perform these tasks very efficiently. In addition, several messages can be downloaded to a remote control board. The remote control board then sorts out the priority and takes care of the proper timing of the messages. That is, a recently received message may require attention before an earlier received message. The remote control board makes this type of determination from information provided by the CPM control board. In accordance with another feature of the present invention, Figure 5 illustrates the mapping of the input signals in a common data base. That is, the inputs to the various remote boards such as switch and sensor signals are stored both in the RAM of the remote board receiving the signals, as well as in a section of RAM in the CPM board 70. For example, inputs labeled B, shown at the PHR remote board 72, are stored in a suitable RAM location B on PHR board 72 as well as in a suitable RAM location B on CPM board 70. The C inputs, illustrated at the XER board 74, are stored in RAM location C on the XER board 74 as well as in a suitable RAM location C on the CPM board. The D inputs to M1R board 76 are stored in RAM location D on MIR board 76 and on the CPM board in RAM location D. It is also possible that certain of the inputs such as labeled A may go directly to the CPM control board 72. This information could be, for example, control panel information. Suppose that because of changing control requirements, it was necessary to change an input going to one control board and deliver the input to another control board. For example, suppose it was necessary to shift the input D from the MIR board to the XER board or, for example, to have the input A go to a special control panel board 124 as shown in PHANTOM. According to the present invention all processors responding to various inputs scan the values of the inputs in the CPM RAM rather than in the processor receiving the input. That is, the allocated RAM space on the CPM board associated with the various inputs contains all the input values as the values are received on the different boards. These values are conveyed over communication channel 80 to t he CPM board. These values are continually updated as changing inputs come in and are available for any portion of control needing to respond to those inputs. A particular control procedure located, for example, on CPM board 70 or PHR board 72, waiting to respond to an input to MIR board 76 does not need scan the MIR board RAM or wait for communications from the MIR board over the channel 80. The particular control procedure can scan the D input values as stored in RAM on CPM board 70. Thus, all the input signals are mapped to RAM locations on the CPM board 70. It thus becomes transparent to the control procedure or code operating on a particular input whether or not the input has been moved to another control board. This also minimizes communications and, in general, an input is read more often ,than it changes. In a similar manner, the outputs to the remote boards such as downloaded instructions are gathered in a common data store. In general, as shown in Figure 5, the RAM in CPM board 72 has allocations for CPM inputs as well as the inputs associated with each of the other input output control boards. Since all of the input is stored in the central memory location on the CPM control board, it is not necessary for a particular input output control board to communicate with another input output control board over a separate line to receive input or output information. It is only necessary for the input output control board to communicate with the CPM control board over the shared line 80 and read the information from the appropriate CPM RAM location. In general, as the inputs to a particular control board change, this information is updated in theRAM section in CPM corresponding to that particular control board. This changed information is optionally provided to the other remote boards by the input output board on specific request, and the remote board responds to this information as required. With reference to Figure 6, there is shown the CPM control board 70 connected to the PHR control board 72, the XER control board 74 and theMIR control board 76 through the communication channel 80. As shown inFigure 5, normally the input signals illustrated as input B, input C and input D, are received by the control boards and communicated over the channel 80 to the CPM board 70. Often, the input signal information can be invalid and garbled, particularly in a noisy environment such as in the operation of a machine or process. Filtering of the information, if done at all, is usually done at the master control such as the CPM board 70. This creates a great, deal of unnecessary transmissions across the communication channel 80 in sorting out the valid from the invalid signals. In accordance with another feature of the present invention, as shown in Figure 6, filtering is provided at the remote boards A filter 128 is provided on each of the remote boards to filter the incoming information before transmission over the communication channel 80. Preferably, the filtering is done in software, but it should be understood that more expensive hardware filters could also be used. Preferably, there are two types of input filters, a transition filter usually associated with a sensor input and a debounce filter usually associated with a switch input. Both of these filter techniques have an associated time period. Both the filter times and the type of filter for each particular input is programmable. For example, in a preferred embodiment there are 32 inputs to thePHR board 72. Identified with each of the 32 inputs is a designated bit in theRAM of the PHR board 72 identifying the type of filter. That is, a 0 or 1 identifies either the transition or debounce filtering. In addition, associated with each of the inputs are an additional two bytes of information. One of the bytes from a timer table represents the designated time period of filtering for that particular input. Iri a preferred embodiment time periods vary from approximately four milliseconds up to one second. The other byte represents a software counter to count down the time period. In operation, once there is a change or transition for a particular switch or sensor input, it is necessary to first determine the type of filtering required for that particular switch or sensor. The RAM location for that particular input is, therefore, scanned for 0 or 1. Next, the byte of RAM from the timer table, is read to give the time period for filtering of the particular input. Assuming, for example, the period is 500 milliseconds, this time period is loaded into the second byte associated with a particular input. This second byte of RAM location is the counter. It will count down to 0 to indicate the end of the filtering period. In this particular example, the counter will count down from 500 milliseconds. It should be noted that the timer period or history byte associated with each of the inputs is programmable and thus the amount of time for filtering of a specific input can be changed. The debounce type filter works as follows. Once an input transition takes place, the timer relating to the specific input is activated. When the timer is activated, it continues counting only during the time that the transition is recognized. In other words, assuming a transition from a low to a high, the high reading will begin the activation of the counter. If during the count down, there is a transition back to low, the counter will suspend counting until another high is sensed. The counter will then resume the countdown from 500 milliseconds. The countdown is cumulative and continues until a total of 500 milliseconds of the high level has been recognized.At this point the high level transition is accepted as valid and mapped to the appropriate CPM RAM location memory map if the high reading has been maintained for the last 500 milliseconds. The transition type filter operates as follows Once an input transition takes place, the associated timer for the specified time period is activated and the transition level is immediately mapped to the appropriateCPM RAM location. The associated counter is loaded with the time period and begins the countdown. If at any time during this time period, the input again changes, the change is ignored until the filter time lapses. At the end of the lapse of the time period, the input state or level at that time is updated.Thus, if the input has remained high, the CPM RAM map is unchanged.However, if the input has changed, the CPM is updated to reflect the change and a new timing sequence initiated. With reference to Figure 7, there is graphically illustrated a byte of RAM, 130a, with each of the eight bit positions corresponding to a particular input switch or sensor. The switches or sensors could be an input to any of the remote control boards. The RAM byte is continually scanned for input transitions and after a period of time, three of the inputs 1, 2 and 4 have shown input transitions, illustrated at 130b. Associated with each of the inputs is a bit of RAM byte 134, identifying by either a 1 or 0 whether or not the particular filter is the transition type or debounce type. For example, input 1 can be assumed to be a sensor identified by 1 and therefore inputs 2 and 4 are switches, identified by 0 . It should be noted, however, that it is not necessary to restrict a switch or sensor to a particular type of filter. Also related to the type of filter and to each input is a time period as shown by memory bytes 136, 138 and 140. Each time period is then loaded into its associated counter or timer as illustrated. In operation, the time periods 136, 138 and 140 are loaded in the appropriate timers. The timer is then activated for the time period specified in the locations 136, 138 and 140. If transition type filtering has been specified in byte 134 for input 1, then any further transitions during the specified time period will be ignored. If debounce type filtering has been specified for inputs 2 and 4, then the timers will count down only when the input remains at transition state. It should be observed that not only the type of filtering for any specific input can be changed by merely changing the flag in the location 134 but also the time periods associated with any specific input can be changed by altering the contents of the various memory locations such as bytes 136, 138 and 140. While there has been illustrated and described what is at present considered to be a preferred embodiment of the present invention, it will be appreciated that numerous changes and modifications are likely to occur to those skilled in the art, and it is intended in the appended claims to cover all those changes and modifications which fall within the true spirit and scope of the present invention.