# Transcutaneous nerve stimulation device using a common controller for pulse production and parameter display.

## Abstract
A transcutaneous nerve stimulation device is provided us ing a common controller 10 for both output pulse production and treatment parameter display. The common controller, which preferentially takes the form of a programmed microprocessor 10 is connected by signal lines to both the pulse output circuitry and the display, which are controlled by time sharing the signal lines. The controller 10 is responsive to operator entered input signals for the calculation of output pulse characteristics and display parameters. During a majority of treatment time, the controller 10 is providing signals on the signal lines for control of the display. The display signals are in terrupted during timed intervals when output signals are pro duced.

## Claims
CLAIMS 1. A transcutaneous nerve stimulation device for producing therapeutic electrical stimulation pulses coniprising an output at which treatment pulses are produced a display for displaying parameters of said treatment pulses a controller having output lines coupled to said output and said display, and producing control signals for said output and said display on said output lines at different times during treatment, said controller having input lines and means for applying treatment pulse parameter signals to said input lines of said controller for control of said treatment pulse parameters and for display of pulse parameters on said display. 2. The stimulation device of Claim 1, wherein said controller is a digital microprocessor. 3. The stimulation device of Claim 2, wherein said output lines comprise a digital bus on which output control signals and display control signals are produced in a tiee shared manner by said microprocessor. 4. The stimulation device of Claim 3, wherein ones of said bus lines are connected to said output and to said display. 5 The stimulation device of any one of claims 1 to 4 wherein said display comprises a liquid crystal display controlled by signals produced by said controller and wherein said output includes a digital to analog converter which is responsive to signals produced by said controller. 6. The stimulation device of Claim 5, wherein ones of said output lines are coupled to both inputs of said digital to analog converter and to segment control inputs of said liquid crystal display. 7. The stimulation device of any one of claims 1 to 4, wherein said output includes a digital to analog converter having an output, and an input coupled to output lines of said controller and a gate having an input coupled to the output of said digital to analog converter, and an output at which treatment pulses are produced, wherein said gate is coupled to an output line of said controller for controllably rendering said gate conductive during the production of said treatment pulses. 8. The stimulation device of any one of claims 1 to 7 wherein said treatment pulse parameter means comprises a plurality of switches coupled to said input lines of said controller. 9. The stimulation device of Claim 8, wherein said treatment pulse parameter means further includes a mode switch for selecting a mode of operation of said device, said mode switch being connected to an input line of said controller. 10. A transcutaneous nerve stimulation device for producing therapeutic electrical stimulation pulses comprising a icroprocessor having inputs and outputs output pulse circuitry having an input coupled to outputs of said microprocessor and an output at which treatment pulses are produced a display having inputs coupled to outputs of said microprocessor for displaying treatment parameters and means for applying treatment parameters to an input of said wicroprocessor. 11. The stimulation device of Claim 10, wherein said wicroprocessor is controlled by a software progra,1 partitioned into a background program and a foreground program, wherein said background program calculates output signals for said display and for said output pulse circuitry, and wherein said foreground program controls the timing of operation of said output circuitry and said display. 12. The stimulation device of Claim 11, wherein said foreground program is executed at a regularly recurring rate. 13. The stimulation device of any one of claims 10 to 12 wherein said treatment parameter means includes a plurality of switches which are periodically sampled by said software program. 14. The stimulation device of Claim 13, wherein said treatment parameter means includes a mode switch which is set to control the mode of operation of said device, the setting of said mode switch being periodically sampled by said software program. 15. The stimulation device of any one of claims 10 to 14, wherein said output pulse circuitry includes a digital to analog converter, and wherein said display comprises a liquid crystal displays and wherein said microprocessor has an output bus coupled to inputs of said digital to analog converter and to inputs of said liquid crystal display. 16. The stimulation device of Claim 15, wherein during a majority of the time, said microprocessor produces control signals for said display on said output bus, said display signal production being interrupted periodically for the production of output pulse control signals on said output bus. 17. The stimulation device of Claim 14, wherein said microprocessor has a data bus coupled to said anode switch and to said display, said data bus being controlled by said microprocessor as an output bus for applying control signals for said display, and as an input bus for periodically sampling the setting of said mode switch. 18. The stimulation device of any one of claims 10 to 14, wherein said output circuitry includes a digital to analog converter having an output, a control input, and data inputs coupled to outputs of said microprocessor, and a transaission gate having an input coupled to the output of said digital to analog converter, an output coupled to an output of said device, and a control input said microprocessor having a first control line coupled to said control input of said digital to analog converter for causing the production of an output voltage by said converter, and a second control line coupled to said control input of said transmission gate for rendering said gate conductive during the production of a treatment pulse. 19. The stimulation device of Claim 18, further including a second transmission gate having an input coupled to the output of said digital to analog converter, an output coupled to a second output of said device, and a control input wherein said microprocessor has a third control line, coupled to said control input of said second transmission gate, for rendering said second transmission gate conductive during the production of a treatment pulse at said second output. 20. The stimulation device of claim 18 or claim 19 wherein said digital to analog converter further includes a reference voltage input, wherein said microprocessor controls the application of a reference voltage to said reference voltage input during the production of treatment pulses.

## Description
TRANSCUTANEOUS NERVE STIMULATION DEVICE USING A COMMONCONTROLLER FOR PULSE PRODUCTION AND PARAMETER DISPLAYThis invention relates to transcutaneous nerve stimulation devices and, in particular, to such devices in which output and display signals are controlled by a common processor.Transcutaneous nerve stimulation devices apply stimulating electrical pulses to electrodes which contact the skin of a patient to relieve pain through electrical nerve stimulation. A patient will generally be qiven a device by a physician, together with instructions on how to use the device safely and effectively. Thereafter, the patient uses the device to perform the necessary treatment.Accordingly, it is desirable for the device to be simple and easy for the patient to use.It has been found that different patients receive benefit from different types of pulse sequences. fence, a stinulation device should be capable of providing a range of different types of pulse sequences, so that the physician can prescribe the treatment most beneficial to any particular patient.In many circumstances it may be possible for the patient to use the stimulation device while continuing his or her normal daily activities. To permit this, the device must be snail and portable. A device snail enough to slip into a pocket and light enough to he carried on a patient s belt is therefore desirable.To perform treatment, the patient should be able to select his prescribed treatment pulse sequence using simple controls, and must verify the treatment sequence by observing an indicator or display on the device. In such a device, then, electronic circuitry must be provided to control the treatment pulse sequence and to control the display.However, the provision of separate circuit assemblies for these two functions increases the size of the device, and can result in a large, bulky stimulation device which opposes the desire for portability. Thus, it is desirable for a stimulation device to employ common control circuitry for both output pulse production and treatment parameter display.In accordance with the principles of the present invention, a stimulation device is provided using a common controller for both output pulse production and treatment parameter display. The common controller, which preferentially takes the form of a programmed microprocessor, is connected by signal lines to both the pulse output circuitry and tile display, which are controlled by tilae sharing the signal lines. The controller is responsive to operator entered input signals for the calculation of output pulse characteristics and display parameters.During a majority of treatment time, the controller is providing signals on the signal lines for control of the display. The display signals are interrupted during timed intervals when output signals are produced. The output signal timing is governed in a manner such that the desired pulse sequences are produced without any noticeable effect on the display, which prolongs the life of the power supply and the display device.In the drawings FI JRr 1 is a schematic illustration of a stimulation device constrticted in accordance with the principles of the present invention FIGURES 2, 3, and 4 are more detailed scherlatics of tlle illustration of FIGURE 1 FIGURE 5 is a block diagram. of the controller of FIGURE 1 FIGURES 6A, 6B, 6C and 7 are flowcharts of the programming of the controller of FIGURE 5 andFIGURES 8 13 are timing diagrans illustrative of the operation of the stimulation device of FIGURE 1.Referring to FIGURE 1, a scher1atic illustration of a digitally controlled stinulation device constructed in accordance with the principles of the present invention is shown. A microprocessor 10 receives operator input control signals from pushbutton switches shown at 12. The microprocessor also receives inputs fron a low battery detector 26 and a sentinel signal detector 50. Signals froni either of these two latter sources will precipitate a termination of output pulse production.The device is powered by a battery 14, which is connected to a power supply regulator 18 by an on off switch 16.The regulator 18 provides regulated supply voltage Vs for the microprocessor 10, output stage voltage VA, and a reference voltage for a digital to analog D A converter 40. The regulator is also coupled to the low battery detector 26 for voltage sampling by the detector.The microprocessor 10 has two ports and a data bus, shown as bus 1, bus 2, and bus 3. Bus 1 provides digital words representative of output signal levels to the D A converter 40, and also control signals for segments of the right most digit of a display 20. Bus 2 provides control signals for seynents of the center digit of the display 20, and also samples the setting of a mode switch 24. Bus 3 has a plurality of data lines for dedicated control functions. Line 31 controls the timing of the application of the reference voltage to the D A converter 40. Line 32 controls the clocking of an output voltage level word into the buffer of the D A converter. Lines 33 and 34 control the closings of gates 42 and 44, which couple the voltage fro the Dj converter to the outputs of the device.Line 35 applies a signal to the mode switch 24 during the time that the state of the mode switch is sampled. Line 36 applies input data to a shift register 22, and line 37 turns on the AtS indicator on the left side of the display 20 when the amplitude of pulses at the first output is being displayed numerically. Nrle output of the fl A converter is coupled by way of the two CMOS gates 42 and 44 to inputs of output signal amplifiers 46 and 48. The outputs of the amplifier 46 and 48 are coupled to respective output transformers TR1 and TR2, and to inputs of the sentinel signal detector 50.A portion of the schematic diagram of FIGURE 1 is shown in further detail in FIGURE 2. The microprocessor 10, which may be of the generic type designated 80C49, is shown with its inputs and outputs specifically designated. A 3 MH z crystal 101 is coupled across inputs X1 and X2 of the microprocessor 10. A capacitor 103 couples the reset input of the microprocessor to ground so that the microprocessor will receive a reset command immediately after the device is turned on and the supply voltage has stabilized. Four pushbutton controls, labelled DISP, INC,DEC and SET are coupled to inputs T , T1 and the interrupt input of the microprocessor. A number of diodes are used to encode signals from the pushbutton switches. For instance, when the DISP pushbutton is closed to change the function being displayed on the display, the diodes from the DISP pushbutton apply low ground level signals to the T and T1 inputs. The nicroprocessor will then decode these two low lines as a DISP command. Also coupled to microprocessor inputs are a sentinel signal by way of transistor 105, and a low battery detection signal. A power on initializing signal is coupled to input T1.The individual lines of the three buses are also shown.Buses 1 and 2 are ports of eight lines each, and bus 3 comprises eight data lines for controlling the specific functions enumerated above. Line 38, which was not shown in FIGURE 1, is a clock line which is selectively activated to load data from line 36 into the shift register 22.FIGURE 3 illustrates the display and bus arrangement ofFIGURE 1 in further detail. Line 31 from the microprocessor is coupled through a CMOS gate 128 to the base of a transistor 118. A signal REFG on this line 31 turns on transistor 118 to apply a reference voltage to D X converter 40 when needed during activation of the D A converter. When the D A converter is not supplying an output voltage, the reference voltage is not needed and is turned off by the REFG signal to conserve battery power.The reference voltage is otherwise turned on mollentarily every half second to sample the battery voltage. The gate 128 will he interrupted momentarily after the on off switch 16 is turned on while capacitor 74 charges. The tine for the capacitor to charge allows the system to stabilize before transistor 70 is turned off, at which time the T1 input of the microprocessor is released. When T1 is released, the output pulses are at a low, safe level. Transistor 72 in turn will turn off, releasing the enabling line to gate 128. Transistor 72 also forces a node change to the desired mode. The application of reference voltage to the A D converter may then proceed, as the microprocessor is running with valid data.This hold off sequence prevents the application of inaccurate, high level output pulses to the patient after a momentary turning off of power, which could leave spurious data in the microprocessor registers until the registers have been validly restored.When the mode switch 24 is to be interrogated to determine if a change in mode has occurred, a signal MSW on line 35 momentarily turns on a transistor 74. The arm of the mode switch 24 will then apply a low signal level to the output of the switch to which it is presently connected. This low signal level is detected on the corresponding one of the four lines of bus 2 to which the mode switch is connected. Bus 2 is acting as a data input port at that time. During the remainder of the time, bus 2 is providing segment drive signals for the middle digit of the display 20 and a hackplane BP signal. Bus 1 is providing segment drive signals for the right most digit of the display at all times except when the t A converter 40 is being loaded with output signal level data.Shift register 22, which is comprised of two four bit, serially connected shift registers 22a and 22b, is loaded with data for the left most display digit from line 36.The clock signal on line 38 shifts the data into the shift registers 22a, 22b. The display also displays the indicators AMP, FV, and RATE on either side to tell the operator which parameter is being controlled by theINCREASE and DECREASE pushbuttons. The left indicators correspond to output 1 and the right indicators to output 2. The AMP indicator for output 1 is controlled by theAMP1 signal on line 37, and the AMP indicator for output 2 is controlled by one line of bus 1. The R. pulse width indicator for output 1 is controlled by the Q2 location of shift register 22b, and the PW indicator for output 2 is tine shared on line 36. The RATE indicators are commonly controlled by the Q4 location of shift register 22a, as both outputs will exhibit the sane pulse rate, or frequency.The output section of the stimulation device is shown in detail in FIGURE 4. When the D A converter is producing the desired output level, signals EN1 and EN2 on lines 33 and 34 render CMOS gates 42 and 44 conductive for periods corresponding to the operator entered pulse width settings. Output pulses are then applied to amplifiers 46 and 48. Output transistors 60 and 62 are turned on to apply output signals to output transformers TR1 and TR2.The output pulses are then transformer coupled to leads connected to electrodes not shown on the skin of the patient.Before each transmission of output pulses, test pulses called sentinel pulses are transmitted to verify that the electrodes are properly connected to the patient. If the connections are properly made, the pulses will not exceed the trigger threshold of a comparator 52, and the output state of the comparator will not change. Improper electrode connections will cause detection of the sentinel pulses, which are coupled to the interrupt input of the microprocessor by transistor 105 FIGURE 2 , and the microprocessor will be inforned of the improper connections. The microprocessor will query its interrupt line, and will recognize the problem. A sentinel flag will be set, and the system will halt the production of output pulses until the failure is remedied and the device is restarted.The sentinel system is more fully described in concurrently filed European patent application number , entitled TRANSCUTANEOUS NERVE STIMULATION DEVICE WITH SENTINEL Reference STM 27, claiming priority from USSN 617429 .The software which controls the microprocessor, and hence operation of the device, is stored in a 2K read only memory ROM . The software is partitioned into a foreground program and a background program. The two programs interact through an exchange of data words and flag bits stored in 128 bytes of random access memory RAM . This software hardware structure is shown inFIGURE 5. During most of the time, the background program loop is running. The background program continuously monitors the pushbutton inputs and the mode switch, looking for a change. When a change occurs, it is detected and any variables which require change are calculated and stored in the RAM. The variables are then available for use by the foreground program.An internal timer which runs continuously interrupts the background program every 2.5 rises. The foregound program, which controls precise timing functions, then proceeds through its sequence, producing output signals at the appropriate times. Output signals are produced in accordance with the data values that the foreground program finds in RA locations. When the foreground program produces output signals from new data values it returns status flags to the RAM to indicate to the background program that the new data has been utilized. The foreground program is shown in flowchart form inFIGURES 6A, 6B, and 6C. When the internal timer has reached zero after 2.5 msec, the background program is interrupted and the microprocessor goes to location 007, where the foreground program begins. The background program data in the accumulator is stored in register 7, and register bank 1 is selected for foreground program control. Register bank 1 contains a number of counters which are decrenented by the foreground program to maintain the appropriate timing of output functions. The internal timer is initialized to a value of 240, corresponding to 2.5 msec, and the foreground processing begins. The foreground program first decrements an LCD counter for control of the display. The LCD display receives two types of pulse trains a common backplane pulse train and individual segment pulse trains, each of a frequency of 25 Hz. When the two pulse trains are changing in phase for any one display segment or indicator, there is no potential difference between tlie pulse trains and the segment or indicator is not displayed. When the two pulse trains are in phase opposition, however, there is always a voltage differential between then and the segment or indicator will be displayed. rEnen the L D counter has been decremented to zero, a half cycle of the 25 Hz pulse rate has expired and the outputs to the LCD display must be changed. The LCD counter is initialized to a value of eight E times 2.5 msec 20 msec 1 2 cycle of 25 Hz , and LCD data resident in the RAM is put on buses 1 and 2. LCD data is serially loaded into the shift register 22 from data line 36. An invert flag F1 is set to inform the background program that it must calculate inverted LCD data values for the next half cycle opposite phase of the LCD pulse trains.A Power On counter is decremented. Every two seconds a power on LED light emitting diode is flashed for 20 msec to indicate to the operator that the device is operating properly. The counter is first checked for a value of 99. At this value, the LED is turned off. The counter is then checked for a value of zero, at which tine the T,ED is to be turned on. st zero the counter is reinitialized to a value of 100, the LED is turned on, and the foreground program continues in FIGURE 6B.A register R2 is then checked to see if a sentinel failure has been detected. If so, the LED is turned on continuously to alert the user of the problem. The LED can only be turned off by remedying the electrode problem and restarting the system.The program next decrenents the rate counter. The rate counter counts down from an initial value RATE which is a number calculated by the background program. The RATE number represents the interval between output pulses selected by the operator. If the rate counter has reached zero, output pulses are to be produced, and the counter is reinitialized and the LCD output data is stored. Since bus 1 will now be used for output data, the LCD data on that bus must be stored during this time, and restored on the bus after the output pulse sequence is finished.The program first checks to see if the device is operating in the modulate mode. In this mode, each output pulse differs in pulse width and amplitude from the previous pulse. Hence, a flag is set to inform tulle background program that a pulse has been produced, and that new parameter values must he calculated for the following pulse. If the device is not in the modulate mode, the program checks to see if the device is in the burst mode.In the burst mode, a burst of seven pulses is produced every half second at a rate of 80 Hz. The amplitude of the burst pulses is leterninerl the operator. If the device is in the burst mode, the program checks to see if a pulse sequence is in progress. If the burst pulse sequence is over, no output is produced. If the sequence of seven pulses is not complete, a burst mode flag is cleared and pulse output commences. flell the program does not find the device to be operating in either the modulate or burst mode, the device must be operating in either the normal or the strength duration mode. In either case, a repetitive sequence of treatment pulses is to be produced, and the program proceeds to produce output pulses. The microprocessor controls pulse production at the first output, then pulse production at the second output. At first, a REFG signal on line 31 applies a reference voltage to the D A converter. A digital word is put on bus 1, and is loaded into the D A converter buffer by a WR signal on line 32. An EN1 signal on line 33 then renders gate 42 conductive for the desired duration, or pulse width, and the output signal is produced at the first output. The program then loads a new pulse amplitude value into the D A converter, and the gate enabling sequence is performed on gate 44 to produce the selected pulse at the second output. After pulse output is complete, the REFG signal is dropped, and all zeroes are loaded into the fl A converter. The LCD data is restore on bus 1 for the display, and the foreground program continues.Pulse output comprises a major portion of the foreground program s time, since output pulses can range from 30 to 250 microseconds in duration.The program next checks to see if the count of the rate counter is two. If so, sentinel pulses must now be produced, in advance of the output pulses five milliseconds later. Again, the LCD data on bus 1 is stored so that bus 1 can be used to transfer pulse amplitude values to the D A converter. The program checks to see if the amplitude of the upcoming pulse for the first output will be greater than 4 milliamperes as referenced to an internal milliampere scale. If not, no sentinel is needed, since the output pulses themselves are too low to result in any patient hazard. But if the output pulse is to be greater than 4 na., a sentinel pulse with a 5 ma. amplitude and a 30 user. duration is produced at the first output, using the sane output sequence described above. This process is repeated to generate a sentinel pulse at the second output. If an electrode has come loose from the patient as detected by the comparator 52, an interrupt will have occurred at the INT input. If the interrupt has occurred, a sentinel detected failure flag is set in a register R2.During tne following pass through the foreground program, this flag in register R2 will be detected, the LE.D will turn on, and the output pulse sequence will be bypassed.Continuing on in FIGURE 6C, a 1 2 second counter is decremented. x number of functions occur at half second intervals. If the 1 2 second counter is at zero, it is reinitialized and a treatment time flag is set. During treatment, the patient sees treatment time on the display in elapsed time up to 255 minutes. Treatment time is accumulated in half second intervals by the background program in response to the setting of the treatment time flag.A half second flag is also cleared. To prevent a patient from producing needlessly high amplitude pulses by ramping the output pulse amplitude up too quickly, the pushbuttons that permit the pulse parameters to be changed are allowed to produce a step change only once each half second. Mnis half second flag allows these time increments to be monitored by the background program. When a parameter pushbutton is held down, the parameter will change by one increment every half second. sample mode switch flag is also cleared. This flag tells the background program to interrogate the mode switch every half second. More frequent interrogation has not been found to be helpful or necessary, and in fact reduces the time during which other functions may be performed. After the 1 2 second counter is queried, the mode is again checked to see if the burst node has been selected. If it has, the burst counter is .1ecremented and checked to see if it is at zero. If so, it is reinitialized and the burst flag is set so that a new sequence of seven burst pulses will be produced beginning with the next pass through the foreground program.The foreground program is now completed, and the register bank for the background program is selected. The accumulator is restored to the contents it had at the beginning of the foreground sequence, and the system resumes with the background program at the point where it was before the foreground timer interrupt occurred.The background program is shown in the flowchart of FIGURE 7. .hen the stimulation device is turned on, the micro processor is reset and the background program starts from location zero. Several variables are initialized pulse amplitude is set to zero, pulse width is set at 50 v sec., and the rate is set at 8O Hz. The sentinel is cleared and counters are initialized. The internal timer for the foreground program is enabled with its initial count of 240.The background program then checks the battery voltage.If it is low, the program stops and the LED is lit. If the battery voltage is at a sufficient level, the program checks to see if the one half second flag has been cleared by the foreground program. If the flag has been cleared, the background program reads the keyboard buttons DISP, INC, and DEC, and looks for any change. If the flag has not yet been cleared, a half second has not passed since tulle last button was pushed, all the keyboard is not read.If a new button entry is detected, the program decodes angel notes it, and calculates the appropriate new variables for storage in the RAM. After this calculation, the one half second flag is reset, to be cleared by the foreground program after one half second has been counter down. The background program then checks to see if a minute flag has been set. During treatment, the program records and displays treatment time in minutes. Treatment time is tracked in one half second increments. When a full minute has been accumulated, the treatment time display is incremented to the next minute, up to a maximum of 255 minutes.During treatment this time is flashed perio ically to inform the user that treatment is progressing normally. Mne off time during flashing extends the life of the display.After the minute flag is checked and found not to be set, the data for the LCD display is calculated and loaded into the appropriate locations in the RAM for access by the foreground program. As mentioned above, the LCD display waveforms must he inverter every 20 msec, in synchronism with the change of state of the LCD backplane pulse train of 25 Hz. Thereafter, the background program does processing necessary according to the mode of operation. If treatment is proceeding in the normal or the strength duration mode, the program proceeds to the mode interrogation sequence of the program. If the device is in the burst mode, the program checks to see if the burst sequence of seven pulses has been completed. If the device is in the modulation mode, the program calculates the parameters of the next pulse if the appropriate flag has been set by the foreground program. If the device is in the calibration portion of the strength duration mode,the program calculates any needed pulse widths, amplitudes, and the logarithmic curve for pulse characteristics. After these calculations, the program proceeds to the mode interrogation sequence.The modulation and strength duration modes of operation are more fully described in concurrently filed EuropeanStates patent application , entitled TREATMENTPULSE SEQUENCES FOR A TRANSCUTANEOUS NERVE STIMULATIONDEVICE Reference STM 28, claiming priority from USSN 617 444 .The background program next checks to see if the sample mode switch flag has been cleared by the foreground program. If it hasn t, the program drops down to the battery check step. If the flag has been cleared, the program reads the mode switch. If there has been a node change, the program changes any status words for the mode processing sequence, including the flag, and initializes variables for parameter values. The background program then proceeds to the battery check step.It should be remembered that the foreground program is continually interrupting the background program every tine the internal timer counts an interval of 2.5 milliseconds. ae pulse waveforns of FIGURES 8 13 illustrate how the buses of the microprocessor are being tine shared to provide different functions. The waveforms of FIGURE 8 show a 480 microsecond interval during which time the LCD data for the display is updated. Referring concurrently to FIGURE 3, the data values on buses 1 and 2 are updated as needed at the beginning of the 480 microsecond interval to control the segments of the right hand and center digits of the LCD display. Line 36 sends out a sequence of eight pulses SHR , which are clocked into shift registers 22a and 22b by CLK pulses on line 38. The control line 37 for the XMP1 display is also changed as needed. The 480 microsecond interval of FI 1RE 8 is relate1 to the 25 Hz pulse waveforms which occur continuously on the buses 1 and 2 for the LCD data. A full 25 Hz cycle takes 40 milliseconds, and it can be seen that the level changes and shift register loading occurs at the transition times of the 25 Hz waveforms. At other tines, the signal levels on buses 1 and 2 are stable, except for the similarly short asynchronous intervals when output data is sent to the D A converter 40, and the mode switch is sampled. In the sequencing shown in FIGURES 8 and 9, the LCD characters are changed without any noticeable change or flicker.FIGURES 10 and 11 relate the timing of the battery check and mode switch interrogation to the LCD waveforms. InFIGURE 10, the REFS pulse on line 31 is applied to the regulator transistor 118 in FIGURE 3 to turn on the regulated voltages while the battery voltage is checked.A MSW pulse on line 35 is applied to transistor 74 for 50 microseconds to apply a low level signal to the left hand terminals of the mode switch 24. The arm of the mode switch then connects this low level to one of the lines of bus 2, which is controlled by the microprocessor as an input bus during this time. The nicroprocessor will detect a low signal on the line of bus 2 connected to the appropriate right hand mode switch terminal. All other lines will be in a high state.This sampling of the battery and mode switch occurs only every half second, and therefore has no significant impact on the LCD display. At all other times, bus 2 is an output bus to the LCD display 20. This is seen in FIGURE 11, where the mode sampling periods are related to the 25Hz waveforns normally on bus 2. The lower waveform, BP, is the hackplane pulse train on bus line P25. When the BP signal is in phase opposition to a seglnent signal, as is the case of the solid bus 2 waveform of FIGURE 11, a voltage is impresse across the segment and a dark LCD segment appears. When the bus signal is controlled to be in phase with the BP signal, no voltage is applied across the segment and the segment cannot be seen.FIGURES 12 and 13 relate the pulse output sequence to the 25 Hz LCD waveforms. In FIGURE 12, a typical sequence is shown for an 80 pulse per second rate sequence of 5D microsecond width pulses. The sequence is 360 microseconds in length in this example. At first, a REFG signal on line 31 applies a reference voltage to the fl A converter 40. A pulse amplitude value for the first output AMP1 is put out on bus 1 and is loaded into the fl A converter buffer by a W pulse 201 on line 32. An E91 pulse on line 33 then closes gate 42 for the pulse width time, 50 microseconds, and an output pulse at the first output is produced for the duration of the EN1 pulse.A second WR pulse 203 then loads the pulse amplitude value for the second output AMP2 into the D A converter. An EN2 pulse on line 34 closes gate 44 for the required pulse width, and an output pulse is produced at the second output. Finally, a third WR pulse 205 loads a zero value pulse amplitude into the D A converter, and the REFG pulse ends, removing the reference voltage from the fl A converter.In FIGURE 13, these 360 microsecond output pulse sequences are relate1 to the 25 Hz waveforms. Output sequences 210214 recur every 12.5 milliseconds for the an pulse per second rate of this example. The 25 Hz wavefornl is seen to change polarity every 20 milliseconds. The 360 microsecond interruptions are so rapid relative to the 25 Hz clock that the user sees no flicker in the LCD display.Moreover, as shown in FIGURE 12, the LCD data values are restored to the bus 1 between every loading of the fl A converter.In use of the stimulation device of the present invention, a user places the electrodes on the treatment area of the body. The desired mode is selected by setting the node switch, and the ON OFF switch is turned on. The left AMP indicator for output 1 is displayed first, and the user then increments INC or decrerients DEC the pulse amplitude value using the appropriate buttons. The DISP button is pressed and PW for the first output is displayed. The user then pushes the INC and DEC buttons to set the desired pulse width. A further push of the DISP button displays the RATE indication, and the INC and DEC buttons are pressed to set the desired pulse rate. TheDISP button is pressed two ore times and the amplitude and pulse width for the second output are displayed and adjusted in the same manner. The pulse rate is common to the two outputs.The amplitude values are calibrated over a range of 0 50 ma., and can be incremented and decremented in 1 ma.steps. The pulse width is variable over a range of 30 250 microseconds in steps of 10 microseconds. The rate is variable from two to one hundred Hertz, with selections being 2 Hz, 100 Hz, and 10 80 Hz in steps of 10 Hz.