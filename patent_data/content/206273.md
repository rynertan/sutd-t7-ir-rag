# ADAPTIVE DIFFERENTIAL PULSE CODE MODULATION SYSTEM

## Claims
Adaptives Differentialimpulscode Modulationssystem, mit einem adaptiven Quantisierer 12 und einem adaptiven Prädikator 14 , die eine auf ein Sprachsignal optimierte Codiercharakteristik besitzen und ein Quantisierer 12 sowie ein Prädikator 14 , die eine auf ein Sprachband MODEM Signal optimierte Codiercharakteristik besitzen, wobei das System normalerweise als ein auf das Sprachsignal optimiertes Codiersystem benutzt wird,

## Description
The present invention relates to an adaptive differential pulse code modulation system in which both voice signals and MODEM signals more than 9600 bit sec can be coded. The proceedings of the Sixth International Conference on Digital Satellite Communications include a paper entitled, A 32 KBPS Codec for Satellite Communication by T. Nishitani et al. This paper discusses a codec which combines a predictor with a predictor driven locking quantizer and provides a speech and data discrimination function in the prediction algorithm. To maximize efficient use of a public line, a frequency band of a transmission is compressed by using an ADPCM Adaptive Differential Pulse Code Modulation system, and in addition, voice signals and MODEM signals are transmitted by using this public line. Therefore, conventionally, in a CCITT Counsel G21, it is prescribed that a MODEM signal having a transmission speed of 4800 bit sec may be coded efficiently. However, the transmission speed of the MODEM has recently improved, and a speed of more than 9600 bit sec is used. However, the conventional coder cannot code a MODEM signal of more than 9600 bit sec. An object of the present invention is to provide an adaptive differential pulse code modulation system including an adaptive quantizer and an adaptive predictor which have a coding characteristic optimized to a voice signal and a quantizer and a predictor which have a coding characteristic optimized to a voice band MODEM signal. In this system, a coding system is normally optimized to the voice signal, but when the system detects a MODEM training signal, it becomes a coding system optimized to the MODEM signal. Figure 1 shows a block diagram of one example of a conventional ADPCM coding apparatus. In Fig. 1, 1 and 3 designate adders, 2 an adaptive quantizer, and 4 an adaptive predictor. In Fig. 1, the adaptive quantizer 2 has an optimum coding characteristic. The output of the adaptive quantizer 2 is supplied, via the adder 3, to the adaptive predictor 4, and a predicted output of the adaptive predictor 4 is supplied to the adder 1 and to the adder 3. Figure 2 shows a block diagram of an ADPCM coding apparatus according to one embodiment of the present invention. In the drawing, 11, 13 denote adders, 12 a quantizer which is switchable between a MODEM optimized quantizer state and an adaptive quantizer state, 14 a predictor which is switchable between a modem optimized fixed predictor state and an adaptive predictor state, and 15 is a MODEM training signal detector. In Fig. 2, the quantizer 12 is normally set to operate as an adaptive quantizer having an optimum coding characteristic for the voice signal, and the predictor 14 is set to operate as an adaptive predictor, so that the ADPCM coding apparatus operates as a system for the voice signal. When the MODEM training signal, which must be transmitted just before data signals by modem itself, is input to the apparatus, it is detected by the MODEM training signal detector 15 a detailed explanation thereof is given later , the quantizer 12 is switched to the MODEM optimized quantizer state optimum for the MODEM signal, and the predictor 14 is switched to the fixed predictor state optimum for the MODEM signal, so that the coding apparatus becomes in the optimum state for the MODEM signal, to code the MODEM signal. The signal power of input is always supervised, and when it becomes small enough, the coder recognizes that the transmission of data is terminated, then the coding mode is returned to the original voice mode. Figure 3 shows a system block diagram of a principle based on the diagram shown in Fig. 2. In Fig. 3, reference numerals in a coder block 11, 12, 14, and 15 correspond to those used in Fig. 2 and reference numerals 112 and 114 in the decoder block corresponding to the reference numerals 12 and 14 in the coder block, respectively. In Fig. 3, the quantizer 12 is formed by a quantizer 12a having a characteristic optimized for a voice signal, an inverse quantizer 12b having a characteristic optimized for a voice signal, a quantizer 12c having a characteristic optimized for a MODEM signal, and an inverse quantizer 12d having a characteristic optimized for a MODEM signal. The predictor 14 is formed by a predictor 14a optimized for a voice signal and a predictor 14b optimized for a MODEM signal. The system block diagram shown in Fig. 3 shows a coder block and a decoder block, and a coded switching control signal is transmitted from the coder block to the decoder block by a transmission line. In Fig. 3, the MODEM training signal detector 15 detects the MODEM training signal and further generates a coded switching control signal, which is transmitted via the transmission line. Switches Sa, Sb, Sc, Sd are controlled by the output of the MODEM training signal detector. In the decoder block shown in Fig. 3, the quantizer 112 is formed by inverse quantizers 112b and 112d corresponding to 12b and 12d in the coder block, and the predictor 114 is formed by predictors 114a and 114b corresponding to 14a and 14b in the coder block. Figure 4 is another system block diagram of a principle based on the diagram shown in Fig. 2. The principle of the diagram shown in Fig. 4 is almost the same as that of the diagram shown in Fig. 3, the difference therebetween being that, in the case of Fig. 4, the switching control signal is not sent from the coder block to the decoder block but it is formed in the decoder block. Figure 5 shows one embodiment of the present invention based on the system block diagram shown in Fig. 4. As shown in Fig. 5, the adaptive quantizer 12 is concretely formed by an quantizer 22, a speed controller 23, a first scale adapter 24, a second scale adapter 25, and an inverse adaptive quantizer 26. The background of this circuit is disclosed in Overview of the ADPCM Coding Algorithm W.R. Daumer et al, CH2064 4 84 0000 0774, 1984 IEEE, pages 774 to 775, especially in Fig. 1a on page 774. Therefore, an explanation of this circuit will be given with reference to the description therein. The first and second scale adapters 24 and 25 are set to form a linear combination of fast and slow adaptive scale factors in accordance with whether the signal is the voice signal or the MODEM signal. The fast scale factor and the slow scale factor are computed from equations 2 and 3 on page 775 of the above mentioned reference. The speed controller 23 is used for changing the speed of the fluctuation. When the switch S₁ is set to 0 the speed is fixed to 0 . The set speed is adapted to the speed adapters 24, 25, and a switch S₂ selects the adapter 24 or 25 in accordance with whether the input signal is the voice signal or the MODEM signal. The predictor 14a P₁ , is formed by delay elements 31a, 31b, ..., 31n 34a, 34b, prediction coefficients 32a, 32b, ..., 32n 35a, 35b, adders 33a, 33b, ..., 33n and 36, and coefficient generating logics 37 and 38. In Fig. 5, the elements 31a 31n, 32a 32n, 33a, 33b, ... and 37 form a zero predictor and elements 34a, 34b, 35a, 35b, 36 and 38 form a pole predictor. Further, the predictor 14b P₂ is formed by the above mentioned commonly used elements, the zero predictor and a pole predictor including delay elements 41a, 41b, ... 41n, prediction coefficients 42a, 42b, ... 42n, adders 43a, 43b, and the coefficients C₁ , ... C The reference numerals in Fig. 5B show the same elements as in Fig. 5A but with the suffix 1 , i.e., 31a becomes 131a, ..., etc. The operation of Fig. 5B is similar to that of Fig. 5A, and therefore, an explanation thereof is omitted. Fig. 6A shows a block diagram of the MODEM training signal detector shown in Fig. 5. Fig. 6A corresponds to Figure 4 of an article by the same inventor, Tomoyoshi TAKEBAYASHI et al A 32 kps ADPCM with improvement in coding characteristics for 9600 bps modem signal, ICASSP86 TOKYO, CH2243 4 86 0000 2187, 1986 IEEE. In the circuit shown in Fig. 6A, an alternate pattern prescribed in the Counsel CCITT V. 29 November 1980 is detected The alternate pattern is prescribed on page 171 of the Counsel CCITT V. 29 as follows. Fig. 6B shows a detailed block diagram of the MODEM training signal generator shown in Fig. 6A. In Fig. 6B, the portions 52, 53, 54, 57 and 57 in the block diagram shown in Fig. 6A correspond to those in Fig. 6B. In Fig. 6B, a bandpass filter 52 has a center frequency at a center of a carrier frequency, and a multiplier 72 of PLL circuit 68 has an input connected to the output of the bandpass filter 52. A polarity detector 80 is connected to the output of the multiplier 72. The output of the polarity detector 80 is connected to a multiplexer 75, which also receives a small positive value α. An adder 79 is connected to the output of the multiplier 75, and the output of the adder 79 is fed back via a limiter 78 and a delay element 77 to another input of the adder 79. The output of the limiter 78 and a real value 1 are supplied to a complex value multiplexer 74, and the output of the multiplier 74 is fed back via a complex value multiplier 73 having another input for receiving e On the other hand, the input to the low pass filter 52 is connected to a filter 54 for obtaining a root mean square thereof and to a bandpass filter 53 which has a center frequency at an upper limit of the MODEM signal band. The output of the filter 54 is connected, via a multiplier receiving a constant C, to an input of a comparator 63, and the output of the filter 53 is connected, via a filter 57 for obtaining a root mean square to another input of the comparator 63 having an output connected to another input terminal of the AND gate 70. The output of the AND gate 70 is connected, via a counter 71, to an output terminal. Next, the opeation of the MODEM training signal detector shown in Fig. 6A will be explained in detail. As shown in Fig. 6A, an input signal is a carrier signal in a sampling sequence, and the carrier frequency component is extracted in a secondary cyclic filter 52 having a pole close to the carrier frequency. The output thereof is set as cos ϑ n, Then, if the following equation exists, Therefore, a zero transition of this signal is supervised in a zero transistion discriminator 67 during a predetermined constant period, and if a zero transition does not exist, the carrier frequency component can be detected, wherein ω is an offset frequency component, and is controlled so as to become That is, an imaginary component This is expressed by the following equation. Moreover, an upper limit and a slow limit are set to ω so that an offset frequency which is compensated by this PLL circuit 68 is restricted. This restriction is made by inserting a limiter 78 to the integrator formed by the delay element 77 and the adder circuit 74. Therefore, an incorrect detection, such as the sine wave next to the target to be detected, can be prevented. Further, as e On the other hand, the training signal of 2900 Hz is detected by the circuits 53, 54, 57, 60 and 63 and supplied to the AND circuit 70. The counter 71 examines whether the times detected by the counter 71 are within the predetermined time that is, the time of sending the alternate pattern and when the time is longer than the predetermined time, it is determined that the training signal is detected. In this connection, if the training signal of 1700 Hz is detected by phase and continuous time, it is not affected by noise in the network or level variations in the network, and an incorrect detection can be prevented and an accurate detection made. Further, the training signal 2900 Hz is also detected by phase and continuous time, and thus an incorrect detection of poor 1700 Hz tone is prevented and the training signal is accurately detected. It is considered that the same circuit as that for detecting the training signal 1700 Hz may be used for the detection of the training signal 2900 Hz, however, this increases the hardware, and the detection of the training signal 2900 Hz is not very important. Therefore, it is not necessary to detect the same precisely.