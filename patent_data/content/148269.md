# SERVO DRIVING UNIT

## Claims
Antriebseinheit für einen Servormotor mit einer Schaltung 115 zur Spannungsversorgung zur Versorgung eines Servomotors 101 mit einer Ankerspannung, einem Stromdetektor 112 zur Detektierung des Ankerstromes des Servomotors 101 , einem Detektor 102 für den Rotations Winkel zur Steuerung des Rotations Winkels des Servomotors 101 und einer arithmetischen Steuerung 108 , die einen Speicher 108b zur Speicherung eines Motorsteuerungsprogramms aufweist, einer Schnittstellenschaltung 108d zum Empfang externer Befehle, und einem Prozessor 108a , der mit dem Rotations Winkeldetektor 102 verbunden ist und Befehlen gehorcht, die von der genannten Schnittstellenschaltung 108d geliefert werden, um das Motorsteuerungsprogramm zur Steuerung des Stromes, das von der Spannungsversorgungsschaltung 115 geliefert wird, auszuführen,

## Description
The present invention relates to a servomotor drive unit for servo controlling a servomotor, and more particularly to a servomotor drive unit employing a microprocessor capable of controlling the servomotor. Such a drive unit is shown in EP 0 070 654 which describes a servomotor drive unit of a fixed configuration and using position and velocity commands. Servomotors are widely used for moving and positioning objects in prescribed locations. For driving the servomotor, a servomotor drive circuit is required for servo controlling the servomotor with a command from a numerical control apparatus or the like and a feedback signal indicative of a condition of the servomotor. A servomotor control system is illustrated in the block diagram of Fig. 1 of the accompanying drawings. The servomotor control system receives a positional command PCMD from the numerical control apparatus or the like, and feeds back rotational pulses pulses which are generated each time a servomotor 101 is angularly moved a prescribed angle PC from a rotary encoder coupled to the shaft of the servomotor 101, and an armature current i flowing through the servomotor 101 for controlling a position, a speed, and a current. More specifically, the servomotor control system has an arithmetic unit 104 for calculating the difference between the positional command PCMD and the rotational pulses PC, and executes a prescribed positional loop calculation with a positional loop arithmetic unit 105 based on the calculated difference to issue a speed command VCMD. Then, the servomotor control system detects an actual speed Va of the servomotor 101 with a speed detection arithmetic unit 103 from a period of the rotational pulses PC. The difference between the speed command VCMD and the actual speed Va is calculated by an arithmetic unit 106, and a prescribed speed loop calculation is executed by a speed loop arithmetic unit 107 based on the calculated difference to produce a current command ICMD. Then, the difference between an actual current of the servomotor 101 and the current command ICMD is calculated by an arithmetic unit 109, and a prescribed current loop calculation is executed by a current loop arithmetic unit 110 based on the calculated difference to produce an inverter drive signal. An inverter 115 which is a power amplifier amplifies the inverter drive signal into a prescribed armature current and supplies the armature current to the servomotor 101. The servomotor 101 is thus servo controlled, and such servo control requires positional loop control, speed loop control, and current loop control. The servomotors are used in a variety of applications. Various modes of controlling the servomotors have been developed to meet required functions of devices in which they are incorporated, and are becoming complex. For example, the mode of controlling a controlled object to move toward a target position is different from the mode of controlling the path and speed of an object while it moves toward a target position. Fig. 2 is a block diagram illustrative of a control mode in which a positional control loop and a speed control loop are combined. In the illustrated control mode, a positional command PCMD is differentiated by a differentiator 111b to produce a speed command, the difference between the speed command and an actual speed is calculated by an arithmetic unit 106, the calculated difference is multiplied by a speed gain Kv with a multiplier 11c, and the product is applied to an adder 111e. The difference between the positional command PCMD and rotational pulses PC is calculated by an arithmetic unit 104, the calculated difference is multiplied by a positional gain Kp with a multiplier 111d, and the product is applied to the adder 111e. The adder 111e is also supplied with an acceleration produced by twice differentiating the positional command PCMD with a differentiator 111a. Therefore, the adder 111e adds the positional command, the speed command, and the acceleration command to produce a current command ICMD. The above control mode enables the object to follow a desired path accurately with a small error, and is suitable for application to robotics. Where various control modes are present, however, it is difficult to employ servomotor drive units of the same hardware construction, and servomotor drive units of different hardware constructions matching desired control modes have to be used. Furthermore, servo control required by a servomotor drive unit may be only current loop control, or current and speed loop control, or current, speed, and positional loop control. This also makes it difficult to share one servomotor drive unit with different control modes. The servomotor drive units have therefore been difficult to mass produce, and could not be manufactured less costly. Accordingly, it is an object of the present invention to provide a servomotor drive unit having a hardware arrangement sharable by various control modes. According to the present invention, there is provided a servomotor drive unit including a voltage supply circuit for supplying an armature voltage to a servomotor, a current detector for detecting the armature current in the servomotor, a rotational angle detector for detecting the rotational angle of the servomotor, and an arithmetic controller having a memory for storing a motor control program, an interface circuit for receiving external commands, and a processor connected to the rotational angle detector and responsive to commands supplied from the said interface circuit for executing the motor control program to control the current supplied from said voltage supply circuit, characterised in that the current detector is likewise connected to the processor and the arrangement is such that the servomotor drive unit can follow any of a positional command, a speed command, and a current command received through the said interface circuit, by virtue of a motor control program which is stored in the memory for carrying out by the processor, the program defining a predetermined series of processor steps which is such as to enable the servomotor drive unit to follow said positional command such as to enable the servomotor drive unit to follow said speed command if an initial number of the predetermined series of processor steps is omitted and such as to enable the servomotor drive unit to follow said current command if said initial number, together with more, of the predetermined series of processor steps are omitted whereby a single motor control program can be modified to provide all of positional command control, speed command control and current command control. Therefore, the servomotor drive unit can effect a variety of servo control modes with a single hardware arrangement simply by modifying the control program to meet the control modes. The servomotor drive unit of the invention can be shared by different control modes, and hence can be mass produced at a large cost reduction. The servomotor drive unit is of the same hardware arrangement regardless of different control modes. Accordingly, maintenance parts may be reduced in number, and it is not necessary to stock maintenance parts suited for individual control modes. Any repair or servicing of the servomotor drive unit at the time the same has a trouble or is serviced is simplified. The present invention will be described in greater detail with reference to the accompanying drawings. Fig. 3 is a diagram explanatory of the principle of the present invention. Fig. 3 A shows a positional command interface, and Fig. 3 B shows a current command interface. Designated at SVU is a servomotor drive unit composed of an arithmetic controller having a microprocessor 108a, an interface circuit 108d, a counter 108g, an analog to digital converter AD converter 108f, and an inverter voltage supply circuit 115. In Fig. 3 A , the servomotor drive unit SVU effects positional, speed, and current control loop calculations dependent on a positional command PCMD fed through an interface circuit 151 from a main processor 150 in a controller CTU of a numerical control apparatus, for thereby servo controlling a servomotor 101. In Fig. 3 B , a host processor 154 is responsive to a positional command from a main procssor 153 in a controller CTU for effecting positional and speed control loop calculations combined as shown in Fig. 2, for example, to produce a current command ICMD. The current command ICMD is fed through an interface circuit 155 to the servomotor drive unit SVU which executes a current control loop calculation for servo controlling the servomotor 101. With the servomotor drive unit SVU constructed only of the arithmetic controller and the voltage supply circuit, any input of the positional command PCMD, the speed command VCMD, and the current command ICMD can be followed simply by modifying a control program for the arithmetic controller. Therefore, the hardware of the servomotor drive unit can be shared. An embodiment of the present invention will be described hereinbelow. Fig. 4 is a diagram showing an embodiment of the present invention, in which a servomotor comprises a synchronous motor. Identical parts in Fig. 4 are denoted by identical reference characters in Fig. 3. A servomotor 101 comprising a synchronous motor is supplied with DC voltages produced by rectifying three phase alternating currents from a three phase AC power supply with a rectifier circuit 117. The servomotor 101 is servo controlled by drive signals supplied from an inverter voltage supply circuit 115 controlled by a control signal issued through a timer circuit 114 from an arithmetic controller 108. The arithmetic controller 108 is composed of a processor 108a for effecting arithmetic operations according to a motor control program, a program memory 108b for storing the motor control program, a data memory 108c for storing data, an interface circuit 108d for receiving commands from an external source such as a numerical control apparatus, an input output port 108e for issuing a pulse width modulation command to a timer circuit 114, an analog to digital AD converter 108f for converting actual phase currents I au, I av, I aw from current detectors 112U, 112V, 112W, described later, into digital values, a counter 108g for being initially loaded with a positional code indicative of a rotational position α of the field pole of the synchronous motor 101 and for counting rotational pulses PC generated from the pulse coder 102 each time the synchronous motor 101 is angularly moved a predetermined angle, and an address data bus 108h connecting the above components. The current detectors 112U, 112V, 112W detect the actual phase currents I av, I aw, I au of the phases and supply the current signals to the AD converter 108f in the arithmetic controller 108. The timer circuit 114 issues a pulse width modulation signal having a width or duration dependent on a pulse width modulation command from the arithmetic controller 108 to the inverter 115. The inverter 115 is composed of six power transistors Q₁ Q₆ and six diodes D₁ D₆. The power transistors Q₁ Q₆ are turned on and off by the pulse width modulation signal from the timer circuit 114 for giving drive currents to the synchronous motor 101. A rectifier circuit 117 is composed of a diode group 117a and a capacitor 117b for rectifying three phase alternating currents from the three phase AC power supply 116 into direct currents to impress a DC voltage on the inverter 115. Operation of the servomotor drive unit shown in Fig. 4 will be described. First, a mode in which the servomotor drive unit is used with a positional command interface will be described. When the synchronous motor 101 is rotated, the counter 108g in the arithmetic controller 108 has been loaded with a positional code from the pulse coder 102 immediately before the synchronous motor 101 starts rotating, and has been counting rotational pulses PC generated as the synchronous motor 101 rotates. Therefore, the counter 108g is indicative of the rotational position of a field pole of the synchronous motor 101 and represents an interval of movement. Since the period of the rotational pulses PC is proportional to the speed of the synchronous motor 101, increments in the count of the counter 108g in a prescribed time interval correspond to the rotational speed of the synchronous motor 101. The processor 108a executes the current loop calculations in the steps 5 11 in each sampling period T and also executes the speed loop calculations in the steps 1 5 in each period nT n 1 according to the control program in the program memory 108b for controlling the inverter 115 to rotate the synchronous motor 101 to at a command speed. Where the servomotor drive unit is used with the positional command interface, a motor control program may be stored in the program memory 108b for enabling the processor 108a to execute the steps 1 11 . The speed command interface will be described. In the speed command interface, the speed command VCMD is supplied through the interface circuit 108d. Since the supplied speed command VCMD is the speed command Vc determined in the step 3 , the processor 108a may execute the steps 4 11 on the speed command VCMD. Therefore, a motor control program may be stored in the program memory 108b for enabling the processor 108a to execute the steps 4 11 . In the current command interface, the current command ICMD is supplied through the interface circuit 108d. Since the supplied current command ICMD is the effective current command Ir determined in the step 5 , the processor 108a may execute the steps 6 11 on the supplied current command ICMD. Therefore, a motor control program may be stored in the program memory 108b for enabling the processor 108a to execute the steps 6 11 . The program 1 3 for calculating the positional control loop may be of another control type, and likewise the programs for calculating the speed and current control loops may be of other control types. Although the synchronous motor has been described in the above embodiment, the motor may be an induction motor or a DC motor. The servomotor drive unit of the present invention can effect a variety of control modes with one hardware arrangement including a microprocessor simply by modifying a motor control program to meet a control mode. The servomotor drive unit is suitable for use with robots and machine tools controlled by numerical control apparatus.