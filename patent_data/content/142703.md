# A METHOD FOR DETERMINING AN UNKNOWN VOLTAGE AND DUAL SLOPE ANALOG TO DIGITAL CONVERTER

## Claims
Verfahren zum Ermitteln einer unbekannten Spannung mit einem eine doppelte Steigung aufweisenden Analog Digital Wandlertyp, der einen Gesamtumwandlungszyklus aufweist, der eine Integrierungsphase, während der ein Speicherelement mit einem unbekannten Strom, proportional zu der unbekannten Spannung, für eine feste Zeitperiode geladen wird, eine Deintegrierungsphase, in der das Speicherelement mit einem bekannten Strom für eine variable Zeitperiode entladen wird, wobei die unbekannte Spannung direkt proportional zu der variablen Zeitperiode ist, und eine Ausgabephase enthält, in der ein digitaler Ausgangswert entsprechend der unbekannten Spannung eine Ausgangsgröße aus dem Wandler ist, und wobei der Wandler ferner Mittel zum Messen der variablen Zeitperiode, Mittel zum Ausbilden mehrerer Zeitsteuerungsbereiche, Mittel zum Abtasten des Bereiches für die unbekannte Spannung vor der Integrierungsphase und Mittel aufweist zum Abtasten der Amplitude der Ausgangsspannung am Ende der Integrierungsphase,

## Description
The present invention relates to a method for determining an unknown voltage according to the first part of claim 1 and to a dual slope analog to digital converter according to the first part of claim 8. Such method and converter are known from US A 3 582 947 or DE A 2 132 513. Integrating analog to digital converters have two characteristics in common. First, their output represents the integral or average of an input voltage over a fixed period of time. Thus, an integrating converter will give repeatable results in the presence of high frequency relative to the measurement period noise. Secondly, they use time to quantize the answer resulting in extremely small non linearity errors and no possibility of missing output codes. Furthermore, the integrating analog to digital converter has very good rejection of frequencies whose periods are an integral multiple of the measurement period. This feature can be used to advantage in reducing line frequency noise. The unique characteristics of the integrating converter have made it the natural choice for panel meters and digital voltmeter applications. The most popular integrating converter is the dual slope type. In such a converter, conversion takes place in three distinct phases. The first phase is an autozero phase during which the errors in the analog components will be automatically nulled out by grounding the input and closing a feedback loop such that error information is stored on an auto zero capacitor. The second phase is the signal integrate phase during which an integrator capacitor is charged with an unknown current, proportional to an unknown voltage V The third phase is the deintegrate phase during which the integrator capacitor is discharged with a known current for a variable period of time. More specifically, at the beginning of the deintegrate phase, the integrator input is switched from V The advantage of a dual slope analog to digital converter is that the theoretical accuracy depends only on the absolute value of the reference voltage and the equality of the individual clock pulses within a given conversion cycle. The latter can easily be held to one part in 10⁶, so in practical terms, the only critical component is the reference voltage. Changes in the value of other components, such as the integration capacitor or the comparator input offset voltage have no effect, provided they don t change during an individual conversion cycle. In spite of the above, several problems are encountered when one desires to develop a very inexpensive digital multimeter and one having several ranges of operation. The only way to bring cost down is to replace as many switches as possible and eliminate costly precision components and to more fully integrate. That is, in the past, in order to handle a number of different ranges, a number of resistor divider networks have been used at the input of a multimeter. These resistor dividers must be precision resistors, resulting in a high cost and the resistors cannot be included in an integrated circuit. Another alternative is to change ranges by changing the time during the integrate phase. With such a technique, the instrument can automatically change ranges until the correct range is found. However, all previous autoranging instruments require the full integrate deintegrate time period to make a measurement and determine whether or not the input is within the desired range. If the instrument is on the wrong scale, it will continue indicating over range until it changes to the correct range. This is quite undesirable because it is time consuming and an annoyance to the user of the instrument. It is therefore an object of the invention to solve the problems encountered heretofore in providing an auto ranging dual slope analog to digital converter. According to the present invention, as claimed these problems are solved by the provision of a novel, dual slope analog to digital converter. The present analog to digital converter has a minimum number of input switches and precision components to provide for more complete integration, resulting in an extremely low cost. The present converter is a multiple range system and the ranges are selected automatically. All one has to do is select current or voltage and AC or DC and the converter does the rest. It will automatically switch from one range to another and will do this quickly until it finds the right range whereupon it determines the value of the input signal and provides a display. With the present technique, one can contact an input and within 1 3 of a second the right value on the right range is provided without ever indicating out Briefly, in a method for determining an unknown voltage of the type having an integrate phase during which a capacitor is charged with an unknown current, proportional to an unknown voltage, for a fixed period of time and a deintegrate phase during which the capacitor is discharged with a known current for a variable period of time, the unknown voltage being directly proportional to the variable period of time, and provisions for measuring the variable period of time, there is disclosed an improvement comprising a establishing a plurality of timing ranges, each differing from at least one other by one order of magnitude b using the shortest timing range as the fixed period of time during a first integrate phase c determining, at the end of a first deintegrate phase, whether the variable period of time is greater or less than a predetermined minimum period of time d using the next longer timing range as the fixed period of time during a second integrate phase if the variable period of time at the end of the first deintegrate phase is less than the predetermined minimum period of time e determining, at the end of a second deintegrate phase, whether the variable period of time is greater or less than the predetermined minimum period of time and f repeating steps d e for each of the timing ranges until the variable period of time, at the end of a deintegrate phase, is greater than the predetermined minimum period of time or the converter reaches the last range and g indicating the value of the unknown voltage from the measured variable period of time when it is greater than the predetermined minimum period of time. It is a feature of the present invention to solve the problem by providing a dual slope analog to digital converter which performs a short cycle determination until it finds the right range and then uses the complete cycle to display an output. An advantage to be derived is a converter having a minimum number of switches and precision components. A further advantage is a converter which is more fully integrated. Another advantage is a converter having a very low cost. Another advantage is a converter which can provide a measurement within 1 3 of a second. still another advantage is a converter which does not normally indicate out of range while searching for the correct range. Still other objects, features, and attendant advantages of the present invention will become apparent to those skilled in the art from a reading of the following detailed description of the preferred embodiment constructed in accordance therewith, taken in conjunction with the accompanying drawings wherein Referring now to the drawings and, more particularly, to Figure 1 thereof, there is shown a dual slope analog to digital converter, generally designated 10, suitable for implementing the present invention. Converter 10 has two inputs V An oscillator 20 provides a stable and constant frequency to counters 21 which are constantly counting the output of oscillator 20. The outputs of counters 21 are applied to control logic 19. Control logic 19 performs the necessary calculations, to be described more fully hereinafter, and controls the opening and closing of switches 12, 13 and 15 via signals over line 22. Control logic 19 also indicates the digital value of the count when a correct count is reached and the range on lines 23 and 24, respectively. This information can be sent to a microprocessor or to a display. Elements 19 21 could be an 8048 microprocessor. Converter 10 is similar to other dual slope convertors in that by manipulation of switches 12, 13 and 15, three phases can be realized autozero, integrate and deintegrate . During the autozero phase, both of switches 12 and 13 are closed and switch 15 is open. This grounds the input to integrator 14 and closes the feedback loop such that error information is stored on capacitor 17 and an autozero capacitor not shown . For the purposes of this invention, this phase is unimportant except in the fact that errors due to offset voltages of integrator 14 and comparator 18 are stored and subtracted from the input voltage V During the integrate phase, switches 12 and 15 are open and switch 13 is closed. During this phase, capacitor 17 is charged with a current through resistor 11 for a fixed period of time. Control logic 19 controls the opening and closing of switches 12, 13 and 15 and performs the control function by decoding pulses from counters 21. At the end of the integrate phase, the voltage V at the output of integrator 14 will be directly proportional to V At the conclusion of the integrate phase, comparator 18 senses the sign of the voltage at node V. The polarity of V During the deintegrate phase, switches 12 and 15 are closed and switch 13 is open. During this phase, the reference voltage V It is the desire of the present invention to not only determine the value of V What about the situation where instead of wanting to read 2 volts, V According to the present invention, these problems are solved by adjusting the time period of the signal integrate phase. The concept of the present invention can best be described using an example. According to the preferred embodiment of the invention, converter 10 has four different ranges, all of which have the same peak voltage V, the ranges being defined by 10, 100, 1,000 and 10,000 clock pulses during the integrate phase. Because one can divide time wise very easily with high accuracy, this is an ideal method of changing ranges. Furthermore, using the method of the present invention, the ranges can be changed rapidly until the proper range is found. The method implemented by converter 10 may be best understood with reference to Figure 3. Assume for the moment that it takes 4,000 counts during the deintegrate phase to provide a full scale reading of the input voltage. When converter 10 is applied to an input voltage, the above described auto zero, integrate and deintegrate process proceeds with 10 clock pulses used as the fixed number of clock pulses during the signal integrate phase. At the conclusion of the integrate phase, deintegration proceeds at the known rate until a zero crossing is reached. Ten percent of a full scale reading, using this example, would be 400 counts. If the number of counts is less than 400, one would immediately know that if switched to the second range, and that range permitted counting for ten times longer during the signal integrate phase, the output would be closer to a full scale reading. In order to prevent inaccuracies, a percentage slightly less than ten percent is selected. As shown in Figure 3, therefore, at the end of the first deintegrate phase, control logic 19 determines whether the count between the beginning of the deintegrate phase and the zero crossing is greater than 380 counts. If yes, control logic determines that the voltage is high enough that a sufficient reading has been obtained and the count and range are transmitted over lines 23 and 24, respectively, to a suitable microprocessor or display. On the other hand, if the count is not greater than 380 counts and this is not the last range, control logic 19 signals switches 12, 13 and 15 to repeat the sequence and now the signal integrate phase proceeds for 100 counts. At the end of the signal deintegrate phase, control logic again determines whether the count at the output of comparator 18 is greater than 380 counts. If it is, the count and range are transferred. If it is not and this is not the last range, switches 12, 13 and 15 are immediately signalled to start over again. This procedure continues for the four ranges until 10,000 clock pulses are counted during the signal integrate phase. If, at the end of the deintegrate phase, the count is greater than 380, the count and range are transferred. If it is not, the count and range are transferred anyway. The display does not display anything until the right range is found or the instrument runs out of ranges. According to the preferred embodiment of the invention, a still further feature is incorporated in converter 10. That is, although the unknown input voltage is assumed to be a DC voltage, realistically there is always noise and or AC interference superimposed on the wanted DC voltage. Therefore, V Accordingly, it is preferred that the frequency of the clock pulses during the signal integrate phase be selected so that 1,000 clock pulses occur during one complete cycle of a 60 Hz signal, i.e. 60 kHz. Obviously, the frequency can be selected to correspond to any other frequency to be cancelled. Thus, when the selected range is the 1,000 clock pulses range, signal integration occurs for a complete cycle of a 60 Hz signal. In this way, if there is some AC signal superimposed on the DC signal, it will automatically cancel out. Such a technique provides converter 10 with very high quality, normal mode rejection. Using such a technique, one automatically achieves normal mode rejection for the 1,000 count and 10,000 count range. It is obvious, however, that this does not automatically occur when counting on the 10 count or 100 count ranges. In order to achieve normal mode rejection in the first two ranges, converter 10 does not integrate continuously during the integrate phase. More specifically, during the first range, when only 10 clock pulses are counted, what control logic 19 does is to signal switch 13 to close for the duration of 1 clock pulse every 100 clock pulses. By using such a technique, the signal integration occurs for the entire 1,000 clock pulse period. In between times, namely for the 99 clock pulses between each 100 clock pulses, converter 10 simply does nothing. This permits converter 10 to achieve normal mode rejection. When converter 10 switches over to the second range in which 100 clock pulses are counted, control logic 19 signals switch 13 over line 22 to close for the duration of 10 clock pulse for every 100 clock pulses. For the remaining 90 clock pulses between each 100 clock pulses, converter 10 simply does nothing. Obviously, when the third range is reached, every clock pulse is counted and the same occurs in the fourth range where 10,000 clock pulses are counted 10 complete cycles of a 60 Hz signal . It can therefore be seen that according to the present invention, the problems encountered heretofore are solved by the provision of a novel, dual slope analog to digital converter. Converter 10 has a minimum number of input switches and precision components to provide for more complete integration, resulting in an extremely low cost. Converter 10 is a multiple range system and the ranges are selected automatically. All one has to do is to select current or voltage and AC and DC and converter 10 does the rest. It will automatically switch from one range to another and will do this quickly until it finds the right range whereupon it determines the value of the input signal and provides a display. With converter 10, one can contact an input and within 1 3 of a second the right value on the right range is provided without ever indicating out of range while the range is searched for.