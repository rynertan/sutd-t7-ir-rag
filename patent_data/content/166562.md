# Device and method for collecting a desired weight amount of a material.

## Abstract
A method and device of collecting a desired end point weight amount of material first conveys the material into the collection container until a predetermined weight amount WP is collected. The predetermined weight amount is less than the desired end point weight amount WF by a selected initial weight offset amount WO . An additional incremental amount of material WI is next conveyed into the container for a predetermined fixed time period TF . In doing so, the method and apparatus gauge the particular flow characteristics of the associated flow system. A further additional incremental amount of material is conveyed into the collection container for another time period TC , the length of which reflects the expected flow characteristics of the system, based upon the performance of the system during the preceding period. The method and apparatus repeat this sequence until the then existing weight amount equals or exceeds the desired end point weight amount.

## Claims
CLAIMS 1. A method of collecting a desired end point weight amount of a material in a collection container, said method comprising the steps of a conveying the material into the collection container until a predetermined weight amount Wp is collected, the predetermined weight amount being less than the desired end point weight amount WF by a selected initial weight offset amount we , b conveying for an initial fixed time period TF an initial incremental weight amount WI of material into the container, the initial incremental weight amount being less than the selected initial weight offset amount W0 , c comparing the then existing weight amount WE of material in the container to the desired end point weight amount WF to derive a present weight offset amount WD , d conveying additional material into the collection container for a calculated time period Tc , the length of which represents the product of the initial fixed time period TF multiplied by the quotient of the present weight offset amount WD and the initial incremental weight amount WI , and either i e repeating steps c and d until the then existing weight amount equals or exceeds the desired endpoint weight amount, or ii f comparing the then existing weight amount of material in the container to the desired end point weight amount to derive a new weight offset amount, g should the new weight offset amount be greater than zero, conveying additional material into the collection container for a new calculated time period, the length of which represents the product of the last calculated time period multiplied by the quotient of the new weight offset amount and the incremental weight amount delivered during the last calculated time period, and h repeating steps f and g until the then existing weight amount equals or exceeds the desired endpoint weight amount. 2. A method according to Claim 1 wherein at least one of the said steps c and f includes the step of reducing the desired end point weight amount by a selected overshoot prevention weight amount WB to derive an adjusted desired end point weight amount, and wherein, in the one of said steps c and f , the then existing weight amount is compared to the adjusted desired endpoint weight amount to derive the weight offset amount. 3. A method according to Claim 1 or 2 and further including the step, between said steps c and d and between said steps f and g where appropriate, of terminating the conveyance of material into the collection container for a preselected delay time period TD , and wherein said step e includes repeating said step c said conveyance termination step, and said step d , or wherein said step h includes repeating said step f , said conveyance termination step and said step g , until the then existing weight amount equals or exceeds the desired end point weight amount. 4. A method according to Claim 1, 2 or 3 further including, between said steps a and b , the further step of terminating the conveyance of material into the collection container for a preselected delay time period RD 5. A method according to Claim 1, 2, 3 or 4, further including, between said steps b and c , the further step of terminating the conveyance of material into the collection container for a preselected delay time period RD . 6. A method according to any preceding claim, wherein at least one of said steps d and g includes the step of comparing the calculated time period etc to a predet ermined maximum time period TMAX or a predetermined minimum time period TMIN , and conveying additional material into the collection container for the calculated time period when the calculated time period is less than the predetermined maximum time period or greater than the predetermined minimum time period, otherwise conveying additional material into the collection container for the predetermined maximum time period or the predetermined minimum time period respectively. 7. A method according to any one of Claims 1 to 5, wherein at least one of said steps d and g includes the step of comparing the calculated time period Tc to both a predetermined maximum time period TMAX and a predetermined minimum time period TMIN , and conveying additional material into the collection container for the maximum time period when the calculated time period exceeds the maximum time period, conveying additional material into the collection container for the minimum time period when the calculated time period is less than the minimum time period, and conveying additional material into the collection container for the calculated time period when the calculated time period is less than the maximum time period and greater than the minimum time period. 8. A device for collecting a desired end point weight amount of a material in a collection container 20 , said device comprising first means 32 for sensing the weight of material in the collection container, second means for controlling conveyance of the material into the collection container 20 until a predetermined weight amount Wp is collected, the predetermined weight amount being less than the desired end point weight amount WF by a selected initial weight offset amount we , third means for controlling for an initial fixed time period TF conveyance of an initial incremental weight amount of material WI into the container, the I initial incremental weight amount being less than the selected initial weight offset amount WD , fourth means for comparing the then existing weight amount WE of material in the container to the desired end point weight amount WF to derive a present weight offset amount WD , fifth means for controlling conveyance of additional material into the collection container for a calculated time period TC , the length of which represents the product of the initial fixed time period TF multiplied by the quotient of the present weight offset amount WD and the initial incremental weight amount WI , and either i sixth means for sequentially operating said fourth and fifth means until the then existing weight amount equals or exceeds the desired end point weight amount, or ii seventh means for comparing the then existing weight amount of material in the container to the desired end point weight amount to derive a new weight offset amount, eighth means operative should the new weight offset amount be greater than zero, for controlling conveyance of additional material into the collection container for a new calculated time period, the length of which represents the product of the last calculated time period multiplied by the quotient of the new weight offset amount and the incremental weight amount delivered during the last calculated time period, and ninth means for sequentially operating said sixth and seventh means until the then existing weight amount equals or exceeds the desired end point weight amount. 9. A device according to Claim 8, wherein at least one of said fourth means and said seventh means includes means for reducing the desired end point weight amount by a selected overshoot prevention weight amount to derive an adjusted desired end point weight amount, and wherein, in the one of said fourth and seventh means, the thenexisting weight amount is compared to the desired endpoint weight amount to derive the weight offset amount. 10. A device according to Claim 8 or 9, further including means for comparing the calculated time period to a predetermined maximum time period or to a predetermined minimum time period and conveying additional material into the collection container for the calculated time period when the calculated time period is less than the predetermined maximum time period or greater than the predetermined minimum time period, otherwise conveying additional material into the collection container for the predetermined maximum time period or the predetermined minimum time period respectively. 11. A device according to Claim 8 or 9, further including means for comparing the calculated time period to both a predetermined maximum time period and a predetermined minimum time period, and conveying additional material into the collection container for the maximum time period when the calculated time period exceeds the maximum time period, conveying the additional material into the collection container for the minimum time period when the calculated time period is less than the minimum time period, and conveying additional material into the collection container for the calculated time period when the calculated time period is less than the maximum time period and greater than the minimum time period.

## Description
DEVICE AND METHOD FOR COLLECTING A DESIRED WEIGHT AMOUNT OF A MATERIALFIELD OF THE INVENTION The invention pertains to methods and devices for delivering predetermined amounts of materials.BACKGROUND AND OBJECTS OF THE INVENTION In many environments, it is desirable to deliver or mix materials in relatively precise amounts. For example, in hospitals and pharmacies, syringes, medical containers, or other receptacles are routinely filled with precise amounts of parenteral fluids. In these and other areas, the performance of the material delivery system is measured in terms of its speed, accuracy, and reliability. The speed, accuracy and reliability of conventional material delivery systems are dependent upon the particular performance characteristics of the associated pumping mechanisms, if any the particular physical characteristics the pathways which convey the material and the nature of the material itself. For example, in the case of conventional peristaltic pumping mechanisms, which are in widespread use, the desired physical characteristics and tolerances of the tubing segments associated with the pump rotors can be initially controlled by following careful manufacturing methods. However, once in use, the dimensions and other physical characteristics of the tubing segments are subject to change for example, due to repeated expansion and contraction by the peristaltic pump rotors or by temperature changes. These changes can introduce metering errors which are either random or change with time. Furthermore, even though a given peristaltic pump may also provide consistently accurate and reliable service when used to convey a particular material through a tubing segment of given physical characteristics, its accuracy and reliability can significantly change if a tubing segment having different physical characteristics is substituted, or if a material having different flow characteristics is conveyed. It is an object of this invention to provide a flow control method and device for a material delivery system, the method and device having a consistently high degree of speed, accuracy, and reliability, independent of the particular physical characteristics of the associated delivery system and any changes which may therein occur. SUMMARY OF THE INVENTION To achieve this and other objects, the invention provides a method and associated device which are usable in association with virtually any fluid delivery system. The method and device quickly and consistently deliver materials in precise amounts and are not significantly effected by the various factors which, alone or in combination, can unexpectedly introduce metering errors in the associated system. The method and device which embody the features of the invention, follow four basic operative steps. In the first step, material is conveyed into a collection container until a predetermined weight amount is collected. The predetermined weight amount is less than the desired finished or end point weight amount by a selected initial weight offset amount. In the second step, additional material is conveyed into the container for a predetermined fixed time period. During this step, the method and device measure the incremental weight amount of material which is conveyed during the fixed time period. In doing so, the method and device test the associated fluid delivery system to make a preliminary determination of its specific flow characteristics. The method and device then control subsequent delivery of material based upon this determination. More particularly, in the third step, the method and device compare the desired end point weight amount to the weight amount of material present in the container after the second step. The difference constitutes the present weight offset amount. In the fourth step, additional material is conveyed into the collection container for a calculated time period. The length of the calculated time period reflects the specific flow characteristics of the system determined during the second step. More particularly, in accordance with the invention, the length of the calculated time period represents the product of the fixed time period employed in the second step multiplied by the quotient of the present weight offset amount obtained in the third step and the incremental weight amount conveyed during the second step. The third and fourth steps are repeated until the then existing weight amount equals or exceeds the desired end point weight amount. In one preferred embodiment, in each repetition of the third and fourth steps, the calculated time period and corresponding incremental weight amount collected during the preceding iteration are used to derive the new calculated time period. The method and device which embody the features of the invention readily adapt themselves to the specific flow characteristics of the associated flow system. In so doing, the method and device can deliver the desired precise amounts of materials independent of the particular flow characteristics of the fluid delivery system or the nature of materials being conveyed. The method and device which embody the features of the invention provide for the fast, accurate and reliable delivery of precise amounts of materials. The speed, accuracy, and reliability of the method and device are not significantly effected by differences in flow tubing dimension, by differences in pump operation, or by the physical characteristics of the material conveyed. Other features and advantages of the invention will become apparent upon reviewing the following, more detailed description, the drawings, and the appended claims. BRIEF DESCRIPTION OF THE DRAWINGS Fig. 1 is a perspective view of a fluid transfer device having a pump control system which embodies the features of the invention Fig. 2 is a diagrammatic view of the device and the associated pump control system Fig. 3 is a flow diagram of one preferred embodiment of the weight evaluation circuit which forms a part of the pump control system of the invention and Fig. 4 is a flow diagram of another preferred embodiment of the weight evaluation circuit. Before explaining the embodiments of the invention in detail, it is to be understood that the invention is not limited in its application to the details of the construction and to the arrangement of components as set forth in the following description or as illustrated in the accompanying drawings. The invention is capable of other embodiments and of being practiced and carried out in various ways. Furthermore, it is to be understood that the phraseology and terminology employed are for the purpose of description and should not be regarded as limiting. DESCRIPTION OF THE PREFERRED EMBODIMENTS A fluid transfer device 10 having a pump control system 12 which embodies the features of the invention is shown in Fig. 1. In use, the pump control system 12 serves to convey a desired amount of fluid from one or more supply containers 14, 16, and 18 into a collection container 20. While the pump control system 12 which embodies the features of the invention can be used in diverse environments, in the illustrated embodiment, the associated device 10 is used to compound different hyperalimentation solutions from up to three supply containers 14, 16, and 18 into the collection container 20 for intravenous delivery to a patient. In this respect, except for the particulars of the pump control system 12 to be described, the device 10 is similar in general operation to the one disclosed inMiller et al, U.S. Patent Application Serial No. 391,759, filed June 24, 1982, and entitled, HIGH SPEED BULK COtsPOUNDER. In use, the device 10 first conveys solution from the first source container 14 into the collection container 20 until a desired amount is delivered.The device 10 then conveys desired amounts of solution in sequence from each of the remaining second and third source containers 16 and 18. The result is a desired final mix of solutions in the collection container 20. It is the purpose of the pump control system 12 to assure that only the desired amount of each solution is quickly, accurately, and reliably conveyed into the collection container 20 from the supply containers 14, 16, and 18. Each supply container 14, 16, and 18 communicates with the collection container 20 through a fluid transfer conduit, respectively 15, 17, and 19, which is preferably flexible tubing or the like. Fluid transfer is accomplished by pumps, respectively 22, 24, and 26, which are operatively connected to the conduits 15, 17, and 19 between each supply container 14, 16, and 18 and the receiving container 20. The pumps 22, 24, and 26 can be of any positive fluid pumping type. Preferably, however, they are peristaltic pumps for use in sterile applications, as shown in Fig.1. As also shown in Fig. 1, the device 10 includes a pump module 28, on which the peristaltic pumps 22, 24, and 26 are mounted. The supply containers 14, 16, and 18 are also suspended by hangers from a support bracket 30 on the pump module 28. The pump module 28 also includes a weight sensor or detector 32, such as a conventional load cell, strain gauge or the like, on which the receiving container 20 is suspended. As shown in Fig. 1, the device 10 also includes a control module 34 which receives and supplies control signals from the pump module 28 through a control cable 36. The control module 34 includes, for each of the supply containers 14, 16, and 18, a display, respectively 38, 40, and 42, which shows the desired volume of each solution which is to be conveyed into the collection container 20, along with a display, respectively 39, 41, and 43, which shows the specific gravity of each solution being conveyed. A display 45 shows the volume amount of solution in the collection container 20. The control module 34 also includes a keyboard 44 and associated data entry buttons 46, 48, and 50, through which the operator can enter the desired volume and specific gravity data into the displays 38, 40, and 42. As shown diagrammatically in Fig. 2, weight indicative voltage signals are developed by conventional means by the weight sensor 32. These signals are conveyed to an amplifier 52 and an analog to digital converter 54. The weight indicative voltage signals are fed through the amplifier 52 and converter 34 and are thereby converted by conventional means to digital weight indicative signals. These digital signals are then conveyed to the pump control system 12. The pump control system 12 includes a weight evaluation circuit 56, which receives the weight indicative digital signals, and a pump operation circuit 58, which receives the output signals of the weight evaluation circuit 56 and drives the selected pump 22. In Fig. 2, the selected pump is pump 22 associated with supply container 14 and flow tubing segment 15. Attention is now directed to Fig. 3, where a flow diagram of a preferred embodiment of the weight evaluation circuit 56 is shown. As shown in Fig. 3, the selected pump 22 is initially operated in a continuous mode. During this mode, material is continuously conveyed from the associated supply container 14 into the collection container 20. The weight evaluation circuit 56 continuously monitors the weight amount of material WT present in the collection container 20. When the weight amount of material in the collection container 20 equals a predetermined weight amount Wp , the continuous mode ceases and an intermittent pumping mode begins. In accordance with an aspect of the invention, the predetermined weight amount Wp, at which the active pump 22 is switched from the continuous to the intermittent mode, equals the desired end point weight amount WF minus a preselected initial offset amount we i.e., Wp WF WO, as shown in Fig. 3. Once in the intermittent mode, as shown in Fig. 3, the active pump 22 is preferably initially stopped for a predetermined time delay interval TD to allow the weight sensor 32 to stabilize and provide an accurate weight indicative output signal.The then existing weight, which will be at or near Wp, is latched and retained in the weight evaluation circuit 56. The active pump 22 is next operated for a predetermined fixed time period TF . During the fixed time period TF, an incremental weight amount W1 of material will be conveyed into the collection container 20. This incremental amount W1 represents the difference between the weight of the container 20 at the beginning of the time period TF and the weight of the container 20 at the end of the time period TF. In accordance with the invention, the fixed time periodTF is preferably purposely selected so that the incremental weight amount W1 collected is less than the selected initial weight offset amount WO, i.e., WI WO. The end point weight amount WF is therefore purposely not the target of the circuit 56 at this stage of the intermittent mode. After the fixed time period TF has elapsed, the active pump 22 is again stopped. Preferably, another time delay TD follows to allow the weight sensor 32 to again stabilize. In accordance with the invention, the incremental weight amount WI which is collected during the fixed time period TF is latched and retained by the circuit 56 for later use. In particular, this data is used to precisely control the subsequent delivery of material to the collection container 20 until the desired end point weight amount WF is reached. The then existing weight amount WE of material present in the collection container 20 is now compared to the desired end point weight amount WF If the then existing weight WE is less than the desired end point weight amount WF a present weight difference amount WD is derived. Preferably, to control the amount by which the circuit 56 can overshoot the desired end point weight amount WF, the end point weight amount WF, to which the existing weight amountWE is compared, is offset by a small overshoot prevention weight anount we . Therefore, preferably, WD WF WB WE, as shown in Fig. 3. Based on the data latched and retained in preceding steps, the weight evaluation circuit 56 next calculates a new time period etc during which the active pump 22 will next be operated to convey additional material into the collection container 20. In accordance with the invention, this calculated time period TC represents the product of the predetermined fixed time period TF, employed during the first initial stage of the intermittent mode, multiplied by the quotient of the present weight difference amountWD and the incremental weight amount WI collected during the fixed time period TF i.e., TC TF . WD, as shown in Fig. 3. w It has been discovered that, regardless of the particular physical dimensions or elasticity of the tubing regardless of the particular characteristics of the pump and regardless of the particular specific gravity or density of the material being conveyed, the ratio between the change in weight amount and the corresponding pumping interval remains essentially constant for a given tubing segment, a given pump, and a given material. Therefore, in accordance with the invention, the weight evaluation circuit 56 initially operates the active pump 22 for the fixed time period TF and measures the initial incremental weight amount WI as a prelude to deriving later, more precise control signals. More particularly, realizing that, for a given flow system, the relationship between weight amount conveyed over time remains relatively constant, the length of any subsequent time period tic required to convey a desired increment weight amount of material WD is computed by the evaluation circuit 56 as follows W, w TF Therefore T TF . WD, as shown in Fig. 3. Preferably, as shown in Fig. 3, the weight evaluation circuit 56 will not operate the active pump 22 for a time period which is less than a predetermined minimum TMIN or exceeds a predetermined maximum TMAX , regardless of the magnitude of the calculated time period TC derived by the circuit 56 based upon then existing conditions. The minimum time period TMIN serves to prevent stalling of the pump due to control signals of insufficient magnitude. The maximun time period TMAX serves, like the overshoot weight offsetWB, to control the amount by which the circuit 56 can overshoot the desired end point weight amount WF. As shown in Fig. 3, then, once the calculated time periodTC is derived, the circuit 56 compares TC both to the predetermined minimum time period TMIN and to the maximum time period TMAX If the calculated time period TC exceeds the maximum time period TMAX, the active pump 22 is operated only for the maximum time period TMAX. If the calculated time period TC is less than the maximum time period TMAX, the active pump 22 is operated for either the calculated period TC or the minimum time period TMIN, whichever is greater. The active pump 22 is operated either for the maximum time period TMAX, or the calculated time period Tc, or the minimum time period TWIN, as appropriate. After another preferred time delay TD, the then existing weight amount WE is again compared to the desired end point weight amount WF. If the then existing weight amount WE equals or exceeds the desired end point weight amount WF, further operation of the active pump 22 is terminated.A new active pump 24, or 26 is selected and the heretofore described steps are repeated in their entirety. However, if WE WF, another comparison of the present weight WE to the end point weight WF, preferably adjusted by the overshoot prevention amount UB, is made to derive another incremental weight amount WD. Another incremental time periodTC is calculated, based now upon the existing incremental weight amount WD needed to obtain the desired end point WF. Again, in accordance with the invention, the length of this new calculated time period TC represents the product of the initial fixed time period TF multiplied by the quotient of the now existing weight offset amount WD and the initial incremental weight amount WI. The sequence of the preceding paragraph is repeated until the then existing weight amount WE equals or exceeds the desired end point weight amount WF. Another preferred embodiment is shown in Fig. 4. This embodiment is identical to the one shown in Fig. 3 and as heretofore described, except that, in each reiteration, the calculated time period TC and the corresponding incremental weight increase observed during the preceding iteration are used in place of TF and W1 to calculate the new time period TC. In this embodiment, then, the circuit 56 is constantly adapting itself to the most recently observed flow characteristics of the device 10. More particularly, as shown in Fig. 4, during the first iteration when RUN 1 , the calculated time period TC represents the product of the fixed time period TF and the quotion of the present weight offset amount WD and the first incremental weight amount WI. Both WI and TC are retained by the circuit 56. In subsequent iterations when RUN 1 , as shown in Fig.4, the new calculated time period New Tc represents the product of the preceding calculated time period Last TC and the quotion of the present weight offset amount WD and the preceding incremental weight amount Last W1 . The pump control system 12 as just described may be variously operated. In the illustrated embodiment, in which the system 12 is used to precisely control the delivery of hyperalimentation solutions, the following system parameters can be used Initial Weight Offset Amount Wg 20 grams Predetermined Time Delay Interval TD 750 milliseconds Fixed Time Period TF 500 milliseconds Overshoot Prevention Weight Offset WB 1 gram Maximum Pump Time Period TMAX 750 milliseconds Minimum Pump Time Period TMIN 250 milliseconds EXAMPLE The pump control system 12 having the above listed system parameters was used to control delivery of various hyperalimentation solutions, and its speed, accuracy, and reliability were compared to the following conventional compounding methods 1 Transfer using only gravity flow, without the use of pumps hereafter referred to as Gravity 2 Transfer using a commercially available vacuum pumping unit hereafter referred to as Vacuum and 3 Transfer by conventional peristaltic pumps, using a commercially available three station volumetric pumping device which does not utilize the system 12 of the invention hereafter referred to as Conventional Pump . The volumetric delivery accuracy was calculated from gravimetric and specific gravity data. The results are shown in the following Table 1. Table 1 Volumetric Delivery Accuracy Mean Volumetric Method error t SD System 12 0.45 0.32 Vacuum 1.11 1.00 Gravity 2.79 t 1.54 Conventional Pump 5.12 5.65 Table 1 demonstrates that the system 12 which embodies the features of the invention is more accurate than any of the conventional methods studied. The mean time required to compound a patient specific, three component hyperalimentation formulation using the system 12 and each of the conventional methods was also calculated. The results are summarized in the following Table 2. Table 2 Patient Specific Formula Compounding Time Required to Transfer Varied Amounts of Amino Acid, 50 Dextrose, and Water to an Empty Final Container Three Component Transfer Mean Time t SD Method Minutes System 12 1.15 0.05 Conventional Pump 7.22 0.38 Vacuum 9.62 0.32 Gravity 23.40 1.92 Table 2 demonstrates that the system 12 which embodies the features of the invention was significantly the fastest method to compound three component formulations. In addition to being both more accurate and faster, Table 1 and Table 2 demonstrate that the system 12 was more reliable than any of the other methods studied, by virtue of having the lowest standard deviation SD . The above Example clearly demonstrates the superiority of the system 12 which embodies the features of the invention, in terms of speed, accuracy, and reliability. Various features of the invention are set forth in the following claims.